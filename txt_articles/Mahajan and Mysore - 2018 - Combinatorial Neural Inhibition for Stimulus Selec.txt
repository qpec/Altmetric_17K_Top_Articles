 Article
Combinatorial Neural Inhibition for Stimulus
Selection across Space
Graphical Abstract
Highlights
d Imc, a midbrain inhibitory nucleus, encodes visual space with
multilobed RFs
d Such coding of space by the owl Imc is necessitated by
scarcity of Imc neurons
d It results in combinatorially optimized inhibition for stimulus
selection
d This solves stimulus selection at all location pairs while
minimizing neural costs
Authors
Nagaraj R. Mahajan, Shreesh P. Mysore
Correspondence
shreesh.mysore@jhu.edu
In Brief
Mahajan et al. show that a sparse set of
midbrain inhibitory neurons encodes
visual space with unusual multilobed
receptive fields. This results in a
combinatorially optimized solution for
selection at all pairs of stimulus locations,
which minimizes metabolic and neural
wiring costs.
Mahajan & Mysore, 2018, Cell Reports 25, 1158–1170
October 30, 2018 ª 2018 The Author(s).
https://doi.org/10.1016/j.celrep.2018.10.022
 Cell Reports
Article
Combinatorial Neural Inhibition
for Stimulus Selection across Space
Nagaraj R. Mahajan1 and Shreesh P. Mysore2,3,*
1Department of Electrical and Computer Engineering, Johns Hopkins University, Baltimore, MD 21218, USA
2Departments of Psychological and Brain Sciences, and Neuroscience, Johns Hopkins University, Baltimore, MD 21218, USA
3Lead Contact
*Correspondence: shreesh.mysore@jhu.edu
https://doi.org/10.1016/j.celrep.2018.10.022
SUMMARY
The
ability
to
select
the
most
salient
among
competing stimuli is essential for animal behavior
and operates no matter which spatial locations stim-
uli happen to occupy. We provide evidence that the
brain employs a combinatorially optimized inhibition
strategy for selection across all pairs of stimulus lo-
cations. With experiments in a key inhibitory nucleus
in the vertebrate midbrain selection network, called
isthmi pars magnocellularis (Imc) in owls, we discov-
ered that Imc neurons encode visual space with
receptive fields that have multiple excitatory hot
spots (‘‘lobes’’). Such multilobed encoding is neces-
sitated by scarcity of Imc neurons. Although distrib-
uted seemingly randomly, the locations of these
lobes are optimized across the high-firing Imc neu-
rons, allowing them to combinatorially solve selec-
tion across space. This strategy minimizes metabolic
and wiring costs, a principle that also accounts for
observed asymmetries between azimuthal and ele-
vational coding. Combinatorially optimized inhibition
may be a general neural principle for efficient stim-
ulus selection.
INTRODUCTION
Animals routinely encounter multiple competing pieces of infor-
mation in their sensory environments. Typically, they handle
this informational complexity by selecting the most salient or
behaviorally relevant piece of information, i.e., highest ‘‘priority’’
information, to guide their actions (Fecteau and Munoz, 2006;
Knudsen, 2007). However, how neural circuits orchestrate the
computations that are essential for such stimulus selection is
not well understood. Here, we unravel the neural basis of one
such critical computation, namely, selection at all possible pairs
of locations. This property permits spatial selection to operate
no matter which specific locations in the sensory world the
competing stimuli occupy. Although appearing straightforward,
the implementation of comparisons between all possible pairs
of stimulus locations is computationally complex: the number
of location pairs at which two competing stimuli could be placed,
L2 � L/2, scales quadratically with L, the number of spatial loca-
tions that are encoded. How does the brain meet the resulting
demands imposed on neural circuitry and solve stimulus selec-
tion at all possible pairs of locations?
A brain network with a well-established role in spatial target
selection, and therefore an excellent locus to study this question,
is the midbrain selection network. It includes the sensorimotor
hub, the superior colliculus (SC) (or the optic tectum [OT] in
birds), and a satellite inhibitory nucleus called the lateral
tegmental nucleus (Graybiel, 1978; Jiang et al., 1996), or isthmi
pars magnocellularis (Imc) in birds (Sereno and Ulinski, 1987;
Wang et al., 2004) (Figure S1A). The SC/OT, which encodes a
topographic map of sensory (and motor) space (Knudsen,
1982; Meredith and Stein, 1986), plays a critical role in stimulus
selection across spatial locations. Specifically, the intermediate
and deep layers of the SC (SCid) (called OTid in birds) are
required for the selection of the highest priority stimulus among
distracters (Lovejoy and Krauzlis, 2010; McPeek and Keller,
2004). This selection, which occurs across all possible locations
of the competing stimuli, is expressed in the activity of SCid/OTid
neurons as response suppression. When one stimulus is pre-
sented at any location, the responses of SCid/OTid neurons en-
coding that stimulus are suppressed by a competing stimulus
presented anywhere outside the neurons’ spatial receptive field
(RF) (Mysore et al., 2010, 2011; Rizzolatti et al., 1974). The
strength of suppression depends on the priorities of the
competing stimuli, and is largely independent of their specific
spatial locations (Mysore et al., 2010, 2011; Rizzolatti et al.,
1974).
Mechanistically, competitive suppression in the OTid is
orchestrated by the GABAergic Imc through its specialized
anatomical connectivity with the OT (Marı
´n et al., 2007; Mysore
and Knudsen, 2013; Wang et al., 2004). Neurons in layer 10 of
the OT (OT10) provide input to each Imc neuron, which, in turn,
projects back broadly across the OTid space map except to
the portions that encode the input locations (Wang et al., 2004)
(Figure S1B). This anatomy allows the Imc to implement a spatial
inverse operation, distributing priority-dependent inhibition to all
competing locations in the OTid space map (Figure S1C).
Notably, inactivation of the Imc abolishes this competitive inhibi-
tion as well as spatial selection in the OTid (Marı
´n et al., 2007;
Mysore and Knudsen, 2013).
In this context, if the spatial RFs of Imc neurons are assumed
to be small, resembling those of the input OT10 neurons, and
possessing the same topographic property as them, a concep-
tually straightforward strategy by which the Imc might achieve
1158
Cell Reports 25, 1158–1170, October 30, 2018 ª 2018 The Author(s).
This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).
 selection for all possible pairs of locations in the OTid is illus-
trated in Figure S1D. For any given pair of stimulus locations,
each stimulus in the pair would activate a group of neighboring
Imc neurons encoding for adjacent locations, resulting in inhibi-
tion with a spatial pattern that would suppress the neurons en-
coding the other stimulus (Figure S1D). Simply repeating this
Imc-OT circuit module for all location pairs would successfully
implement stimulus selection across space with a strategy
termed ‘‘modular copy-and-paste.’’
However, the precise nature of the spatial RFs of Imc neurons
and their properties are not well understood. Previous work in the
Imc suggests that Imc neurons have spatial RFs that are verti-
cally elongated, covering almost the entire extent of elevational
space in an uninterrupted manner (Li et al., 2007; Wang and
Frost, 1991). If true, such Imc RFs lead to a computational
paradox. On the one hand, vertically elongated Imc RFs are un-
able to implement stimulus selection in the OT at all possible
stimulus location pairs: selection cannot be solved for over a
third of the location pairs along the elevation (Figure S1E). On
the other hand, competitive stimulus selection in the OTid is
known to occur across all encoded locations (Mysore et al.,
2010, 2011; Rizzolatti et al., 1974), with the Imc being the primary
source of competitive inhibition (Marı
´n et al., 2007; Mysore and
Knudsen, 2013). To resolve this paradox, we set out to investi-
gate the functional properties of Imc neurons in the barn owl,
as well as the computations implemented by the Imc-OT
network in service of stimulus selection across space.
Our results indicate that the Imc employs a combinatorially
optimized inhibition strategy to solve stimulus selection at all
location pairs in the OT. This strategy is supported by an unusual,
multilobed encoding of visual space by Imc, one that is consis-
tent with the observed scarcity of Imc neurons available to
encode stimulus locations. Although the lobes of individual Imc
RFs are distributed seemingly randomly in space, their locations
are optimized across neurons such that assorted but intersect-
ing subsets of Imc neurons are recruited to combinatorially solve
selection across two-dimensional (2D) visual space. We show
that Imc’s combinatorially optimized inhibition strategy for
spatial selection minimizes metabolic and neural wiring costs.
Moreover, within this framework of neural cost minimization,
asymmetries observed in Imc’s encoding of elevational versus
azimuthal locations are accounted for by asymmetries in its
anatomical organization. Together, combinatorially optimized in-
hibition emerges as an efficient strategy for stimulus selection.
RESULTS
Spatial RFs of Imc Neurons Have Multiple ‘‘Lobes’’
We measured the visuospatial RFs of Imc neurons using extra-
cellular recordings (STAR Methods). Individual Imc units were
identified by spike sorting single and multiunit data; only those
units deemed to be of ‘‘high quality’’ were included in the anal-
ysis (STAR Methods). Consistent with published data, Imc neu-
rons have high firing rates (median, 76.5 Hz [Goddard et al.,
2014; Marı
´n et al., 2007]; Figures 1A, 1B, 1E, and 1F).
We found that individual Imc neurons possessed visual RFs
with multiple, distinct response fields or lobes (Figures 1A–1H,
S2A, and S2B). The number of lobes in each RF was estimated
in an unbiased manner using a two-step process (STAR
Methods): (1) a nonlinear clustering method (Rodriguez and
Laio, 2014) to fit different numbers of clusters to the spatial
map of firing rates followed by (2) a model selection method
(Tibshirani et al., 2001) to robustly select the optimal number of
clusters in the data (Figures 1C, 1G, and S2C–S2F). We found
that about two-thirds of Imc neurons had multilobed RFs
(80/116; see also Figure 1L).
To test whether the multilobed structure of Imc RFs was an
artifact of our experimental or analytical methods, we performed
three controls. First, we tested whether errors in spike sorting
might have caused multiple units with single-lobed RFs to be
misidentified as a single unit with a multilobed RF. To this end,
we applied an additional separability criterion to our sorted units.
We tested the statistical separability of the waveforms of each
sorted unit with those of any other unit as well as with outlier
waveforms recorded at the same site, and retained only those
units that were well separated (STAR Methods). We found that
the majority of the sorted units (114/116) satisfied the separa-
bility criterion as well (p < 0.05; Figure 1I), ruling out multiunit
contamination as a source of error. Second, we examined
whether the spatial sampling resolution used for RF measure-
ment, as well as neuronal response variability, might have
caused the erroneous identification of single-lobed RFs as being
multilobed (Figure S2G). Using experimentally grounded simula-
tions, we mapped out the values of sampling step size and
response Fano factor that yielded a multilobe misidentification
rate of 5% or greater (Figure 1J, red zone; STAR Methods). By
comparing with experimental data, we found that the values of
these parameters from each recorded unit fell outside the 5%
misidentification zone. As a final control, because it is well estab-
lished that OT RFs have single spatial response fields, we
measured visual RFs of OT neurons. Our methods correctly iden-
tified all of the measured OT RFs as being single-lobed (Figures
1K and S2H). Together, these results confirmed the veracity of
our conclusion that the Imc contains predominantly ‘‘multilobe’’
neurons (68%; 78/114; Figure 1L).
RF Lobes Are Distributed along the Elevation, but Not
Azimuth
To investigate organizing principles underlying spatial encoding
by Imc neurons, we analyzed the properties of the measured vi-
sual RFs along the two major anatomical axes of the Imc (Fig-
ure S1A). The azimuthal centers of RF lobes were nearly identical
for lobes of individual multilobed neurons (Figure 2A, blue data;
STAR Methods), across neurons recorded at a given site (Fig-
ure 2B, blue data), and across sites recorded along the dorso-
ventral axis of the Imc (Figure 2C; STAR Methods). However,
azimuthal encoding varied systematically along the rostrocaudal
axis of the Imc: centers of RF lobes encoded progressively more
peripheral azimuths as the recording electrode was moved from
rostral to caudal portions of the Imc (Figure 2D; (Li et al., 2007;
Wang and Frost, 1991)).
The encoding of elevation by Imc neurons was strikingly
different. RF lobes of individual multilobed neurons were spaced
arbitrarilyinelevation(Figure2A:largerangeofreddata).Addition-
ally, RF lobes of multilobed Imc neurons were distributed widely
across elevational space: for each multilobed neuron (Figure 2A,
Cell Reports 25, 1158–1170, October 30, 2018
1159
 inset: large median of data), across neurons recorded at a given
site (Figure 2B, red), and across sites recorded along both dorso-
ventral and rostrocaudal axes (Figures S3A–S3D). There was also
no systematic relationship between encoded elevations and dis-
tance along either principal axis (Figures S3A and S3B).
These results demonstrated that whereas azimuthal space is
encoded in a topographic manner along the rostrocaudal extent
of the Imc, elevational space is encoded by RFs with multiple,
arbitrarily spaced, and widely distributed lobes of varying num-
ber and size (Figures S3E–S3J), with a maximum of three RF
lobes per neuron (Figure 1L).
Neuronal Scarcity in Coronal Planes of Imc Necessitates
Multiple RF Lobes along Elevation
The multilobed encoding of elevational space by Imc neurons
was puzzling. This was especially so because neurons that
-10
10 
40 
30 
20 
10 
0  
-10
-20
-30
-40
-50
40 
30 
20 
10 
0  
-10
-20
-30
-40
-50
0
20
40
60
80
100
sp/s
1 2 3 4 5 6
k
-1
0
1
GAP
100%
1 lobe
A
B
C
D
I
K
L
250 μs
k
GAP
E
F
H
-10
0  
10 
-15
-5
5
15 
40 
30 
20 
10 
-10
-20
-30
-40
-50
0  
Time(ms)
J
-10
10 
1 2 3 4 5 6
Time (ms)
0  
100
-200
350 500
55 
45 
35 
25 
15 
5  
-5 
-15
-25
-35
-45
-55
20
40
60
80
100
sp/s
 5
15
25
35
-55
-45
-35
-25
-15
-5 
5  
15 
25 
35 
45 
55 
55 
45 
35 
25 
15 
5  
-5 
-15
-25
-35
-45
-55
-50
0  
40 
-55
5  
55 
0  
100350 750
250 μs
0
0.5
0
-50
0  
40 
G
Azimuth (°)
Elevation (°)
Azimuth (°)
Elevation (°)
Azimuth (°)
Elevation (°)
Azimuth (°)
Elevation (°)
Azimuth (°)
Elevation (°)
Azimuth (°)
Elevation (°)
0
-10
10 
0
-10
10 
0
Azimuth (°)
Elevation (°)
Elevation (°)
Elevation (°)
Azimuth (°)
-10
10 
0
-50
0  
40 
0
152535
5
Elevation (°)
-55
5  
55 
Elevation (°)
25
5
25
5
25
5
-55
5  
55 
Elevation (°)
Azimuth (°)
Azimuth (°)
5 152535
32%
58%
10%
2 lobes
1 
lobe
3
n = 114
n = 69
-25
-20
-15
-10
-5
0
log10(p)
100%
20
45
15
0
5
10
15
20
25
5
30
35
El step
Fano factor of RF
Az step
15
5
15
0
5
1
2
Fano factor of RF
10
5
El step
Az step
10
Figure 1. Visual Receptive Fields of Imc Neurons Have Multiple Distinct Response Fields (Lobes)
(A) 2D visual receptive field (RF) of Imc neuron: raster plot of neuron’s responses to visual stimulus presented at different spatial locations. Inset top: gray line,
stimulus onset; red lines, time window used to calculate firing rate; evoked firing rates in Imc were high (median, 76.5 Hz; n = 114 neurons). Inset bottom: average
spike waveform for neuron in (A); identified as high-quality unit (STAR Methods); mean (black) ± SD (gray).
(B) Color-coded firing rate map corresponding to (A).
(C) Rate map in (B) re-plotted as distribution of points in a 2D plane and subjected to spatial clustering (STAR Methods). Shown are the best single (top left), best
two (top right), and best three clusters (bottom left) fitted to the data using the density peaks clustering method (Rodriguez and Laio, 2014) (Figure S2C; STAR
Methods). Bottom right: plot of GAP statistic, a robust model selection metric, against the number of clusters (k) fitted to data (Tibshirani et al., 2001) (STAR
Methods). Red point: statistically optimal number of clusters (k*), identified as the smallest k for which GAP exceeds zero; here k* = 2 (STAR Methods) (Tibshirani
et al., 2001).
(D) Half-max extents of these two optimal RF clusters (lobes).
(E–H) Same as (A)–(D), but for a different Imc neuron.
(I) Plot of p values (logarithmic scale) obtained from separability testing for each sorted unit; one-way ANOVA followed by correction for multiple comparisons
(STAR Methods). p value < 0.05 (blue data): units that are deemed ‘‘well separated’’ from co-recorded units as well as outliers (n = 114). Red data: units not well
separated form cohort.
(J) Effect of neuronal response variability and spatial sampling step size on number of RF lobes detected in a simulated single-lobed RF; Monte Carlo analysis
(Figure S2G; STAR Methods). Red area: Fano factor and step size pairs yielding >5% rate of misidentifying single-lobed RF as multilobed. Blue data: experi-
mentally recorded Imc neurons (n = 114).
(K) Summary of number of RF lobes across 69 OT neurons. See also Figures S1 and S2.
(L) Summary of number of RF lobes across 114 Imc neurons.
1160
Cell Reports 25, 1158–1170, October 30, 2018
 provide input to the Imc (OT10), as well those that receive Imc’s
output (OTid), all tile sensory space with single-lobed spatial
RFs organized topographically in both elevation and azimuth
(Figure 1K) (Knudsen, 1982). Might the implementation of stim-
ulus selection across space, a main function of the Imc (Mysore
and Knudsen, 2013), impose demands on the spatial coding
properties of Imc neurons that can explain multilobed RFs?
To examine the implications of spatial selection on Imc RF
structure and, specifically, of the need for implementing stimulus
selection at all possible location pairs, we turned to theory (STAR
Methods). Briefly, we compared the total number of location
pairs at which selection must occur in the OTid, with the number
of location pairs in the OTid at which selection can be achieved
by a set of Imc neurons. Since multilobed Imc encoding is
restricted along the elevation (Figures 2A, 2B, and S3A–S3D),
we focused on stimulus selection between all possible pairs of
elevations at any azimuth. We proved mathematically that if
the number of Imc neurons (N) encoding different elevations at
a given azimuth is less than the number of distinct elevational lo-
cations (L) encoded by the OTid at that azimuth (N < L), then
multilobed Imc RFs are necessary for stimulus selection at all
possible location pairs (STAR Methods).
To examine the biological applicability of this insight, we esti-
mated L and N in the owl brain. For a given azimuth, the OTid en-
codes elevations ranging typically from �60� to +60�, and does
so at a spatial resolution of at least 3� (STAR Methods). Conse-
quently, the number of distinct elevational locations encoded
by the OTid at a given azimuth (Lel) is at least 120�/3� = 40
(Lel R 40). Next, we estimated the number of Imc neurons en-
coding these elevational locations (Nel). Because visual azimuth
is organized topographically along Imc’s rostrocaudal axis (Fig-
ure 2D), transverse sections of the Imc provide snapshots of Imc
tissue encoding all elevations at a given azimuth (Figures 3A and
3B). We obtained histological sections perpendicular to the ros-
trocaudal axis of the Imc and performed Nissl staining to visu-
alize cell bodies (STAR Methods). Counts of the number of
Nissl-stained somata (Garcı
´a-Cabezas et al., 2016) showed
that the majority of sections (75%) had fewer than 28 neurons
per section (Nel; Figures 3B and 3C). Thus, Nel is typically
much smaller than Lel (median Nel/Lel < 26/40 = 0.65).
In contrast, along the azimuth, Naz is greater than or equal to
Laz. The OTid encodes azimuths ranging typically from �15� to
60� at a spatial resolution of at best 1� (STAR Methods). As a
result, the number of distinct azimuthal locations encoded by
OTid is at most 75 (Laz % 75). On the other hand, we estimated
that there are at least 84 neurons involved in encoding these
distinct azimuths, Naz R 84 (STAR Methods). Thus, there are
more Imc neurons than there are encoded azimuthal locations
(Naz R Laz), an observation that is consistent with the absence
of multilobed RFs along the azimuth.
A
B
0
0.5
1
1.5
  2
Distance from rostral-most 
penetration (mm)
0
10
20
30
40
50
60
C
D
# recording sites
Azimuth
Az
El
Maximum lobe distance 
(°)
0  
0.1
0.2
0.3
0.4
0.5
0
10
20
30
40
50
60
Depth from dorsal-most 
site (mm)
Azimuth
# neurons
∆ azimuth
*
0
40
80 120
0
15
30
0
40
80
120
Pairwise lobe distance 
(°)
0
20
40
# neurons
*
0
40
80
120
0
5
10
15
5°
40°
0°
55°
0
40
80 120
Max. lobe distance(°) 
0
20
# neurons
 50°
0°
*
66°
Figure 2. RF Lobes of Multilobe Imc Neu-
rons Are Distributed along Elevation but
Not Azimuth, and RFs Are Organized Topo-
graphically in Azimuth, but Not Elevation
(A) Histograms of pairwise distance between
centers of RF lobes of individual multilobed neu-
rons (STAR Methods). Blue: azimuthal distance;
red: elevational distance; marked range: 5th to
95th percentile range of red data; large range in-
dicates arbitrary spacing of RF lobes. Arrows:
median values; *: median significantly different
from 0 (p = 0.17, azimuth; p < 0.05, elevation; one-
tailed
rank
sum
tests).
Inset:
histogram
of
maximum elevational distance between centers of
RF lobes of an individual multilobed neuron. Ar-
row: median value; significantly different from 0
(p < 0.05, one-tailed rank sum test); large median
indicates widely distributed RF lobes.
(B) Histograms of maximum distances between
centers of RF lobes of multilobed neurons sorted
from individual recording sites (STAR Methods);
conventions as in (A); p = 0.65 for azimuth; one-
tailed rank sum test, p < 0.05 for elevation; one-
tailed t test.
(C) Plot of average azimuthal center of a recording
site against the dorsoventral position of the site
within the Imc (STAR Methods); colors: different
penetrations. Inset: data re-plotted as histogram
of pairwise differences in the azimuthal centers of
recording sites along a dorsoventral penetration
(p = 0.18, one-tailed rank sum test).
(D) Plot of average azimuthal ‘‘center’’ of a
dorsoventral penetration against the rostrocaudal
position of electrode in the Imc in that recording
session
(STAR
Methods).
Colors:
different
recording sessions; Spearman correlation = 1 in
each case. See also Figure S3.
Cell Reports 25, 1158–1170, October 30, 2018
1161
 These results indicated that multilobed encoding by Imc neu-
rons is consistent with the need for the Imc-OT circuit to achieve
stimulus selection at all possible elevational location pairs in the
face of a scarcity of Imc neurons encoding elevation (Figures 3B
and 3C).
Model Predicts Combinatorially Optimized Inhibition for
Selection at All Location Pairs
To explore how an under-complete set of Imc neurons might
implement selection at all possible location pairs, we turned to
computational modeling. We set up stimulus selection across
spatial locations as an optimization problem with L locations
(elevations at a given azimuth), and N model neurons encoding
those elevations (N < L; Figure S4; STAR Methods). We imbued
all model neurons with Imc-like spatially inverting connectivity
with the OT (Figures S1 and S4). The spatial RFs of these model
Imc neurons were represented, for simplicity, using ones and
zeros, with ones corresponding to locations inside the RF, and
zeros, outside (Figure 4B; also see Figure S4 for validity of model
even when this assumption is relaxed).
The goal of the optimization was to identify the spatial RF
structures of these N neurons (i.e., the numbers of their RF lobes
and their spatial locations), such that when two stimuli of equal
priority were placed at any pair of locations, they suppressed
each other equally. This necessary and sufficient condition for
implementing selection at all location pairs was captured by a
specially constructed cost function whose value decreased as
the number of location pairs at which the above condition was
satisfied increased. The cost function took the lowest possible
value of –L(L � 1) if and only if the condition was satisfied at all
location pairs (STAR Methods). Any set of Imc RFs that achieved
this minimum value, i.e., that achieved selection for all location
pairs, was called an ‘‘optimal solution.’’
For each value of L, we varied the number of neurons in the
model from N = 1 to N = L. In addition, in each case, we examined
the impact of single as well as multilobed RFs on the existence
and nature of optimal solutions. We did so by including a
constraint that specified the maximum number of lobes allowed
in a model neuron’s RF, denoted by kmax. The values of kmax
tested were 1, 3, and 10, corresponding to key experimentally
relevant values: kmax = 1 only permitted model neurons with
(traditional) single-lobed RFs as potential solutions to the optimi-
zation problem; kmax = 3 permitted up to three lobed RFs, in line
with the experimental data (Figure 1L); and kmax = 10 allowed up
to 10 lobes per RF, representing the largest number of typical
Imc RF lobes that one can fit within the encoded elevational
space (STAR Methods). Therefore, the main parameters in the
optimization problem were L (number of locations), kmax
(maximum number of RF lobes allowed per neuron), and N (num-
ber of Imc neurons). For each triplet of (L, kmax, N), we ran the
optimization problem 1,000 times (Monte Carlo simulation),
each time with a different, randomly chosen initial condition, to
explore the space of potential optimal solutions.
We found that L = 5 was the smallest number of locations for
which selection could be solved at all location pairs with fewer
than 5 neurons (Figure 4B). The fewest number of neurons
needed by the model in this case, called N*, was 4 (Figure S5A;
STAR Methods). Therefore, the maximum ‘‘savings’’ in the num-
ber of Imc-like neurons for L = 5 locations was 1 (=L � N*). We
found that as L increased, neuronal savings increased (Fig-
ure 4A; orange data), with L = 40 locations requiring just
N* = 27 neurons to solve selection at all location pairs (savings
of 13 neurons or 32%). Neuronal savings also increased as a
function of kmax, the maximum number of RF lobes allowed
per neuron (Figure 4A; black versus orange data). Notably,
when only single-lobed RFs were allowed in the model
(kmax = 1), N* was always equal to L, and there were no neuronal
savings (Figure 4A; blue data). Thus, consistent with our theoret-
ical prediction, selection at all possible location pairs could not
be achieved with fewer than L neurons if all neurons only had
single-lobed RFs.
The primary motivation for our optimization-based modeling
approach was to gain insight into the computational logic under-
lying successful stimulus selection at all possible location pairs
when neurons are scarce. An example optimal solution obtained
when L = 5 locations, kmax = 3 lobes, and N = 4 neurons (Fig-
ure 4B), illustrates how fewer than L inhibitory neurons can suc-
cessfully achieve selection at all location pairs (Figures 4C and
4D). Figure 4E shows another example optimal model solution,
obtained when L = 40 locations, kmax = 3 lobes, and N = 27
(N*) neurons.
A
B
C
Figure 3. Imc Encodes Elevations with a Sparse Number of Neurons
(A) Coronal section of owl midbrain showing Imc and OT.
(B) Zoomed-in image showing individual, Nissl-stained, Imc somata (arrow-
heads); 22 somata in this section. The zoomed-in image was obtained by
stitching 5 images (each taken at 403 magnification) with overlapping fields of
view at the edges.
(C) Violin plot showing number of Imc somata per coronal section; each dot,
one section; n = 64 sections across two owls. Dashed line: median (26 neu-
rons); solid line: 75th percentile (28 neurons).
1162
Cell Reports 25, 1158–1170, October 30, 2018
 Detailed analysis of optimal model solutions from all runs of
all (L, kmax, N) values tested with N < L revealed that every
single optimal solution exhibited three functional properties,
which we refer to as signature properties. (Figure 5 illustrates
these properties for the example optimal solution in Figure 4B
and also summarizes them quantitatively for all optimal solu-
tions.) First, every optimal solution contained multilobed Imc
neurons (Figures 4B, 4E, and 5A). Conceptually, this ‘‘multilobe
property’’ is necessary because of the scarcity of neurons, i.e.,
the N < L constraint, as demonstrated previously by theory
(STAR Methods).
Second, the RFs of the neurons in optimal solutions collec-
tively exhibited the ‘‘optimized lobe overlap’’ property: every
multilobed neuron shared each of its lobes, but not all, with
another neuron (Figures 5B–5D). To visualize this property,
consider a two-lobed neuron Ma (Figure 5B: for instance, neuron
#1 in Figure 4B). There necessarily existed another neuron B (for
instance, neuron #2 in Figure 4B) in the solution such that the up-
per lobe of Ma was shared with the lobes of neuron B, but the
lower lobe of Ma was not. Similarly, there also existed another
neuron C (for instance, neuron #3 in Figure 4B) in the optimal
model solution such that the lower lobe of Ma was shared with
the lobes of neuron C, but not the upper lobe. (Here, the neurons
B and C could be either single-lobed or multilobed.) This prop-
erty was quantified using a binary score: briefly, each optimal so-
lution was assigned a score of 1 if every multilobed neuron in that
solution satisfied the optimized lobe overlap property (as illus-
trated in Figure 5B), and 0 otherwise. We found that every
optimal solution obtained had a score of 1 (Figure 5C). Concep-
tually, the optimized lobe overlap property is necessary because
selection needs to be solved also when two stimuli are placed at
the locations encoded by different lobes of an individual multi-
lobed neuron (Figure 5D). Consequently, this imposes a severe
constraint on the relative organization of RF lobes across neu-
rons in optimal solutions—one that causes structured non-
orthogonality of the RFs.
Third, neurons in optimal solutions used a ‘‘combinatorial inhi-
bition’’ strategy to achieve stimulus selection at all location pairs
(Figures 5E–5J). The combinatorial nature was quantified via a
pair of necessary and sufficient conditions, namely that assorted
subsets of neurons were selectively recruited to solve stimulus
selection for individual location pairs, with the subsets corre-
sponding to different location pairs intersecting extensively.
An optimal solution was said to exhibit the assortedness
feature if ‘‘distant’’ neurons were recruited to solve selection be-
tween even nearby locations (Figures 5E and 5F), and vice versa
(Figures 5E and 5G), no matter the specific ordering of neurons in
the optimal solution (Figure S5B; STAR Methods). This feature
was quantified for each optimal solution (STAR Methods): briefly,
for a given ordering of neurons in an optimal solution, the selec-
tion matrix (as in Figure 4D) was constructed, ‘‘nearby’’ location
pairs were identified (STAR Methods), the largest distance be-
tween neurons recruited for selection at each nearby location
pair computed (STAR Methods), and the maximum value of
this ‘‘neuronal distance’’ obtained across all the nearby location
pairs in that solution. Then, the minimum value of this neuronal
distance was computed across all permutations of neurons
within that optimal solution, and across all optimal solutions for
C
A
B
D
E
Figure 4. Example Optimal Solution from Model Illustrates Stimulus Selection at All Location Pairs with an Under-Complete Set of Neurons
(A) Summary plot showing the fewest number of neurons (N*) needed by model to solve selection across all locations for different numbers of locations (L)
(Figure S5A; STAR Methods). kmax: maximum number of RF lobes allowed for each neuron (STAR Methods).
(B–D) Illustration of selection at all possible location pairs by an optimal model solution for L = 5 locations (numbered a–e) and N = 4 neurons (numbered #1–#4).
(B) The four RFs in the optimal solution. Shaded areas: RF of neuron; two neurons have multilobed RFs (#1, two lobes; #3, three lobes).
(C) Optimal solution in (B) implements selection between stimuli Sa and Sb at location pair ab (extreme left). Sa and Sb are of equal priority (1 unit for simplicity). Top
row: information flow through the model OT10-Imc-OTid circuit triggered by Sa. First column: activation of OT10 space map. Second column: activation of in-
dividual Imc neurons. Third column: suppression pattern generated by each activated Imc neuron (spatial inverse of the neuron’s RF; consistent with published
anatomical results; Figures S1B–S1E [Wang et al., 2004]). Fourth column: combined pattern of suppression in the OTid. Dark colors: 2 units of suppression; light
colors: 1 unit (STAR Methods). Curved arrow: net suppression driven by Sa location b. Dark-gray shading: ‘‘activated’’ neuron (#2); defined as a neuron driven by
Sa but that does not send inhibition to location b. Red shading: ‘‘recruited’’ neuron (#3); defined as activated neuron that sends inhibition to location b, thereby
involved in selection for location pair ab. Bottom row: same as top row, but for stimulus Sb.
(D) Selection matrix summarizing implementation of selection at all location pairs by optimal model solution in (A). Columns: ten possible location pairs; rows: the
four neurons. In each column: dark-gray, activated neurons; red, recruited neurons; blank, neurons not activated by either stimulus.
(E) Example optimal solution for (L, kmax, N*) = (40, 3, 27). Black pixels: locations inside neurons’ RF; white pixels, locations outside neurons’ RF.
Cell Reports 25, 1158–1170, October 30, 2018
1163
 that (L, kmax, N) triplet (Figure 5F; min-max distance). We found
that every optimal solution resulted in the recruitment of distant
neurons to solve selection at nearby locations (Figure 5F).
Conversely, every optimal solution resulted in the recruitment
of nearby neurons to solve selection for distant locations (Fig-
ure 5G; max-min distance). These results demonstrated the
assorted nature of optimal solutions (see also Figure S6).
An optimal solution was said to exhibit the extensive intersec-
tion feature if neural subsets recruited to solve selection even for
two location pairs in distant portions of space shared common
neurons (Figures 5H and 5I). This feature was quantified by first
identifying ‘‘doublets’’: two location pairs such that the locations
within each pair were nearby locations, but such that the two
pairs themselves occupied distant portions of space. Then we
checked whether the neural subsets recruited to solve selection
for at least one such doublet involved a common neuron, and
scored the solution as 1 if they did (STAR Methods). We found
that optimal solutions obtained from all runs exhibited this
feature (Figure 5I; see also Figure S6), demonstrating the exten-
sively intersecting nature of optimal solutions. Together, the
above results indicated that combinatorial inhibition was a signa-
ture property of optimal solutions.
Conceptually, combinatorial patterns of inhibition are a conse-
quence of the RF lobes of model Imc neurons being widely
distributed and arbitrarily spaced in the optimal solutions (Fig-
ures 5J, S6B, and S6D): restricting RF lobes to only nearby
locations substantially limits the number of available RF config-
urations, potentially precluding optimal solutions. Stated equiv-
alently, the combinatorial inhibition strategy arises because of
the combinatorial coding of space by the model Imc neurons: in-
dividual neurons do not always encode only for neighboring lo-
cations (Figures 4B, 4E, S6B, and S6D), and conversely, nearby
locations are not always encoded by ‘‘nearby’’ neurons (no
matter what permutation of neurons is considered; Figures
S5B, S6B, and S6D). Therefore, when two stimuli are presented,
two groups of the inhibitory Imc neurons are activated in a non-
ordered fashion, resulting in a combinatorial pattern of inhibition.
Taken together, the model revealed that selection at all
possible location pairs when N < L, as is the case with Imc’s
elevational coding, necessitates a combinatorially optimized in-
hibition strategy by multilobed neurons.
In contrast, when N R L, as is the case with Imc’s azimuthal
encoding, the model was always able to solve selection at
all location pairs with just single-lobed neurons (Figure 4A,
kmax = 1, blue data), by using the straightforward modular
copy-and-paste strategy (Figure S1D).
Experimental Validation of Model Predictions in Imc
The above modeling results indicated that sparse sets of Imc-like
inhibitory neurons use a combinatorially optimized inhibition
strategy to achieve selection at all possible location pairs. How-
ever, it is unclear whether the owl Imc does, in fact, implement
this strategy for selection across elevational locations. To
examine this, we tested whether the experimentally recorded ac-
tivity of Imc neurons exhibited the three signature properties of
combinatorially optimized inhibition predicted by the model.
Because all elevations at a given azimuth are encoded by neu-
rons within a coronal plane (Figures 2B and 2C), we sampled
these neurons by making recordings at multiple dorsoventral
sites within each coronal plane (STAR Methods).
Across recordings made in 16 such coronal planes, we found
that multilobed neurons were present in nearly every case
(14/16; Figures 6A and S3A), thereby validating signature prop-
erty #1. The impracticability of recording exhaustively from all
Imc neurons in a coronal plane made it infeasible to test whether
every lobe of each multilobed neuron satisfied the optimized lobe
overlap property (signature property #2; Figures 5B–5D). There-
fore, we tested whether at least one lobe of each multilobed
neuron satisfied it (Figure 6B; STAR Methods). The median frac-
tion of multilobed neurons in each coronal plane that satisfied
signature property #2 was 1 (Figure 6C).
Finally, we tested for signature property #3 (combinatorial inhi-
bition). Both its features, namely, assorted recruitment and
extensive intersection, were satisfied in nearly every testable
case (7/8 and 6/6 planes, respectively; Figures 6D–6G; STAR
Methods), despite the non-exhaustive sampling of Imc neurons
in individual planes. In addition, the computational basis of
combinatorial inhibition, namely, combinatorial coding of space
by model Imc neurons, which was quantified via the arbitrary
spacing and wide distribution of their RF lobes (Figure 5J), was
also found in experimental data (Figures 2A, 2B, and S3A–S3D).
Thus, our experimental results show that owl Imc neurons are
activated in a combinatorially optimized fashion that solves stim-
ulus-priority-dependent competitive selection across location
pairs in the OT.
DISCUSSION
This study unpacked the mechanistic underpinnings in owls of a
critical neural function, namely stimulus selection at all location
pairs, and revealed combinatorially optimized inhibition as an
efficient strategy for it when neurons are scarce. Combinatorial
activation of neurons is typically inferred by visualizing their pat-
terns of activation in response to stimuli; for instance, combina-
torial activation of odors by olfactory receptor neurons (Sicard
and Holley, 1984). Here, in addition to visualizing these patterns,
we quantified the underlying intuition by defining the ‘‘assorted-
ness’’ and ‘‘extensive intersection’’ features, which are neces-
sary and sufficient for combinatorial activation, and applied
this approach to both model solutions as well as experimental
data. This allowed for quantitative support for the finding
of combinatorially optimized activation of inhibitory neurons.
Broadly, this study was framed in the context of selection be-
tween pairs of stimulus locations. However, because selection
between more than two stimuli requires comparisons between
all the possible stimulus pairs, the results of this study apply
directly to the general problem of selection among any number
of competing stimuli.
Multilobed Visuospatial RFs and Stimulus Selection
Multilobed spatial RFs have not been reported previously in any
early visual area to the best of our knowledge. We found that, in
the Imc, a sensory area that is just two synapses away from the
retina (Wang et al., 2006), the majority of neurons have multi-
lobed visual RFs. This contrasts with previous reports of large,
vertically elongated visual RFs in the Imc (Li et al., 2007; Wang
1164
Cell Reports 25, 1158–1170, October 30, 2018
 B
#1
#2
#3
#4
upper 
lobe
lower 
lobe
upper
lower
middle
#1
#3
A
E
#1
#2
#3
#4
ab de
neuron
Shared 
a
b
c
d
e
H
LPs in 
distant 
portions
of space
a
b
c
d
e
Nearby
LP
Distant
LP 
#1
#2
#3
#4
1
3
bc ae
Fraction of optimal
sols that contain
multilobed neurons
C
D
Fraction of optimal sols
 satisfying optimized
 lobe-overlap property
S
S
OT
10
Activation
of 2-lobed
Imc neuron
OTid
F
G
Min-max neural distance  
for nearby LPs (norm.)
0
0.5
1
3 lobes
10 lobes
0
0.5
1
3 lobes
10 lobes
I
Fraction of optimal solutions 
with extensive intersection 
for distant LPs
0
40
80
120
0
3
6
# model neurons
J
40°
Pairwise lobe distance (°)
(L, N*) = (40,27)
62°
*
(5,4)
(20,14)
(40,27)
(L, N*)
0
0.5
1
Max-min neural distance  
for distant LPs (norm.)
(5,4)
(20,14)
(40,27)
(L, N*)
(5,4)
(20,14)
(40,27)
(L, N*)
a
b
(5,4)
(20,14)
(40,27)
(L, N*)
0
0.5
1
(5,4) (20,14) (40,27)
(L, N*)
0
0.5
1
0
40
80
120
0
3
6
# model neurons
62°
Maximum lobe distance 
(°)
*
Figure 5. Model Solutions Reveal Combinatorially Optimized Inhibition Strategy for Stimulus Selection at All Location Pairs with an Under-
Complete Set of Neurons
Quantification of signature properties of combinatorially optimized inhibition for optimal model solutions.
(A) Signature property #1 (multilobe neurons). Fraction of optimal model solutions that had multilobed Imc neurons for all (L, N*) pairs; orange bars, kmax = 3; black
bars, kmax = 10.
(B–D) Signature property #2 (optimized lobe overlap; see text).
(B) Illustration of property for example optimal solution in Figure 4B. Top row: multilobe neuron #1 in Figure 4B shares upper, but not lower lobe with neuron #2,
and shares lower, but not upper lobe with neurons #3 and #4. Bottom row: similar, but for multilobe neuron #3.
(C) Fraction of optimal model solutions that satisfy the ‘‘optimized lobe overlap’’ property; conventions as in (A).
(D) Schematic illustrating need for the optimized lobe overlap property of multilobed Imc neurons. Shown is a two-lobed Imc neuron (middle). When stimuli Sa and
Sb both occur within the RF of this ‘‘Imc’’ neuron (left), the resulting zone of suppression generated by this Imc neuron in the OTid would spare both stimuli (right);
selection for this location pair would not be achievable by just this neuron.
(E–J) Signature property #3 (combinatorial inhibition; see text). (E–J) ‘‘Assortedness’’ feature.
(E) Illustration of this feature for example optimal solution in Figure 4B. Left panel: locations a–e. Right panel: patterns of neurons activated and recruited to solve
selection for indicated location pairs (LPs); extracted from selection matrix in Figure 4D. Location pair bc involves nearby locations (left panel), but recruits distant
neurons to solve selection (right panel; #1 and #4; distance = 3, yielding normalized distance of 1, the largest possible value; STAR Methods); conversely, distant
location pair ae recruits nearby neurons (#1 and #2; distance = 1, yielding normalized distance of 0, the smallest possible value; STAR Methods).
(F) Summary plot showing that distant neurons are recruited for selection at nearby locations. Plotted is the normalized distance between neurons recruited for
solving selection at nearby locations, termed ‘‘min-max’’ distance. This is the minimum, taken across optimal solutions and their permutations, of the maximum
normalized distance between neurons in a solution recruited for solving selection at nearby locations. Green dashed line: normalized distance cutoff to be
exceeded for neurons to be termed ‘‘distant’’ (0.66; STAR Methods) and ‘‘nearby’’ neurons (magenta; 0.33; STAR Methods).
(G) Summary plot showing that nearby neurons are recruited for selection at distant locations. Plotted is the normalized distance between neurons recruited for
solving selection at distant locations, termed ‘‘max-min’’ distance. This is the maximum, taken across optimal solutions and their permutations, of the minimum
normalized distance between neurons in a solution recruited for solving selection at distant locations. Magenta dashed line: normalized distance cutoff to not be
exceeded for neurons to be termed ‘‘nearby’’ (0.33; STAR Methods).
(H–J) ‘‘Extensive intersection’’ feature.
(H) Illustration of this feature for example optimal solution in Figure 4B: location pairs occupying distant portions of space (left panel) recruit intersecting neural
subsets to solve selection (right panel; STAR Methods). See also Figures S5 and S6.
(I) Fraction of optimal model solutions that satisfy the extensive intersection feature (STAR Methods; conventions as in A).
(legend continued on next page)
Cell Reports 25, 1158–1170, October 30, 2018
1165
 and Frost, 1991), a consequence of the detailed approaches
used here, rather than species differences (Marı
´n et al., 2007).
Multilobed Imc RFs were characterized here using flashing
dots as visual stimuli. The use of this classical approach, which
has been employed extensively in visual neuroscience, high-
lights the contrast between the unusual multilobed encoding of
space by Imc and the traditional single-lobed encoding of space
by other early visual areas including OT (Figure 1K).
Imc does not play a functional role in OT’s representation of
the features of single stimuli (Mysore and Knudsen, 2013). In
contrast, Imc plays a critical role in delivering global competitive
inhibition across the OT space map and enables the selection of
the highest priority stimulus by the OT (Marı
´n et al., 2007; Mysore
and Knudsen, 2013). Therefore, potential functions for Imc’s
multilobed RFs were best considered in the context of compet-
itive stimulus selection across space, rather than in the context
of neural or behavioral responses to single stimuli. In so doing,
we showed that the scarcity of Imc neurons available to encode
elevational locations at a given azimuth necessitated multilobed
RFs in order to achieve stimulus selection across elevations (in
that azimuthal plane).
Stimulus Selection across Space and Model
Assumptions
Through computational modeling and subsequent experimental
validation, our results showed that the multilobed RFs of sparse
Imc neurons implement a combinatorial inhibition strategy for
solving stimulus selection across locations (Figure 4). Our model
included three key biological properties of the Imc-OT circuit as
axiomatic features: (1) that Imc neurons are scarce (in elevation);
(2) that they interconnect with the OT in a specialized, spatially
inverting manner; and (3) that selection along elevation in the
OT depends entirely on the priorities of the competing stimuli
but not on their specific locations. The first axiomatic feature
was demonstrated in Figure 3. The second, although not yet
confirmed functionally, is consistent with anatomical tracing
(J) Lobes of neurons in model solutions were arbitrarily placed and widely spread. Histogram of pairwise distance between centers of RF lobes of individual
multilobed neurons for a randomly selected model solution for (L, kmax, N*) = (40, 3, 27); marked range: 5th to 95th percentile range of red data; large range
indicates arbitrary spacing of RF lobes. Inset: histogram of maximum distance between centers of RF lobes of a multilobed neuron, for the same model solution.
Red arrows: median values; * medians significantly different from 0 (p < 0.001, one-tailed rank sum test); large median indicates widely distributed RF lobes.
40 
20 
0  
-20
-40
A
B
40 
20 
0  
-20
-40
C
E
#1 #2
upper 
lobe
lower 
lobe
upper
lower
#1
#2
a
b
c
d
e
LPs in 
distant 
portions 
of space
Shared neuron
Nearby
LP
g
f
a
b
c
d
e
g
f
0
0.5
1
Location pairs
Imc neurons
F
G
ae
ag
ac
bf
bd
bc
be
bgcd
ab
ad
af
ce cf cgde df dg ef eg fg
#1
#2
#3
#4
#5
ab eg
ag
ac
3
1
-10
0 10 20
-10
0 10 20
0
20
50 
-50
Elevation
0
20
0
20
0
20
0
20
a
b
c
#1
#2
#3
#4
#5
d
e
f
a
b
c
d
e
f
D
g
g
0
0.5
1
Normalized dist b/w 
recruited neurons
Distant
 LP
Coronal planes 
with multilobed 
neurons
Coronal planes 
satisfying 
intersection 
property
n=6
Nearby
LPs
Distant
LPs
Fraction of neurons
Azimuth(°)
Azimuth(°)
Elevation(°)
Elevation(°)
Azimuth(°)
100%
87%
13%
n=16
Figure 6. Experimental Validation of Combinatorially Optimized Inhibition in the Imc
(A) Signature property #1: pie chart summary of fraction of Imc coronal planes tested that contained multilobed neurons (87% = 14/16 planes; also Figures S3E
and S3F).
(B and C) Signature property #2.
(B) Left: rate map of RF of another Imc neuron sorted from the same recording site as the neuron in Figures 1A–1D. (Only these two neurons were recorded in this
Imc coronal plane.) Middle: half-max of RFs of neurons in Figure 1 (purple; reproduced from Figure 1D) and Figure 6B, left (orange). Right: for each neuron, the
upper RF lobe, but not lower one, shows overlap, satisfying the testable lobe overlap property (see text); conventions as in Figure 5B.
(C) Fraction of multilobe neurons in each coronal plane satisfying the testable version of lobe overlap property; dot, coronal plane; median fraction = 1.
(D–F) Signature property #3.
(D) RFs (half-max) of all Imc neurons recorded within an example coronal plane. a–g are seven (discretized) spatial locations encoded by these neurons (STAR
Methods).
(E) Selection matrix showing combinatorial activation of recorded neurons for selection at different location pairs; conventions as in Figure 4D.
(F) Two left panels: illustration of assortedness feature for example in (D); conventions as in Figure 5E (STAR Methods). Right: summary of this feature across Imc
coronal planes; only those planes containing R 3 Imc neurons each were testable (8/14; STAR Methods) Dashed lines: distance cutoffs for ‘‘distant’’ neurons
(green; 0.66) and ‘‘nearby’’ neurons (magenta; 0.33; STAR Methods). Filled circles: Imc coronal planes that satisfied these cutoff criteria; R7/8 in each case (STAR
Methods).
(G) Left: illustration of ‘‘extensive intersection’’ feature for example in (D); conventions as in Figure 5H. Right: pie chart summary of this feature across coronal
planes (100% exhibited the feature; 6/6). Note that this feature was testable only for those planes for which the recorded neurons encoded location pairs
occupying distant portions of space (6/14; STAR Methods).
1166
Cell Reports 25, 1158–1170, October 30, 2018
 studies (Wang et al., 2004). The third, invariance of competitive
suppression along elevation, has been demonstrated in previous
work (Mysore et al., 2010). Incidentally, in other species, there
are asymmetries between upper and lower hemifields (Yilmaz
and Meister, 2013), and more generally, there can be a spatial
gradient with stimuli at different locations being weighted differ-
ently; such a weighting function is easily incorporated into our
optimization model.
As the goal of our modeling was to extract core computational
principles underlying the implementation of selection at all loca-
tion pairs, we chose, in the interest of model simplicity, not to
include other details of Imc RFs observed in the data (Figure S3)
beyond the three axiomatic features. These included proportions
ofsingleversusmultilobedRFs,therelativespreadsoftheheights
of single- versus two- versusthree-lobed RFs,etc. In addition, the
model made two other simplifying assumptions. First, to reduce
model complexity, model RFs were implemented as discrete, bi-
nary ‘‘pixels’’ (Figure 4), as opposed to being continuous hills of
activity (Figure 1). As described in Figure S4, this assumption
does not affect the spatial pattern of Imc inhibition onto the OT.
However, it fails to capture the scaling of the strength of the inhi-
bition based on the specific position of the stimulus within the
half-max extent of a RF. Second, the model implemented the bio-
logical observation that the maximum number of lobes in any Imc
RF (denoted kmax) was three (Figure 1L) by constraining the num-
ber of RF pixels to be less than or equal to kmax. The consequence
of this assumption was that the sizes of model RFs were also
limited to kmax pixels (Figures 5E, S5B, and S6BD; kmax = 3), unlike
biological RFs that could be larger in size (Figures 1, 6, and
S2). This assumption was nonetheless necessary because it
improved the convexity of the cost function, thereby allowing
the runs of the optimization model to converge. Despite these as-
sumptions, however, strong predictions of the model regarding
combinatorially optimized inhibition for location-invariant selec-
tion (and the corresponding signature properties) were success-
fully validated with subsequent experiments, demonstrating that
the Imc does indeed employ combinatorially optimized inhibition
for stimulus selection at all possible elevational pairs.
Notably, the signature properties were also robust to the spe-
cific proportions of single- versus two- versus three-lobed RFs.
This was evidenced by the fact that, in the model, the signature
properties held true for all optimal solutions even though the pro-
portions of lobes varied widely across optimal solutions: for
instance, one of the optimal solutions for L = 40, N* = 27 con-
sisted of 7.5% single-lobed, 18.5% two-lobed, and 74% three-
lobed RFs, whereas one optimal solution for L = 5, N* = 4
consisted of 50% single-lobed, 25% two-lobed, and 25%
three-lobed RFs (Figure 4B). Consequently, our conclusions
were not impacted by a match (or not) between proportions of
RFs in the model Imc and the proportions in the owl Imc. (Inci-
dentally, because the proportions in experimental data were ob-
tained, necessarily, by combining data across coronal planes
and across birds, they do not represent the distribution within
any particular Imc coronal plane [Figure 1L].)
Selection across Locations in Elevation versus Azimuth
Our results indicate that the Imc implements stimulus selection
for locations both along elevation and azimuth. However, the
strategy employed for location pairs along the elevation is
distinct from that along the azimuth, a difference that can be ac-
counted for by the difference in anatomical organization along
the two axes. The scarcity of Imc neurons in coronal planes is
consistent with a combinatorially optimized solution for selection
along elevational locations through the use of multilobed spatial
RFs (Figures 3, 4, 5, and 6). In contrast, abundance of Imc neu-
rons along the rostrocaudal axis (STAR Methods) is consistent
with the modular copy-and-paste solution through the use of
single-lobed spatial RFs (Figure S1D).
Minimization of Wiring and Metabolic Costs
In this context, three questions regarding the biological imple-
mentation of selection at all location pairs by the Imc remain
puzzling. First, why might N < L be biologically desirable in
the Imc in the first place, necessitating combinatorially opti-
mized inhibition? Second, if N < L is attractive biologically,
why do Imc RFs not have a large number of lobes, thereby
achieving greater savings in the number of Imc neurons (Fig-
ure 4A)? In other words, why is the maximum number of Imc
RF lobes restricted to a low number (kmax = 3; Figure 1L)?
Third, why is multilobed encoding found only along one spatial
axis (here, elevation), and why not along both axes for greater
neuronal savings?
To gain insight into these questions, we examined Imc function
in the context of two types of costs that nervous systems must
incur in building and operating a neural circuit: wiring cost and
metabolic cost. We estimated wiring cost by quantifying the
cost of implementing spatially inverting projection patterns
from the Imc to the OT (Chen et al., 2006), and metabolic cost
by quantifying the cost of broadcasting of spikes across the
OT for competitive suppression. We found that wiring cost de-
creases as the number of RF lobes increases (Figure 7A; STAR
Methods). In contrast, metabolic cost increases as the number
of RF lobes increases (Figure 7B; STAR Methods). Conse-
quently, the wiring cost places a lower bound on the number of
RF lobes (and a corresponding upper bound on the number of
neurons), whereas the metabolic cost places an upper bound
on the number of RF lobes (and a lower bound on the number
of neurons). The optimal number of RF lobes (and the number
of neurons necessary), therefore, is one that minimizes some
weighted combination of the two opposing costs (Figure 7C).
Because Imc neurons have high firing rates (median, 76.5 Hz
[Goddard et al., 2014; Marı
´n et al., 2007]; Figure 1A), this causes
the metabolic cost of Imc function to scale up substantially, pull-
ing the ideal number of RF lobes to even lower values than for low
firing-rate neurons (Figure 7C, thick versus thin line; thereby also
providing a rationale for the continued presence of some single-
lobed neurons in the Imc; Figure 1L).
Taken together, these results indicate that a small number of
Imc neurons (N < L), with multilobed RFs that have a small num-
ber of RF lobes (small kmax value), are well suited to achieve
selection across all locations if net neural costs are to be mini-
mized. Increasing excessively the number of RF lobes along
one spatial axis (here, elevation), or increasing the number of
RF lobes also along the other axis as well (here, azimuth) are
not biologically desirable. Thus, the estimation of the net cost
of neural circuit operation provides a plausible window into
Cell Reports 25, 1158–1170, October 30, 2018
1167
 ‘‘why’’ the owl Imc may be organized functionally in the way that
it is (Figure 7).
The reason for occurrence of multilobed encoding along
elevation, specifically, rather than along azimuth, is less evident
and may simply be a consequence of the relative anatomy of Imc
and OT. The Imc is asymmetric in shape, elongated along the
rostrocaudal axis, but compressed along the dorsoventral axis
(Wang et al., 2004). It is plausible that the OT’s representation
of azimuth along its rostrocaudal axis (Knudsen 1982) drives azi-
muths to be encoded along the parallel (and neurally rich) rostro-
caudal axis of the Imc (Wang et al., 2004), for ease of wiring,
thereby relegating elevation to be coded by the transverse
(and neurally sparse) planes.
Space Coding in Imc Is Unlike Traditional Population
Coding Schemes
The multilobed encoding of space by Imc neurons (Figures 1, 6,
and S6) combined with the optimized lobe overlap (signature
property #2; Figures 5 and 6) across Imc RFs in a coronal sec-
tion, led to the observation that Imc neurons use a combinatori-
ally optimized population coding strategy (Figures 6 and S6).
This coding is conceptually distinct from the major population
neural coding schemes described thus far in the literature.
For instance, in population vector coding, multiple neurons
with overlapping, single-lobed tuning curves (or RFs) are acti-
vated to encode feature values such as stimulus locations, mo-
tion direction, etc., with high precision (Georgopoulos et al.,
1986; Lee et al., 1988; Lewis and Kristan, 1998; Ma et al.,
2006). With such coding, it is always possible to order these
RFs along the feature axis such that neighboring values of fea-
tures are always encoded by functionally ‘‘local’’ subsets of neu-
rons (Figures S6A and S6C). In contrast, neurons with multilobed
RFs cannot be ordered this way: some neurons always code also
for distant locations (Figures S6B, S6D, and 5J), and selection for
a given location pair cannot be guaranteed to be solved by only a
local subset of neurons (Figures S6B and S6D).
A population coding scheme reported in the literature that
does involve multilobed encoding as well as the activation of
non-local neural subsets is the combinatorial coding of odors
by olfactory receptor neurons (Sicard and Holley, 1984). How-
ever, whereas assorted and extensively intersecting subsets of
neurons are activated to encode odors, no inherent constraints
that necessitate the optimization of the relative positioning of
these RF lobes across neurons have been reported. In contrast,
in the combinatorially optimized coding reported here, the place-
ment of RF lobes needs to be optimized across neurons and is
exemplified by the lobe overlap property (Figure 5B and 5C).
For this same reason, our scheme also differs from the encod-
ing of space by entorhinal grid cells: the firing fields of different
grid cells are not inherently yoked to one another (Hafting
et al., 2005; Towse et al., 2013). In addition, each grid cell has
a large number of highly organized firing fields, unlike the few,
and arbitrarily placed, RF lobes of Imc neurons.
Finally, combinatorially optimized coding also stands in direct
contrast to the sparse, orthogonal coding by an overcomplete
set of neurons reported in many brain areas (Mao et al., 2017;
Olshausen and Field, 1997). Imc’s coding, instead, involves pro-
miscuous, non-orthogonal representation of space by an under-
complete set of neurons.
The problem of stimulus selection at all location pairs with
limited neurons, which yields combinatorially optimized coding
in Imc, belongs to the same (np-complete) class of computation-
ally complex problems as the traveling salesman problem and
the minimum spanning tree problem (Kruskal, 1956; Lawler
et al., 1985). Although the brain solves this problem naturally,
exactly how Imc’s optimized, multilobed RFs are specified dur-
ing neural development is an intriguing open question and a sub-
ject for future work.
Generality of Combinatorially Optimized Coding beyond
the Owl and the Imc
The discoveries, here, of multilobed visual representation,
combinatorially optimized population coding, and an efficient
inhibitory solution for a critical brain function (namely, stimulus
selection) have come from the systematic study of the functional
response properties of inhibitory neurons in the owl Imc, an area
kmax
A
B
C
x107
x104
Total cost
x109
f = 80 Hz
f = 10 Hz
1
3
10
0
5
10
Wiring cost
1
3
10
0
3
6
Metabolic cost
1
3
10
0
1
2
L=20
L=30
L=40
kmax
kmax
L=40
L=40
Figure 7. Metabolic and Wiring Costs for
Stimulus Selection at All Possible Location
Pairs
(A) Wiring cost plotted as a function of the
maximum number of Imc RF lobes allowed (kmax);
calculated across optimal model solutions (STAR
Methods). Values of kmax examined along x axis
are particularly relevant to the Imc: kmax = 1 cor-
responds the single-lobed case, kmax = 3 to the
experimentally determined value in the owl Imc,
and kmax = 10 to the practical upper bound on the
number of possible RF lobes (based on the func-
tional properties of Imc neurons; STAR Methods
and Figure 1L).
(B) Metabolic cost as a function of kmax (STAR
Methods).
(C) Schematic showing total cost (weighted combination of A and B) for Imc circuit to solve selection at all location pairs for L = 40 at low average firing rates (thin
line, 10 Hz), and high average firing rates (thick line, 80 Hz; STAR Methods); weights used for combining wiring and metabolic costs were identical for the low and
high firing rate cases. Circled values along x axis (and corresponding large dots) indicate the optimal kmax values at the two firing rate levels. Results demonstrate
left shift of optimal kmax with increasing firing rates (STAR Methods; the specific values of optimal kmax yielded by this analysis, and shown here, are incidental to
the choice of the values of relative weights, and not particularly informative by themselves.) In all cases, mean ± SD values are plotted; SD values smaller than size
of dots.
1168
Cell Reports 25, 1158–1170, October 30, 2018
 proposed as a critical processing critical processing hub for
stimulus selection for attention (Marı
´n et al., 2007; Mysore and
Knudsen, 2013; Sereno and Ulinski, 1987).
Although Imc is conserved across the midbrain of all verte-
brates (Graybiel, 1978; Jiang et al., 1996; Wang et al., 2004),
the functional properties of this nucleus of emerging importance
have not been studied in any vertebrate other than the barn owl
thus far. The biological advantages of the unusual coding strat-
egy elucidated here suggest that combinatorially optimized cod-
ing by sparse inhibitory neurons may be a solution employed
generally by the vertebrate midbrain to achieve spatial selection
across all locations.
Additionally, this computational strategy extends naturally to
any selection problem in which the choice must be made no mat-
ter what the specific values are of other stimulus features such as
orientation, color, odor identity, etc. One example is feature-
based pop-out (Treisman and Gelade, 1980), in which, for
instance, a bar-shaped visual stimulus of a particular orientation
stands out (is ‘‘selected’’ neurally and behaviorally) among a
background of several bars of a different orientation. Since
pop-out must and does operate effectively no matter what the
absolute orientations of the bars are (as long as their relative ori-
entations are distinct), the underlying circuit mechanism must
have the ability to compare responses of neurons encoding for
different, and in fact, all possible, pairs of orientations, much
like the Imc helps compare responses of OT neurons encoding
for different (all possible pairs of) locations. Our results suggest
that a careful examination of the encoding properties of inhibitory
neurons in cortical as well as sub-cortical areas may reveal
combinatorially optimized coding as a widespread strategy in
the brain for efficient, feature-invariant stimulus selection and
decision making under metabolic and anatomic constraints.
STAR+METHODS
Detailed methods are provided in the online version of this paper
and include the following:
d KEY RESOURCES TABLE
d CONTACT FOR REAGENT AND RESOURCE SHARING
d EXPERIMENTAL MODEL AND SUBJECT DETAILS
B Animals
d METHOD DETAILS
B Neurophysiology
B Imc targeting
B Visual stimuli and RF measurement
B Spike sorting multi-unit data
B Identification of the optimal number of RF lobes
(Figure 1)
B Defining the centers of RF lobes
B Monte-Carlo analysis of the effect of neuronal noise
and spatial sampling resolution on number of detected
RF lobes (Figure 1)
B Histology (Figure 3)
B Theoretical calculations regarding the need for multi-
lobed RFs
B Estimating number of elevational and azimuthal loca-
tions encoded by OTid (Lel and Laz, respectively)
B Selection across azimuthal locations
B Optimization model for solving stimulus selection at all
elevational location-pairs (Figure 4)
B Characterizing signature properties of optimal model
solutions, and testing them in experimental data (Fig-
ures 5 and 6)
B Wiring and metabolic costs in the Imc-OT circuit for im-
plementing selection at all location-pairs (Figure 7)
d QUANTIFICATION AND STATISTICAL ANALYSIS
d DATA AND SOFTWARE AVAILABILITY
SUPPLEMENTAL INFORMATION
Supplemental Information includes six figures and can be found with this
article online at https://doi.org/10.1016/j.celrep.2018.10.022.
ACKNOWLEDGMENTS
This work was supported by funding from NIH grant R01 EY027718. We are
grateful to Drs. James Knierim and Daniel O’Connor for feedback.
AUTHOR CONTRIBUTIONS
N.R.M. and S.P.M. designed the research, performed experiments, analyzed
the data, and wrote the paper.
DECLARATION OF INTERESTS
The authors declare no competing interests.
Received: April 14, 2018
Revised: September 13, 2018
Accepted: October 3, 2018
Published: October 30, 2018
REFERENCES
Bala, A.D.S., Spitzer, M.W., and Takahashi, T.T. (2003). Prediction of auditory
spatial acuity from neural images on the owl’s auditory space map. Nature 424,
771–774.
Carrasco, M., and Frieder, K.S. (1997). Cortical magnification neutralizes the
eccentricity effect in visual search. Vision Res. 37, 63–82.
Chen, B.L., Hall, D.H., and Chklovskii, D.B. (2006). Wiring optimization can
relate neuronal structure and function. Proc. Natl. Acad. Sci. USA 103,
4723–4728.
Fecteau, J.H., and Munoz, D.P. (2006). Salience, relevance, and firing: a prior-
ity map for target selection. Trends Cogn. Sci. 10, 382–390.
Fee, M.S., Mitra, P.P., and Kleinfeld, D. (1996). Automatic sorting of multiple
unit neuronal signals in the presence of anisotropic and non-Gaussian vari-
ability. J. Neurosci. Methods 69, 175–188.
Garcı
´a-Cabezas, M.A., John, Y.J., Barbas, H., and Zikopoulos, B. (2016).
Distinction of neurons, glia and endothelial cells in the cerebral cortex: an algo-
rithm based on cytological features. Front. Neuroanat. 10, 107.
Georgopoulos, A.P., Schwartz, A.B., and Kettner, R.E. (1986). Neuronal pop-
ulation coding of movement direction. Science 233, 1416–1419.
Goddard, C.A., Huguenard, J., and Knudsen, E. (2014). Parallel midbrain mi-
crocircuits perform independent temporal transformations. J. Neurosci. 34,
8130–8138.
Graybiel, A.M. (1978). A satellite system of the superior colliculus: the parabi-
geminal nucleus and its projections to the superficial collicular layers. Brain
Res. 145, 365–374.
Hafting, T., Fyhn, M., Molden, S., Moser, M.B., and Moser, E.I. (2005). Micro-
structure of a spatial map in the entorhinal cortex. Nature 436, 801–806.
Cell Reports 25, 1158–1170, October 30, 2018
1169
 Jiang, Z.D., King, A.J., and Moore, D.R. (1996). Topographic organization
of projection from the parabigeminal nucleus to the superior colliculus in
the ferret revealed with fluorescent latex microspheres. Brain Res. 743,
217–232.
Knudsen, E.I. (1982). Auditory and visual maps of space in the optic tectum of
the owl. J. Neurosci. 2, 1177–1194.
Knudsen, E.I. (2007). Fundamental components of attention. Annu. Rev. Neu-
rosci. 30, 57–78.
Kruskal, J.B., Jr. (1956). On the shortest spanning subtree of a graph and the
traveling salesman problem. Proc. Am. Math. Soc. 7, 48–50.
Lawler, E.L., Lenstra, J.K., Rinnooy Kan, A.H.G., and Shmoys, D.B. (1985). The
traveling salesman problem. A guided tour of combinatorial optimization.
J. Oper. Res. Soc. 37, 536.
Lee, C., Rohrer, W.H., and Sparks, D.L. (1988). Population coding of saccadic
eye movements by neurons in the superior colliculus. Nature 332, 357–360.
Lewis, J.E., and Kristan, W.B., Jr. (1998). A neuronal network for computing
population vectors in the leech. Nature 391, 76–79.
Li, D.P., Xiao, Q., and Wang, S.R. (2007). Feedforward construction of the
receptive field and orientation selectivity of visual neurons in the pigeon.
Cereb. Cortex 17, 885–893.
Lovejoy, L.P., and Krauzlis, R.J. (2010). Inactivation of primate superior collicu-
lus impairs covert selection of signals for perceptual judgments. Nat. Neurosci.
13, 261–266.
Ma, W.J., Beck, J.M., Latham, P.E., and Pouget, A. (2006). Bayesian inference
with probabilistic population codes. Nat. Neurosci. 9, 1432–1438.
Mao, D., Kandler, S., McNaughton, B.L., and Bonin, V. (2017). Sparse orthog-
onal population representation of spatial context in the retrosplenial cortex.
Nat. Commun. 8, 243.
Marı
´n, G., Salas, C., Sentis, E., Rojas, X., Letelier, J.C., and Mpodozis, J.
(2007). A cholinergic gating mechanism controlled by competitive interactions
in the optic tectum of the pigeon. J. Neurosci. 27, 8112–8121.
McPeek, R.M., and Keller, E.L. (2004). Deficits in saccade target selection after
inactivation of superior colliculus. Nat. Neurosci. 7, 757–763.
Meredith, M.A., and Stein, B.E. (1986). Visual, auditory, and somatosensory
convergence on cells in superior colliculus results in multisensory integration.
J. Neurophysiol. 56, 640–662.
Mysore, S.P., and Knudsen, E.I. (2013). A shared inhibitory circuit for both
exogenous and endogenous control of stimulus selection. Nat. Neurosci. 16,
473–478.
Mysore, S.P., Asadollahi, A., and Knudsen, E.I. (2010). Global inhibition and
stimulus competition in the owl optic tectum. J. Neurosci. 30, 1727–1738.
Mysore, S.P., Asadollahi, A., and Knudsen, E.I. (2011). Signaling of the stron-
gest stimulus in the owl optic tectum. J. Neurosci. 31, 5186–5196.
Olshausen, B.A., and Field, D.J. (1997). Sparse coding with an overcomplete
basis set: a strategy employed by V1? Vision Res. 37, 3311–3325.
Rizzolatti, G., Camarda, R., Grupp, L.A., and Pisa, M. (1974). Inhibitory effect of
remote visual stimuli on visual responses of cat superior colliculus: spatial and
temporal factors. J. Neurophysiol. 37, 1262–1275.
Rodriguez, A., and Laio, A. (2014). Machine learning. Clustering by fast search
and find of density peaks. Science 344, 1492–1496.
Schlueter, M., Gerdts, M., and Ruckmann, J.J. (2012). A numerical study of
MIDACO on 100 MINLP benchmarks. Optimization 61, 873–900.
Sereno, M.I., and Ulinski, P.S. (1987). Caudal topographic nucleus isthmi and
the rostral nontopographic nucleus isthmi in the turtle, Pseudemys scripta.
J. Comp. Neurol. 261, 319–346.
Sicard, G., and Holley, A. (1984). Receptor cell responses to odorants: similar-
ities and differences among odorants. Brain Res. 292, 283–296.
Sridharan, D., Boahen, K., and Knudsen, E.I. (2011). Space coding by gamma
oscillations in the barn owl optic tectum. J. Neurophysiol. 105, 2005–2017.
Tibshirani, R., Walther, G., and Hastie, T. (2001). Estimating the number of
clusters in a dataset via the gap statistic. J. R. Stat. Soc. B 63, 411–423.
Towse, B.W., Barry, C., Bush, D., and Burgess, N. (2013). Optimal configura-
tions of spatial scale for grid cell firing under noise and uncertainty. Philos.
Trans. R. Soc. Lond. B Biol. Sci. 369, 20130290.
Treisman, A.M., and Gelade, G. (1980). A feature-integration theory of atten-
tion. Cognit. Psychol. 12, 97–136.
Wang, Y.C., and Frost, B.J. (1991). Visual response characteristics of neurons
in the nucleus isthmi magnocellularis and nucleus isthmi parvocellularis of pi-
geons. Exp. Brain Res. 87, 624–633.
Wang, Y., Major, D.E., and Karten, H.J. (2004). Morphology and connections of
nucleus isthmi pars magnocellularis in chicks (Gallus gallus). J. Comp. Neurol.
469, 275–297.
Wang, Y., Luksch, H., Brecha, N.C., and Karten, H.J. (2006). Columnar projec-
tions from the cholinergic nucleus isthmi to the optic tectum in chicks (Gallus
gallus): a possible substrate for synchronizing tectal channels. J. Comp. Neu-
rol. 494, 7–35.
Yilmaz, M., and Meister, M. (2013). Rapid innate defensive responses of mice
to looming visual stimuli. Curr. Biol. 23, 2011–2015.
1170
Cell Reports 25, 1158–1170, October 30, 2018
 STAR+METHODS
KEY RESOURCES TABLE
CONTACT FOR REAGENT AND RESOURCE SHARING
Further information and requests for resources and reagents should be directed to and will be fulfilled by the Lead Contact, Shreesh
P. Mysore (shreesh.mysore@jhu.edu).
EXPERIMENTAL MODEL AND SUBJECT DETAILS
Animals
We performed experimental recordings in 15 head-fixed, non-anesthetized adult barn owls that were viewing a visual screen
passively (Tyto alba). Both male and female birds were used; the birds were shared across several studies. All procedures for animal
care and use were carried out following approval by the Johns Hopkins University Institutional Animal Care and Use Committee, and
in accordance with NIH guidelines for the care and use of laboratory animals. Owls were group housed in enclosures within the aviary,
each containing up to 6 birds. The light/dark cycle was 12 hr/12 hr.
METHOD DETAILS
Neurophysiology
Experiments were performed following protocols that have been described previously (Mysore et al., 2010; Mysore and Knudsen,
2013). Briefly, epoxy-coated, high impedance, tungsten microelectrodes (A-M Systems, 250mm, 5 �10 MU at 1 kHz) were used
to record single and multi-units extracellularly. A mixture of isoflurane (1.5%–2%) and nitrous oxide/oxygen (45:55 by volume)
was used at the start of the experiment to anesthetize the bird and secure it in the experimental rig (a 30-minute period of initial
set-up). Isoflurane was turned off immediately after the bird was secured and was not turned back on for the remainder of the exper-
iment. Frequently, nitrous oxide was also turned off at this point, but in several experiments, it was left on for a few hours if needed.
However, it was turned off at least 30 minutes before the recording session. Our recordings were performed starting, typically, 3
hours after initial set-up (the time required for positioning the electrode). As recovery from isofluorane occurs well under 30 minutes
after it is turned off, and recovery from nitrous oxide occurs within a minute (the bird stands up and flies away if freed from restraints),
recordings were made in animals that were not anesthetized and non-tranquilized.
Imc targeting
The Imc is an oblong structure that is 2.8 mm rostrocaudally and 0.35 mm dorsoventrally, appearing as a 700-mm 3 350-mm elliptical
disk in coronal sections. It lies parallel to the rostrocaudal axis of the OT, located approximately 16 mm ventral to the surface of the
brain, and approximately 500 um medial to the medial-most part of the OT. We targeted the Imc following previously published
methods (Mysore and Knudsen, 2013). Briefly we first navigated to the OT (based on well-established methods; (Knudsen, 1982)),
and then navigated to the Imc using the OT’s topographic space map as reference. Imc targeting has been validated previously using
dye injections (Mysore and Knudsen, 2013), and was additionally verified at the outset of this study through anatomical lesions (Fig-
ure S1A). Dorsoventral penetrations through the Imc were made at a medial-leading angle of 5� from the vertical to avoid a major
blood vessel in the path to the Imc.
REAGENT or RESOURCE
SOURCE
IDENTIFIER
Experimental Models: Organisms/Strains
Adult barn owls (Tyto alba)
Johns Hopkins University, Stanford
University, University of Maryland
N/A
Software and Algorithms
Custom code for RF analysis and computational
modeling in MATLAB
This paper
N/A
Gap statistical analysis for model selection
Tibshirani et al., 2001
In-built MATLAB function (‘evalclusters’)
MIDACO-SOLVER (Solver for nonlinear
optimization problems)
Schlueter et al., 2012
http://www.midaco-solver.com/
Clustering by fast search-and-find of density
peaks (for clustering RF data)
Rodriguez and Laio, 2014
https://people.sissa.it/�laio/Research/
Res_clustering.php
Cell Reports 25, 1158–1170.e1–e9, October 30, 2018
e1
 Visual stimuli and RF measurement
Visual stimuli used here have been described previously (Mysore et al., 2010, 2011). Briefly, stationary, translating, or looming visual
dots (of fixed contrast) were flashed at different locations on a tangent TV monitor in front of the owl. Looming stimuli were dots that
expanded linearly in size over time, starting from a size of 0.6� in radius. Visual stimuli were presented for 250ms with an inter stimulus
interval of 1.5-3 s at all sampled locations. Pilot experiments indicated that visual RFs were narrow in azimuth but spread along the
elevation. Therefore, RF measurements were made by presenting stimuli over the �60� to 60� range in elevation, and over a 40�
(±10.4�) range in azimuth (centered around the azimuth that yielded the best responses). The ranges of sampling steps used were
4�-10� in azimuth and 5�-15� in elevation. Typically, we sampled 55-70 spatial locations for each neuron (typically, 6 locations along
azimuth and 10 locations along elevation). Each sampled stimulus location was repeatedly tested 9-15 times in a randomly inter-
leaved fashion. Multi-unit spike waveforms, recorded using Tucker Davis Technologies hardware interfaced with MATLAB, were
sorted offline into putative single neurons (see below). The spatial responses for each neuron were measured by counting spikes
at each sampled location during a 100-350 ms time window following stimulus onset.
Spike sorting multi-unit data
The ‘chronux’ spike-sorting toolbox was used for the majority of the analyses (Fee et al., 1996). This method is based on a hierarchical
unsupervised clustering approach in which the spike waveforms are initially classified into a large number of clusters, typically
10 times the number of putative units recorded. Clusters with very few spikes are discarded and the remaining clusters are then
aggregated automatically using metrics of similarity between waveform shapes. In addition, we include only those units for analysis
that have less than 5% of the spikes within 1.5 ms of each other (ISI criterion).
The statistical separability of individual sorted units was assessed based on the distance of a unit’s cluster (of waveforms) from the
clusters corresponding to other units as well as the outlier cluster measured at the same site. We first projected the spike waveforms
measured at a given site to a 3-dimensional space using principal components analysis. Then, we performed a one-way ANOVA test
to examine if the mean of the waveforms of a given unit (in the projected 3-dimensions) was significantly different from the means
corresponding to the other units and the outliers. This was followed by the Holm-Bonferroni criterion for multiple comparisons. In
a few cases (4/116), there were either too few waveforms in the outlier cluster (number of waveforms in outlier cluster less than
8% of number of waveforms in any of the remaining sorted units), or the outlier waveforms did not form a cluster with a Gaussian
distribution. In such cases, we only tested for the distance of the unit’s cluster mean from the cluster means of other units. We re-
garded only those units whose cluster means were significantly different from the means of all other units (and the outlier cluster)
as ‘well-separated’ units per this separability criterion (p < 0.05; the p value plotted for each unit in Figure 1I is the largest p value
obtained across all comparisons for that unit). Only well-separated units were included in all remaining analyses (subsequent to Fig-
ure 1I) in this study.
Identification of the optimal number of RF lobes (Figure 1)
In order to determine the number of response fields (or lobes) in an RF in an unbiased manner, we first transformed the measured RF
responses to a distribution of points in 2-dimensional space (azimuth x elevation). This distribution was generated such that the den-
sity of points around each sampled spatial location was proportional to the firing rate of the neuron evoked by a visual stimulus pre-
sented at that location. We achieved this by distributing points randomly and uniformly within a rectangle centered around the
sampled location such that the number of points was equal to the firing rate at that location; the dimensions of the rectangle were
the azimuthal and elevational sampling steps, respectively. This transformation allowed us to apply spatial clustering methods to
the firing rate maps.
Next, using the density peaks clustering method (Rodriguez and Laio, 2014), we fit successively k = 1,2,3.6 clusters to the dis-
tribution (Figures 1C and 1G). This clustering method identifies cluster centers by searching for regions that have high local density of
points (r) that are also far away from any points of equal or higher density (d = minimum distance from points of equal or higher den-
sity; Figures S2C–S2F. For the point with highest local density, d is conventionally taken as the maximum distance of the point from all
other points). It is robust to nonlinear cluster boundaries and unequal cluster sizes – conditions under which traditional methods like
k-means perform poorly. The k cluster centers are chosen by the algorithm as points with the k highest values of gamma (g), defined
as the product of r and d. We repeated this procedure for each k, thereby fitting the 1-best, 2-best, . 6-best clusters to the data.
Following this, we applied a model selection procedure to identify the optimal number of clusters in the data, i.e., the best k value
(k*), based on the ‘gap statistic’ (Tibshirani et al., 2001). This is an unbiased method to detect the number of clusters that best fit a
distribution of points. For each k, we estimated a ‘gap’ value (gap(k)), which evaluated the goodness of fitting k clusters to the dis-
tribution. The gap value was calculated by standardizing the pooled within-cluster sum of square distances between all points in each
of the k clusters (Wk) and comparing its log value (log (Wk)) to the expectation of this quantity, (E*(log (Wk)), under the null hypothesis
that the data contains only one cluster (Tibshirani et al., 2001). We calculated this in MATLAB by using the ‘evalclusters’ function with
‘gap’ as the evaluation method, which yielded gap(k) as well as se(k) for each k; se(k) was the standard error in the estimate of gap(k).
Then, the gap selection statistic was defined as, GAP(k) = gap(k)- gap(k+1) + se(k+1). The number of clusters that fit the data optimally
is defined by the method as the smallest value of k for which GAP(k) > = 0. Conceptually, the value of GAP(k) for the null hypothesis
(k* = 1) keeps decreasing linearly with increasing k, whereas the rate of the decrease of the metric under the alternate hypothesis
e2
Cell Reports 25, 1158–1170.e1–e9, October 30, 2018
 (k* > 1) has been shown to fall exactly at k = k*. Hence the ‘gap’ between the two curves is maximum at k = k*, and GAP(k), the dif-
ference between gap(k) and gap(k+1) is greater than zero for the first time when k = k*.
Defining the centers of RF lobes
The center of an RF lobe defined as the stimulus location evoking the highest firing rate within that lobe. The azimuthal RF ‘center’ of
an Imc neuron is defined as the average of the azimuthal centers of all of its RF lobes, because RF lobes of an individual neuron do
not vary significantly in azimuth (Figure 2A; blue). The azimuthal RF ‘center’ of a recording site in the Imc, across all the neurons
recorded at that site, is defined as the average of the azimuthal centers across all the RF lobes of all the neurons recorded at that
site. This is valid because RF centers of individual neurons within a recording site do not vary significantly in azimuth (Figure 2B;
blue). The azimuthal RF ‘center’ of a penetration is defined as the average of the azimuthal centers across all recording sites in
that penetration. This is valid because RF centers of individual recording sites within a penetration do not vary significantly in azimuth
(Figure 2C).
Monte-Carlo analysis of the effect of neuronal noise and spatial sampling resolution on number of detected RF lobes
(Figure 1)
A low spatial sampling resolution during the measurement of spatial RFs, as well as high variability in neural responses, could both
cause a single lobed RF to appear falsely as a multilobed one (see Figure S2G). To test how robust our method for identifying the ideal
number of RF lobes is to sampling resolution (sampling step-size) and neural response variability (response Fano-factor; defined as
variance/mean), we performed the following control. First, we generated a single-lobed Gaussian in 2D (azimuth x elevation), with
mean and covariance equal to the average values of these parameters across all the experimentally measured Imc RFs (114 Imc
units). Using this single-lobed RF as ‘reference’, we repeatedly simulated RFs using different step-sizes and different response
Fano-factor values: For a given step-size, the firing rate at each location was chosen randomly from a normal distribution with
mean equal to the value yielded by the reference RF at that location, and variance determined by the Fano-factor value. Next, we
transformed this simulated RF into a distribution of 2-D points and applied the density peaks clustering method. Finally, we applied
the gap-statistic model selection method to determine the ideal number of lobes in the RF. We repeated this 150 times for each
step-size and Fano-factor pair, and calculated the fraction of times for which multiple RF lobes were detected (erroneously) in
this data. We repeated the whole procedure for a range of step-size and Fano-factor values that subsumed the range of experimental
step-sizes and measured Fano-factor values, and identified the zone that yielded R 5% false detection rate of multiple lobes
(Figure 1J).
To test the extent to which our experimental and analytical methods falsely detected multilobed RFs, we compared the experimen-
tally used step-size for each RF and the RF’s Fano-factor value with those that yielded a R 5% false detection rate in simulation. The
Fano-factor for each RF was calculated as the average of the Fano-factor values at all sampled locations in that RF. The step-size for
each RF was calculated as the average of the azimuth and elevation sampling steps used to measure the RF. We found that all of our
RFs were well within the ‘safe’ zone of % 5% error (Figure 1J). Thus, the detection of multilobed RFs in our data was unlikely to be a
spurious consequence of sub-optimal measurement conditions.
Histology (Figure 3)
Owls were perfused with paraformaldehyde and their brains extracted per standard procedures. The fixed brains were blocked so
that the rostro caudal axis of the Imc was perpendicular to the sectioning plane, and brain sections of 40mm thickness were obtained.
Sections containing Imc were mounted, Nissl stained, and coverslipped. Sections were imaged at 40x under a light microscope and
the number of Nissl stained somata in the Imc in each section were manually counted by NRM and SPM independently (Garcı
´a-
Cabezas et al., 2016). For each section, the maximum value of the counts from the two authors was used to generate the plot in
Figure 3C.
Theoretical calculations regarding the need for multilobed RFs
We compared the total number of location-pairs at which selection must occur in the OTid, with the number of location-pairs at which
selection is achievable by a set of Imc neurons. Since multilobed Imc encoding is restricted along the elevation (Figures 2A and 2B),
we focused on stimulus selection between all possible pairs of elevations at any azimuth.
Simplified version. We started by making two simplifying assumptions: (a) that the OT space map is a collection of non-overlapping
spatial RFs that tile sensory space, and (b) that each Imc neuron has exactly k RF lobes (k always R 1).
In this scheme, if the number of distinct elevations (at a given azimuth) in the discretized OT space map is L, then the total number of
distinct pairs of stimulus locations possible is L(L-1). A stimulus placed within any RF lobe of a k-lobed Imc neuron can suppress
competing stimuli located anywhere outside the RF, i.e., at L-k locations. Therefore, each Imc neuron is capable of implementing
competitive selection at k(L-k) pairs of locations. With N such Imc neurons, the number of pairs of stimulus locations at which compet-
itive selection can be resolved by the Imc is at most Nk(L-k). Note that this quantity is computed assuming no overlap between Imc
RFs and is greater than the number of pairs of stimulus locations at which competitive selection can be resolved by the Imc if overlap
between RFs is allowed. Therefore, to achieve successful competitive suppression between all possible pairs of stimulus locations,
i.e., location invariance, a condition that must be satisfied is
Cell Reports 25, 1158–1170.e1–e9, October 30, 2018
e3
 NkðL � kÞRLðL � 1Þ
(1)
= > kRLðL � 1Þ
NðL � kÞ
(2)
This necessary (but not sufficient) condition for location invariance is already very revealing: If all Imc neurons had only single-lobed
RFs, i.e., k = 1, the above inequality reduces to NRL i.e., the number of Imc neurons would need to be greater than or equal to the
number of distinct spatial locations. Since the logical proposition ‘A = > B’ is exactly the same as the proposition ‘not (B) = > not (A)’, in
our case, the proposition ‘k = 1 = > N R L’ is exactly the same as the proposition ‘N < L = > ks1’, i.e., if the number of Imc neurons is
less than the number of spatial locations, then at least one Imc RF must be multilobed (because RFs cannot have fewer than one lobe,
by definition).
This conclusion held true even when both the simplifying assumptions – (a) that OT RFs are non-overlapping, and (b) that all Imc
neurons have the same number of RF lobes – were relaxed (see ‘Full version’ next).
Full version. We used a more biologically accurate model of space in which RF extents, overlap of RFs across neurons, and the
resolution of competition reported in the OTid (the minimum distance between two stimuli such that OTid is able to select the stronger
of the two stimuli) (Mysore et al., 2010) were all modeled to match experimental data. In addition, we allowed varying numbers of Imc
RF lobes:
Let the total range of elevational locations for which barn owl’s midbrain encodes space be R, and the resolution of encoding space
be r. Then, the number of distinct locations at which a stimulus can be placed along elevation is L = R=r. Let the resolution for
competitive selection be Cres.
The total number of distinct location-pairs at which two competing stimuli can be placed such that they are greater than Cres apart
from each other is approximately LðL � ð2Cres=rÞÞ. Note that this quantity is calculated by counting all the locations at which a second
stimulus can be placed such that it is at least Cres away on either side of a first stimulus that is placed in any of the L locations. How-
ever, when a first stimulus is placed at the edge of the visual field, a second competing stimulus can be placed only on one side such
that it is Cres away. It is straightforward to show that LðL � ð2Cres=rÞÞ is smaller than the corresponding quantity obtained when edge
effects are included. Hence, for location invariance to be achieved, selection of the stronger stimulus must at least be implemented
when two competing stimuli are placed in any of these possible location-pairs.
Let the number of lobes in a given Imc neuron be k. Let the half-max size of each lobe be lh. Then, a k lobed Imc neuron solves
competition for a total of kðL � ðlh=rÞkÞ location-pairs (assuming each Imc neuron sends inhibition to all locations that lie outside
the half-max extent of the neuron’s RF, without loss of generality; see ‘‘Model assumptions’’ section below and Figure S4 for impli-
cations of this assumption). This is just the number of location-pairs such that one stimulus can be placed inside the multilobed RF (at
its peak for effective suppression of competing stimuli) and the other outside. Let the total number of k lobed Imc neurons be Nk.
Therefore, the total number of Imc neurons is
N =
X
k
Nkk
(3)
To achieve location invariance, we need
X
k
Nkk
�
L � lh
r k
�
RL
�
L � 2Cres
r
�
(4)
Since kR1, and lh > 2Cres (mean lh = 33.6� ± 1.25� from the 209 RF lobes across 114 Imc neurons we measured, and Cres < 10�
(Mysore et al., 2010)), we get
�
L � lh
r k
�
%
�
L � 2Cres
r
�
(5)
Using (5) in (4) gives,
X
k
NkkRL
(6)
In other words, if all the Imc neurons are single-lobed (k = 1), this equation becomes NRL. Since the logical proposition ‘A = > B’
is exactly the same as the proposition ‘not (B) = > not (A)’, the proposition ‘k = 1 = > N R L’ is exactly the same as the proposition
‘N < L = > k s 1’ i.e., if the number of Imc neurons is less than the number of spatial locations, then at least one Imc RF must be
multilobed (because RFs cannot have fewer than one lobe, by definition).
Estimating number of elevational and azimuthal locations encoded by OTid (Lel and Laz, respectively)
To estimate, conservatively, the number of distinct elevational locations encoded by the OTid, we divided the extent of elevational
space by the poorest resolution of spatial encoding by OTid neurons. The OTid encodes elevations ranging typically from �60� to 60�
(Knudsen, 1982; Mysore and Knudsen, 2013). The poorest OTid spatial resolution was estimated as the largest distance between
e4
Cell Reports 25, 1158–1170.e1–e9, October 30, 2018
 adjacent spatial locations for which discriminability (d-prime) of neural responses was above a plausible threshold of 1(Bala et al.,
2003). Using published data (Sridharan et al., 2011) that reports d-prime values computed from spatial tuning curves in the OTid,
we estimated the OTid’s poorest spatial resolution at 3�. Thus, the number of distinct elevational locations encoded was at least
120�/3�, in other words, Lel R 40.
To estimate the largest number, the number of distinct azimuthal locations encoded by the OTid, we divided the extent of azimuthal
space by the best resolution of spatial encoding by OTid neurons. The OTid encodes azimuths ranging typically from �15� to
60�(Knudsen, 1982; Mysore et al., 2010). In addition, the OTid encodes frontal azimuths with a magnification factor of 150 mm/deg,
and peripheral azimuths with a magnification factor of 50 mm/deg (Knudsen, 1982). Because resolution varies inversely as the magni-
fication factor, we estimated the best spatial resolution from the poorest using M-scaling 3� * 50/150 = 1� (Carrasco and Frieder,
1997). Thus, the number of distinct azimuthal locations encoded was at most 75�/1�, in other words, Laz % 75.
Selection across azimuthal locations
The number of distinct azimuthal locations encoded by OTid was estimated above to be % 75 (Laz % 75).
The rostrocaudal extent of the Imc is 2800 mm, and the somas of Imc neurons are no larger than �33 mm (largest somatic dimen-
sion = 33 mm, n = 456 neurons across 20 coronal sections). Therefore, there are at least 84 (coronal) sections along the rostrocaudal
axis of the Imc (2800/33), with each section containing at least one Imc neuron not also found in the neighboring sections. (For this
conservative estimate of Naz, we only need that of the �26 neurons in each successive coronal section of the Imc (median #neurons
per section = 26; Figure 3C; dashed red line), just one be distinct.) In other words, there are at least 84 neurons involved in encoding
the at most 75 distinct azimuths: Naz R 84. Laz % 75, which yields that Naz R Laz.
Thus, there is sufficient number of Imc neurons to encode azimuthal locations, precluding the need for a combinatorial solution for
selection at all location-pairs along the azimuth (involving multilobe neurons with RF lobes spread along the azimuth). Consistent with
this expectation, azimuthal encoding by Imc neurons is effectively single-lobed: all lobes of a multilobe Imc neuron encode the same
azimuth (Figures 2A–2C).
Optimization model for solving stimulus selection at all elevational location-pairs (Figure 4)
Conceptualizing and setting-up the model (Figure S4). In our model,
L = number distinct spatial elevations at a given azimuth encoded in our model (i.e., the number of elevations in the ‘OTid’
space map).
N = number of model Imc-like neurons, i.e., neurons with Imc-like anatomical projection patterns.
kmax = maximum number of RF lobes allowed for each model neuron.
N* = smallest number of upto-kmax-lobed model neurons needed to solve selection across L elevations.
The optimization model solves for the number and positions of RF lobes of each of the N model neurons in order to achieve se-
lection at all location-pairs. The model neurons are ‘Imc-like’: each of them is excited by a stimulus placed anywhere within its
RF, and delivers competitive inhibition to all locations in the OTid space map outside its RF that is proportional to the strength of
the stimulus (Figures S4A and S4B). Without loss of generality, we take stimulus priority = 1 unit (for all stimuli), and the proportionality
constant (underlying inhibition by the Imc) to be 1. Therefore, for each stimulus, each neuron excited by that stimulus generates an
inhibition of 1 unit at those locations in the OTid that are outside that neuron’s RF (Figures S4A and S4B). For successful, relative-
priority dependent competitive stimulus selection between stimuli presented at a given pair of locations, the net inhibition at these
two locations in the OTid should be equal. For competitive selection to be solved at all location-pairs, this condition must hold for
stimuli placed at any pair of all the possible Lc2 (L choose 2) pairs of locations. The details of the setup of the optimization problem
are described below.
Let X be a matrix of size L x N (Figure S4C), where the jth column of the matrix corresponds to the L elevational locations encoded by
the jth Imc neuron in the population. The optimization problem is framed as minX f (X; L, N), where the objective function f(X) is de-
signed such that it achieves its minimum value (of -L(L-1)) for a given L only when the RFs of the model neurons solve selection at
all location-pairs.
Consider two competing stimuli (of equal strength) placed at locations 1 and 2. In our scheme, we represent this by a row vector
u1xn = [1 1 0 ..0 .0] (Figure S4D). The ones in the first two indices of the row vector correspond to the two locations at which the
competing stimuli are placed.
Note that XTuT results in a vector in which the jth index corresponds to the number of locations that the jth neuron is activated by
when the two competing stimuli are placed in positions shown in a (Figure S4E).
Additionally, the matrix (X-1) corresponds to the suppression image of the Imc population, where 1 is a matrix vector of all ones. The
jth column of this matrix represents the locations to which the jth Imc neuron sends inhibition in the OT space map. This is because of
the inverse anatomical projections from the Imc to the OT. The product (X-1)XTuT then results in a vector in which the jth index cor-
responds to the net inhibition sent to the jth location by the entire Imc population when the two competing stimuli are placed at
different locations, i.e., at different positions within the row vector u (Figure S4F).
Cell Reports 25, 1158–1170.e1–e9, October 30, 2018
e5
 For competitive selection at these two locations, the net inhibition at these two locations in the space map of the model ‘OTid’
should be equal. To penalize solutions for which this is not the case, we include a cost term in the objective function that is equal
to the square of difference in the inhibition at the two locations. This is written mathematically as
f1ðX; u; L; NÞ =
�
vðX � 1ÞXTuT�2
(7)
where v is a row vector whose length equals that of u and nonzero indices are same as u, but with the sign of one of the 1 s flipped (in
this case v = [1 �1 0 ..0 .0] or [-1 1 0 ..0 .0]). The minimum value that f1 can take is 0, which happens when equal inhibition is sent
to both the locations at which the competing stimuli are placed (Figure S4F).
In addition to the strength of inhibition at the two locations being equal, the strength of inhibition must be strictly negative. This is
because, the other possibility, of strength of inhibition at each location being zero, would not be acceptable because no inhibition
would be sent to either of the two locations. To penalize solutions for which this condition is not met, we include a cost term
in the objective function that is equal to the number of locations at which the inhibition is not negative. This is written
mathematically as
f2ðX; u; L; NÞ = u � sign
�
ðX � 1ÞXTuT�
(8)
Minimizing f2, therefore, ensures that inhibition is sent to both the locations. The minimum value f2 can take is �2, when inhibition is
sent to both the competing locations (Figure S4F).
Finally, we write the full objective for the location-pair (the locations in the pair are specified in the vector u) as below
fðX; u; L; NÞ = f1ðX; u; L; NÞ + f2ðX; u; L; NÞ
=
�
vðX � 1ÞXTuT�2 + u � sign
�
ðX � 1ÞXTuT�
(9)
The minimum possible value that f can take is �2.
For location invariance to be achieved, the function f should be minimized for each pair of locations at which competing stimuli can
be placed. In other words, f should be minimized for all possible permutations of vector u. This can be written mathematically as
fðX; u; L; NÞ = tr
�
VðX � 1ÞXTUT: � VðX � 1ÞXTUT�
+ tr
�
U � sign
�
ðX � 1ÞXTUT��
(10)
where U is the permutation matrix of vector u (thus rows of U contain all possible location-pairs). V is the corresponding permutation
matrix of vector v. tr(Y) refers to the trace (sum of all the diagonal elements) of the matrix Y. Y.*Z is the Hadamard (element-wise)
product between the matrices Y and Z and sign(Y) is a matrix obtained by applying the element-wise sign operator to the matrix Y.
Because there are Lc2 possible location-pairs (corresponding to the Lc2 permutations of the vector a), the minimum value that f can
achieve is �2*Lc2 = -L(L-1). Thus, selection is solved at all location-pairs in our optimization model if and only if the cost function con-
verges to the lowest possible value of –L(L-1).
We add two constraints to this optimization scheme. First, we code the RFs of all the model neurons with ones (inside RF) and zeros
(outside RF), a simplifying assumption (see ‘‘Model assumptions’’ section below for implications of this assumption). Second, we
introduce a mechanism to limit the number of lobes in any model neuron to kmax. This is done so that, by setting kmax = 3, we would
be able to match the experimentally observed constraint that there are no more than three RF lobes per Imc neuron. The first
constraint is fed into the optimization problem as bounded integer constraints with bounds between 0 and 1 to make the RFs binary.
The second constraint is implemented as an inequality constraint, written mathematically as
gðjÞ = kmax � 1L � XjR0; for all j = 1; 2.N
(11)
where 1L is a row vector of length L, and Xj is the jth column of X corresponding to the RF of the jth neuron. Additionally, we also test the
model with kmax = 10 for some of the analyses reported in Figures 4, 5, and 7.
We solve the above nonlinear optimization problem with mixed constraints, an np-complete problem, using the ‘MIDACO’ solver in
MATLAB (Schlueter et al., 2012).
Estimating N*:
N* is the smallest number of model neurons needed to solve selection at all location-pairs for a given L and kmax, i.e., the smallest N for
which the minimum value of the objective function (-L(L-1)) can be successfully achieved. This was estimated as follows. For each
value of N from 1 to L, we ran the optimization model 1000 times (1000 runs). Any given run was said to have converged to a solution if
the value of cost function did not change for 1000 successive iterations (by setting the ‘evalstop’ criterion in the optimization code to
1000), thereby reaching an asymptotic value. The collection of model neuron RFs at convergence was called a ‘convergent solution’.
Additionally, if the convergent solution attained the value of –L(L-1), then it was called an ‘optimal solution’. In other words, optimal
solutions are ones that converged and additionally achieve stimulus selection at all location-pairs.
N* (for a given L and kmax) is, therefore, the smallest value of N for which at least one of the 1000 runs yielded an optimal solution,
meaning that for N = N*-1, none of the 1000 runs yielded a solution that successfully achieved selection across all L locations.
e6
Cell Reports 25, 1158–1170.e1–e9, October 30, 2018
 For instance, if kmax = 1 lobe, then for all L, N* = L (Figure 4A, blue data; consistent with theoretical calculation presented in the text
surrounding Figure 3). If kmax = 3 lobes and L = 5 elevations, all runs for all values of N from 1 to L yielded convergent solutions, but
optimal solutions were produced only when N R 4 (Figure S5A). More generally, if kmax > 1 lobe, then for all L > 4, N* < L (Figure 4A;
orange and black data).
Range of kmax values chosen for various analyses (Figure 4A onward):
The specific values of kmax used in our simulations (Figures 4, 5, and 7) were 1, 3, and 10 lobes. The reasoning for this choice of values
is described below.
kmax = 1 lobe corresponded to the null hypothesis of single-lobed RFs
kmax = 3 lobes represented Imc data (Figure 1L)
kmax = 10 lobes. (i) The range of elevations encoded by the OTid and the Imc is no greater than �60� to �60�, and (ii) Most individual
RF-lobes have a half-max height R 10� (10-percentile value of half-max height of an individual RF lobe = 10� (Figure S3G). There-
fore, the number of possible distinct lobes along elevation for RFs of typical Imc neurons % �10 lobes ( = 120�/ (10� + 2�); with the
two added degrees representing 1� spacing on either side of a lobe to separate it from abutting ones.)
Model assumptions. Our optimization model makes two key simplifying assumptions: (a) discretized (pixelated) spatial locations,
and (b) binary (on or off) RFs of the model neurons. The former assumption can be readily reconciled with biology by making the pixel
size sufficiently small. Therefore, this assumption does not result in loss of generality of the model. Second, the pattern of spatial
inhibition sent to the OTid space map, the key computational function required of Imc in the model, is the spatial inverse of the
RF: inhibition is sent to all locations except the ones inside the RF. In other words, the spatial pattern of inhibition is, by definition,
a ‘binarized spatial inverse’ of the Imc RF, with the strength of delivered inhibition being proportional to the specific location within
the continuous RF at which the stimulus is placed (Figures S4A and S4B). For the model, it is the pattern of inhibition that is critical,
informationally speaking, rather than the variations in the strength of delivered inhibition based on the specific location within RF that
a stimulus occupies (Figures S4A and S4B). (This is unlike population vector coding, where the specific values of firing rates within an
RF are critical informationally (Georgopoulos et al., 1986; Lee et al., 1988; Lewis and Kristan, 1998; Ma et al., 2006)). Therefore, the
continuous RF can be binarized itself (say, at the half-max, or 75%-max level) without the qualitative conclusions of the model being
affected (Figures S4A and S4B). Notably, despite these simplifying abstractions of the biology by the model, we found that predic-
tions from the model held true experimentally (Figure 6), further revealing that the model captured sufficiently well the key
computational principles at play in this circuit. Consequently, it was able to provide a compelling explanation for the unusual func-
tional properties of Imc neurons, and illuminate the neural mechanisms by which this midbrain circuit solves stimulus selection at all
location-pairs.
Characterizing signature properties of optimal model solutions, and testing them in experimental data (Figures 5
and 6)
The ‘‘multilobe property’’ (property #1)
Model.
For each optimal solution at each (L, kmax, N) tested, we examined if any of the model RFs were multilobed. A model RF was
said to be multilobed if it had ‘‘on’’ pixels that were separated by ‘‘off’’ pixels; two adjacent ‘‘on’’ pixels were treated as one lobe. For
instance, in Figure 4B, neurons #2 and #4 have one lobe each. Neuron #1 has two RF lobes and neuron #2 has 3 RF lobes. These two
neurons are multilobed. Thus, this optimal model solution is said to satisfy the ‘‘multilobe property.’’
Data.
For each coronal Imc plane recorded, we examined if any of the neurons in that plane had multilobed RFs. Whether an RF was
single or multilobed was determined using methods described in (and surrounding) Figure 1.
The ‘‘optimized lobe-overlap property’’ (property #2)
Model.
A multilobed model neuron that shares each of its RF lobes, but not all, with another neuron is said to satisfy this property. If
every neuron in a model solution satisfies this property, the model solution itself is said to satisfy the optimized lobe-overlap property.
The fraction of model solutions satisfying this property for each (L, N*) is plotted in Figure 5C (100%, in each case).
Data.
The set of neurons recorded within a given coronal plane, i.e., across all the recording sites along a dorsoventral penetration,
is collectively a potential solution set for solving selection across all elevation pairs at that azimuth. (This is because of our finding that
spatial azimuth is encoded topographically along the rostrocaudal axis of the Imc, and all the elevations at a given azimuth are en-
coded by the neurons in the coronal plane at the appropriate point along the rostrocaudal axis; Figures 2 and S3). A multilobe neuron
that shares at least one of its RF lobes, but not all, with another neuron in the solution set is said to satisfy the experimentally testable
version of the lobe-overlap property. To test this property in data, we first obtained the set of discrete elevational locations encoded
by Imc neurons in a solution set (coronal plane). We did this by quantizing, at a resolution of 3� (to match theory and model; see main
text related to Figure 3), the maximum elevation range encoded by their RFs combined. Next, an RF lobe of a multilobed Imc neuron
was said to overlap with the RF of another neuron if there existed a location within the former’s half-max extent that also lay within the
half-max extent of the latter’s RF. The fraction of multilobed Imc RFs in each coronal plane that satisfy this testable version of the
optimized lobe-overlap property is shown in Figure 6C. (This testable version of the lobe-overlap property was necessary because
of the inherent infeasibility of recording from all Imc neurons in a coronal section, i.e., from all the neurons in a ‘solution set’.
Specifically, the small mediolateral extent of the Imc (< 350 mm), coupled with the thickness of the electrode (250 mm) that was
Cell Reports 25, 1158–1170.e1–e9, October 30, 2018
e7
 used to reliably target the deep Imc (�16 mm below brain surface), limited us to one dorsoventral penetration within a coronal section.
This made recording from all Imc neurons in a given section unviable. The average # neurons recorded per section = 3.44 ± 0.47.
The ‘combinatorial’ property (property #3)
‘‘Assorted neural subset’’ feature. Distant neurons are recruited to achieve selection for nearby locations, and nearby neurons are
recruited to achieve selection for distant locations. To test for this feature, we divide the elevation range (L locations) into three parts,
the upper L/3, middle L/3 and lower L/3 locations. Two locations are said to be ‘nearby’ if the distance between them is % L/3, and
‘distant’ if the distance between them is R 2L/3. Similarly, two neurons are said to be nearby if the distance between them is % (N-1)/
3, and distant, if their distance is R 2(N-1)/3. We then ask if distant neurons are recruited for a nearby location-pair (LP), and vice-
versa. Since there is no meaningful functional ordering of multilobe neurons owing to the lack of topography in the encoding of eleva-
tion, we must test these questions across permutations of the ordering of Imc neurons within a solution.
Model.
First, we tested if distant neurons are recruited for a nearby location-pair. We did so by computing the following metric
(Equation 12) for each (L, N*) (Figures 5E and 5F).
d ðnearby LPÞ =
�
min
solutions
�
min
permutations
�
max
nearby LPðdÞ
���
(12)
Here, ‘d’ is the maximum distance between the neurons recruited for solving selection for a given nearby location-pair in a given so-
lution. The maximum of this across all nearby location-pairs yields the farthest distance between neurons recruited to solve selection
for any nearby location-pair. The minimum of this value across permutations of neurons in the solution, and across all solutions, yields
d (nearby LP) for that (L, N*).
For L = 5 (N* = 4), we tested this exhaustively for all possible permutations ( = factorial(4)). However, for L = 20 (N* = 14) and L = 40
(N* = 27), the number of permutations is very large (14! = 8.7 x1010 and 27! = 1.08 3 1028). Because it was infeasible to test all possible
permutations in these cases, we tested a subset of permutations (n = 1000) that was selected randomly from the set of all the possible
permutations using the ‘randperm’ function in MATLAB.
For each (L, N*), we calculated the normalized minimum distance between neurons recruited for selection at distant location-pairs
as shown in Equation 13, and plotted it in Figure 5F.
dnormðnearby LPÞ = dðnearby LPÞ � dmin
dmax � dmin
(13)
Here, dmax ( = N*-1) and dmin ( = 1) are the maximum and minimum possible distances between neurons in a solutions set consisting of
N* neurons. We found that in every case, this normalized distance was high (> 0.66; the normalized cut-off value chosen for defining
‘distant’ neurons).
Next, we tested if nearby neurons are recruited for a distant location-pair (Figures 5E and 5G), using a metric constructed with a
logic similar to that used above:
d ðdistant LPÞ =
�
max
solutions
�
max
permutations
�
min
distant LPðdÞ
���
(14)
dnormðdistant LPÞ = dðdistant LPÞ � dmin
dmax � dmin
(15)
For each (L, N*), we calculated the normalized maximum distance between neurons recruited for selection at distant LPs
(Equation 15), and plotted the results in Figure 5G. We found that in every case, this normalized distance was small (< 0.33; the
normalized cut-off value chosen for defining ‘nearby’ neurons).
Data.
For Imc neurons in each solution set (coronal plane), we obtained the range of discretized elevation values encoded as before
(resolution of 3�), and then calculated the normalized minimum distance between nearby neurons and the normalized maximum dis-
tance between distant neurons using the Equations 13 and 15 above. Note that for the notions of nearby neurons and distant neurons,
there need to be at least 3 neurons in the solution set so that the maximum distance is 2 and the minimum distance is 1. Out of 14
coronal planes that contained multilobe neurons, 8 had R 3 neurons. The results from these 8 planes are plotted in Figure 6F.
(B) ‘‘Extensive intersection’’ feature.
Location-pairs occupying distant portions of space recruit shared neurons to solve selection at
each pair. Two location-pairs are said occupy distant portions of (elevational) space if one location-pair lies within the upper third of
the locations (upper L/3) and the other lies within the lower third of the locations (lower L/3). Since intersection between the neural
subsets is independent of the ordering of the neurons, we do not need to test this for all permutations of neuron orderings.
Model.
For every optimal solution at a given (L, N*), we tested if there existed two location-pairs (a ‘doublet’) occupying distant
portions of space such that the neural subsets recruited to solve selection at each location-pair shared at least one neuron. The
fraction of optimal solutions that satisfied this property is plotted as a function of (L, N*) in Figure 5I; the fraction is uniformly 100%.
Data.
For Imc neurons in each solution set (coronal plane), we obtained the range of discretized elevation values encoded as before
(resolution of 3�). We then tested if these neurons satisfied the extensive-intersection property as described for the model. Of the 14
e8
Cell Reports 25, 1158–1170.e1–e9, October 30, 2018
 coronal planes at which neurons were recorded, in 6 cases, the encoded locations included two location-pairs that occupied distant
locations. The fraction of these 6 coronal planes that satisfied the extensive intersection property is shown in Figure 6G (100%).
Wiring and metabolic costs in the Imc-OT circuit for implementing selection at all location-pairs (Figure 7)
Wiring cost
The wiring cost incurred by the Imc to implement selection at all location-pairs is estimated as the cost of generating axonal projec-
tions (‘wires’) between each Imc neuron and each of its target OTid neurons. This cost depends both on the number of locations that
each neuron must suppress and the number of neurons in the population. Assuming that the lengths of wires from Imc to each OTid
neuron is approximately equal (say 1 unit each, without loss of generality), we can estimate the total wiring length and consequently
the total wiring cost using Equation 16 below (see Chen et al., 2006).
Wiring CostðL; N�; kmaxÞ =
 X
N�
i = 1
ð#Locations suppressed by neuron i Þ
!
^ p
(16)
The summation is the total wiring length of all the wires from the Imc neurons to the OTid population. ‘p’ is a power term such that
typically 1 < p < 4 (see Chen et al., 2006). This quantity is computed for each optimal solution (obtained over the 1000 runs) for a given
(L, N*, kmax) triplet, and the results are plotted in Figure 7A.
Metabolic cost
The metabolic cost incurred by the Imc to implement selection at all location-pairs is estimated as the cost of generating and broad-
casting spikes to the OTid to achieve competitive suppression. This depends on the number of neurons activated by a stimulus at
each of the L locations, as well as the number of OTid locations to which each activated neuron delivers inhibition. If the cost of sup-
pressing one OTid location using 1 spike is 1 unit, then the total metabolic cost for the circuit for a given firing rate f is given by Equa-
tion 17 below (using a similar formula as for wiring cost).
Metabolic costðL; N�; kmax; fÞ =
 
f
L
X
L
j = 1
X
N�
i = 1
ð#Locations suppressed by neuron i when stimulus is placed at location Þ
!
^ q
(17)
Note that when the stimulus is placed at location j, the term in the inner summation is non-zero only for activated neurons. ‘q’ is a
power term chosen such that 1 < q < 4 (similar to the wiring cost). This quantity is computed for each optimal solution (obtained
over the 1000 model runs) for a given (L, N*, kmax, f = 10 Hz), and the results plotted in Figure 7B.
Total cost
The total cost for any solution is calculated as a weighted combination of the wiring cost (weight = a) and the metabolic cost
(weight = b) as given in Equation 18 below.
Total costðL; N�; kmax; fÞ = ða � Wiring costðL; N�; kmaxÞÞ + ðb � Metabolic costðL; N�; kmax; fÞÞ
(18)
Therefore, there are five parameters (a; p; b; q and f) in the computation of the total cost. The results are plotted for
a = 20; p = 2:5; b = 80; q = 2:42 and for firing rates of f = 10 Hz (thin black line) and f = 80 Hz (thick black line) in Figure 7C.
QUANTIFICATION AND STATISTICAL ANALYSIS
All analyses were carried out with custom MATLAB code. Parametric or non-parametric statistical tests were applied based on
whether the distributions being compared were Gaussian or not, respectively (Lilliefors test of normality). The Holm-Bonferroni
correction was used to account for multiple comparisons. Data shown as a ± b refer to mean ± s.e.m, unless specified otherwise.
The ‘*’ symbol indicates significance at the 0.05 level (after corrections for multiple comparisons, if applicable). Correlations between
RF centers (azimuth) and electrode measurement positions (rostrocaudal/ dorsoventral) were tested using Spearman’s rank corre-
lation coefficient (corr command in MATLAB with the Spearman option).
DATA AND SOFTWARE AVAILABILITY
Software code and the data that support the findings of this study are available from the corresponding author upon reasonable
request.
Cell Reports 25, 1158–1170.e1–e9, October 30, 2018
e9
