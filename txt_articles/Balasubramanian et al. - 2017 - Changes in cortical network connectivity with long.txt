 ARTICLE
Changes in cortical network connectivity with long-
term brain-machine interface exposure after
chronic amputation
Karthikeyan Balasubramanian1, Mukta Vaidya2,8, Joshua Southerland3, Islam Badreldin4, Ahmed Eleryan5,
Kazutaka Takahashi
1, Kai Qian6, Marc W. Slutzky7, Andrew H. Fagg3, Karim Oweiss4
& Nicholas G. Hatsopoulos1,2
Studies on neural plasticity associated with brain–machine interface (BMI) exposure have
primarily documented changes in single neuron activity, and largely in intact subjects. Here,
we demonstrate significant changes in ensemble-level functional connectivity among primary
motor cortical (MI) neurons of chronically amputated monkeys exposed to control a multiple-
degree-of-freedom robot arm. A multi-electrode array was implanted in M1 contralateral or
ipsilateral to the amputation in three animals. Two clusters of stably recorded neurons were
arbitrarily assigned to control reach and grasp movements, respectively. With exposure,
network density increased in a nearly monotonic fashion in the contralateral monkeys,
whereas the ipsilateral monkey pruned the existing network before re-forming a denser
connectivity. Excitatory connections among neurons within a cluster were denser, whereas
inhibitory connections were denser among neurons across the two clusters. These results
indicate that cortical network connectivity can be modified with BMI learning, even among
neurons that have been chronically de-efferented and de-afferented due to amputation.
DOI: 10.1038/s41467-017-01909-2
OPEN
1 Department of Organismal Biology and Anatomy, University of Chicago, Chicago, IL 60637, USA. 2 Committee on Computational Neuroscience, University
of Chicago, Chicago, IL 60637, USA. 3 School of Computer Science, University of Oklahoma, Norman, OK 73019, USA. 4 Department of Electrical &
Computer Engineering, University of Florida, Gainesville, FL 32611, USA. 5 Department of Electrical & Computer Engineering, Michigan State University, East
Lansing, MI 48824, USA. 6 Department of Biomedical Engineering, Illinois Institute of Technology, Chicago, IL 60616, USA. 7 Departments of Neurology,
Physiology, and Physical Medicine and Rehabilitation, Northwestern University Feinberg School of Medicine, Chicago, IL 60611, USA. 8Present address:
Department of Neurology, Northwestern University, Chicago, 60611 IL, USA. Correspondence and requests for materials should be addressed to
K.B. (email: karthikeyanb@uchicago.edu) or to K.O. (email: koweiss@ufl.edu) or to N.G.H. (email: nicho@uchicago.edu)
NATURE COMMUNICATIONS| 8:  1796 
| DOI: 10.1038/s41467-017-01909-2| www.nature.com/naturecommunications
1
1234567890
 E
xposure to a brain–machine interface (BMI) provides a
useful paradigm for examining the relationship between
neural plasticity and motor skill acquisition because a BMI
creates a causal relationship between a subset of recorded neurons
and the behavioral output of the device being controlled. There-
fore, any behavioral learning that takes place in a BMI paradigm
must be due to changes in neural activity among the recorded
neurons, although plasticity in neural activity may be due to
synaptic plasticity occurring outside the recorded area. A number
of BMI studies have shown short-term (within a daily session) and
long-term (across days) learning1–3. Associated changes in mod-
ulation and tuning curves of single cells and local field potential
oscillations have also been observed as BMI learning takes place1,
3–10. However, much less, if any, work has examined changes in
network connectivity associated with BMI experience.
Most BMI studies that have examined neural plasticity and
learning have faced two limitations. First, typical BMI experi-
ments recalibrate the decoders from day to day because neurons
are lost or gained due to recording instabilities. Therefore, both
the decoder and the recorded neural population vary over time. To
isolate the effects of neural plasticity on BMI learning, it is
important to keep the decoding parameters fixed and to record
from the same population of neurons over long-term exposure.
Second, most BMI studies involving non-human primates have
relied on healthy, intact animals or animals that have undergone
acute nerve blocks11 (however, see ref.12 for a brain–spine interface
to by-pass spinal lesions). Therefore, it is unclear whether observed
neural plasticity can generalize to patients with severe and often
chronic motor disabilities such as spinal cord injury or amputation
who are the ultimate recipients of BMI systems.
To address these limitations, we used fixed decoders with a
subset of neurons that were stably recorded over a one month
BMI learning experiment. Moreover, we used unilaterally ampu-
tated monkeys that had undergone therapeutic amputation several
years (two of them with 9 to 10 years and a third monkey over 4
years) before they arrived in our lab. The use of chronically
amputated monkeys is arguably the most clinically-relevant model
of human amputation and an important model of chronic de-
afferentation and de-efferentation where reorganization of motor
and somatosensory maps in cortex has taken place13–16.
0.93**
0.97**
0.76**
Contralateral - Z1
Contralateral - Z2
Ipsilateral - K
Reach
Grasp
Reach
Grasp
Normalized path length
Median time to success (sec)
Reach
Grasp
Contralateral - Z1
Contralateral - Z2
Ipsilateral - K
Normalized path length
a
360
50
40
30
20
30
20
10
0
30
20
10
5
0
0
0
10
20
30
40
10
20
30
40
0
30
60
15
10
5
0
10
0
300
240
180
120
60
0
5
10
15
20
25
30
35
40
0
10
20
30
0
5
10
15
b
c
d
0.83**
0.90**
R2
0.70**
R2
0.88**
0.31*
0.37*
Day of training
Day of training
Day of training
Day of training
R2
R2
Fig. 1 Behavioral performance of the subjects. a shows the median time to success over BMI training. Time to success refers to the time taken to perform a
successful trial of the reach-grasp-pull-release task. The discrete points in the plot correspond the actual data, and the solid lines show a fourth order
polynomial fit to the data. b–d shows the improvement in mean normalized path lengths of reach and grasp movements. Normalized path length refers to
the total path traveled by the robotic arm to complete a successful trial divided by the shortest path possible. The dotted lines represent least-square fit for
the data (shown as discrete points). **p < 0.001 and *p < 0.01
ARTICLE
NATURE COMMUNICATIONS | DOI: 10.1038/s41467-017-01909-2
2
NATURE COMMUNICATIONS| 8:  1796 
| DOI: 10.1038/s41467-017-01909-2| www.nature.com/naturecommunications
 We implanted multi-electrode arrays in the upper limb area of
primary motor cortex (MI) either contralateral (monkeys Z and
N) or ipsilateral (monkey K) to the amputation. We then arbi-
trarily assigned two clusters of recorded neurons to control either
the reaching or grasping velocities of a multiple degree-of-
freedom robot and trained the monkeys to volitionally modulate
these clusters of neurons to perform a sequential movement
consisting of reaching toward a target object, grasping it, pulling
it back, and finally releasing it. Applying a statistical causality
analysis to the network of neurons used to control the robot, we
determined whether network connectivity in the “contralateral”
monkeys would emerge among neurons that had not controlled
an intact limb for several years and compared the evolution in
network connectivity with that observed in the “ipsilateral”
monkey whose motor cortex continued to control an intact limb.
Results
BMI learning. The subjects learned to control the reach and
grasp velocities of the robot through volitional modulation of
spiking activity to perform the sequential reach-to-grasp task. The
task was self-paced with no preset time limit to successfully
perform a trial. The median time to successfully perform a trial
decreased with BMI exposure from ~370 to 60 s and ~250 to 20 s
for the two experiments with the contralateral monkey Z, from
~30 to 21 s for the contralateral monkey N and from ~110 to 40 s
for the one experiment with the ipsilateral monkey K (for mon-
keys Z and K see Fig. 1a; for monkey N see Supplementary Fig. 1b
(left panel); solid lines show a fourth order polynomial fit to the
data points; for monkey N, the fit was a third order polynomial
fit). We also assessed the efficiency in performing the task by
measuring the normalized path length defined as the total path
length traversed by the hand (reach) or aperture (grasp) divided
by the shortest path possible without path reversals. The mean
normalized path lengths of the reach and grasp control dimen-
sions decreased for the two experiments with the contralateral
monkey Z (Fig. 1b–c; dotted lines show least-square fit for the
data points; contralateral-Z1 R2 = 0.83 (reach, p < 0.001; t-
statistic with n = 21) and 0.90 (grasp, p < 0.001; t-statistic with
n = 21); contralateral-Z2 R2 = 0.70 (reach, p < 0.001; t-statistic
with n = 12) and 0.88 (grasp, p < 0.001; t-statistic with n = 12))
and for the single experiment with the contralateral monkey N
(Supplementary Fig. 1b (right panel); R2 = 0.67 (reach, p < 0.01; t-
statistic with n = 5) and 0.07 (grasp, p ~ 0.1; t-statistic with n =
5)). Likewise, for the ipsilateral monkey K, the normalized path
lengths decreased with BMI exposure (Fig. 1d; Ipsilateral-K R2 =
0.31 (reach, p < 0.01; t-statistic with n = 20) and 0.37 (grasp, p <
0.01; t-statistic with n = 20)). Although the three animals (Z, N
and K) exhibited learning effects, their movement strategies were
different such that monkey Z tended to perform reaching and
grasping in a sequential manner (see Supplementary Movie 1 for
qualitative demonstration and Supplementary Movie 2 for
improvements with learning), whereas monkey K and N exhib-
ited more simultaneous coordination of the reaching and grasp-
ing movements.
Emergence of effective connectivity. We developed a statistical
model to predict the current spiking activity of each neuron based
on the spike history of all neurons in the reach and grasp clusters
(see Methods section). Using this model, we then determined
statistically significant directed connections among all neuron as
BMI learning took place. The temporal evolution of connection
density (i.e., number of connections divided by the total number
of possible connections) with BMI learning was quite distinct
between the contralateral and ipsilateral monkeys (Fig. 2a;
Supplementary Fig. 2). Both contralateral monkeys began with a
sparse network early in BMI exposure whose connection density
increased in a nearly monotonic fashion with BMI learning
(Fig. 2b, red and blue lines for contralateral-Z1 (with Decoder A)
and
contralateral-Z2
(with
Decoder
B),
respectively;
Supplementary Fig. 3a for monkey N with Decoder B). In
contrast, the ipsilateral monkey began with a dense network early
in BMI learning, which was then pruned in the middle of BMI
learning, and then increased in connection density at the end of
BMI learning beyond the initial density (Fig. 2b, yellow line;
ipsilateral-K with Decoder B).
To more closely examine the dynamics of network connectiv-
ity, we parsed the entire network into four subnetworks
comprising (1) directed connections between the neurons within
Contralateral - Z1
Contralateral - Z2
Ipsilateral - K
Connection density
Monkey-K (Ipsilateral)
Monkey-Z (Contralateral)
Early
a
b
Intermediate
Late
0.7
0.6
0.5
0.4
0.3
0.2
0.1
0
5
10
15
Day of training
20
25
30
35
40
R1
R2
R3
R4
R5
R6
R7
R8
R9
R10
R11
R12
R13
R14
R15
G15
G14
G13
G12
11
G
G10
G9
G8
G7
G6
G5
G4
G3
G2
G1
R1
R2
R3
R4
R5
R6
R7
R8
R9
R10
G10
G9
G8
G7
G6
G5
G4
G3
G2
G1
Fig. 2 Network density in the neuronal populations. (a, Top) Three instances along the days of training shows a monotonic increase in network connectivity
in the contralateral monkey Z (contralateral-Z2). Each chord represents a connection between two neurons. (a, Bottom) shows the connectivity in the
ipsilateral monkey K. There was an initial decrease in the network density followed by an increasing phase. Different colored chords represent individual
neurons. The labels Rn (red) and Gn (green) correspond to the reach and grasp neurons, respectively. b The connection density along the entire course of
training for two experiments with monkey Z and one experiment with monkey K
NATURE COMMUNICATIONS | DOI: 10.1038/s41467-017-01909-2
ARTICLE
NATURE COMMUNICATIONS| 8:  1796 
| DOI: 10.1038/s41467-017-01909-2| www.nature.com/naturecommunications
3
 the reach and (2) grasp clusters, (3) directed connections from the
grasp cluster and terminating in the reach cluster and (4) directed
connections from the reach cluster and terminating in the grasp
cluster (Supplementary Figs. 4–6). Across all four subnetworks,
we observed a similar trend in connection density as we had with
the entire network where connection density increased nearly
monotonically for the contralateral monkey Z, and connections
were pruned followed by an increase in connectivity in the
ipsilateral monkey K.
Connection polarity. By examining the sign of the average value
of spike history coefficients among all significant connections (see
Table 1), we could compare the temporal evolution of excitatory
and inhibitory connections during BMI learning. For the con-
tralateral monkeys, both excitatory and inhibitory connection
density increased although the excitatory connection density was
consistently larger and increased faster reaching a level that was
over 100% higher than the inhibitory connection density at the
end of BMI learning (Fig. 3a, b; Supplementary Fig. 3b; see also
Supplementary Fig. 7 for a third experiment with monkey Z using
decoder A and a position controller where the decoded velocity
was temporally integrated to generate position commands to the
robot). For the ipsilateral monkey, both excitatory and inhibitory
connection density exhibited pruning, and, as with the con-
tralateral monkeys, excitatory connection density was consistently
larger than inhibitory connection density (Fig. 3c).
We then compared excitatory and inhibitory connection
density within vs. across the reach and grasp clusters across all
training days. To do this, we measured the density of directed
connections projecting out from a given neuron (i.e., the out-
degree density) to other neurons within or across clusters. For
both monkeys Z and K, excitatory connection density within
clusters was significantly higher as compared to across clusters
(Fig. 4a–c; see red squares, and red lines in the inset, p < 0.01,
paired t-test; see Supplementary Fig. 7b for Contralateral-Z3
experiments). In contrast, inhibitory connection density was
significantly higher across clusters as compared to within clusters
(Fig. 4a–c; see blue circles, and blue lines in the inset, p < 0.05,
paired t-test). Similar trends were observed in the reach and grasp
clusters of the contralateral monkey N (Supplementary Fig. 3c),
but with the limited period of BMI exposure, the differences were
not statistically significant for this monkey.
Relationship between connectivity and firing rate. As con-
nectivity evolved with BMI learning, we also observed con-
comitant changes in firing rate among the neurons in the two
clusters that mirrored the changes in connection density to a
certain extent (Fig. 5a). This could be potentially problematic as
our statistical model will more likely find a significant connection
between neurons with high spike counts, if a functional con-
nection exists. To discount this possibility, we first cross-
correlated the dynamics in connection density with the changes
in mean firing rate over BMI learning sessions. For the con-
tralateral monkey Z, we found that the peak correlation occurred
at a time lag of at least one learning session indicating that the
mean firing rate modulation led the changes in connection den-
sity and suggesting that the connection density was not simply an
artifact of overall firing rate (Fig. 5a (inset)). Likewise, for the
ipsilateral monkey K, we found that the firing rate changes led the
changes in connectivity by one training session during the initial
pruning as well as during later growth in connectivity. Second, we
compared connectivity in a late learning data set with the
Table 1 Granger causality analysis to estimate connectivity
Steps
Formulation
1. Modeling the CIF using GLM
framework
log λi tjθi; H t
ð Þ
ð
Þ ¼ θi;0 þ PN
n¼1
PMi
m¼1 θi;n;mRn;m t
ð Þ;where, θi;0 represents the baseline activity, and θi;n;m represents the
effect of ensemble spiking history Rn;m t
ð Þ of neuron n on the firing probability of neuron i at time t for n = 1, …, N
neurons. Here Rn;m t
ð Þ is modeled as the spiking history using a binwidth W (set as 3 ms) spanning the interval
[t – mW, t-(m-1)W]
2. Selecting model order
Akaike’s Information Criterion
3. Likelihood of causality
Γij ¼ log LiðθiÞ
Liðθj
iÞ
¼ log
Prðtþ1 of ijpast of everyone upto tÞ
Prðtþ1 of ijpast of everyone except j upto tÞ
4. Connection polarity
sgn PMi
m¼1 θi:j:m
�
�
�
�
�
�
Contralateral - Z1
Day of training
0
10
20
30
40
0.1
0
10
20
30
40
0.2
0.3
0.4
0.5
30
20
10
0
Contralateral - Z2
Ipsilateral - K
Excitatory
Inhibitory
a
b
c
Connection density
0.1
0.2
0.3
0.3
0.2
0.1
Fig. 3 Network connection density among excitatory and inhibitory connections. a, b correspond to the two experiments with the contralateral monkey Z
and c shows the network density in the ipsilateral monkey K. (solid lines are fourth order polynomial fits to the data points)
ARTICLE
NATURE COMMUNICATIONS | DOI: 10.1038/s41467-017-01909-2
4
NATURE COMMUNICATIONS| 8:  1796 
| DOI: 10.1038/s41467-017-01909-2| www.nature.com/naturecommunications
 connectivity in a data set that pooled three early learning sessions
so that the total spike counts in both data sets were comparable.
For both monkeys, the connection density was significantly
higher in the late learning data set even controlling for total spike
count (Fig. 5b; paired t-test, p < 0.01 for the excitatory connec-
tions and p < 0.05 for the inhibitory connections).
To extend the analysis further, we classified the neurons based
on the correlation between the individual firing rates and the
network density. Neurons with firing rates significantly correlated
to network density were formed into one group and the
remaining neurons formed the second group (see Supplementary
Fig. 8). For the Contralateral-Z2 neurons, both groups showed
nearly monotonic increases in their connection density irrespec-
tive of the differing profiles in their firing rates. Similarly, for the
Ipsilateral-K neurons, the connection dynamics remained com-
parable for the two groups of neurons, despite their firing rate
differences.
Discussion
We have successfully demonstrated that learning to use a
cortically-controlled BMI to perform a complex, sequential task is
possible in chronically amputated animals. This is significant as it
is known that the motor cortex undergoes reorganization fol-
lowing amputation and thus has clinical implications for human
amputees17–26. We have also demonstrated here the possibility of
using ipsilateral cortex of a chronic amputee to successfully
perform a BMI task and compared the dynamics of its plastic
changes with contralateral networks. This has implications on
developing BMIs for lateralized cortical deficit, where neural
plasticity is required to accommodate movement control of both
BMI and intact arm within a single hemisphere.
While the contralateral monkey Z exhibited a more dramatic
decrease in median time to success, both monkeys (Z and K)
managed to ultimately perform a successful sequential movement
in <30 s within 12–21 training sessions. Likewise, both monkeys
became more efficient in controlling the reach and grasp com-
ponents of the task by reducing their normalized path length by
up to a factor of 30. There was no clear indication that learning
had reached asymptotic performance, so performance would have
likely improved even further with extended BMI exposure.
Most studies on BMI exposure3, 25, 26 have used the same
group of neurons to decode multiple degrees of freedom. In
contrast, we used different clusters of neurons assigned to control
the reach and grasp dimensions separately, and observed plastic
changes occurring within and across the clusters. This approach
of clustering the neurons provided a means to assess network
changes occurring within and across distinct functional groups.
Neural plasticity can be a more reliable manifestation of BMI
learning27, 28 compared to extrinsic performance metrics. First,
the behavioral metrics showed fluctuations during learning (see
contralateral data in Fig. 1a), while the connection density
showed a near monotonic increase with exposure (Fig. 2b). By
using fixed decoders with stably recorded neurons, we had the
opportunity to isolate the effects of learning on neural plasticity in
the same set of neurons over a 40-day period. Second, although
different decoders resulted in somewhat different performance
results (Fig. 1a, red vs blue), the overall dynamics of network
density were very similar (see Fig. 2b, red vs blue).
Neural adaptation with BMI exposure has shown single cell
plasticity including changes in the tuning properties of individual
neurons7, 8, 29. Synchrony in a specific bandwidth of neural
oscillations has also been shown to increase with BMI exposure9.
Likewise, with operant conditioning of a neuroprosthetic device,
the coherence between neural activity in M1 and dorsal striatum
has been shown to increase30. It was previously argued that
plasticity at the subcortical levels is necessary to learn neuro-
prosthetic skills31. However, further studies would be needed to
establish whether subcortical plasticity is critical also for chronic
amputees acquiring neuroprosthetic skills and whether such
plasticity have any causal influence on the cortical plasticity.
Unlike most other studies that have examined single cell
properties, we characterized the dynamics in functional con-
nectivity in a network of M1 neurons and observed a striking
difference in network plasticity between the contralateral and
ipsilateral monkeys. As might be expected, the contralateral
monkeys began with a sparsely connected network early in BMI
learning with a normalized connection density of ~0.05 (i.e., 5%).
The contralateral motor cortex had not controlled an intact limb
for several years, and thus had been severely de-efferented and
de-afferented for an extended time. With BMI learning, the
contralateral networks steadily increased their connection density
attaining an excitatory connection density of 30–40% and an
inhibitory connection density of 10–20%.
The ipsilateral monkey, in contrast, began with a large con-
nection density of nearly 40 and 20% among excitatory and
inhibitory connections, respectively. Although the ipsilateral
motor cortex may have experienced disrupted activity from the
motor cortex on the contralateral side, it had continued to control
an intact limb and had received normal afferent feedback from
the intact limb which may explain why the connection density
was higher than in the contralateral monkey. A number of studies
0.6
a
b
c
0.4
0
10
Day of training
20
30
0
Day of training
20
30
0
Day of training
Within
Between
20
30
0.2
0
0
0.2
Within cluster connection density
Between cluster connection density
0.4
0.6
0
0.2
0.4
0.6
0
0.2
0.4
Ipsilateral - K
Contralateral - Z2
Contralateral - Z1
0.6
Excitatory
Inhibitory
Fig. 4 Excitatory and inhibitory connection density within and between the reach and grasp clusters. a–c The connection density within vs. across clusters
for excitatory (red points) and inhibitory (blue points) connections. Each point corresponds to a given training day. Gray dashes correspond to the identity
line. Inset shows the temporal dynamics of the connections resolved by clusters. Solid lines represent within-cluster connection density and dashed lines
represent between-cluster connection density
NATURE COMMUNICATIONS | DOI: 10.1038/s41467-017-01909-2
ARTICLE
NATURE COMMUNICATIONS| 8:  1796 
| DOI: 10.1038/s41467-017-01909-2| www.nature.com/naturecommunications
5
 have shown motor representations in motor cortex associated
with ipsilateral limb movements as well as contralateral limb
movements32, 33. Moreover, studies have used imagined or overt
ipsilateral limb movements to control a BMI34–36. In our study,
for the ipsilateral monkey (monkey K) that drove the BMI using
the cortex ipsilateral to the amputation, the decoder was not
based on explicit movement of the intact limb (contralateral
limb), but we cannot completely discount the possibility of any
imagined or overt movement attempts during BMI learning.
Over the first 8 training sessions, the network of the ipsilateral
monkey proceeded to prune its connections and then re-establish
a dense network structure. One might speculate that the existing
network structure that had controlled the intact limb had to be
modified to control the BMI, thus resulting in a transient pruning
of connections.
However, a curious fact
is
that the re-
establishment of a dense network began at roughly day 30
exactly when the ipsilateral monkey began performing poorly for
a short while before returning to her minimum time to success
(Fig. 1a). This suggests a novel network structure began to be
established on day 30 associated with a new strategy (i.e., different
from her original BMI control strategy) for BMI control resulting
in a temporary worsening of performance. Although we did not
track movements in the intact limb, an intriguing possibility is
that the transient pruning and following network expansion may
have subtly affected the behavior of the intact limb.
The overall dynamics of network connectivity were quite dif-
ferent between the contralateral and ipsilateral monkeys, but,
there were several common features in the nature of their con-
nectivity and its relationship with mean firing rate. First, the
excitatory connection density was consistently stronger by about
50–200% than the inhibitory density when considering the entire
network. Second, excitatory connection density was generally
stronger within the reach and grasp clusters than between the
reach and grasp clusters (Fig. 4) indicating that neurons driving a
single control dimension were more tightly coupled than neurons
across the two control dimensions which could move more
independently. In contrast, inhibitory connection density was
stronger across the two clusters than within the clusters again
suggesting less synchronous movement of the reach and grasp
control dimensions.
Monkeys Z and K were two months old when they were
amputated, and their corticospinal pathways, especially the
cortico-motoneuronal
projections,
would
have
needed
6–8 months to fully develop37, 38. This provided a unique plat-
form to study network dynamics in an ensemble of neurons that
had not completely matured to control the upper limb. This adds
to previous BMI work using subjects with pathological condi-
tions. A study using a rat stroke model showed that perilesional
cortex (PLC) could be used for BMI control39. In human subjects
with spinal cord injury (SCI), direct cortical control was also
shown to be feasible40, 41. With PLCs, the downstream circuits
remain intact, and for SCI, depending on the extent of the injury,
residual afferent and even efferent pathways may be intact. Our
chronic amputee model extends previous studies by showing that
Contralateral - Z1
Contralateral - Z2
Ipsilateral - K
0.4
0.38
a
b
0
–5 0
5
0.32
0
–1
0.8
0
–1
–5
5
0
0.65
0
–1
–5
5
0
–5 0
5
Connection density
Mean firing rate (Hz)
0.3
0.2
0.1
0.4
15
10
5
0.7
0.6
0.5
0.4
0.3
0.2
0.1
0
Outgoing connections
0
20
40
0
22
20
18
16
14
12
10
8
6
4
2
0
22
20
18
16
14
12
10
8
6
4
2
0
22
20
18
16
14
12
10
8
6
*
*
*
**
**
4
2
0
Early
Early
Late
Late
Early
Early
Late
Late
Early
Early
Late
Late
20
40
15
**
Day of training
Day of training
Day of training
Excitatory
Inhibitory
30
Connection density
Mean firing rate
Standard error of mean firing rate
5
15
25
5
15
25
Fig. 5 Relationship between connectivity and firing rate. a shows the mean firing rate (gray line; the standard error is shown as shaded region) along with
the overall connectivity (yellow line). Inset shows the cross-correlation between mean firing rate and the normalized connectivity. The peak correlation is
marked in red line. b Connection density projecting out of each neuron (i.e., out-degree density) during an early pooled data set and a late learning day is
shown. The early pooled and late data sets had comparable spike counts. Each point corresponds to the number of out-degree connections of a single
neuron. Red and blue lines connect excitatory and inhibitory out-degree densities, respectively. (Paired t-test, **p < 0.01, *p < 0.05)
ARTICLE
NATURE COMMUNICATIONS | DOI: 10.1038/s41467-017-01909-2
6
NATURE COMMUNICATIONS| 8:  1796 
| DOI: 10.1038/s41467-017-01909-2| www.nature.com/naturecommunications
 neuroprosthetic control and functional plasticity are possible
using cortex that had lost both afferent and efferent connections
to the missing limb segments years prior to the BMI experiments.
The temporal evolution of mean firing rate led the dynamics of
connectivity by at least one training session indicating that the
changes in functional connectivity may have been driven by firing
rate modulation. If functional connectivity reflects underlying
synaptic connectivity, these results suggest that the animal may be
voluntarily modulating inputs to motor cortex to affect changes
in firing rate which in turn lead to synaptic plasticity among the
neurons controlling the BMI. These observations support the
argument that network plasticity and reorganization can play an
important role in learning to control a neuroprosthetic device.
Methods
Neurophysiology and recordings. Three rhesus (Macaca Mulatta) monkeys
(monkeys Z, N and K) with chronic unilateral amputation of the upper limb were
used in this experiment. The monkeys had received therapeutic amputations prior
to our receiving them for these experiments. The amputations were required to
rescue them following injuries to their arm, and were not amputated for the
purposes of this experiment. Monkey Z had a transradial amputation and monkeys
K and N had elbow disarticulation amputation ~ 10, 9 and 4 years before they
arrived to our lab. Monkeys Z and K were 2 months old at the time of amputation,
and monkey N was 5 years old. Utah multi-electrode arrays (UEAs) (1.0 mm
electrode length and 400 µm pitch from Blackrock Microsystems, Inc., Salt Lake
City, UT) were implanted in the upper limb region of primary motor cortex (M1)
on the contralateral side to the amputation for monkeys Z and N, and on the
ipsilateral side to the amputation for monkey K (see Fig. 6a for monkeys Z and K).
Prior to implantation, small electrical currents were applied to the motor cortex
using a surface stimulator to evoke movements in the residual limb or intact limb
contralateral to the side of the implantation. The surgical and behavioral proce-
dures involved in this study were approved by the University of Chicago
Institutional Animal Care and Use Committee and conform to the principles
outlined in the Guide for the Care and Use of Laboratory Animals.
Neural data recorded as analog signals were amplified, bandpass filtered
between 0.3 Hz and 7.5 kHz, and sampled at 30 kHz before digitization. A fourth
order high-pass Butterworth filter with a cut-off frequency of 250 Hz was applied
before spike detection. Out of a population of more than 100 neurons recorded
from monkeys Z and N, and 200 neurons from monkey K, 20 to 30 of the most
stable neurons were chosen, for decoding. Single units were isolated manually using
an online hoop-based spike sorting algorithm (Blackrock Microsystems, Inc.) and
then assigned to the corresponding clusters for decoding. Each waveform was
isolated using 3 or 4 hoops that would define a spike template. These hoop
definitions were stored and applied again with minor modifications during the
consecutive BMI session. The experimenter manually verified for any missing
neurons and ensured that the waveforms remained comparable across days. The
mean waveforms of neurons used in two of the experiments are shown in
Supplementary Figs. 9–12. In theory, units could have been lost and replaced by
other units from one day to the next with the same or similar features on the same
channel. So, it is not possible to be absolutely sure that we are recording from the
same cell.
BMI and behavioral task. The top-level diagram of the experimental setup is
shown in Fig. 6b. Single neuron activities were binned into 50 ms bins, and the
spike trains were decoded to estimate reach and grasp velocities. A Null-space
controller42 was used to map the decoded output into joint-space velocities of a
multiple DOF robot. The animals were operantly conditioned with juice reward to
control the robot in order to perform a sequential reach-to-grasp task (Fig. 6c).
Each trial in the task began with the robot arm positioned 18 centimeters away
from the target object by the robot controller. The animal was then free to voli-
tionally move the robot arm and hand in order to reach forward to the target
object, grasp the object, pull it back by 5 cm and then release it. The robot com-
prised a 7 DOF redundant arm (i.e., the Barrett Whole Arm Manipulator, or
WAM) with a 4 DOF hand (i.e., the BarrettHand) (Barrett Technology LLC,
Newton, MA). The BarrettHand was modified such that one digit opposed the
other two so that it represented the thumb and defined an aperture between it and
the other two juxtaposed digits. In this study, the task space was limited to two
control dimensions. Each control dimension represented a synergy of joint DOFs
R
C
M
L
R
C
M
L
Start
Reset
Grasp
Reach
Pull
Release
4 mm
CS
SPCD
R
C
M
L
R
C
M
L
a
c
d
CS
SPCD
Reach 
decoder
Grasp 
decoder
4 mm
Reach neurons
Grasp neurons
Contralateral - Z1
Contralateral - Z2
Ipsilateral - K
Monkey Z
Monkey K
Monkey  K
Monkey  Z
Neural interface
single unit activity
Binned 
spike train
Decoder
Robotic 
controller
ROS domain
Visual feedback
Robot
base
X-axis
b
Fig. 6 Schematic of the brain–machine interface and the motor task. a Cortical landmarks and the location of array implantation (SPCD, superior precentral
dimple; CS, central sulcus). b Neural spike trains were decoded to generate control signals for the robot. Blocks within the dotted region were implemented
in the Robotic Operating System (ROS) platform. c The behavioral task comprises reaching toward an object, grasping and pulling it through a partial
trajectory back, and release d two neural subpopulations, reach (red) and grasp (green) were decoded independently to generate control velocities for the
robot. Spatial distribution of the clusters are shown for the contralateral and ipsilateral experiments
NATURE COMMUNICATIONS | DOI: 10.1038/s41467-017-01909-2
ARTICLE
NATURE COMMUNICATIONS| 8:  1796 
| DOI: 10.1038/s41467-017-01909-2| www.nature.com/naturecommunications
7
 which corresponded to either (1) moving the hand along the x axis in Cartesian
coordinates away from and toward the base of the robot or (2) grasping by opening
or closing all three digits of the robotic hand simultaneously (Fig. 6d; Supple-
mentary Fig. 1a). The span of the reach dimension was 18 cm and the maximum
grasp aperture was 15 cm. And, the task was self-paced without any time con-
straints. Two distinct subsets of single units from M1, dubbed as reach and grasp
clusters, controlled the reach and grasp dimensions, independently. Subsequently,
the decoded outputs were translated into joint-space velocities.
Decoder initialization. With amputee subjects, neural activity cannot be mathe-
matically mapped to innate motor output due to the lack of an intact limb, and,
therefore, we used non-biomimetic algorithms to create the mapping. Two dif-
ferent types of fixed decoders (Decoders A & B) with different neurons for each
decoder were used for the contralateral monkey Z comprising two separate
experiments (“Contralateral-Z1” and “Contralateral-Z2”) separated by a 40 day
interval where the monkey was not exposed to the BMI. Only Decoder B was used
with the contralateral monkey N (“Contralateral-N”) and ipsilateral monkey K
(“Ipsilateral-K”). Each decoder comprised two one-second long (20 taps of 50 ms
each) Wiener filters independently controlling the reach and grasp velocities. The
decoders were initialized either, (i) using neural activity related to extrinsic beha-
vior on the ipsilateral side (decoder A) or (ii) using intrinsic resting-state neural
activity (decoder B).
Decoder A. Neural activity from a population of M1 neurons was mapped to
two “desired” velocity profile templates (for reach and grasp dimensions,
respectively) inspired by the minimum-jerk velocity profiles that characterize
biological reaching43, 44. Neural activity was sampled while the monkey performed
an ipsilateral arm movement, and this activity was mapped to the velocity template
of the reach control dimension. For the grasp dimension, neural activity was
sampled as the monkey observed pre-programmed grasp trials performed by the
robot, relying on observation-based responses in M145, 46.
And, the system of equations,
^
y ¼ Xβ;
ð1Þ
was solved for β using a Ridge regression estimator, given by,
β ¼ ðXTX þ λIÞ�1XTy;
ð2Þ
where, ^
y is the decoded velocity for a given neural activity matrix X (composed of
activity from n neurons ×20 bins of 50 ms history each). The ridge parameter λ
ensures that the inverted matrix has a condition number no larger than 103.
Estimators based on ridge regression are known to reduce the variance of the
estimate but with a certain bias. This variance-bias trade-off is useful to avoid
overfitting of the data, and handles unseen data presented to the estimator.
Decoder B. While Decoder A is more suitable for unilateral amputees capable of
moving the ipsilateral arm, an unsupervised approach47 based on resting-state
neural activity was tested that completely relaxes any requirement of motor
behavior. This decoder uses spontaneous neural activity characteristics to estimate
the decoder coefficients. Tap weights were sampled from a multivariate Gaussian
generative model space denoted by,
β � Nð0; SÞ;
ð3Þ
where, S represents the sample covariance matrix derived from spontaneous neural
activity as,
S ¼ 1
M
^
X
T ^
X;
ð4Þ
where, ^
X is the mean-centered neural firing rate matrix X, and M is the number of
filter taps. The eigenvectors of S span the entire covariance space. They were
determined by decomposing the matrix,
Y ¼
1
ffiffiffiffiffi
M
p
^
X ¼ UΣVT;
ð5Þ
The decoder coefficients were estimated using a subset of the eigenvectors
Us � U, denoted as,
w ¼ Usϕ;
ð6Þ
where, ϕ is the vector of spanning coefficients that minimizes the cost function,
J ¼
ffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi
ffi
wTS�1w
p
þ z � 1
j
j þ cr
X
g
rgðμg; σ2
gÞ þ
X
g
cs:rsðγgÞ
 
!
þ 1 � f
j
j;
ð7Þ
where,
ffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi
ffi
wTS�1w
p
is the Mahalanobis distance to the distribution assumed in
Equation-3, z � 1
j
j is the term used to reduce output fluctuations by decreasing the
number of zero-crossings of the zero-mean decoded output, rgðμg; σ2
gÞ (Rao score)
and rsðγgÞ ensure Gaussian properties in the decoded output. The final term,
1 � f
j
j ensures a more equitable distribution of labor across all the neurons in use,
where f denotes the fraction of neurons contributing to 90% of the decoded output.
Each monkey was assigned two clusters ({reach, grasp}) to control the robot.
The decoders used {15, 15}, {9, 9} and {19, 10} pairs of neurons for the reach and
grasp clusters from Monkeys K, N and Z, respectively. After n-hours of training,
Monkey Z was reassigned with new clusters with {10, 10} neurons and trained on
the same behavioral task. Monkey K used the ipsilateral side of the amputation to
control the robot, while Monkeys N and Z used the contralateral implantations.
Neural clusters. Before running the BMI experiments, we assessed the stability of
neurons by tracking them over 7 sessions. Based on prior published work from our
lab48, we have found that neurons that are stable over 7 sessions are highly likely to
remain stable over the next session. Therefore, we chose a subset of neurons for
BMI control that had remained stable for 7 sessions prior to the BMI experiment.
These stable units were clustered into distinct groups based on strong correlated
firing in the “resting” state, while the animal was sitting idly in its chair49. Units’
identities were tracked using their waveform profiles50 prior to assessing their
stability. Instead of using all available neurons for each control dimension, we
chose to assign a particular cluster of highly correlated neurons to control a single
control dimension. This is due to the incremental approach we used for BMI
exposure such that the monkey was first exposed to one control dimension (i.e.,
reach) and then given the grasp dimension to control together with the previous
dimension. Thus, the monkey could, in principle, learn to modulate one cluster to
control the reach and then learn to modulate an independent cluster of neurons to
control the grasp instead of relearning to modulate the entire neural population for
reach and grasp. Two of the clusters were arbitrarily chosen to control the reach
and grasp control dimensions. The analyses presented here are from when the
monkeys were exposed to using both clusters. Monkey Z used 29 neurons {19
Table 2 Algorithm for balancing units per cluster
Require: A set of clusters of stable units, C, and a minimum number of units per cluster, M
Ensure: At least M stable units are assigned per cluster
N ← 0
for all c ∈ C do
N ← N + (M − sizeof(c))
end for
while N > 0 do
Identify all available donorClusters with size of (c)>M
for all c ∈ donorClusters do
Find the electrode ec that has the most weakly connected stable units
end for
Pick a donorCluster ← c such that c ← arg mini∈donorClusters funcon (i, ei)
Assign all units on ec to a receivingCluster ← υ such that υ ← arg maxi∈C funcon (i, ei)
N ← 0
for all c ∈ C do
N ← N + (M−size of (c))
end for
end while
ARTICLE
NATURE COMMUNICATIONS | DOI: 10.1038/s41467-017-01909-2
8
NATURE COMMUNICATIONS| 8:  1796 
| DOI: 10.1038/s41467-017-01909-2| www.nature.com/naturecommunications
 reach, 10 grasp} for Decoder A, and 20 neurons {10 reach, 10 grasp} for Decoder B.
Likewise, 18 neurons {9 reach, 9 grasp} were used for Decoder B with monkey N.
Finally, for monkey K, 30 neurons {15 reach, 15 grasp} were used for decoding.
Decoder B used clusters with balanced number of neurons in each cluster (see
Table 2 for the balancing algorithm). We also reserved other recorded neurons that
were stable and had resting-state characteristics that were similar to neurons in the
clusters, to be used as replacement if neurons were lost. However, in the experi-
ments reported here, we did not lose any neurons.
Directed effective connectivity. We used a Granger-type causality estimation
technique generalized for point-processes to infer directed effective connectivity
and its polarity (i.e., excitatory or inhibitory) among simultaneously recorded
neurons51, 52 Neural activity epochs during specific periods of the decoded velocity
were used to infer causality. The magnitude of decoded velocities were normalized
to range between 0 and 1, and periods were chosen when the velocities were ≤0.05
for 500 ms followed by a transition to ≥0.5 within 50 ms and then maintained ≥0.5
for another 500 ms. The instantaneous spiking of a candidate neuron was char-
acterized as its conditional intensity function (CIF), λ(t|H(t)), where H(t) denotes
the spiking history of all neurons in the ensemble up to time t. The log CIF of each
neuron was modeled as a linear combination of its covariates, i.e., H(t), with a
model order (M) of 60 ms and a bin size (W) of 3 ms (i.e. 20 spike history terms per
source neuron). The model order, i.e., the history for each neuron, was optimized
using AIC (Akaike’s information criterion). Then, to determine the influence of a
source neuron on the candidate neuron, the log-likelihood ratio between models (i)
including and (ii) excluding the history of the source neuron was computed. If the
model performance decreased significantly (p < 0.05, χ2-test, False Detection Rate
corrected for multiple comparison) when the source neuron was excluded from the
model, we inferred that the source neuron was effectively connected to the can-
didate neuron. Finally, the sign of the sum of corresponding spike history coeffi-
cients was used to determine whether the directed connection was excitatory or
inhibitory. We assessed the consistency of polarity of the history terms by com-
puting the ratio between the number of history terms with dominant polarity and
the number of terms with non-dominant polarity for each neuron within a session.
Supplementary Fig. 13 shows the distribution of this ratio for each individual
session. The modes of these distributions are approximately at a ratio of 2 indi-
cating that a large portion of connections emanating from a neuron have twice as
many history terms of one particular sign. The implementation steps for causality
estimation are provided in Table 1.
Data availability. The data that support the findings of this study are available
from the corresponding authors upon reasonable request.
Received: 1 February 2017 Accepted: 24 October 2017
References
1. Taylor, D. M., Tillery, S. I. H. & Schwartz, A. B. Direct cortical control of 3D
neuroprosthetic devices. Science 296, 1829–1832 (2002).
2. Musallam, S., Corneil, B., Greger, B., Scherberger, H. & Andersen, R. Cognitive
control signals for neural prosthetics. Science 305, 258–262 (2004).
3. Carmena, J. M. et al. Learning to control a brain–machine interface for reaching
and grasping by primates. PLoS Biol. 1, e42 (2003).
4. Ganguly, K., Dimitrov, D. F., Wallis, J. D. & Carmena, J. M. Reversible large-
scale modification of cortical networks during neuroprosthetic control. Nat.
Neurosci. 14, 662–667 (2011).
5. Churchland, M. M. et al. Neural population dynamics during reaching. Nature
487, 51–56 (2012).
6. Orsborn, A. L. & Carmena, J. M. Creating new functional circuits for action via
brain- machine interfaces. Front. Comput. Neurosci. 7 157 (2013).
7. Orsborn, A. L. et al. Closed-loop decoder adaptation shapes neural plasticity for
skillful neuroprosthetic control. Neuron 82, 1380–1393 (2014).
8. Zacksenhouse, M. et al. Cortical modulations increase in early sessions with
brain-machine interface. PLoS ONE 2, e619 (2007).
9. Engelhard, B., Ozeri, N., Israel, Z., Bergman, H. & Vaadia, E. Inducing gamma
oscillations and precise spike synchrony by operant conditioning via brain-
machine interface. Neuron 77, 361–375 (2013).
10. Flint, R. D., Scheid, M. R., Wright, Z. A., Solla, S. A. & Slutzky, M. W. Long-
term stability of motor cortical activity: implications for brain machine
interfaces and optimal feedback control. J. Neurosci. 36, 3623–3632 (2016).
11. Ethier, C., Oby, E. R., Bauman, M. & Miller, L. E. Restoration of grasp following
paralysis through brain-controlled stimulation of muscles. Nature 485, 368–371
(2012).
12. Capogrosso, M. et al. A brain–spine interface alleviating gait deficits after spinal
cord injury in primates. Nature 539, 284–288 (2016).
13. Sanes, J. N., Suner, S., Lando, J. F. & Donoghue, J. P. Rapid reorganization of
adult rat motor cortex somatic representation patterns after motor nerve injury.
Proc. Natl Acad. Sci. USA 85, 2003–2007 (1988).
14. Jacobs, K. M. & Donoghue, J. P. Reshaping the cortical motor map by
unmasking latent intracortical connections. Science 251, 944–947 (1991).
15. Wu, C. W.-H. & Kaas, J. H. Reorganization in primary motor cortex of
primates with long-standing therapeutic amputations. J. Neurosci. 19,
7679–7697 (1999).
16. Qi, H.-X., Stepniewska, I. & Kaas, J. H. Reorganization of primary motor cortex
in adult macaque monkeys with long-standing amputations. J. Neurophysiol.
84, 2133–2147 (2000).
17. Cohen, L. G., Bandinelli, S., Findley, T. W. & Hallett, M. Motor reorganization
after upper limb amputation in man. Brain 114, 615–627 (1991).
18. Kew, J. et al. Reorganization of cortical blood flow and transcranial magnetic
stimulation maps in human subjects after upper limb amputation. J.
Neurophysiol. 72, 2517–2524 (1994).
19. Pascual-Leone, A., Peris, M., Tormos, J., Pascual, A. P.-L. & Catala, M.
Reorganization of human cortical motor output maps following traumatic
forearm amputation. Neuroreport 7, 2068–2070 (1996).
20. Giraux, P., Sirigu, A., Schneider, F. & Dubernard, J.-M. Cortical reorganization
in motor cortex after graft of both hands. Nat. Neurosci. 4, 691–692 (2001).
21. Nudo, R. J., Plautz, E. J. & Frost, S. B. Role of adaptive plasticity in recovery of
function after damage to motor cortex. Muscle Nerve 24, 1000–1019 (2001).
22. Dhillon, G. S., Lawrence, S. M., Hutchinson, D. T. & Horch, K. W. Residual
function in peripheral nerve stumps of amputees: implications for neural
control of artificial limbs. J. Hand Surg. 29, 605–615 (2004).
23. Di Pino, G., Guglielmelli, E. & Rossini, P. M. Neuroplasticity in amputees: main
implications on bidirectional interfacing of cybernetic hand prostheses. Prog.
Neurobiol. 88, 114–126 (2009).
24. Agashe, H., Paek, A. & Contreras-Vidal, J. Multisession, noninvasive closed-
loop neuroprosthetic control of grasping by upper limb amputees. Prog. Brain
Res. 228, 107-128 (2016).
25. Velliste, M., Perel, S., Spalding, M. C., Whitford, A. S. & Schwartz, A. B.
Cortical control of a prosthetic arm for self-feeding. Nature 453, 1098–1101
(2008).
26. Vargas-Irwin, C. E. et al. Decoding complete reach and grasp actions from local
primary motor cortex populations. J. Neurosci. 30, 9659–9669 (2010).
27. Oweiss, K. G. & Badreldin, I. S. Neuroplasticity subserving the operation of
brain–machine interfaces. Neurobiol. Dis. 83, 161–171 (2015).
28. Ushiba, J. & Soekadar, S. Brain–machine interfaces for rehabilitation of
poststroke hemiplegia. Prog. Brain. Res. 228, 163–183 (2016).
29. Wodlinger, B. et al. Ten-dimensional anthropomorphic arm control in a
human brain- machine interface: difficulties, solutions, and limitations. J.
Neural. Eng. 12, 016011 (2014).
30. Koralek, A. C., Costa, R. M. & Carmena, J. M. Temporally precise cell-specific
coherence develops in corticostriatal networks during learning. Neuron 79,
865–872 (2013).
31. Koralek, A. C., Jin, X., Long, J. D. II, Costa, R. M. & Carmena, J. M.
Corticostriatal plasticity is necessary for learning intentional neuroprosthetic
skills. Nature 483, 331–335 (2012).
32. Cisek, P., Crammond, D. J. & Kalaska, J. F. Neural activity in primary motor
and dorsal premotor cortex in reaching tasks with the contralateral versus
ipsilateral arm. J. Neurophysiol. 89, 922–942 (2003).
33. Ganguly, K. & Carmena, J. M. Emergence of a stable cortical map for
neuroprosthetic control. PLoS Biol. 7, e1000153 (2009).
34. Wisneski, K. J. et al. Unique cortical physiology associated with ipsilateral hand
movements and neuroprosthetic implications. Stroke 39, 3351–3359 (2008).
35. Bundy, D. T. et al. Using ipsilateral motor signals in the unaffected cerebral
hemisphere as a signal platform for brain–computer interfaces in hemiplegic
stroke survivors. J. Neural. Eng. 9, 036011 (2012).
36. Milovanovic, I., Robinson, R., Fetz, E. E. & Moritz, C. T. Simultaneous and
independent control of a brain-computer interface and contralateral limb
movement. Brain Comput. Interfaces 2, 174–185 (2015).
37. Darian-Smith, I. et al. in The Anatomy of Manual Dexterity 17–63 (Springer,
1996).
38. Armand, J., Olivier, E., Edgley, S. & Lemon, R. Postnatal development of
corticospinal projections from motor cortex to the cervical enlargement in the
macaque monkey. J. Neurosci. 17, 251–266 (1997).
39. Gulati, T. et al. Robust neuroprosthetic control from the stroke perilesional
cortex. J. Neurosci. 35, 8653–8661 (2015).
40. Hochberg, L. R. et al. Neuronal ensemble control of prosthetic devices by a
human with tetraplegia. Nature 442, 164–171 (2006).
41. Hochberg, L. R. et al. Reach and grasp by people with tetraplegia using a
neurally controlled robotic arm. Nature 485, 372–375 (2012).
42. Platt, R. Jr, Fagg, A. H. & Grupen, R. A. Null-space grasp control: theory and
experiments. IEEE Trans. Robot. 26, 282–295 (2010).
43. Flash, T. & Hogan, N. The coordination of arm movements: an experimentally
confirmed mathematical model. J. Neurosci. 5, 1688–1703 (1985).
NATURE COMMUNICATIONS | DOI: 10.1038/s41467-017-01909-2
ARTICLE
NATURE COMMUNICATIONS| 8:  1796 
| DOI: 10.1038/s41467-017-01909-2| www.nature.com/naturecommunications
9
 44. Shadmehr, R. & Wise, S. P. The computational neurobiology of reaching and
pointing: a foundation for motor learning (MIT press, Cambridge, MA, 02142,
USA, 2005).
45. Tkach, D., Reimer, J. & Hatsopoulos, N. G. Congruent activity during action
and action observation in motor cortex. J. Neurosci. 27, 13241–13250 (2007).
46. Tkach, D., Reimer, J. & Hatsopoulos, N. G. Observation-based learning for
brain–machine interfaces. Curr. Opin. Neurobiol. 18, 589–594 (2008).
47. Badreldin, I. et al. Unsupervised decoder initialization for brain-machine
interfaces using neural state space dynamics. In 6th International IEEE/EMBS
Conference on Neural Engineering (NER) 997–1000 (2013)
48. Dickey, A. S., Suminski, A., Amit, Y. & Hatsopoulos, N. G. Single-unit stability
using chronically implanted multielectrode arrays. J. Neurophysiol. 102,
1331–1339 (2009).
49. Eldawlatly, S., Jin, R. & Oweiss, K. G. Identifying functional connectivity in
large-scale neural ensemble recordings: a multiscale data mining approach.
Neural. Comput. 21, 450–477 (2009).
50. Eleryan, A. et al. Tracking single units in chronic, large scale, neural recordings
for brain machine interface applications. Front. Neuroeng. 7, 23 (2015).
51. Kim, S., Putrino, D., Ghosh, S. & Brown, E. N. A Granger causality measure for
point process models of ensemble neural spiking activity. PLoS Comput. Biol. 7,
e1001110 (2011).
52. Takahashi, K. et al. Large-scale spatiotemporal spike patterning consistent with
wave propagation in motor cortex. Nat. Commun. 6, 7169 (2015).
Acknowledgements
This work was supported by the Defense Advanced Research Projects Agency (DARPA)
grant N66 001-12-1-4023 (K.B., M.V., J.S., I.B., A.E., M.S., A.H.F., K.O., and N.G.H),
National Institute of Neurological Disorders and Stroke (NINDS) grant R01 NS 045853
(K.B., and N.G.H.), National Institute of Dental and Craniofacial Research (NIDCR)
grant R01 DE023816 (K.T., and N.G.H.), National Institutes of Health (NIH) grants NS
062031 (K.O., I.B., and A.E.) and NS 93909 (K.O.), and National Science Foundation
(NSF) grant 1504954 (K.O.). This work used the Beagle supercomputer resources pro-
vided by the Computation Institute and the Biological Sciences Division of the University
of Chicago and Argonne National Laboratory, and the Midway cluster at the Research
Computing Center of the University of Chicago.
Author contributions
A.H.F., N.G.H., and K.O. directed the study. K.B., A.H.F., N.G.H., M.S., K.O., and M.V.
contributed to the study design. N.G.H., K.B., and M.V. performed the array implan-
tations. KB and MV were responsible for the data collection. I.B., K.O., and A.H.F.
contributed to the development of the unsupervised decoder algorithm. K.O. and A.E.
contributed to the neural clustering algorithm. A.H.F. and J.S. were responsible for the
design of control algorithms. J.S. and A.H.F. were responsible for the Robot Operating
System-based implementations. A.H.F., J.S., and K.B. contributed to the implementation
of neural decoders used in the experiment. K.B., M.V., and K.Q. contributed to the
behavioral training of the animals and robot operations. K.B. and K.T. were responsible
for the functional connectivity analyses. K.O., M.S., and K.B. contributed to other aspects
of neural data analysis. K.B. and N.G.H. were responsible for the manuscript write-up.
K.B., A.H.F., N.G.H., K.T., and M.S. contributed to reviewing and editing the manuscript.
Additional information
Supplementary Information accompanies this paper at doi:10.1038/s41467-017-01909-2.
Competing interests: N.G.H. serves as a consultant for BlackRock Microsystems, Inc., the
company that sells the multi-electrode arrays and acquisition system used in this study.
The remaining authors declare no competing financial interests.
Reprints and permission information is available online at http://npg.nature.com/
reprintsandpermissions/
Publisher's note: Springer Nature remains neutral with regard to jurisdictional claims in
published maps and institutional affiliations.
Open Access This article is licensed under a Creative Commons
Attribution 4.0 International License, which permits use, sharing,
adaptation, distribution and reproduction in any medium or format, as long as you give
appropriate credit to the original author(s) and the source, provide a link to the Creative
Commons license, and indicate if changes were made. The images or other third party
material in this article are included in the article’s Creative Commons license, unless
indicated otherwise in a credit line to the material. If material is not included in the
article’s Creative Commons license and your intended use is not permitted by statutory
regulation or exceeds the permitted use, you will need to obtain permission directly from
the copyright holder. To view a copy of this license, visit http://creativecommons.org/
licenses/by/4.0/.
© The Author(s) 2017
ARTICLE
NATURE COMMUNICATIONS | DOI: 10.1038/s41467-017-01909-2
10
NATURE COMMUNICATIONS| 8:  1796 
| DOI: 10.1038/s41467-017-01909-2| www.nature.com/naturecommunications
