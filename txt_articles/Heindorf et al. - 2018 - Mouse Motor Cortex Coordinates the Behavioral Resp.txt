 Article
Mouse Motor Cortex Coordinates the Behavioral
Response to Unpredicted Sensory Feedback
Highlights
d Motor cortex (M1) is necessary for the motor response to an
unexpected perturbation
d M1 is not necessary when the same movement is carried out
spontaneously
d Layer 2/3 neurons are differentially activated by unexpected
visual perturbations
d Activity in layer 5 PT neurons correlates with behavioral
responses
Authors
Matthias Heindorf, Silvia Arber,
Georg B. Keller
Correspondence
silvia.arber@unibas.ch (S.A.),
georg.keller@fmi.ch (G.B.K.)
In Brief
The role of motor cortex in movement
control is controversial. Heindorf et al.
demonstrate that motor cortex mediates
corrective behavioral responses to
unexpected visual perturbations,
paralleled by layer-specific cortical
responses distinct from the ones during
the same movement without
perturbation.
Heindorf et al., 2018, Neuron 99, 1040–1054
September 5, 2018 ª 2018 The Author(s). Published by Elsevier Inc.
https://doi.org/10.1016/j.neuron.2018.07.046
 Neuron
Article
Mouse Motor Cortex Coordinates
the Behavioral Response
to Unpredicted Sensory Feedback
Matthias Heindorf,1,2 Silvia Arber,1,2,4,* and Georg B. Keller1,3,4,5,*
1Friedrich Miescher Institute for Biomedical Research, 4058 Basel, Switzerland
2Biozentrum, Department of Cell Biology, University of Basel, 4056 Basel, Switzerland
3Faculty of Natural Sciences, University of Basel, 4056 Basel, Switzerland
4These authors contributed equally
5Lead Contact
*Correspondence: silvia.arber@unibas.ch (S.A.), georg.keller@fmi.ch (G.B.K.)
https://doi.org/10.1016/j.neuron.2018.07.046
SUMMARY
Motor cortex (M1) lesions result in motor impair-
ments, yet how M1 contributes to the control of
movement remains controversial. To investigate the
role of M1 in sensory guided motor coordination,
we trained mice to navigate a virtual corridor using
a spherical treadmill. This task required directional
adjustments through spontaneous turning, while un-
expected
visual
offset
perturbations
prompted
induced turning. We found that M1 is essential for
execution and learning of this visually guided task.
Turn-selective layer 2/3 and layer 5 pyramidal tract
(PT) neuron activation was shaped differentially
with learning but scaled linearly with turn accelera-
tion during spontaneous turns. During induced turns,
however, layer 2/3 neurons were activated indepen-
dent of behavioral response, while PT neurons still
encoded behavioral response magnitude. Our re-
sults are consistent with a role of M1 in the detection
of sensory perturbations that result in deviations
from intended motor state and the initiation of an
appropriate corrective response.
INTRODUCTION
In mammals, movement is controlled by circuits spanning
throughout the central nervous system from the cortex to the spi-
nal cord, where motor neurons orchestrate the contraction of the
many different body muscles. While the activity of neurons closer
to motor output correlates well with muscle contraction, the rela-
tionship between activity and movement is less clear in higher
level motor circuits. In motor cortex, neuronal activity correlates
with a diverse range of parameters including speed of movement
(Beloozerova and Sirota, 1993a), direction (Georgopoulos et al.,
1986), muscle activity (Armstrong and Drew, 1984), movement
error signals (Inoue et al., 2016), or was proposed to follow a
dynamic attractor (Churchland et al., 2012). Different lines of
research provide evidence that motor cortex impacts on motor
output. Perhaps most strikingly, stimulation of motor cortex,
either electrically or optogenetically, results in muscle contrac-
tions (Brecht et al., 2004; Ferrier, 1874; Harrison et al., 2012;
Miri et al., 2017; Tennant et al., 2011). These effects could be
mediated by direct projections from motor cortex to the spinal
cord. Layer 2/3 motor cortex neurons are recurrently connected
and provide intracolumnar excitatory drive to layer 5 pyramidal
tract (PT) neurons (Weiler et al., 2008). Layer 5 PT neurons proj-
ect ipsilaterally to other regions involved in motor control such as
striatum and the basal pontine nucleus (Jankowska and Edgley,
2006; Kita and Kita, 2012). Given that feedback connectivity from
layer 5 PT neurons to more superficial neurons is sparse (Kiritani
et al., 2012; Morishima and Kawaguchi, 2006), this suggests that
layer 2/3 neurons function to integrate cortical input (Huber et al.,
2012) and coordinate the activation of layer 5 PT neurons, which
in turn influence behavioral output circuits.
Interpretations on a prominent role of motor cortex in move-
ment control and motor learning, however, are complicated by
the fact that motor cortex lesions result in different behavioral
phenotypes across species. In non-human primates and hu-
mans in particular, motor cortex lesions abolish most capacity
for movement that recovers with training in non-human primates
(Lang and Schieber, 2003; Murata et al., 2008; Zaaimi et al.,
2012). Similar lesions in rodents, however, result in no overt
movement impairment (Kawai et al., 2015). Hence, although mo-
tor cortex is directly connected to many subcortical circuit
components, it remains unclear under which circumstances
and/or for what types of movements cortical control is exerted
on these circuits. Reliance on motor cortex might be stronger
for dexterous movements that require precise feedback control.
Movement control could thus rely on motor cortex during condi-
tions in which processing of sensory information also relies on
cortex. Mouse visual cortex, for example, is thought to not only
process visual information, but also act as a detector of visual
feedback that deviates from the visual feedback based on motor
output (Attinger et al., 2017; Fiser et al., 2016; Zmarz and Keller,
2016). Consistent with the hypothesis that motor cortex might be
involved in the processing of deviations of expected from actual
sensory input, selective responses triggered by unexpected
feedback perturbations during locomotion are present in cat
1040
Neuron 99, 1040–1054, September 5, 2018 ª 2018 The Author(s). Published by Elsevier Inc.
This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).
 motor cortex (Marple-Horvat et al., 1993), and in rodents it has
been shown that motor cortex is necessary for the rapid initiation
of a behavioral response to an unexpected feedback perturba-
tion (Lopes et al., 2016). Moreover, exposing animals to
increased demands for movement accuracy results in increased
activity in motor cortex, which could be the consequence of
increased precision in sensory feedback guided control of move-
ment (Beloozerova et al., 2010; Beloozerova and Sirota, 1993b;
Farrell et al., 2015). It is thus conceivable that motor cortex is
particularly relevant for generating an appropriate behavioral
response to deviations from expected sensory information.
To investigate the role of motor cortex in sensory guided coor-
dination of movement, we trained mice to navigate to a target at
the end of a virtual corridor in the presence of unexpected shifts
in the direction of the corridor. We show that motor cortex inhi-
bition interferes with both task learning and execution. By
recording calcium signals in layer 2/3 and layer 5 PT neurons,
we found that activity in both populations changed in a
learning-dependent manner and correlated with the amplitude
of individual turns mice make while navigating. In response to
an unexpected shift of the corridor, mice executed corrective
turns. Surprisingly, we found that under these conditions,
neuronal activation in layer 2/3 did not depend on the subse-
quent behavioral response. This is consistent with the idea that
during consolidation of a motor skill, layer 2/3 integrates signals
from other cortical areas while layer 5 becomes successively
more involved in the control of movement with learning.
RESULTS
Involvement of Motor Cortex in the Feedback Guided
Control of a Spherical Treadmill
To investigate how motor cortex is involved in visually guided
motor control, we trained mice to navigate to a target at the
end of a corridor by controlling turning and forward movement
for a water reward in a virtual reality environment while head-
fixed on an air-supported spherical treadmill (see STAR
Methods, Figure 1A, and Video S1). Task performance was
quantified as the fraction of time mice spent running in the target
direction (within an angle of ±36�, chance performance is 20%)
normalized by the total time spent running. We made the task
more difficult with increasing performance of the mice by pro-
gressively lengthening the virtual tunnel throughout training to
keep the number of rewards per training session approximately
constant (Figure 1B). Mice typically performed above chance
level already in the first session and on average reached plateau
performance by session 6 (5.3 ± 1.5 sessions, mean ± standard
deviation, n = 22 mice) (Figure 1C).
We first determined whether the anterior part of primary motor
cortex that contains the caudal forelimb area (CFA) (Harrison
A
B
C
D
Figure 1. Performance in a Visually Guided Vir-
tual Reality Navigation Task Is Motor Cortex
Dependent
(A) Mice were trained to control movement in a virtual
environment through locomotion on the spherical
treadmill. Upon reaching the target at the end of the
corridor, mice received a water reward. A blue laser
was directed at left and right motor cortex in rapid
alternation for optogenetic inhibition of neuronal ac-
tivity via excitation of vGAT+ interneurons.
(B) Top: schematic of the tunnel with three example
traversals at the beginning of training (day 1, tunnel is
not drawn to scale, length-to-width ratio: 5:1). Bot-
tom: schematic of the tunnel with three example tra-
versals from an expert mouse (day 8). With increasing
performance of the mice, we increased the length of
the tunnel to increase the difficulty of the task (length-
to-width ratio: 30:1).
(C) Average performance as a function of training days
(fraction of time spent running in the direction of the
target, see STAR Methods) in mice with (blue, n = 12
mice) and without (black, n = 22 mice) motor cortex
inhibition. Here, data from all three groups of mice
with different inhibition laser power levels (1 mW, 2
mW, and 10 mW) are pooled (see also Figure S1E).
Error bars indicate SEM over mice. Dashed black line
marks chance performance. *p < 0.05, **p < 0.01,
***p < 10�3; Wilcoxon rank sum test. Mice trained with
photoinhibition did not significantly improve perfor-
mance as opposed to the control group (day 1 versus
day 8; with photoinhibition: p = 0.17, n = 12 mice;
without photoinhibition: p < 10�6, n = 22 mice; Wil-
coxon rank sum test).
(D) Photoinhibition decreased performance in expert
mice (n = 15 mice). *p < 0.05; Wilcoxon rank sum test.
Error bars indicate SEM over mice. Dashed black line
marks chance performance.
Neuron 99, 1040–1054, September 5, 2018
1041
 et al., 2012; Tennant et al., 2011) implicated in the control of fore-
limbs is involved in execution. We did this by bilateral optoge-
netic inhibition either throughout training or once mice reached
plateau performance. We implanted cranial windows over left
and right motor cortices in transgenic mice that express chan-
nelrhodopsin-2
in
inhibitory
neurons
(vGAT::ChR2(H134R)-
EYFP), a strategy previously used successfully to inhibit neuronal
activity in cortex (Guo et al., 2014). The laser spot had a diameter
of 0.8 mm (full width at half maximum) at the surface of cortex
and was moved bilaterally to either one (1.5 mm lateral and
0.5 mm anterior of bregma) or two locations (1.5 mm lateral,
and 0.5 mm and 1.5 mm anterior of bregma) during the scan (Fig-
ure S1A). Mice were trained either with motor cortex inhibited
throughout the first eight training sessions at three different
levels of inhibition (1 mW, 2 mW, and 10 mW laser power;
n = 12 mice; see STAR Methods) or under non-inhibited condi-
tions (n = 22 mice). In absence of motor cortex inhibition, mice
increased task performance significantly over the course of the
first eight training sessions. In contrast, mice that received motor
cortex inhibition during training showed impaired learning (Fig-
ures 1C, S1B, and S1C). The amount of impairment depended
on the level of inhibition (laser power) and the extent of the
cortical area inactivated (Figures S1A and S1D). The effects of
inactivation of CFA were stronger than those observed with inac-
tivation of a more anterior location in M1 (Figures S1A and S1E).
Inactivation effects were likely not simply a consequence of the
transient nature of optogenetic inhibition, as a similar impairment
in task learning was observed in a different group of mice (n = 5
mice) that received small bilateral ibotenic acid lesions targeted
to CFA prior to training (Figures S1D and S1F). These data
demonstrate that motor cortex and in particular CFA activity is
necessary for learning of the task. We then continued training
two groups of mice (3 mice previously trained with chronic motor
cortex inhibition and 3 mice without motor cortex inhibition) for
another six training sessions without motor cortex inhibition. Per-
formance of mice that had received chronic inhibition of motor
cortex in the initial eight training sessions increased to a perfor-
mance level matching that of normally trained mice, at a learning
rate not different from initial learning in mice without motor cortex
inhibition (Figure S1G). Subsequent inhibition of motor cortex in
expert mice resulted in a significant decrease in performance
(Figure 1D). To ensure that laser stimulation alone did not inter-
fere with performance, we trained four mice that did not express
channelrhodopsin-2 with laser stimulation of motor cortex and
found no impairment in learning (Figure S1H). Taken together,
these results demonstrate that motor cortex is necessary for
both learning and execution of a virtual navigation task that re-
quires visually guided control of a spherical treadmill.
To perform this virtual navigation task, mice learn to control left
and right corrective turns to steer toward a target while running
on the spherical treadmill using visual feedback. Peak velocity
and acceleration of these spontaneous turns increased over
the course of training (Figures 2A and 2B; day 1 versus day 8,
speed: p < 10�4, acceleration: p < 10�5, n = 22 mice; Wilcoxon
rank sum test). We selected turns based on a threshold on the
rotational velocity of the treadmill. To include only well isolated
turns, we discarded turns that were preceded by another turn
in the same direction within less than 5 s (see STAR Methods).
To test whether motor cortex inhibition interferes with the ability
to execute turns, we compared turning behavior with and without
motor cortex inhibition. We found no evidence for an effect of
motor cortex inhibition on the amplitude of spontaneous turns
in expert mice during performance testing days (Figures 2C
and 2D). We next tested whether the frequency with which
mice executed turns was influenced by motor cortex inhibition.
We found that inhibition of motor cortex only led to a modest
reduction in the frequency of spontaneous turns (number of turns
per second of time spent running without optogenetic inhibition
was: 0.12 ± 0.009, mean ± SEM; and with optogenetic inhibition:
0.10 ± 0.014, mean ± SEM; n = 15 mice; p = 0.07; Wilcoxon rank
sum test, see STAR Methods), and at the same time resulted in a
small increase in locomotion speed (11.4 cm/s ± 3.5 cm/s
[mean ± SD, n = 12 mice] with inhibition, versus 7.8 cm/s ±
2.6 cm/s [mean ± SD, n = 12 mice] without inhibition; p = 0.02;
Wilcoxon rank sum test). Thus, motor cortex inhibition did not
reduce the overall vigor of movement or impair the mouse’s abil-
ity to execute spontaneous turns.
Given that motor cortex inhibition did not affect the general
ability to run and turn on the ball, but nevertheless significantly
reduced task performance, we argued that motor cortex might
be necessary for the coordination of visually guided movements.
Mice continuously detect deviations from intended heading and
correct for these deviations by executing turns. Spontaneous
turns can be executed either under visual guidance, and thus
correct for course deviations, or independent of visual guidance.
To obtain better experimental control of when mice initiate visu-
ally guided turns, we introduced sudden and unexpected visual
offsets (Video S2). Mice are then required to respond to an imme-
diate and unexpected perturbation in their visual field in order to
correct for a course deviation. We first tested whether mice
respond to these visual offset perturbations, and whether these
induced turns require motor cortex.
Unexpected visual offset perturbations were implemented by
suddenly shifting the heading of the mouse in the virtual corridor
by 30� either to the left or right at a random time during corridor
traversal (see STAR Methods). To prevent any potential interfer-
ence with initial task learning, we did not introduce perturbations
in the first two days. We found that mice typically responded to
perturbations with a rapid corrective turn (Figure 2E). Fully
trained mice responded with a corrective response within 1 s
of the offset in 74% ± 4% (mean ± SEM, n = 14 mice) of trials.
The latency of the first detectable turning response following
the visual offset perturbation was 301 ms ± 45 ms (mean ±
SEM, n = 19 mice). As with spontaneous turns, the speed and ac-
celeration of these induced turns increased over the course of
training (Figure 2F, p < 0.002; n = 22 mice; Wilcoxon rank sum
test). Hence, mice rapidly detect and correct for visual offset
perturbations.
To probe for the involvement of motor cortex in these rapid
corrections in response to unexpected visual perturbations, we
quantified the effect of motor cortex inhibition on induced turns.
In mice with chronic motor cortex inhibition during training, re-
sponses to visual offset perturbations were strongly reduced
(fraction of trials with a corrective response: 28% ± 2%,
mean ± SEM, n = 12 mice; Figures S2A and S2B). We then tested
the effect of brief (3 s) inhibition of motor cortex concurrent with
1042
Neuron 99, 1040–1054, September 5, 2018
 visual offset perturbations in trained mice (n = 14 mice that all
had at least eight training sessions preceding the test session).
With motor cortex inhibition concurrent with visual offset pertur-
bations, mice were less likely to execute a corrective turn within
1 s of the visual offset (45% ± 5%, mean ± SEM, Figures 2G and
2H). This effect was less pronounced when inactivating the more
anterior region of M1 only (Figures S2C and S2D). In trials in
which the inhibition of motor cortex prevented a corrective turn
within 1 s of the visual offset, mice typically executed a corrective
turn immediately after cessation of motor cortex inhibition. The
fraction of trials without a corrective turn depended on the timing
of the onset of the motor cortex inhibition relative to the pertur-
bation. When the onset of motor cortex inhibition preceded the
visual offset perturbation by 1 s or occurred concurrently, the
fraction of trials without corrective response was significantly
larger than when inhibition onset followed the perturbation onset
by 1 s (Figures S2E and S2F). This analysis was confounded by
the fact that mice transiently reduced forward locomotion speed
concurrent with the onset of motor cortex inhibition. However,
mice reduced locomotor speed both in trials with and without
delayed turning response (Figure S2G), indicating that the de-
layed turning response cannot be explained by the reduction in
E
F
G
H
A
B
C
D
Figure 2. Motor Cortex Inhibition Delays Visually Guided Corrective Turns
(A) Mice spontaneously turn left and right as they learn to traverse the virtual corridor. The amplitude of spontaneous turns increased over the course of training
(days 1 to 8) for both left (blue) and right (red) turns. Shading indicates SEM over turns. Turns per day, left: 184 ± 27; right: 186 ± 28 (mean ± SD, n = 22 mice).
(B) Average acceleration during spontaneous turns increased with training (p < 10�8, R2 = 0.19, n = 22 mice; linear trend analysis; see STAR Methods). Error bars
indicate SEM over mice (n = 22 mice).
(C) Speed profiles of the spontaneous turns without inhibition of motor cortex (left panel, n = 14 mice) and the spontaneous turns initiated during inhibition of motor
cortex (right panel, n = 14 mice, data from the same mice as in left panel), executed on performance testing days in expert mice, sorted by maximum speed. Motor
cortex inhibition did not prevent mice from executing spontaneous turns. Color indicates turning speed.
(D) Average speed profile of turns without (black) and with (blue) bilateral inhibition of motor cortex. Same data as shown in (C). Shading indicates SEM over mice
(n = 14 mice). Note that turning speed with or without motor cortex inhibition was not different in a window 3 s after turn onset (marked by dashed lines). n.s., not
significant; Wilcoxon rank sum test.
(E) Average speed profiles during corrective turns to the left (blue) and right (red) induced by visual offset perturbations over the course of training (days 3 to 8, the
first 2 days did not have visual offset perturbations, left turns: n = 632, 666, 688, 803, 776, 884; right turns: 675, 687, 725, 806, 749, 907 in 22 mice, respectively).
Shading indicates SEM over turns. Turns per day, left: 34 ± 4; right: 34 ± 4 (mean ± SD).
(F) Acceleration during corrective turns induced by visual offset perturbations increased over the course of training (p < 10�5, R2 = 0.15, n = 22 mice; linear trend
analysis; see STAR Methods). Error bars indicate SEM over mice (n = 22 mice).
(G) Speed profile of 321 visual offset perturbation-induced corrective turns in expert mice that had reached plateau performance without (left panel, n = 14 mice,
data from same mice as in C) and with (right panel, 353 trials, n = 14 mice, data from the same mice as in left panel) inhibition of motor cortex concurrent with visual
offset perturbation for 3 s (blue bar). Turns are sorted by latency to peak velocity. In a subset of trials (55% ± 5%, mean ± SEM, see STAR Methods), mice delayed
their corrective turn response until after motor cortex inhibition ceased. Color indicates turning speed.
(H) Average speed profile of visual offset perturbation-induced corrective turns without (black) and with (blue) bilateral inhibition of motor cortex for 3 s starting
concurrently with the visual offset perturbation (time 0). Same data as shown in (G). Shading indicates SEM over mice (n = 14 mice). Turning speed was lower with
motor cortex inhibition (0 s – 3 s after perturbation onset). **p < 0.01; Wilcoxon rank sum test.
Neuron 99, 1040–1054, September 5, 2018
1043
 locomotion speed. Finally, we ensured that the inhibition of the
turning response was mediated by activation of channelrhodop-
sin-2 in cortical interneurons and not a consequence of the laser
stimulation itself. In mice that did not express channelrhodopsin-
2, laser stimulation had no effect on the probability of a corrective
turn (Figures S2H and S2I).
In summary, we found that motor cortical activity is necessary
for visually guided turn execution, but not for the execution of a
turn per se. Chronic motor cortex inhibition prevented responses
to visual offset perturbations almost completely, and brief inhibi-
tion coincident with the visual offset perturbation significantly
reduced the probability of mice executing a corrective turn.
These results are consistent with the interpretation that motor
cortex activity is necessary for the execution of a corrective
movement in response to perturbation.
Activity in Motor Cortex Scaled Linearly with the
Amplitude of Spontaneous Turns
To further investigate the role of motor cortex in task performance,
we next recorded neuronal activity in CFA motor cortex (Fig-
ure S1A) chronically throughout training in either layer 2/3 or layer
5 PT neurons using two-photon calcium imaging of GCaMP6f
(Chen et al., 2013) (Figure S3). We identified layer 2/3 neurons by
recording depth and using an AAV2/1-EF1a-GCaMP6f virus
(1,154 neurons in 8 mice). For recordings of layer 5 PT neurons,
we used a genetic and viral intersectional strategy with an AAV2/
1-EF1a-DIO-GCaMP6f in Sim1(KJ18)-Cre mice (Gerfen et al.,
2013) (560 neurons in 11 mice). Layer 5 PT neurons are thought
to have the most direct impact on movement control (Kita and
Kita, 2012; Li et al., 2015). The transfer function from neuronal ac-
tivitytocalciumsignalinthesegeneticallyencodedcalciumindica-
tors is non-linear, but monotonic. As a consequence, single spikes
may not always be detectable and our activity measures are
biasedtowardburstsofneuralactivity.Moreover,thefluorescence
change in response to an action potential across cell types, which
may have different calcium buffering kinetics, may not be directly
comparable. For this reason, we do not compare the magnitude
of the calcium responses across cell types but instead compared
how responses within one cell type change with time or as a func-
tion of behavioral variables.
We first analyzed neuronal responses during spontaneous
turns (Figures 3A and 3B). We found that a substantial fraction
of neurons had significant responses during spontaneous turns
(mean ± SD, 49% ± 19% in 8 mice in layer 2/3, 39% ± 16% in
11 mice in layer 5 PT). We then split turns into contra- and ipsi-
versive depending on whether the turn was in the opposite or
same direction as the hemisphere from which we recorded
neuronal activity. We classified neurons as either more respon-
sive during contraversive or ipsiversive turns (Table S1). To
determine the population responses to turns, we first averaged
the response of contraversive neurons to contraversive turns
and the response of ipsiversive neurons to ipsiversive turns
and averaged these two responses to a population response
(see STAR Methods). To quantify neuronal response strength
as a function of turn amplitude, we split turns into bins with
different acceleration magnitudes and quantified neuronal re-
sponses of layer 2/3 neurons and layer 5 PT neurons as a func-
tion of turn acceleration. We found that activity in both layer 2/3
and layer 5 PT neurons scaled linearly with turn acceleration (Fig-
ures 3C–3J; layer 2/3: p < 10�10, R2 = 0.08, n = 1,154 neurons;
layer 5 PT: p < 10�10, R2 = 0.04, n = 560 neurons; linear trend
analysis, see STAR Methods). This scaling of neuronal response
with increasing turn acceleration was present both early and late
in training (Figures S4A and S4B). To test whether such a linear
relationship between neuronal activity and acceleration of move-
ment would exist for any movement, we analyzed responses
during running onsets and split them by acceleration of running
onset. We found no evidence of a linear relationship between
neuronal activity and acceleration magnitude at running onset
for either layer 2/3 or layer 5 PT neurons (Figures S4C–S4H). In
summary, neuronal activity in mouse motor cortex increased lin-
early with turn acceleration. In contrast, although running onset
resulted in a detectable increase in neuronal activity, this
response did not linearly increase with acceleration.
With Learning, Neuronal Activity Decreased in Layer 2/3
and Increased in Layer 5 PT Neurons
Motor learning has been shown to alter neuronal activity in mo-
tor cortex in a variety of paradigms (Huber et al., 2012; Masa-
mizu et al., 2014; Peters et al., 2017). To determine how
turning-related responses change with learning, we compared
spontaneous turning responses of the same neurons early
(days 1 to 4) and late (days 5 to 8) during training, regardless
of the neurons’ preferred turning direction. We found that re-
sponses in layer 2/3 early in training were larger during contra-
versive turns than during ipsiversive turns. Late in training, the
response during contraversive turns had decreased and was
no longer
different
from the response
during ipsiversive
turns (Figures 4A and 4B; early versus late, contraversive:
p < 10�4; contraversive versus ipsiversive, early: p = 0.02,
late: p = 0.52; n = 1154 neurons; paired Student’s t test). In
contrast, activity in layer 5 PT neurons increased selectively
during contraversive turns, while, similar to the activity in layer
2/3 neurons, response amplitude during ipsiversive turns re-
mained unchanged with training (Figures 4D and 4E; early
versus late, contraversive: p < 0.002, ipsiversive: p = 0.89;
n = 560 neurons; paired Student’s t test). The bias of response
strength of layer 5 PT neurons to contraversive turns was
already present during the early phase but increased further
with training (Figure 4E; contraversive versus ipsiversive, early:
p < 10�4, late: p < 10�5; n = 560 neurons; paired Student’s
t test). Consistent with the increased layer 5 PT neuron activity
over the course of training, we also found an increase in corre-
lation with turning velocity in layer 5 PT, but not in layer 2/3
neurons (Figures 4C and 4F; early versus late, layer 2/3:
p = 0.73; n = 1,154 neurons; layer 5 PT: p < 10�17; n = 560 neu-
rons; paired Student’s t test). We then quantified the stability of
neuronal responses during contra- and ipsiversive turns in layer
2/3 and layer 5 PT neurons by correlating the population
response vector during contra- and ipsiversive turns across
different days. We found that the neuronal representation was
most stable in layer 5 PT neurons during contraversive turns
with a time constant of 13.6 days, which was higher than during
ipsiversive turns and higher than both contra- and ipsiversive
response stability of layer 2/3 activity (Figure S5; layer 5 PT
contraversive: 13.6 days, layer 5 PT ipsiversive: 6.9 days, layer
1044
Neuron 99, 1040–1054, September 5, 2018
 2/3 contraversive: 3.3 days, layer 2/3 ipsiversive: 4.6 days).
Thus, activation during spontaneous turns was experience
dependent in both layer 2/3 and layer 5 PT neurons, the
changes in activity patterns with training exhibit opposing
trends in the two cell types and the response stability across
training was higher in layer 5 PT neurons.
Given that motor cortex inhibition selectively impeded the
mouse’s ability to successfully correct for visual offset perturba-
tions, we speculated that motor cortical neurons might be acti-
vated more strongly during turns directed toward the target
than during turns taken away from the target. To test for a differ-
ential activation of layer 2/3 and layer 5 PT neurons during turns
toward compared to turns away from the target, we analyzed
turn responses of both groups of neurons as a function of head-
ing direction relative to the target preceding the analyzed turn.
We found that activation of both layer 2/3 and layer 5 PT neurons
was higher during turns that were taken toward the target (Fig-
ures 5 and S6). In summary, activation of motor cortical neurons
was
stronger
when
mice
executed
target-directed
turns
compared to when they executed turns away from the target.
A
B
C
D
E
F
G
H
I
J
Figure 3. Calcium Response of Layer 2/3 and Layer 5 PT Neurons in Motor Cortex Scales Linearly with Amplitude of Spontaneous Turns
(A) Top: calcium activity of one layer 2/3 neuron that was preferentially active during contraversive turns (black line) and one layer 2/3 neuron that was prefer-
entially active during ipsiversive turns (gray line). Bottom: the mouse’s rotational acceleration. Times of positive acceleration mark contraversive turns (blue line
and shading) and negative values mark ipsiversive turns (red line and shading).
(B) Average change in fluorescence aligned on contraversive (blue) and ipsiversive (red) turns throughout training (days 1 to 8) for the two neurons shown in (A).
Shading indicates SEM over turns (number of contraversive turns: n = 1,654; ipsiversive turns: n = 1,668).
(C) To record the activity of layer 2/3 excitatory neurons, we injected AAV2/1-EF1a-GCaMP6f into vGAT-Cre x ROSA-LSL-tdTomato mice (n = 8).
(D) We split all spontaneous turns recorded throughout training (days 1 to 8) into bins of high (black line) and low (gray line) acceleration. Shading indicates SEM
over turns (number of turns for high acceleration bin: n = 6,174; low acceleration bin: n = 14,018).
(E) Larger turns were associated with higher neuronal activity. Average population activity of layer 2/3 neurons for the turns shown in (D) (n = 1,154 neurons).
Colors as in (D). Shading indicates SEM over neurons.
(F) Average population activity of layer 2/3 neurons as a function of acceleration of the spontaneous turn. Error bars indicate SEM over neurons (n = 1,154).
Dashed black line is a linear fit to the data. Shading marks bins used for the turning and activity traces in (A) and (B). ***p < 10�3, R2 = 0.08, n = 1,154 neurons; linear
trend analysis (see STAR Methods). n.s., not significant, lowest bin is not different from zero; Student’s t test.
(G) To record the activity of layer 5 PT neurons, we injected conditional AAV2/1-DIO-EF1a-GCaMP6f into Sim1(KJ18)-Cre mice (n = 11 mice).
(H) As in (D), but for the layer 5 PT experiments (number of turns for high acceleration bin: n = 5,764; low acceleration bin: n = 21,865).
(I) As in (E), but for layer 5 PT neurons (n = 560 neurons).
(J) As in (F), but for layer 5 PT neurons. ***p < 10�3, R2 = 0.04, n = 560 neurons; linear trend analysis (see STAR Methods).
Neuron 99, 1040–1054, September 5, 2018
1045
 Visual Offset Perturbations Activate Layer 2/3
Independent of Motor Response Magnitude
Given that motor cortex inhibition significantly reduced the ability
of mice to respond to visual offset perturbations, we tested
whether the responses of layer 2/3 and layer 5 PT neurons during
induced turns differed from those during spontaneous turns.
Both layer 2/3 and layer 5 PT neurons exhibited an increase of
mean activity following the visual offset perturbation. The latency
between visual offset perturbation and average neural response
was 225 ms ± 54 ms (mean ± SEM, n = 8 mice) in layer 2/3 neu-
rons and 283 ms ± 50 ms (mean ± SEM, n = 11 mice) in layer 5 PT
neurons. In addition, turn-responsive neurons whose activation
preceded the turn onset responded earlier in layer 2/3 than in
layer 5 PT (layer 2/3: 176 ms; n = 190 neurons; layer 5 PT:
221 ms; n = 34 neurons; p = 0.01; Student’s t test, see STAR
Methods). We split the different visual offset trials into six bins
by the rotational acceleration of the induced turn (Figures 6A–
6C). Surprisingly, we found that layer 2/3 neurons responded
to perturbations independent of the amplitude of the subsequent
turn (Figures 6B and 6C). We found no evidence for a difference
in response amplitude between trials on which mice executed no
course correction on average and trials during which they ex-
hibited maximal course correction in response to the visual offset
perturbation (Figure 6C; first versus last bin, p = 0.71; n = 1,154
neurons; paired Student’s t test). By contrast, the activation of
layer 5 PT neurons reflected the magnitude of the subsequent
turn. We found that in layer 5 PT neurons, there was a significant
increase of neuronal responses with higher amplitudes of the
turning
magnitude
(Figures
6D–6F;
first
versus
last
bin,
p < 10�3; n = 560 neurons; paired Student’s t test). However,
similar to layer 2/3 neurons, there was also a significant activa-
tion of layer 5 PT neurons even in the absence of a measurable
A
B
C
D
E
F
Figure 4. With Training Activity in Layer 2/3 Decreases and Increases in Layer 5 PT Neurons
(A) Top: average turn response of a layer 2/3 neuron during a contraversive turn (left) during the first 4 days of training (early, pale blue, n = 804 turns) and the last
4 days of training (late, dark blue, n = 818 turns); and the average turn responses of another neuron during ipsiversive turns (right) early (pale red, n = 819 turns) and
late (dark red, n = 873 turns) in training. Bottom: average turning speed traces corresponding to the data shown in the top panels. Shading indicates SEM
over turns.
(B) Average layer 2/3 responses during contraversive (blue) and ipsiversive (red) turns early (days 1 to 4) and late (days 5 to 8) in training. Responses during
contraversive turns decrease with training. Error bars indicate SEM over neurons (n = 1,154 neurons). *p < 0.05, ***p < 10�3, n.s., not significant; paired Student’s
t test.
(C) Average absolute Pearson’s correlation coefficient of layer 2/3 activity and turning velocity early (days 1 to 4) and late (days 5 to 8) in training. n.s., not
significant; paired Student’s t test.
(D) As in (A), but for two layer 5 PT neurons (number of early contraversive turns: n = 592; late contraversive turns: n = 898; early ipsiversive turns: n = 590 turns; late
ipsiversive turns: n = 899).
(E) As in (B), but for layer 5 PT neurons (n = 560 neurons). **p < 0.01, ***p < 10�3, n.s., not significant; paired Student’s t test.
(F) As in (C), but for layer 5 PT neurons. ***p < 10�3; paired Student’s t test.
1046
Neuron 99, 1040–1054, September 5, 2018
 turning response (Figures 6C and 6F; first bin versus no
response, layer 2/3: p < 10�29; n = 1,154 neurons; layer 5 PT:
p < 10�11; n = 560 neurons; paired Student’s t test). Thus, while
the activation of layer 2/3 neurons to a visual offset perturbation
was independent of subsequent behavioral response, the acti-
vation of layer 5 PT neurons remained predictive of the subse-
quent behavioral response.
Visual Offset Perturbations Activate Layer 2/3 Neurons
Irrespective of Motor Response Direction
The fact that layer 2/3 neuron activation to perturbations
occurred independently of the subsequent motor behavior could
be the result of a concurrent activation of multiple possible motor
plan encoding ensembles in response to an unexpected pertur-
bation. If this were the case, we would expect both contra- and
ipsiversive turn-responsive layer 2/3 neurons to be activated
independent of the direction of the perturbation. We compared
responses of contra- and ipsiversive turn neurons during sponta-
neous and induced turns, sorting neurons by their response
magnitude during spontaneous contraversive turns (Figures 7A
and 7G). During spontaneous turns, both layer 2/3 and layer 5
PT neurons tended to be activated only during either contra- or
ipsiversive turns, but not both. The average response of contra-
versive neurons during spontaneous ipsiversive turns was a net
decrease of mean activity and vice versa (Figures 7B and 7H).
This decrease was likely the result of a response decay to the
preceding contraversive turn. To quantify the similarity of the
population response during spontaneous contraversive turns
compared to the population response during spontaneous ipsi-
versive turns, we computed the correlation coefficient of the
population vector of activity during ipsi- and contraversive turns
as a function of time relative to the turn onset (Figures 7C and 7I).
The population activity during contraversive turns in both layer
2/3 and layer 5 PT neurons was negatively correlated with the
population activity during ipsiversive turns before and after turn
onset. The negative correlation preceding the turn is likely a
consequence of the fact that mice tend to execute contra- and
ipsiversive turns in alternation.
To test whether the neurons that are activated during sponta-
neous turns are also activated during induced turns, we quanti-
fied the responses of the same neurons during induced turns.
Neurons that responded during spontaneous contraversive
turns also responded during induced contraversive turns (Fig-
ures 7D and 7J). Consistent with the idea that induced turns
result in a concurrent activation of contra- and ipsiversive neu-
rons, we found that contraversive neurons also exhibited an
initial response during induced ipsiversive turns (Figures 7D–
7E, 7J, and 7K). This initial response during induced turns in
the non-preferred direction was more pronounced in layer 2/3
than in layer 5 PT neurons. Based on the layer 2/3 responses,
we estimated the duration of this concurrent activation to be
666 ms ± 9 ms (mean ± SEM, n = 1,154 neurons, see STAR
Methods). By analyzing the correlation of the population activity
vectors during induced contraversive and induced ipsiversive
turns, we found that the activity vectors were initially positively
correlated only in layer 2/3 but not in layer 5 PT neurons (Figures
7F and 7L). Thus, immediately following an unexpected pertur-
bation, both contra- and ipsiversive turn-responsive neurons
are activated in layer 2/3, irrespective of their response prefer-
ence during spontaneous turns. It is conceivable that the layer
2/3 activation in response to perturbations is not a co-activation
of ipsi- and contraversive turn neurons, but a general response to
any unexpected sensory stimulus. We therefore examined the
responses to unexpected air puffs to the neck resulting in a
startle response. We indeed found a response to air puffs in
both layer 2/3 and layer 5 PT neurons, but the activity pattern eli-
cited by the air puff did not correlate with that elicited by either
ipsi- or contraversive visual offset perturbations (Figure S7),
A
B
Figure 5. Activity during Spontaneous Turns Is Higher when the Turn Is Taken Toward the Target
(A) Average activity during spontaneous turns in layer 2/3 neurons as a function of the heading in a window �0.625 s to �0.125 s preceding the turn. Turns were
acceleration matched (see STAR Methods and Figure S8) and binned such that a negative prior heading indicates a turn toward the target and a positive prior
heading a turn away from the target. In this analysis, we included data from all training days (days 1 to 8). Error bars indicate SEM over turns. Horizontal gray line
and shading is the average response and SEM over turns. *p < 0.05, **p < 0.01, ***p < 10�3; Student’s t test against the center bin. Bins that are not significant are
not marked.
(B) As in (A), but for layer 5 PT neurons.
Neuron 99, 1040–1054, September 5, 2018
1047
 demonstrating that motor cortex response patterns are specific
to the applied sensory perturbation.
To test whether the positive correlation between population
activity vector during contra- and ipsiversive turns was the
result of a symmetric co-activation of both contra- and ipsiver-
sive neurons, we projected the population activity vector onto
the two-dimensional subspace spanned by the activity patterns
during contra- and ipsiversive spontaneous turns as a function
of time (see STAR Methods). We did this for every offset
perturbation separately and computed average trajectories.
Consistent with a symmetric co-activation of both contra- and
ipsiversive turn activity patterns, the population activity in layer
2/3 after a visual offset perturbation initially follows a trajectory
near the line of unity between the two population activity pat-
terns for contra- and ipsiversive turns (Figure 8A). Consistent
with the observation that in layer 5 PT neurons we found no ev-
idence for a positive correlation of population activity during
contra- and ipsiversive turns (Figure 7L), we also find no evi-
dence for co-activation of activity patterns in layer 5 PT neurons
(Figure 8B). One interpretation is that in layer 2/3, visual offset
perturbations result in an initially symmetric co-activation of
the motor response patterns of both contra- and an ipsiversive
turns and that one of the two activity patterns is selected
through sequential processing in motor cortex to eventually
activate only one of the two in layer 5 PT neurons (Figure 8C).
Based on this, one would expect layer 5 IT neurons that are in
between the layer 2/3 and layer 5 PT neurons in this processing
hierarchy to exhibit intermediate effects. Layer 5 IT neurons
receive strong input from layer 2/3 neurons and have a mostly
unidirectional projection onto layer 5 PT neurons (Anderson
A
B
C
D
E
F
Figure 6. Visual Offset Perturbations Activate Layer 2/3 Neurons Independent of the Amplitude of the Induced Turn
(A) We split visual offset perturbation-induced turns recorded throughout training (days 3 to 8) into bins of high (black) and low (gray) accelerations. Shading
indicates SEM over turns (number of turns for high acceleration bin: n = 402; low acceleration bin: n = 659).
(B) Average response in layer 2/3 neurons for the high (black line) and low (gray line) acceleration turns as defined in (A). Both low and high acceleration result in
almost identical activation of layer 2/3 neurons (n = 1,154 neurons).
(C) Average population response of layer 2/3 neurons as a function of acceleration of the induced turn. Error bars indicate SEM over neurons (n = 1,154 neurons).
Dashed black line is a linear fit to the data. Shading marks bins used for the turning and activity traces in (A) and (B). ***p < 10�3, Student’s t test of first bin versus
no response; n.s.,: not significant, paired Student’s t test of first versus last bin. We found no evidence of a linear trend (p = 0.86, R2 = 10�6, n = 1,154 neurons;
linear trend analysis; see STAR Methods).
(D) As in (A), but for layer 5 PT experiments (number of turns for high acceleration bin: n = 966; low acceleration bin: n = 1,167).
(E) As in (B), but for layer 5 PT neurons (n = 560 neurons).
(F) As in (C), but for layer 5 PT neurons (n = 560 neurons). ***p < 10�3; Student’s t test of first bin versus no response. ***p < 10�3; paired Student’s t test of first
versus last bin. Linear trend analysis (see STAR Methods) indicated a significant linear trend (p < 10�7, R2 = 0.01, n = 560 neurons).
1048
Neuron 99, 1040–1054, September 5, 2018
 A
B
D
E
C
H
G
J
F
K
L
I
Figure 7. Spontaneous Turn-Responsive Cells Are Also Activated during Visual Offset Perturbation-Induced Turns
(A) Time course of average fluorescence of all layer 2/3 neurons (n = 1,154 neurons) during spontaneous contraversive (left) and ipsiversive (right) turns executed
throughout training (days 1 to 8). Neurons are sorted by their selectivity during contraversive turns.
(B) Average neuronal activity of contraversive neurons (marked by blue and red box in A) during spontaneous contraversive (blue) and ipsiversive (red) turns.
Shading indicates SEM over neurons (n = 616).
(C) Pearson’s correlation coefficient of the population vector during contraversive and ipsiversive turns as a function of time around turn onset (black line, gray
shading marks standard deviation over turns). Horizontal green lines mark mean (solid) and standard deviation (dashed) of random correlation. Horizontal black
line marks time bins in which correlation is significantly different from chance (gray indicates bins that are not significant).
(D) Same as (A), but for visual offset perturbation-induced turns executed during training days 3 to 8. Sorting of neurons is the same as in (A).
(E) Same as (B), but for visual offset perturbation-induced turns executed during training days 3 to 8. Initially, contraversive neurons are activated during both
contraversive and ipsiversive induced turns.
(F) Same as (C), but for visual offset perturbation-induced turns. Correlation of population vectors during induced turns is initially positive and only becomes
negative approximately 2 s after onset of the visual offset perturbation.
(G) Same as (A), but for layer 5 PT neurons (n = 560 neurons).
(H) Same as (B), but for layer 5 PT neurons (n = 229 neurons, as selected in G).
(I) Same as (C), but for layer 5 PT neurons.
(J) Same as (D), but for layer 5 PT neurons.
(K) Same as (E), but for layer 5 PT neurons.
(L) Same as (F), but for layer 5 PT neurons. In contrast to layer 2/3, we find no evidence of a positive correlation of population vectors in layer 5 PT neurons.
Neuron 99, 1040–1054, September 5, 2018
1049
 et al., 2010; Kiritani et al., 2012). We recorded the activity of
layer 5 IT neurons in Tlx3-Cre(PL56) mice throughout training
and found that the responses of layer 5 IT neurons during spon-
taneous turns were similar to those in layer 2/3 and layer 5 PT
neurons (Figures S8A–S8E). However, the learning-related
changes in layer 5 IT neurons were intermediate between those
observed in the other two neuron types (Figure S8F). Similar to
the responses in layer 2/3, activation of layer 5 IT neurons during
induced turns exhibited no linear increase with increasing ac-
celeration of the subsequent turn (Figures S8G–S8I). However,
even though the correlation of population vector activity during
ipsi- and contraversive-induced turns was positive just above
chance, we found no evidence of a symmetric co-activation of
contra- and ipsiversive neurons during induced turns (Figures
S8J–S8L). Thus, these data are consistent with a model in which
layer 2/3, layer 5 IT, and layer 5 PT form a sequential processing
hierarchy that selects an appropriate motor output in response
to a sensory perturbation.
DISCUSSION
The precise role of motor cortex in the control of movement is still
unclear. Here, we demonstrate that inactivation or lesions of mo-
tor cortex interfere with the mouse’s ability to learn and execute a
virtual navigation task, despite the fact that the ability to execute
the movements necessary to complete the task remained virtu-
ally unimpaired. These results are consistent with the interpreta-
tion that the impairment in task learning and execution results
from an inability of the mouse to execute movements under vi-
sual guidance but not movements per se. Recording neural ac-
tivity during unexpected visual offset perturbations, we found
that responses in layer 2/3 to unexpected visual feedback are
driven by the visual offset and do not correlate with the magni-
tude of the resulting behavioral correction. Moreover, the
neuronal response to a visual offset perturbation initially is a
co-activation of both ipsi- and contraversive neurons. In
contrast, responses in layer 5 PT neurons maintain the linear
A
C
B
Figure 8. Activity Patterns for Spontaneous Contra- and Ipsiversive Turns Are Co-activated in Layer 2/3 during Visual Offset Perturbation-
Induced Turns
(A) Projections of the population vector during spontaneous contraversive (blue) and spontaneous ipsiversive (red) executed throughout training (days 1 to 8) onto
the plane spanned by the population vector 1 s after turn onset during spontaneous contraversive and spontaneous ipsiversive turns. Origin of the coordinate
system is the mean population vector preceding turns. Shading of the maker indicates time relative to turn onset. We then projected the population activity vector
during induced contraversive (cyan) and induced ipsiversive turns (magenta) executed during training days 3 to 8 onto the same coordinate system. Black crosses
mark the first bin with the first significant change in turning velocity following visual offset perturbation. Error bars indicate SEM over turns. Dashed black line
marks line of unity.
(B) As in (A), but for layer 5 PT responses.
(C) Model for the response of motor cortex to unexpected feedback perturbations. In an initial phase of the response, multiple assemblies of neurons, the activity
of which we speculate corresponds to different motor plans, are co-activated and primed in layer 2/3. These assemblies could be separately driven by sensory
evidence, and potentially directly compete. At a later time, during the movement selection phase of the response, the dominant activation pattern of layer 2/3 can
recruit the corresponding assembly in layer 5 that then drives a behavioral response by activating subcortical motor control centers.
1050
Neuron 99, 1040–1054, September 5, 2018
 relationship with the magnitude of the induced turn that they
show during spontaneous turns, without co-activation of ipsi-
and contraversive neurons. We discuss our findings in the
context of specific requirements of motor cortical signaling dur-
ing sensory guided behavior, the specificity of cortical response
patterns during these behaviors, as well as the influence of
learning on motor cortical ensemble activity.
The Involvement of Motor Cortex in the Control of
Movement
Cortex evolved to complement a functional sub-cortical motor
control system. It exerts its influence on movement through in-
teractions with neuronal circuits distributed throughout the cen-
tral nervous system. While neuronal circuits in the spinal cord are
essential to produce and support basic movement patterns
including alternation of left-right and extension-flexion phases
during locomotion (Kiehn, 2016), neurons in the brainstem with
descending projections to the spinal cord are key in instructing
movement execution in different species (Esposito et al., 2014;
Jankowska and Edgley, 2006; Lawrence and Kuypers, 1968).
Brainstem nuclei in turn are targets of major descending projec-
tions from cortical as well as subcortical motor areas (Jankow-
ska and Edgley, 2006; Kably and Drew, 1998; Kuypers and
Lawrence, 1967). The effect of lesion or inactivation of motor cor-
tex is highly species dependent, consistent with a role of motor
cortex that, during evolution, initially may have been merely
modulatory. Cortical control of movement may therefore have
co-evolved with an increasing reliance of species on cortical pro-
cessing of sensory input providing the necessary information to
guide movement with accuracy and precision, especially when
the extraction of sensory information requires complex process-
ing. In agreement with such a model, effects of motor cortex
lesion in rodents are most pronounced when the task requires
fine digit control (Whishaw et al., 1998), when animals encounter
novel sensory conditions and movement coordination requires
rapid sensory feedback control (Lopes et al., 2016), or when an-
imals are still in the process of learning to control the movement
(Kawai et al., 2015). It is thus conceivable that motor cortex func-
tions to structure and adjust movements based on incoming
sensory information processed in cortex.
To test this model, we developed a virtual navigation task for
mice that requires visually guided control of movement. We
found that inhibition of motor cortex impairs the ability of the
mouse to execute turns induced by unexpected visual offsets
(Figure 2). Inhibition of motor cortex also impaired the ability
of the mouse to perform the task, but did not prevent the
mouse from executing spontaneous turns. Considering that
spontaneous turns can be executed either with or without vi-
sual guidance, and that visually guided spontaneous turns are
necessary to perform the task, our findings suggest that motor
cortex is necessary for the visual guidance of turns. Based on
this, we would expect to find higher activity in M1 during visu-
ally guided spontaneous turns than during non-visually guided
spontaneous turns. For any individual spontaneous turn, we
cannot determine whether it was executed under visual guid-
ance or non-visually guided. However, given that mice are
trained to navigate to a visual target, we can assume that visu-
ally guided spontaneous turns are directed toward the target,
while non-visually guided turns are equally likely to occur
toward or away from the target. To test whether there is a dif-
ference in activity between visually guided and non-visually
guided spontaneous turns, we split turns into those directed
toward the target (which are a combination of both visually
guided and non-visually guided turns) and those directed
away from the target (which are non-visually guided turns).
Interestingly, we observed that activation in motor cortical neu-
rons was significantly higher for target-directed spontaneous
turns than for turns directed away from the target (Figure 5).
Thus, while motor cortex clearly possesses the capacity to
drive movements when stimulated (Harrison et al., 2012; Ten-
nant et al., 2011), our results suggest that in this virtual naviga-
tion task motor cortical control is exerted mainly during visually
guided behavior. These results are consistent with the results of
experiments performed in cats, which showed that motor
cortical neurons are strongly activated when cats step over
an obstacle placed in front of them but not in the preceding
period walking on a runway (Drew et al., 2002). In this context,
cortical circuits for visually guided control of locomotion have
been suggested to involve the parietal cortex (Drew and Mari-
gold, 2015), an area that is directly connected with visual cortex
in rodents (Kolb and Walkey, 1987). These inputs could provide
motor cortex with the signals necessary to perform visually
guided behavior, similar to inputs from somatosensory cortex
that are necessary for somatosensory control of movement
(Mathis et al., 2017; Sreenivasan et al., 2016).
Differential Roles of Layer 2/3 and Layer 5 in Response
to Unexpected Feedback Perturbations
Motor cortex activity has been shown to correlate with a variety
of movement parameters in mice (Dombeck et al., 2009; Ko-
miyama et al., 2010; Li et al., 2015; Peters et al., 2017) and pri-
mates (Churchland et al., 2012; Moran and Schwartz, 1999;
Townsend et al., 2006). Consistent with a correlation between
neuronal activity in motor cortex and specific movement param-
eters, we found that neuronal activity in both layer 2/3 and layer 5
PT neurons exhibited a linear increase with increasing accelera-
tion of spontaneous turns (Figure 3) and most neurons were
selectively activated during either ipsi- or contraversive turns
(Figure 7). Interestingly, we found that a similar linear increase
in neuronal activity was not apparent for running onset activity
as a function of forward running onset acceleration in our task
(Figure S4). It is possible that the acceleration at running onsets
is not dependent on visual control and hence is not influenced by
motor cortex. Consistent with such a model, mice were still able
to initiate running during optogenetic inhibition of motor cortex,
and recent work also suggests that short-latency motor cortex
signaling is not needed during walking (Miri et al., 2017). Motor
cortex might generally retain a linear relationship between
neuronal activity and movement amplitude along coding dimen-
sions during spontaneous movement initiation. Neuronal activity
in motor cortex has been shown to be tuned not just to the acti-
vation of a muscle, but to the context in which this activation
occurs (Griffin et al., 2015), and whether the activation was in
response to an unexpected perturbation (Stout et al., 2015).
Consistent with a central role of motor cortex in the detection
of and the response to unexpected sensory perturbations, we
Neuron 99, 1040–1054, September 5, 2018
1051
 found that layer 2/3 and layer 5 PT neurons were differentially
activated in response to unexpected feedback perturbations:
initial activation of layer 2/3 neurons did not depend on either ac-
celeration or direction of the subsequent induced turn, while
layer 5 PT neurons retained both a linear dependence on turning
acceleration and the selectivity for turn direction they exhibited
during spontaneous behavior (Figure 6). Combining this with
the finding that motor cortex is necessary for turn initiation in
response to an unexpected feedback perturbation but not for
the execution of spontaneous turns per se, these data may point
to a role of motor cortex in the response to unexpected sensory
perturbations (Adams et al., 2013). Our data would be consistent
with a model in which layer 2/3 neurons signal a deviation be-
tween intended and actual motor state that updates an internal
representation of the intended motor state in layer 5 PT neurons.
Such a description would be computationally equivalent to a pre-
dictive processing description of visual cortex, where layer 2/3
neurons have been postulated to signal deviations between
actual and expected visual input that function to update an inter-
nal representation of the visual scene in layer 5 neurons (Attinger
et al., 2017; Fiser et al., 2016; Rao and Ballard, 1999; Zmarz and
Keller, 2016).
Alternatively, the concurrent activation of ipsi- and contraver-
sive layer 2/3 neurons in response to unexpected sensory per-
turbations would also be consistent with a model in which layer
2/3 concurrently activates both ipsi- and contraversive turn mo-
tor plan ensembles. In this model, either the ipsi- or contraver-
sive ensemble in layer 5 PT is then selected for output to
subcortical structures, likely as a consequence of input from
other cortical areas and local cortical processing. This would
be consistent with the finding that in primate motor cortex,
different movement goals can be simultaneously represented
during movement preparation (Klaes et al., 2011). A sequential
selection process is also supported by the known hierarchical
local connectivity in motor cortex between layer 2/3, layer 5
IT, and layer 5 PT, which is predominantly unidirectional (An-
derson et al., 2010; Kiritani et al., 2012; Weiler et al., 2008),
and the observation that responses in layer 5 IT neurons
were intermediate between the ones we observed in layer 2/3
and layer 5 PT (Figure S8). Neither of these models likely
exhaustively describes the function of motor cortex, but they
both point to a common computational goal of motor cortex:
increasing the accuracy and efficiency with which an animal
can react to a sensory perturbation.
Learning-Related Activation Changes Could Reflect
Changes in the Precision of Sensorimotor Control
Motor learning is typically accompanied by functional and
structural plasticity in motor cortex (Huber et al., 2012; Ko-
miyama et al., 2010; Ma et al., 2016; Masamizu et al., 2014; Pe-
ters et al., 2017; Yang et al., 2009). Consistent with this, we
observed systematic changes in activation during spontaneous
turns in both layer 2/3 and layer 5 PT neurons with increasing
task performance over days (Figure 4). Also consistent with
previous findings, activation of both layer 2/3 and layer 5 PT
neurons was initially stronger during contraversive turns than
during ipsiversive turns (Cui et al., 2013; Li et al., 2015).
Interestingly, with experience, activation of layer 2/3 during
contraversive turns decreased to the level of activation during
ipsiversive turns, whereas in layer 5 PT neurons, the activity
during contraversive turns was larger than during ipsiversive
turns and increased further with experience. Note that we do
not know whether these changes we observe in motor cortex
with learning are merely a consequence of a change in behav-
ioral strategy or are the cause of that change. As task perfor-
mance increases, the frequency and magnitude of deviations
from intended trajectory should decrease while the vigor and
precision with which corrective movements are executed
should increase. Thus, as mice gain experience traversing the
virtual tunnel, the movement error, which is necessary for
trial-to-trial motor adaptations (Inoue et al., 2016), is systemat-
ically reduced. We indeed found evidence for systematic motor
adaptations in the way mice learn to correct their movement
trajectory: with training, the fraction of turns directed toward
the target increased (Figure S6). Additionally, we found that
the stability of responses in layer 5 PT neurons increased
over the course of learning and is higher than that of layer
2/3 neurons (Figure S5). This is consistent with movement error
detection in layer 2/3 that drives movement adaptation and
hence does not stabilize with learning, while activity in layer 5
PT neurons that mediate motor output stabilizes with increasing
behavioral stereotypy in a given task.
Conclusion
In summary, we propose that motor cortex influences motor
behavior under conditions in which movement is guided by un-
expected sensory input. The mechanism by which motor cortex
exerts influence on movement control might be by the activa-
tion of different possible motor plan ensembles in layer 2/3 neu-
rons in response to deviations from expected sensory input. Of
these plans, one is selected for execution by the activation of
an appropriate subset of layer 5 PT neurons. Such a model
would also explain why the dependence on motor cortex for
motor behavior parallels the species’ reliance on cortex for sen-
sory processing.
STAR+METHODS
Detailed methods are provided in the online version of this paper
and include the following:
d KEY RESOURCES TABLE
d CONTACT FOR REAGENT AND RESOURCE SHARING
d EXPERIMENTAL MODEL AND SUBJECT DETAILS
B Animals and surgery
d METHOD DETAILS
B Surgery and virus injections
B Virtual reality setup and behavioral paradigm
B Optogenetic inhibition experiments
B Two-photon calcium imaging
B Histology
d QUANTIFICATION AND STATISTICAL ANALYSIS
B Data analysis
B Behavioral data analyses
B Calcium imaging data analyses
d DATA AND SOFTWARE AVAILABILITY
1052
Neuron 99, 1040–1054, September 5, 2018
 SUPPLEMENTAL INFORMATION
Supplemental Information includes eight figures, two tables, and two movies
and can be found with this article online at https://doi.org/10.1016/j.neuron.
2018.07.046.
ACKNOWLEDGMENTS
We thank Bence O
¨ lveczky for comments on an earlier version of the manu-
script. We thank Daniela Gerosa-Erni for production of the AAV vectors and
Marcus Leinweber for help with the construction of the microscope and virtual
reality setup, and the members of the Arber and the Keller labs for discussion
and support. M.H. and S.A. were supported by ERC Advanced Grant No
692617, Kanton Basel-Stadt, and the Louis Jeantet Prize for Medicine, and
all authors were supported by the Swiss National Science Foundation and
the Novartis Research Foundation.
AUTHOR CONTRIBUTIONS
M.H. performed the experiments and analyzed the data. M.H., S.A., and
G.B.K. designed the experiments and wrote the manuscript.
DECLARATION OF INTERESTS
The authors declare no competing interests.
Received: December 11, 2017
Revised: June 6, 2018
Accepted: July 25, 2018
Published: August 23, 2018; corrected online: February 27, 2019
REFERENCES
Adams, R.A., Shipp, S., and Friston, K.J. (2013). Predictions not commands:
active inference in the motor system. Brain Struct. Funct. 218, 611–643.
Anderson, C.T., Sheets, P.L., Kiritani, T., and Shepherd, G.M.G. (2010).
Sublayer-specific microcircuits of corticospinal and corticostriatal neurons in
motor cortex. Nat. Neurosci. 13, 739–744.
Armstrong, D.M., and Drew, T. (1984). Discharges of pyramidal tract and other
motor cortical neurones during locomotion in the cat. J. Physiol. 346, 471–495.
Attinger, A., Wang, B., and Keller, G.B. (2017). Visuomotor Coupling Shapes
the Functional Development of Mouse Visual Cortex. Cell 169, 1291–1302.e14.
Beloozerova, I.N., and Sirota, M.G. (1993a). The role of the motor cortex in the
control of vigour of locomotor movements in the cat. J. Physiol. 461, 27–46.
Beloozerova, I.N., and Sirota, M.G. (1993b). The role of the motor cortex in the
control of accuracy of locomotor movements in the cat. J. Physiol. 461, 1–25.
Beloozerova, I.N., Farrell, B.J., Sirota, M.G., and Prilutsky, B.I. (2010).
Differences in movement mechanics, electromyographic, and motor cortex
activity between accurate and nonaccurate stepping. J. Neurophysiol. 103,
2285–2300.
Brecht, M., Schneider, M., Sakmann, B., and Margrie, T.W. (2004). Whisker
movements evoked by stimulation of single pyramidal cells in rat motor cortex.
Nature 427, 704–710.
Chen, T.-W., Wardill, T.J., Sun, Y., Pulver, S.R., Renninger, S.L., Baohan, A.,
Schreiter, E.R., Kerr, R.A., Orger, M.B., Jayaraman, V., et al. (2013).
Ultrasensitive fluorescent proteins for imaging neuronal activity. Nature 499,
295–300.
Churchland,
M.M.,
Cunningham,
J.P.,
Kaufman,
M.T.,
Foster,
J.D.,
Nuyujukian, P., Ryu, S.I., and Shenoy, K.V. (2012). Neural population dynamics
during reaching. Nature 487, 51–56.
Cui, G., Jun, S.B., Jin, X., Pham, M.D., Vogel, S.S., Lovinger, D.M., and Costa,
R.M. (2013). Concurrent activation of striatal direct and indirect pathways dur-
ing action initiation. Nature 494, 238–242.
Dombeck, D.A., Graziano, M.S., and Tank, D.W. (2009). Functional clustering
of neurons in motor cortex determined by cellular resolution imaging in awake
behaving mice. J. Neurosci. 29, 13751–13760.
Drew, T., and Marigold, D.S. (2015). Taking the next step: cortical contributions
to the control of locomotion. Curr. Opin. Neurobiol. 33, 25–33.
Drew, T., Jiang, W., and Widajewicz, W. (2002). Contributions of the motor cor-
tex to the control of the hindlimbs during locomotion in the cat. Brain Res. Brain
Res. Rev. 40, 178–191.
Esposito, M.S., Capelli, P., and Arber, S. (2014). Brainstem nucleus MdV me-
diates skilled forelimb motor tasks. Nature 508, 351–356.
Farrell, B.J., Bulgakova, M.A., Sirota, M.G., Prilutsky, B.I., and Beloozerova,
I.N. (2015). Accurate stepping on a narrow path: mechanics, EMG, and motor
cortex activity in the cat. J. Neurophysiol. 114, 2682–2702.
Ferrier, D. (1874). Experiments on the Brain of Monkeys. Proc. R. Soc. Lond.
23, 409–430.
Fiser, A., Mahringer, D., Oyibo, H.K., Petersen, A.V., Leinweber, M., and Keller,
G.B. (2016). Experience-dependent spatial expectations in mouse visual cor-
tex. Nat. Neurosci. 19, 1658–1664.
Georgopoulos, A.P., Schwartz, A.B., and Kettner, R.E. (1986). Neuronal pop-
ulation coding of movement direction. Science 233, 1416–1419.
Gerfen, C.R., Paletzki, R., and Heintz, N. (2013). GENSAT BAC cre-recombi-
nase driver lines to study the functional organization of cerebral cortical and
basal ganglia circuits. Neuron 80, 1368–1383.
Griffin, D.M., Hoffman, D.S., and Strick, P.L. (2015). Corticomotoneuronal cells
are ‘‘functionally tuned’’. Science 350, 667–670.
Guo, Z.V., Li, N., Huber, D., Ophir, E., Gutnisky, D., Ting, J.T., Feng, G., and
Svoboda, K. (2014). Flow of cortical activity underlying a tactile decision in
mice. Neuron 81, 179–194.
Harrison, T.C., Ayling, O.G.S., and Murphy, T.H. (2012). Distinct cortical circuit
mechanisms for complex forelimb movement and motor map topography.
Neuron 74, 397–409.
Huber, D., Gutnisky, D.A., Peron, S., O’Connor, D.H., Wiegert, J.S., Tian, L.,
Oertner, T.G., Looger, L.L., and Svoboda, K. (2012). Multiple dynamic repre-
sentations in the motor cortex during sensorimotor learning. Nature 484,
473–478.
Inoue, M., Uchimura, M., and Kitazawa, S. (2016). Error Signals in Motor
Cortices Drive Adaptation in Article Error Signals in Motor Cortices Drive
Adaptation in Reaching. Neuron 90, 1114–1126.
Jankowska, E., and Edgley, S.A. (2006). How can corticospinal tract neurons
contribute to ipsilateral movements? A question with implications for recovery
of motor functions. Neuroscientist 12, 67–79.
Kably, B., and Drew, T. (1998). Corticoreticular pathways in the cat. I.
Projection patterns and collaterization. J. Neurophysiol. 80, 389–405.
Kawai, R., Markman, T., Poddar, R., Ko, R., Fantana, A.L., Dhawale, A.K.,
Kampff, A.R., and O
¨ lveczky, B.P. (2015). Motor cortex is required for learning
but not for executing a motor skill. Neuron 86, 800–812.
Kiehn, O. (2016). Decoding the organization of spinal circuits that control loco-
motion. Nat. Rev. Neurosci. 17, 224–238.
Kiritani, T., Wickersham, I.R., Seung, H.S., and Shepherd, G.M.G. (2012).
Hierarchical connectivity and connection-specific dynamics in the corticospi-
nal-corticostriatal microcircuit in mouse motor cortex. J. Neurosci. 32,
4992–5001.
Kita, T., and Kita, H. (2012). The subthalamic nucleus is one of multiple inner-
vation sites for long-range corticofugal axons: a single-axon tracing study in
the rat. J. Neurosci. 32, 5990–5999.
Klaes, C., Westendorff, S., Chakrabarti, S., and Gail, A. (2011). Choosing
goals, not rules: deciding among rule-based action plans. Neuron 70,
536–548.
Kolb, B., and Walkey, J. (1987). Behavioural and anatomical studies of the pos-
terior parietal cortex in the rat. Behav. Brain Res. 23, 127–145.
Komiyama, T., Sato, T.R., O’Connor, D.H., Zhang, Y.-X., Huber, D., Hooks,
B.M., Gabitto, M., and Svoboda, K. (2010). Learning-related fine-scale
Neuron 99, 1040–1054, September 5, 2018
1053
 specificity imaged in motor cortex circuits of behaving mice. Nature 464,
1182–1186.
Kuypers, H.G., and Lawrence, D.G. (1967). Cortical projections to the red nu-
cleus and the brain stem in the Rhesus monkey. Brain Res. 4, 151–188.
Lang, C.E., and Schieber, M.H. (2003). Differential impairment of individuated
finger movements in humans after damage to the motor cortex or the cortico-
spinal tract. J. Neurophysiol. 90, 1160–1170.
Lawrence, D.G., and Kuypers, H.G. (1968). The functional organization of the
motor system in the monkey. II. The effects of lesions of the descending
brain-stem pathways. Brain 91, 15–36.
Leinweber, M., Ward, D.R., Sobczak, J.M., Attinger, A., and Keller, G.B. (2017).
A Sensorimotor Circuit in Mouse Cortex for Visual Flow Predictions. Neuron
96, 1204.
Li, N., Chen, T.W., Guo, Z.V., Gerfen, C.R., and Svoboda, K. (2015). A motor
cortex circuit for motor planning and movement. Nature 519, 51–56.
Lopes, G., Nogueira, J., Paton, J.J., and Kampff, A.R. (2016). A robust role for
motor cortex. bioRxiv. https://doi.org/10.1101/058917.
Ma, L., Qiao, Q., Tsai, J.-W., Yang, G., Li, W., and Gan, W.-B. (2016).
Experience-dependent plasticity of dendritic spines of layer 2/3 pyramidal
neurons in the mouse cortex. Dev. Neurobiol. 76, 277–286.
Madisen, L., Zwingman, T.A., Sunkin, S.M., Oh, S.W., Zariwala, H.A., Gu, H.,
Ng, L.L., Palmiter, R.D., Hawrylycz, M.J., Jones, A.R., et al. (2010). A robust
and high-throughput Cre reporting and characterization system for the whole
mouse brain. Nat. Neurosci. 13, 133–140.
Marple-Horvat, D.E., Amos, A.J., Armstrong, D.M., and Criado, J.M. (1993).
Changes in the discharge patterns of cat motor cortex neurones during unex-
pected perturbations of on-going locomotion. J. Physiol. 462, 87–113.
Masamizu, Y., Tanaka, Y.R., Tanaka, Y.H., Hira, R., Ohkubo, F., Kitamura, K.,
Isomura, Y., Okada, T., and Matsuzaki, M. (2014). Two distinct layer-specific
dynamics of cortical ensembles during learning of a motor task. Nat.
Neurosci. 17, 987–994.
Mathis, M.W., Mathis, A., and Uchida, N. (2017). Somatosensory Cortex Plays
an Essential Role in Forelimb Motor Adaptation in Mice. Neuron 93, 1493–
1503.e6.
Miri, A., Warriner, C.L., Seely, J.S., Elsayed, G.F., Cunningham, J.P.,
Churchland,
M.M.,
and
Jessell,
T.M.
(2017).
Behaviorally
Selective
Engagement of Short-Latency Effector Pathways by Motor Cortex. Neuron
95, 683–696.e11.
Moran, D.W., and Schwartz, A.B. (1999). Motor cortical representation of
speed and direction during reaching. J. Neurophysiol. 82, 2676–2692.
Morishima, M., and Kawaguchi, Y. (2006). Recurrent connection patterns of
corticostriatal pyramidal cells in frontal cortex. J. Neurosci. 26, 4394–4405.
Murata, Y., Higo, N., Oishi, T., Yamashita, A., Matsuda, K., Hayashi, M., and
Yamane, S. (2008). Effects of motor training on the recovery of manual dexter-
ity after primary motor cortex lesion in macaque monkeys. J. Neurophysiol. 99,
773–786.
Peters, A.J., Lee, J., Hedrick, N.G., O’Neil, K., and Komiyama, T. (2017).
Reorganization of corticospinal output during motor learning. Nat. Neurosci.
20, 1133–1141.
Rao, R.P.N., and Ballard, D.H. (1999). Predictive coding in the visual cortex: a
functional interpretation of some extra-classical receptive-field effects. Nat.
Neurosci. 2, 79–87.
Sreenivasan, V., Esmaeili, V., Kiritani, T., Galan, K., Crochet, S., and Petersen,
C.C.H. (2016). Movement Initiation Signals in Mouse Whisker Motor Cortex.
Neuron 92, 1368–1382.
Stout, E.E., Sirota, M.G., and Beloozerova, I.N. (2015). Known and unexpected
constraints evoke different kinematic, muscle, and motor cortical neuron re-
sponses during locomotion. Eur. J. Neurosci. 42, 2666–2677.
Tennant, K.A., Adkins, D.L., Donlan, N.A., Asay, A.L., Thomas, N., Kleim, J.A.,
and Jones, T.A. (2011). The organization of the forelimb representation of the
C57BL/6 mouse motor cortex as defined by intracortical microstimulation and
cytoarchitecture. Cereb. Cortex 21, 865–876.
Townsend, B.R., Paninski, L., and Lemon, R.N. (2006). Linear encoding of
muscle activity in primary motor cortex and cerebellum. J. Neurophysiol. 96,
2578–2592.
Vong, L., Ye, C., Yang, Z., Choi, B., Chua, S., Jr., and Lowell, B.B. (2011).
Leptin action on GABAergic neurons prevents obesity and reduces inhibitory
tone to POMC neurons. Neuron 71, 142–154.
Weiler, N., Wood, L., Yu, J., Solla, S.A., and Shepherd, G.M.G. (2008). Top-
down laminar organization of the excitatory network in motor cortex. Nat.
Neurosci. 11, 360–366.
Whishaw, I.Q., Gorny, B., and Sarna, J. (1998). Paw and limb use in skilled and
spontaneous reaching after pyramidal tract, red nucleus and combined lesions
in the rat: behavioral and anatomical dissociations. Behav. Brain Res. 93,
167–183.
Yang, G., Pan, F., and Gan, W.-B. (2009). Stably maintained dendritic spines
are associated with lifelong memories. Nature 462, 920–924.
Zaaimi, B., Edgley, S.A., Soteropoulos, D.S., and Baker, S.N. (2012). Changes
in descending motor pathway connectivity after corticospinal tract lesion in
macaque monkey. Brain 135, 2277–2289.
Zmarz, P., and Keller, G.B. (2016). Mismatch Receptive Fields in Mouse Visual
Cortex. Neuron 92, 766–772.
1054
Neuron 99, 1040–1054, September 5, 2018
 STAR+METHODS
KEY RESOURCES TABLE
CONTACT FOR REAGENT AND RESOURCE SHARING
Further information and requests for resources and reagents should be directed to and will be fulfilled by the Lead Contact, Georg
Keller (georg.keller@fmi.ch).
EXPERIMENTAL MODEL AND SUBJECT DETAILS
Animals and surgery
All animal procedures were approved by and carried out in accordance with guidelines of the Veterinary Department of the Canton
Basel-Stadt, Switzerland. The mice used in this study were kept on a C57BL/6 background and were of the following genotype: 8
REAGENT or RESOURCE
SOURCE
IDENTIFIER
Antibodies
Chicken Anti-GFP
ThermoFisher
RRID: AB_2534023
Anti-NeuN
Millipore
RRID: AB_2298772
Alexa Fluor 488 Donkey Anti-Chicken IgY
Jackson ImmunoResearch
RRID: AB_2340375
Alexa Fluor 568 donkey anti - rabbit IgG
ThermoFisher
RRID: AB_2534017
Alexa Fluor 647 donkey anti - mouse IgG
ThermoFisher
RRID: AB_162542
Bacterial and Virus Strains
AAV2/1-EF1a-GCaMP6f-WPRE
FMI Vector Core
N/A
AAV2/1-EF1a-DiO-GCaMP6f-WPRE
FMI Vector Core
N/A
Chemicals, Peptides, and Recombinant Proteins
Isoflurane (Attane)
Provet
CAS 26221-73-3
Fentanyl
Actavis
CAS 990-73-8
Midazolam (Dormicum)
Roche
CAS 59467-96-8
Medetomidine (Dormitor)
Orion
CAS 86347-14-0
Flumazenil (Anexate)
Roche
CAS 78755-81-4
Atipamezole (Antisedan)
Orion Pharma
CAS 104054-27-5
Histoacryl
B. Braun
CAS 6606-65-1
Dental cement (Paladur)
Heraeus Kulzer
CAS 9066-86-8
Ibotenic acid
Sigma
CAS 2552-55-8
Experimental Models: Organisms/Strains
Mouse: C57BL6/J
Charles River Laboratories
N/A
Mouse: Tg(Tlx3-Cre)PL56Gsat
MMRRC
RRID: MMRRC_041158-UCD
Mouse: Tg(Sim1-Cre)KJ18Gsat
Gerfen et al., 2013
RRID: MMRRC_031742-UCD
Mouse: Slc32a1tm2(cre)Lowl/J
Vong et al., 2011
RRID: IMSR_JAX:016962
Mouse: B6.Cg-Gt(ROSA)26Sortm14(CAG-tdTomato)Hze/J
Madisen et al., 2010
RRID: IMSR_JAX:007914
Mouse: B6.Cg-Tg(Slc32a1-COP4*H134R/EYFP)8Gfng/J
The Jackson Laboratory
RRID: IMSR_JAX:014548
Software and Algorithms
LabVIEW
National Instruments
RRID: SCR_014325
Iris: 2 photon scanning software
N/A
https://sourceforge.net/projects/iris-scanning/
MATLAB
The MathWorks
RRID: SCR_001622
Calliope: Image processing software
N/A
https://svn.code.sf.net/p/iris-scanning/calliope/
Other
Titanium Headplate
Leinweber et al., 2017
Custom
Virtual reality setup
Leinweber et al., 2017
Custom
Neuron 99, 1040–1054.e1–e5, September 5, 2018
e1
 vGAT-Cre (Vong et al., 2011, RRID: IMSR_JAX:016962) x ROSA-LSL-tdTom (Madisen et al., 2010, RRID: IMSR_JAX:007914) mice
were used for imaging layer 2/3 excitatory neurons, 11 Sim1-Cre(KJ18) mice for imaging layer 5 pyramidal tract (PT) neurons (Gerfen
et al., 2013, RRID: MMRRC_031742-UCD), 9 Tlx3-Cre(PL56) (Gerfen et al., 2013, RRID: MMRRC_041158-UCD) were used for imag-
ing layer 5 intratelencephalic (IT) projection neurons, 15 vGAT::ChR2(H134R)-EYFP (RRID: IMSR_JAX:014548) mice were used for
optogenetic inhibition experiments, 5 C57BL/6 were used for ibotenic acid lesion experiments, and 6 C57BL/6 mice were used in
optogenetic control experiments. Mice were group housed in a vivarium (light/dark cycle: 12/12 hr) and were 6 – 14 weeks old at
the beginning of experiments. Experimental mice used were of both sexes.
METHOD DETAILS
Surgery and virus injections
For all surgical procedures, mice were anesthetized using a mixture of Fentanyl (0.05 mg/kg; Actavis), Midazolam (5.0 mg/kg; Dor-
micum, Roche) and Medetomidine (0.5 mg/kg; Domitor, Orion). In surgeries preparing for two-photon imaging experiments, a crani-
otomy of approximately 4 mm diameter was made over the right motor cortex centered on a location 0.5 mm anterior and 1.5 mm
lateral of bregma. This corresponds approximately to the caudal forelimb area mapped by intracortical microstimulation
(Tennant et al., 2011). We placed 5 to 9 injections of approximately 150 nL each of either unconditional AAV2/1-Ef1a-GCaMP6f (titer
1011 – 1012 GC/mL) for imaging layer 2/3 neurons or conditional AAV2/1-Ef1a-DIO-GCaMP6f (titer 1011 – 1012 GC/mL) for imaging
layer 5 PT neurons within a radius of approximately 500 mm of the center of the target region. For ibotenic acid (5 g/L; Sigma) lesions,
a single point injection of approximately 250 nL was made centered in the caudal forelimb area (CFA, 0.5 mm anterior and 1.5 mm
lateral from bregma). For optogenetic experiments, the craniotomy was made to span motor cortex bilaterally. A circular 4 mm (im-
aging) or a custom-cut (optogenetics) coverslip was implanted with superglue (Pattex) to close the craniotomy. A custom-machined
titanium head bar was attached to the skull using dental cement (Paladur, Heraeus). Anesthesia was antagonized by an intraperito-
neal injection of a mixture of Flumazenil (0.5 mg/kg; Anexate, Roche) and Atipamezole (2.5 mg/kg; Antisedan, Orion Pharma) and
mice were returned to their home cage with access to a running wheel and water ad libitum for at least 3 days before beginning
of the experiment.
Virtual reality setup and behavioral paradigm
For all experiments we used a virtual reality setup as previously described (Leinweber et al., 2017). Mice were head-fixed and free to
run on a spherical, air-supported styrofoam ball. Rotation of the ball was coupled to movement in a virtual reality environment. A vir-
tual corridor was projected onto a toroidal screen positioned in front of the mice covering approximately 240 degrees horizontally and
100 degrees vertically of the field of view using a projector (Samsung SP-F10M). To prevent light leak from the projector onto the two-
photon imaging plane, the projector was synchronized to the resonant scanner of the microscope. Mice were trained to control head-
ing in the virtual tunnel and navigate toward a target. Upon reaching the target, a reward was delivered through a blunt syringe spout
positioned near the snout of the mouse (�7 mL / reward, 1:10 diluted milk). To incentivize mice to engage in the training paradigm, they
were water-restricted with access to 1 mL water daily 3 days before start of either imaging or optogenetic experiments. Care was
taken to prevent a drop in body weight to below 80% of starting weight and additional water was supplemented when necessary.
The amount of rewards the mice could collect during training was not restricted. A new trial was initiated after a 5 s time out during
which a gray screen was presented. The tunnel was kept short initially (length to width ratio of 5:1) but was progressively lengthened
to increase difficulty of the task such that mice collected approximately 2 rewards per minute. By the end of training, the tunnel length
typically corresponded to approximately 4 m of physical distance (length to width ration of 30:1). Mice were trained and imaged daily
in training sessions that lasted approximately 45 min. From training session three onward, visual offset perturbations were introduced
with a probability of 0.8 per traversal at a random location in the virtual tunnel (restricted to the middle portion of the tunnel between
20% and 80% of total length). Visual offset perturbations consisted of a sudden 30� offset in the heading randomly either to the left or
to the right.
Optogenetic inhibition experiments
Mice were trained to navigate the virtual environment as described above. Light from a 473 nm laser (Shanghai Laser & Optics Cen-
tury, BL473H-200) was sinusoidally modulated at 40 Hz using a Pockels Cell (Conoptics, Model 350-80). The laser was directed at
either two locations per hemisphere (in mm: 1.5 lateral, 0.5 and 1.5 anterior of bregma) at 5 mW time averaged power per location
(10 mW per hemisphere), or one location (in mm: 1.5 lateral, 0.5 anterior of bregma) at 1 mW or 2 mW time averaged power per
location/hemisphere. Full-width half maximum of the laser beam was 0.8 mm (pale blue dashed circle in Figure S1A) and power drop-
ped to 1/e at a radius of 0.5 mm. Photostimulation was performed through a cranial window. We used a galvo-galvo scan head to
either cycle between the target locations or between two blank locations on the head-bar during times of no stimulation. For stim-
ulation, the laser cycled between each of the two (four) target locations for the duration of the stimulus with a dwell time of 40 ms
(20 ms) per location. To minimize stimulation related changes in audible noise generated by the moving galvanometers and lumi-
nance changes associated with scanning of the laser beam, the laser was continuously cycled between the two blank locations
on the head bar during times of no stimulation. For the chronic inhibition experiments during training (Figures 1, 2, S1, and S2),
we stopped inhibition of motor cortex in cases where the trial lasted more than 15 s by cycling the laser between the blank positions.
e2
Neuron 99, 1040–1054.e1–e5, September 5, 2018
 Inhibition was then resumed at the start of the next trial. This was done to increase the motivation of the mice to run on the spherical
treadmill. For the experiments on the effect of motor cortex inhibition on the response to visual offset perturbations in trained mice
(Figures 2 and S2), the laser was switched from blank to target position at different times relative to the onset of the visual offset
perturbation (�1 s, �0.5 s, 0 s, 0.5 s, 1 s). Different laser onset times were randomized and data were collected over four training
sessions on four consecutive days.
Two-photon calcium imaging
All two-photon imaging experiments were performed using a modified Thorlabs B-Scope as described previously (Leinweber et al.,
2017). Light source was a femtosecond laser (MaiTai eHP DeepSee, Spectra Physics) tuned to 990 nm. The scan head was based on
an 8 kHz resonant scanner (Cambridge Technology). For imaging we used a 16x, 0.8 NA objective (Nikon). Emission light was band
pass filtered (525/50, Semrock BrightLine) and detected using GaAsP photomultiplier tubes (H7422, Hamamatsu). Photomultiplier
tube signals were amplified (DHPCA-100, Femto), digitized (NI5772, National Instruments) at 800 MHz and band-pass filtered at
80 MHz using a digital Fourier-transform filter implemented in custom written software on an FPGA (NI5772, National Instruments).
Images were acquired at 40 Hz frame rate at a resolution of 750 3 400 pixels.
All the imaging in layer 2/3 and layer 5 IT neurons were done in cell bodies. In a subset of mice (3 of 11 mice), we recorded activity of
layer 5 PT neurons from main dendritic trunks below the apical arborization, because the image quality did now allow for somata im-
aging (Figures S3A–S3C). We found no evidence for a difference in the effects we described between somatic or dendritic recordings
of these layer 5 PT neurons (Figures S3D–S3F), and therefore pooled dendritic and somatic recordings for all subsequent analyses.
Histology
For histological processing at the end of the experiment, mice were deeply anesthetized with a ketamine-xylazine mixture, transcar-
dially perfused with 4% PFA/PBS and brains were extracted and post-fixed for 24 hr. After cryopreservation in 30% sucrose/PBS,
brains were frozen in embedding medium (Tissue-Tek) and stored at �80�C. Sections were then cut with a thickness of 80 mm using a
cryostat, collected free-floating in PBS, and subsequently immuno-stained for GFP (ThermoFisher, RRID:AB_2534023) and the
neuron-specific protein NeuN (Millipore, RRID:AB_2298772). Fluorophore-coupled secondary antibodies were obtained from Jack-
son or ThermoFisher. Stained sections were then mounted in a glycerol-based medium and imaged using a Zeiss LSM700 or a Visi-
tron Spinning Disc confocal microscope.
QUANTIFICATION AND STATISTICAL ANALYSIS
Data analysis
All data analysis was performed using custom-written and publicly available (https://sourceforge.net/projects/iris-scanning) soft-
ware written in MATLAB (MathWorks). Statistical tests were used as stated in the figure legends.
Behavioral data analyses
Onsets of spontaneous turns were determined by thresholding (0.12 deg/s) the absolute value of rotational velocity of the spherical
treadmill. To isolate well-defined turns, we discarded turn onsets that were preceded by another turn in the same direction within 5 s.
This excluded 45% of the turns identified with the threshold crossing criterion. This procedure was aimed at eliminating threshold
crossings that occurred in rapid succession either as a result of noise in the recording or as small rotational velocity changes due
to individual steps. Our results did not change qualitatively when varying this exclusion window size over a wide range (2 s -
10 s). Thus, for spontaneous turns neural and behavioral data were aligned to the threshold crossing of the rotational velocity as
described above. For induced turns (Figures 2, 6, 7, 8, S2, S3, and S8), neural and behavioral data were aligned to the time of the
visual offset perturbation. To measure the fraction of time spent running (Figures 1 and S1), we used a threshold of 0.6 cm/s on
the forward velocity of locomotion of the mouse on the spherical treadmill.
Performance (Figures 1 and S1) was quantified as the fraction of time spent running toward the target (±36 degrees from the di-
rection of the target) normalized by the total time spent running. Plateau performance was defined as the first day at which a mouse’s
performance reached 90% of its maximum performance. The learning rate (Figure S1) was calculated as the slope of a line fit to the
performance data. Rotational acceleration during a spontaneous (induced) turn (Figure 2) was quantified as the difference in mean
speed in a post window 0 s to 1 s (0.5 s – 1.5 s) and the mean speed in a baseline window - 2 s to - 1.5 s (- 0.5 s to 0 s) normalized by the
time between the two windows. Note that we used the same baseline and response windows for both behavioral and neuronal (see
below) quantifications. Spontaneous turns during optogenetic inhibition (Figure 2) were analyzed in expert mice, on performance
testing days. To compare spontaneous and induced turning behavior with optogenetic inhibition from the same expert mice (Figure 2),
we excluded one mouse of which we did not have data for induced turns. For the visual offset perturbation responses, delayed
response trials (Figures 2 and S2) were defined as trials in which turning velocity of the mice did not cross a threshold (10 deg/s) within
1 s after visual offset perturbation.
Onsets of running (Figure S4) were determined by thresholding the forward locomotion velocity of the mouse on the spherical
treadmill. To include only well isolated running onsets we used a threshold of 1.2 cm/s, and discarded running onsets that were
preceded by running onset in a window of 2.5 s or were within 5 s of a reward delivery.
Neuron 99, 1040–1054.e1–e5, September 5, 2018
e3
 Calcium imaging data analyses
Raw two-photon images were full-frame registered to correct for brain motion. Neurons were manually selected based on mean and
maximum fluorescence images. Note that the use of maximum fluorescence images biased our selection of neurons to active neu-
rons. Other than excluding neurons that were not clearly identifiable in any of the imaging time points, we excluded no neurons
from further analysis. Raw fluorescence traces (F) were computed and smoothed as previously described (Leinweber et al.,
2017). (F-F0)/F0 (abbreviated as DF/F) values were calculated using the median fluorescence (over the entire recording session)
for normalization (F0).
To compute the average event-triggered change in fluorescence DF/F (Figures 3, 4, S6–S8), we baseline subtracted the responses
of each neuron using the baseline windows: for spontaneous turns �2 s to �1.5 s; for visual offset perturbation-induced turns,
running onsets and air puffs �0.5 s to �0 s. To compute average responses (Figures 3, 4, 5, 6, 7, 8, and S3–S8) we used differences
of mean DF/F in a response window and mean DF/F the baseline window. Response windows were: for spontaneous turn and air puff
responses: 0 s to 1 s; for visual offset perturbation-induced turn and running onset responses: 0.5 s to 1.5 s.
We defined neurons as contraversive (ipsiversive) turn neurons (Figures 3, 5, 6, 7, 8, S3, S4, S6, and S8) if their response during
contraversive (ipsiversive) turns was stronger than their response during ipsiversive (contraversive) turns. Note, in this way all neurons
are either classified as contraversive or ipsiversive and no neurons excluded. To obtain a population response, we then calculated the
average of the activity of contraversive turn neurons during contraversive turns and the average of ipsiversive turn neurons during
ipsiversive turns, and then averaged these two responses (Figures 3, 5, 6, S3, S4, and S8). Note that the average learning related
population response reported in Figure 4 does not take into account the neuron’s preference for turning direction.
Linear trend analysis (Figures 2, 3, 6, S3, S4, and S8) was performed using the MATLAB regress function. To quantify the signif-
icance of the linear trend we report the R2 statistic and p value of the F statistic.
To increase the number of turns in the lowest acceleration bin in Figures 3F, 3J, S3, S4, and S8, we did not apply the 5 s inter turn
interval exclusion criterion for this bin.
Learning related change of correlation (Figures 4C and 4F) was calculated for each neuron as the absolute value of the Pearson’s
correlation coefficient of the rotational velocity of the treadmill and the fluorescence trace. To reduce the potential impact of move-
ment artifacts in the fluorescence traces, which would lead us to overestimate the strength of correlation, we set all DF/F values below
1 to 0 before calculating the correlation coefficient.
Latency of activation during induced turns was estimated by first selecting neurons that had a significant response to visual offset
perturbations in a window 0.5 s to 1.5 s after visual offset (response versus baseline window �0.5 s to 0 s preceding the visual offset,
p < 10�3, Student’s t test). For these neurons we then detected in an early response window (0 s - 0.3 s after visual offset) the first time
point at which the fluorescence trace crossed a threshold of 2 standard deviations of the fluorescence distribution in a window �0.5 s
to 0 s preceding visual offset.
The duration of the concurrent activation during contra- and ipsiversive turns in response to visual offset perturbations (Figure 7E)
was estimated for all neurons by determining the first significant difference between ipsi- and contraversive responses in a window
0 s to 1.25 s after visual offset. Threshold for significant responses was twice the standard deviation of the difference in a
window �0.5 s to 0 s preceding visual offset.
For the analysis of stability of responses over the course of training (Figure S5) we calculated a matrix of Pearson’s correlation co-
efficients of neuronal population response vectors during contra- and ipsiversive turns separately. Data of each day was split into first
and second half, and the correlation matrix obtained by correlating the population vector obtained from the first half of the data on day
A with the population vector obtained from the second half of the data on day B. The time constant of the stability of the neuronal
response was approximated by the decay constant of an exponential fit through the mean values of the off-diagonals of the corre-
lation matrix.
For the analysis of differences of activation during spontaneous turns as a function of direction of the turn (Figures 5 and S6), turns
were classified as directed toward the target or as directed away from the target and binned by the heading relative to the target
preceding the onset of the turn (average heading in a window �0.625 s to �0.125 s preceding the turn onset). To acceleration-match
turns toward and away from the target for each heading bin separately, we sorted all turns by the average acceleration in a window 0 s
to 1 s after turn onset. We then successively excluded the highest acceleration turns in the heading bin with the higher average
acceleration and the lowest acceleration turns in the heading bin with the lower average acceleration until the heading bin that initially
had the higher average acceleration had a lower average acceleration than the heading bin that initially had the lower average ac-
celeration. This was done in steps of 1% of the number of turns.
The time course of population vector correlation (Figures 7, S7, and S8) was obtained by calculating the average Pearson’s cor-
relation of the population vector of activity during ipsi- and contraversive turns for all mice. The population vector of activity was
calculated as a function of time, averaging the activity in a window of 0.4 s in steps of 0.2 s. To account for differences in the number
of turns per mouse we randomly sub-selected an equal number of turns (corresponding to number of turns from the mouse with the
least turns) from all mice. To obtain estimates of the baseline level of correlation, we computed the population vector of activity cor-
relation at random times during running. To visualize the dynamics of the population vector of activity around spontaneous and
induced turn onsets (Figures 8 and S8), we projected the population vector of activity for each turn event, calculated in time bins
of 0.1 s, onto the two-dimensional space spanned by the population vector during a spontaneous right turn and the population vector
during a spontaneous left turn (calculated as the difference between 0 s and 1 s after turn onset). This was done for spontaneous
e4
Neuron 99, 1040–1054.e1–e5, September 5, 2018
 contra- and ipsiversive, and induced contra- and ipsiversive turns separately. For this analysis, data from mice with less than 15%
contraversive or ipsiversive neurons were excluded (0 of 8 layer 2/3 mice and 2 of the 11 layer 5 PT mice), as in these mice the es-
timate of spontaneous turn basis vectors was too unstable. The onsets of the behavioral response for the induced turns (Figures 8
and S8, black crosses) were estimated as the time bin with first significant (p < 0.05, Student’s t test) deviation of the distribution of
rotational velocity after the visual offset perturbation (in a window of 25 ms, measured in steps of 25 ms) from the distribution imme-
diately preceding the visual offset perturbation (in a window of 25 ms).
DATA AND SOFTWARE AVAILABILITY
Requests for data and software should be directed to and will be fulfilled by the Lead Contact, Georg Keller (georg.keller@fmi.ch).
Software for controlling the two-photon microscope and preprocessing of the calcium imaging data is available on https://
sourceforge.net/projects/iris-scanning/.
Neuron 99, 1040–1054.e1–e5, September 5, 2018
e5
