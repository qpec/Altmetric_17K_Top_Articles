 High-Multiplex Semiconductor Biochip  
Page 1 of 64 
 Hassibi et al. 
Supplementary Note 1 
 
Description: 
Depiction of amplicon generation for both conventional PCR and asymmetric PCR 
and real-time solid-phase capturing to quantify the initial template concentration  
 
 
 
 
 
 
 
 
 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 2 of 64 
 Hassibi et al. 
Supplementary Note 2 
 
Description: 
Materials and methods for generating the example inverse fluorescence 
transduction data. 
 
The melt curves in Fig. 2 (cf. manuscript) were generated by first PCR asymmetrically amplifying a region 
of the rpoB of M. tuberculosis (H37Rv), removing the reaction into a flow-through chamber with a 
probe-printed 1”x3” slide, hybridizing it such that enough ssDNA amplicons bind to the probes and 
finally imaging the slide (and the probes) when subject to a 55°C to 95°C melt process. The details of 
each experiment are below. 
Primers for amplifying the targeted rpoB region 
FIGURE 
PRIMER 
RATIO 
SEQUENCE (5’-3’) 
2A 
Forward (Excess) 
2.5:1 
5’-CY5-TGGTCGCCGCGATCAAGGAG-3’ 
Reverse (Limiting) 
5’-CTCCAGCCCGGCACGCTC-3’ 
2B 
Forward (Excess) 
3:1 
5’-BHQ3-TGGTCGCCGCGATCAAGGAG-3’ 
Reverse (Limiting 
5’-CTCCAGCCCGGCACGCTC-3’ 
2C 
Forward (Excess) 
3:1 
5’-TGGTCGCCGCGATCAAGGAG-3’ 
Reverse (Limiting) 
5’-CTCCAGCCCGGCACGCTC-3’ 
 
Probes pairs 
FIGURE 
PRIMER 
SEQUENCE (5’-3’) 
2A 
Wild Type (WT) 
5’-GAATTGGCTCAGCTGGCTAAAAAA-C6-NH2-3’ 
Mutant (MT) 
5’-GAATTGGCTCGGCTGGCTAAAAAA-C6-NH2-3’ 
2B 
Wild Type (WT) 
5’-NH2-C6-AAAAAATGAATTGGCTCAGCTGGCTATCGCGGCG-TYE665-3’ 
Mutant (MT) 
5’-NH2-C6-AAAAAATGAATTGGCTCGGCTGGCTATCGCGGCG-TYE665-3’ 
2C 
Wild Type (WT) 
5’-Cy3-GAATTGGCTCAGCTGGCTAAAAAA-C6-NH2-3’ 
Mutant (MT) 
5’-Cy3-GAATTGGCTCGGCTGGCTAAAAAA-C6-NH2-3’ 
 
PCR amplification chemistry 
FIGURE 
Master Mix 
dNTP 
TEMPLATE 
2A 
Multiplex PCR Master 
Mix (NEB) 
200 µM each 
66 fM genomic H37Rv 
2B 
Advantage 2 Master 
Mix (Clonetech) 
200 µM each 
135 fM genomic H37Rv 
2C 
Q5® Master Mix (NEB) 
200µM dATP, dTTP, and dGTP, 
100µM dCTP, and 100µM Q-dCTP* 
660 fM genomic H37Rv 
* Black Hole Quencher 10 (BHQ10)-dCTP (BioSearch Laboratories) 
 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 3 of 64 
 Hassibi et al. 
PCR instrument/conditions.  C1000 Touch (BioRad Laboratories, Inc.) 95⁰C for 3 min, followed by 45 
cycles of amplification at 95°C for 20 s, 64°C for 40 s, and 68°C for 20 s, and 3) a final extension step for 3 
min extension at 68°C.   
Hybridization and melt.  Reaction was removed from PCR instrument and inserted into the probe-
printed slide, hybridized for 1 hour at 55⁰C followed by a melt from 55°C to 95°C over 20 min. In case of 
Fig. 2a (cf. manuscript), after the hybridization and prior to melt, the slide was washed with 1 mL of 1x 
hybridization buffer (5x Denhardt’s reagent, 5 mM KH2PO4, 0.1% SDS, and 5x SSC). 
 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 4 of 64 
 Hassibi et al. 
Supplementary Note 3 
 
Description: 
Materials and methods for characterization and study of the labeling of PCR 
amplicons using quencher-labeled dNTPs (Q-dNTPs). 
 
 
Measuring and Optimizing Q-dNTP Incorporation Rate 
We developed simplified analytical methods to characterize the ability of a polymerase to suitably 
incorporate various quencher-labeled dCTP conjugates.  This methodology allowed for the initial 
empirical optimization of product extension yield and also Q-dCTP incorporation frequency.  To help 
ensure effective energy transfer (quenching) during the IFT melt curve phase of the assays, we have 
targeted approximately one Q-dCTP every fifteen nucleotides.  This spacing represents a balance 
between signal transduction and amplicon yield. 
Thermostable DNA polymerase was used to extend a self-priming hairpin oligonucleotide sequence in 
the presence and absence of Q-dCTP (BHQ-10 dCTP conjugate, MW 1051.78, LGC BioSearch) in addition 
to the four natural dNTPs at 1:1:1:1 mole ratio. The resulting nucleic acid components were then 
evaluated for the proportion of starting material converted into dsDNA (via gel electrophoresis, Fig. 
Supp. 1) and the probability of Q-dCTP incorporation (via UV-Vis spectrophotometry), by virtue of the 
unique Q-dCTP absorbance at 516 nm (Fig. Supp. 2). 
Representative reactions employing SuperScript III (Thermo-Fisher pn 11732-020) included 1 µL enzyme, 
12.5 µL 2x reaction mix, 1 µL 50 mM MgSO4, 2.5 µL 50 µM self-priming oligonucleotide, 0-200 µM Q-
dCTP conjugate and sufficient water for 25 µL total volume.  Extension conditions were 5 min at 95°C, 20 
min at 68°C and hold at 15°C.  1 µL of the reaction mixture was analyzed with an Agilent RNA 6000 Nano 
Chip (Agilent pn 5067-1511), according to the Nano Kit Guide.  20 µL of the reaction mixture was treated 
with a QIAquick PCR Purification Kit (Qiagen pn 28106) according to the manufacturer’s protocol and 
eluted in 20µL EB buffer.  12.5 µL of the purified sample (free of unincorporated dNTPs) was diluted into 
DNA Suspension Buffer (10 mM Tris, 0.1 mM EDTA, pH 8.0) and its UV-Vis spectrum was collected on a 
Beckman DU-800 spectrophotometer with a 1 cm path-length cuvette. 
The self-priming 100mer oligonucleotide sequence Oligo1 was as follows:   
5'-TGC CTC AGC GTA AGG TTC CAG ATA AAT AGG TCA GGC CTG ATT CAA GTG TTC TTT GCA AAC TCC TCT 
TGG CTA ATC GCG GCT CGC GTG TCG CGA GCC GCG A-3'   
This construct possesses 16 potential sites for the polymerase to incorporate either natural dCTP or the 
corresponding Q-dCTP.  The extended sequence has a calculated extinction coefficient of 133,9511 at 
260 nm.  The Q-dCTP conjugate has a measured extinction coefficient of ~30,000 at 516nm.  The 
probability of Q-dCTP incorporation was calculated with the following formula:  P = (moles Q-dCTP / 
moles DNA)/16.  Typically, polymerase extension reactions containing up to 200 µM Q-dCTP (in addition 
to the four standard dNTPs) afforded P values of ~0.21, which for Oligo1 corresponds to, on average, 
3.36 Q-dCTP incorporations per strand.   
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 5 of 64 
 Hassibi et al. 
 
 
Figure Supp. 1: Gel view of Bioanalyzer data from RNA 6000 Nano Chip for Oligo1 alone (1), Oligo1 extended using SSIII 
without Q-dCTP (2) or in the presence of 100 μM (3) or 200 μM Q-dCTP (4). This experiment was conducted once. 
 
 
 
Figure Supp. 2: UV-Vis scan of purified products from extensions performed in the absence/presence of Q-dCTP. Each 
measurement (spectral scan) was conducted once. 
 
 
-0.02
0
0.02
0.04
0.06
0.08
0.1
0.12
200
300
400
500
600
700
800
Absorbance
Wavelength (nm)
Thermo SSIII Oligo1
Thermo SSIII Extended
Thermo SSIII Extended + 100uM BHQ10-dCTP
Thermo SSIII Extended + 200uM BHQ10-dCTP
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 6 of 64 
 Hassibi et al. 
Supplementary Note 4 
 
Description: 
Materials and methods for characterization and evaluation of FAM-TAM 
construct. 
 
A. Absorption Spectra 
A DU800 UV/Vis spectrophotometer (Beckman Coulter) was utilized to obtain the absorption spectrum 
and the molar extinction coefficient of the FAM-TAM construct and BHQ10 and BHQ2 quenchers.  
Lyophilized FAM-TAM oligo (5’-6-TAMN/TTT TTT /iFluorT/TT CCC TGA GCT GAA CGG GAA GC -3’) was 
obtained from Integrated DNA Technologies. The oligo was diluted in distilled water to obtain a 100 µM 
stock solution. From the stock solution, a final 1µM analyte concentration with a total volume of 1000 
µL was created in aqueous buffer (Tris-HCl, pH 8.7 @ 25°C, [K+] = 55 mM, [Mg2+] = 3.5 mM). 
The normalized absorption spectrum of the 1 µM analyte measured at room temperature is shown in 
normalized units in Fig. Supp. 3. Peak absorbance measured close to the donor (FAM) absorption peak, 
is 0.1184 at 495 nm. For a concentration of 1 μM and an optical path length of 1 cm, the molar 
extinction coefficient is calculated to be 118,400 M-1 cm-1, using Beer Lambert’s law.  The absorption 
spectra of BHQ10 and BHQ2 quenchers were also obtained and are shown in Fig. Supp. 4. 
 
 
 
Figure Supp. 3: Measured absorbance spectrum of the FAM-TAM construct. This measurement was conducted once. 
 
 
 
 
0.1184
(@495nm)
0
0.02
0.04
0.06
0.08
0.1
0.12
0.14
400
500
600
700
Absorbance
Wavelength (nm)
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 7 of 64 
 Hassibi et al. 
  
Figure Supp. 4: Normalized measured absorbance spectrum of BHQ10 and BHQ2 quenchers. The measurement for each 
quencher was conducted once. 
 
B. Emission Spectra:  
A QuantaMaster QM-400 spectrofluorometer (PTI-Horiba) was utilized to obtain the emission spectrum 
of the FAM-TAM construct (5’-6-TAMN/TTT TTT /iFluorT/TT CCC TGA GCT GAA CGG GAA GC -3’). The 
oligo was diluted in distilled water to obtain a 100 µM stock solution. From the stock solution, a final 10 
nM analyte concentration with a total volume of 1000 µL was created in aqueous buffer (Tris-HCl, pH 8.7 
@ 25°C, [K+] = 55 mM, [Mg2+] = 3.5 mM). 
The emission spectrum of the 10 nM analyte measured at room temperature is shown in normalized 
units in Fig. 3 (cf., manuscript).  The excitation wavelength is 495 nm. 
 
C. FRET Efficiency Calculation: 
A linear superposition concept was employed to estimate the FRET efficiency of FAM-TAM construct, 
denoted here by 𝜂𝐹𝑅𝐸𝑇. If we assume 𝑓
𝐹𝐴𝑀(𝜆), 𝑓
𝑇𝐴𝑀(𝜆) and 𝑓
𝐹𝐴𝑀−𝑇𝐴𝑀(𝜆) are the emission spectra of 
FAM, TAM , and FAM-TAM, respectively, then we have  
 
𝑓
𝐹𝐴𝑀−𝑇𝐴𝑀(𝜆) = (1 − 𝜂𝐹𝑅𝐸𝑇)𝜙𝐹𝐴𝑀𝑓
𝐹𝐴𝑀(𝜆) + 𝜂𝐹𝑅𝐸𝑇𝜙𝐹𝐴𝑀𝑓
𝑇𝐴𝑀(𝜆),                    
(1) 
 
where 𝜙𝐹𝐴𝑀 ≅ 0.9 and 𝜙𝑇𝐴𝑀 ≅ 0.411,2 are the quantum yields of FAM and TAM, respectively.  
In Fig. Supp. 5, we show the measured emission spectra of the fluorophores. Using this data and 
applying (1), we estimated 𝜂𝐹𝑅𝐸𝑇  to be ~0.92. 
 
0
0.2
0.4
0.6
0.8
1
400
500
600
700
Normalized Abs.
Wavelength (nm)
BHQ10
BHQ2
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 8 of 64 
 Hassibi et al. 
 
 
 
 
 
 
 
(a) 
 
 
 
 
 
 
(b) 
 
 
 
 
 
 
(c) 
Figure Supp. 5: Measured emission spectrum of (a) FAM; (b) TAM; and (c) FAM-TAM. 𝝀𝟏 = 518 nm and 𝝀𝟐 = 583 nm. Each 
measurement was conducted once. 
 
 
 
 
0
0.2
0.4
0.6
0.8
1
450
500
550
600
650
700
Normalized Emission
Wavelength (nm)
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 9 of 64 
 Hassibi et al. 
D. Estimating Fluorophore-Quencher FRET Distance: 
The efficiency of FRET, 𝐸 has an inverse relationship with the sixth power of 𝑟, the donor-to-acceptor 
distance3, such that  
𝐸 =
1
1+( 𝑟
𝑅0)6 ,                                                                                                     (2) 
where 𝑅𝑜 is the Förster distance, defined as the distance where the 𝐸 = 50% efficient. Now, 𝑅𝑜 can be 
computed by the following4 
𝑅𝑜 = 0.211 (
𝑘2∅𝐷𝐽
𝜂4 )
1
6,                                                                           (3) 
where 𝜙𝐷 is donor quantum yield, 𝐽 is the spectral overlap between donor emission and acceptor 
absorption spectra, 𝜂 is the refractive index of the medium, and 𝑘2 is the dipole orientation factor 
between the FRET moieties. 
In FAM-TAM construct, we have two fluorophores that can be quenched, hence  𝑅𝑜 should be calculated 
individually for each one. Below, we show the values of 𝑅𝑜 for both pairs separately; FAM-BHQ10 and 
TAM-BHQ10. The simulated FRET efficiency vs. distance is shown in Fig. Supp. 6. 
 
FAM-BHQ10 
TAM-BHQ10 
𝜂 
1.33 
1.33 
𝜙𝐷 
0.91 
0.412 
𝑘2 
2/35 
2/35 
𝐽 
1.927x1015 (nm)4M-1cm-1  
1.291x1015 (nm)4M-1cm-1  
𝑅𝑜 
5.27 nm 
4.62 nm 
 
Table Supp. I: FRET Distance between donors and quenchers. 
 
 
Figure Supp. 6: Simulated FRET efficiency vs. intermolecular distance for FAM-BHQ10 and TAM-BHQ10 FRET pairs.  
0
0.2
0.4
0.6
0.8
1
0
2
4
6
8
10
Quenching Efficiency
Acceptor-Donor distance (nm)
FAM-BHQ10
TAM-BHQ10
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 10 of 64 
 Hassibi et al. 
Supplementary Note 5 
 
Description: 
Architecture, photo-sensor topology, pixel circuitry, and the measured results of 
the CMOS integrated circuit. 
 
 
A. Array Architecture 
Figure Supp. 7: Architecture of the CMOS biochip and its main functional blocks.  
 
The implemented biochip (Fig. Supp. 7) includes a 32×32 element biosensor array with 13 temperature 
sensor pixels. These pixels have an identical architecture to photo-sensing pixels (Fig. Supp. 8-13), 
except their photodiode is covered by metal layers. This blocks the photon flux and enables us to 
continually measure the temperature-dependent dark current of the pixels as a surrogate for the 
temperature on that coordinate. 
For readout, each element can be individually addressed through row and column decoders.  DOUT is the 
digital output of the column multiplexer which is sent off chip (to the FPGA) through a low voltage 
differential signaling (LVDS) buffer. All the necessary clocks, row and column select signals, the analog 
reference voltages and power supply (3.3V) are applied externally as shown above.  
The analog column reader is implemented for testing, debugging, and calibration. 
The on-chip heating element is a 2.5Ω passive multi-finger metal resistor, implemented using the top 
metal layer (M4) of the CMOS process to deliver up to 10W of power from a 5V source. This heater is 
distributed uniformly within the chip both in the biosensor array area and its periphery. 
The measured performance summary is listed in Fig. Supp. 14-17 and Supplementary Note 5.I. 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 11 of 64 
 Hassibi et al. 
B. In-pixel ΣΔ photo-sensor topology 
 
Figure Supp. 8: Circuit topology of the in-pixel ΣΔ photo sensor connected to the CMOS-compatible photodiode to detect 𝑰𝐩𝐡. 
 
C. Pixel Circuitry 
 
Figure Supp. 9: Detailed circuit implementation of the biosensor pixel. 
 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 12 of 64 
 Hassibi et al. 
C.1. Current Integrator (Transistor-Level) 
 
Figure Supp. 10: Transistor level implementation of the in-pixel current integrator with capacitive feedback. 
 
C.2. Quantizer and S&H 
 
Figure Supp. 11: Timing diagram and transistor level implementation of the in-pixel quantizer and the sample and hold 
circuitry. 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 13 of 64 
 Hassibi et al. 
C.3. Digital-to-Analog (DAC) Converter and Timing Diagram  
Figure Supp. 12: Timing diagram and transistor level implementation of the in-pixel digital-to-analog converter (DAC). 
 
D. Pixel Layout and Individual Circuit Blocks 
 
 
Figure Supp. 13: Layout of the biosensor pixel with the individual circuit blocks. 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 14 of 64 
 Hassibi et al. 
E. Measured External Quantum Efficiency (Q.E.) of the CMOS Photodiode (No Filter)  
 
 
 
 
 
Figure Supp. 14: Measured external quantum efficiency (Q.E) of the embedded photodiode. The data is the average of 1011 
pixels on a single CMOS chip. The measurement was conducted once. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 15 of 64 
 Hassibi et al. 
F. Measured Dark Current across the Array vs. temperature 
 
 
Figure Supp. 15: Measured dark current (𝑰𝐃) as a function of temperature. The average from 1024 pixels from one 
experiment is plotted with error bars showing the minimum and maximum range. The histogram shows the pixel count vs. 
𝑰𝐃 at 30°C and 90°C. 
 
G. Measured Photo Sensor Linearity (λX = 495 nm) 
 
Figure Supp. 16: Measured photo-sensor linearity vs. incident photon flux (495nm excitation wavelength). The plot shows 
the average of 1011 pixels from one experiment. 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 16 of 64 
 Hassibi et al. 
H. Signal-to-Noise (SNR) vs. Shot-Noise Limit 
 
 
Figure Supp. 17: The measured vs. theoretical signal-to-noise (SNR) ratio for high and low gain modes. Each measurement 
was conducted once. 
 
 
 
 
 
 
 
 
 
 
 
 
 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 17 of 64 
 Hassibi et al. 
I. 
Chip Performance Summary 
 
 
 
 
 
 
Table III: Chip Performance Summary
Table III: Chip Performance Summary 
Technology 0.25 μm CMOS  
Supply voltage 2.5V 
Die dimensions 7.0mm x 9.0mm 
Array dimensions 32 x 32 
Biosensor size  100μm  x 100μm 
Photodiode 50μm  x 50μm (Nwell-Psub) 
Photodetector dark current (𝑰𝒅𝒄) 20 fA (30°C) – 5.5 pA (90°C) 
Photodetector 𝑸𝑬(𝝀) >0.38 (500nm – 775nm) 
Frame rate (𝑩𝑾) 1Hz to 50Hz 
Well capacity (𝑸𝒘𝒆𝒍𝒍) 6.25 × 1010 e- (Low Gain) 
6.25 × 109 e- (High Gain) 
Maximum photocurrent (𝑰𝑫𝐦𝐚𝐱) 10nA (Low Gain) at fΣΔ = 100 kHz 
 1nA (High Gain) at fΣΔ = 100 kHz 
CLK1, CLK2 pulse width (𝒕𝚽𝟏,𝟐) 10ns – 100ns 
Detection linearity > 105 
Detection dynamic range (DDR) 116 dB  
Chip Output 102.4 Mbps LVDS serialized 
Heating/cooling rate 4°C/sec 
Operating temperature range 25°C – 100°C 
Temperature sensor resolution 0.3°C (for chip temperature 45°C - 100°C) 
Total power consumption 62mW (array) + 50mW (LVDS) + 6mW 
(analog column amplifiers) = 118mW 
 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 18 of 64 
 Hassibi et al. 
Supplementary Note 6 
 
Description: 
Emission filter structure and measured response.  
 
To measure fluorescence emission, the biochip utilizes an emission filter to selectively block the 
excitation light of the LED source while passing the emitted photons that originate from FAM-TAM 
constructs.  The cross section of the filter and its structure is shown in Fig. Supp. 18, and is made of two 
thin-film coatings, patterned and deposited on top of the CMOS chip.  
The first coating in our design is a traditional multi-layer dielectric long-pass optical filter, which consists 
of alternating layer of dielectric materials with different refractive index n1 and n2. Such a structure 
offers excellent rejection; yet its transmittance is highly angle-sensitive (defined by θ in the Fig. Supp. 
18).  
To mitigate this problem, a coating is used which is made of alternating layers of metal and dielectric 
materials. This metal-dielectric interference filter offers less rejection when compared to the full 
dielectric long-pass filter but it is less angle-sensitive. Combining the two filters permits us to build a 
filter with excellent rejection of the excitation light and minimum sensitivity to non-normal angles of 
incidence (AOI).  
Both coatings are carefully designed using Essential McLeod Software (Thin Film Center, Tuscon, AZ).  
The simulated filter responses are shown in Fig. Supp. 19. As explained in Fig. 3 (cf. manuscript), the 
filter has to block the excitation light in the 440-480 nm wavelength range while permitting the emitted 
light in the 600-700nm range.  The optical density (OD) of the complete stack is > 6 for AOI of 0° and 30°. 
Even at high AOI of 60°, the effective OD for excitation wavelength of 470nm is 4.12.  Also, the top layer 
thickness is adjusted to maximize the E-field at the filter-solution interface to ensure proper excitation 
of the fluorophores at the interface.  The measured transmittance of the filter in presence of the PCR 
reagents and the fluidic cap is shown in Fig. Supp. 20. 
 
Figure Supp. 18: CMOS biochip cross-section with the excitation filter structure. 
n1
n2
n1*
n2*
ϴ
Multi-Layer Dielectric Filter
Metal-Dielectric Filter
CMOS chip
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 19 of 64 
 Hassibi et al. 
 
Figure Supp. 19: Simulated filter response for the filter structure shown in Fig. Supp. 18. 
 
 
Figure Supp. 20: Measured transmittance of the filter in presence of the PCR reagents and the fluidic cap. All the 
experiments, including spectral scans and transmittance measurements, were conducted once. 
 
 
Wavelength (nm)
Transmittance (%)
Excitation
OD: 4.19
Passband
AOI : 60°
AOI : 0°
AOI : 30°
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 20 of 64 
 Hassibi et al. 
Supplementary Note 7 
 
Description: 
Variations, failure rates, and prototype manufacturing/assembly yields. 
 
Component 
Parameter 
Observed 
Variations/Error 
Mitigation/Calibration  
Process 
CMOS IC 
Electronic 
functionality 
(analog/digital) 
~2/250 non-functional  
Functionality test prior to 
biochip assembly 
Photo-sensing 
quantum 
efficiency (Q.E.) 
< 10% variation 
Correct using the normalization 
probes   
Dark Current (Id) 
< 40% variation 
Correct using CDS  
  
  
  
  
Emission Filter 
Transmittance 
None 
Verify each wafer coating run 
prior to biochip assembly 
  
  
  
  
Probe Printing 
Surface 
Functionalization 
< 10% water contact angle 
variation 
Verify expected witness 
coupon water contact angle 
and recorded instrument 
process parameters 
Probe Printing 
< 5% devices scrapped 
due to spot diameter or 
spot placement accuracy 
or probe signal out of 
range 
Real-time instrument optical 
droplet confirmation and 
fiducial alignment score, batch 
sampling and fluorescence 
imaging of assay and control 
probes.  
  
  
  
  
Fluidic Cap* 
Mechanical 
~20% have defects 
Inspect and discard imperfect 
components prior to biochip 
assembly 
Optical 
~10% have small scratches 
Inspect before assembly 
  
  
  
  
Setup/Instrument 
Temperature 
Control 
0.3°C 
Calibrate after each 10 
experiments 
  
  
  
  
CMOS Biochip 
Experiments  
Sample Quality 
Varied 
Quantify using qRT-PCR process 
every week or 10 experiments  
Reaction Mix 
Varied 
Verify using assay CNTRL(+) 
RT-PCR 
15% formed bubbles* 
Disqualify experiment 
* The fluidic cap used in this research was a prototype and had the lowest yield among all components. 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 21 of 64 
 Hassibi et al. 
Supplementary Note 8 
 
Description: 
Reader instrument of the CMOS biochip platform. 
 
 
Figure Supp. 21: Reader instrument block diagram and its interface with the CMOS biochip module. 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 22 of 64 
 Hassibi et al. 
Supplementary Note 9 
 
Description: 
Methods for CMOS biochip data acquisition and analysis. 
 
In this supplementary, we discuss how we dealt with non-idealities of the measurements such as sensor 
additive noise, excitation light non-uniformity and etc.  
 
A. Dark Current Subtraction 
Dark current subtraction is the first step in data processing for the photo-sensor pixels. Dark current, 
denoted here by 𝐼𝑑, is a temperature-dependent additive value that is added to photocurrent signal. Its 
value is not constant during the experiments and can change by 2 orders of magnitude over the course 
of the melt phase. A correlated double sampling (CDS) technique is used to eliminate the undesired 
effect of 𝐼𝑑 from the photocurrent reading (see Fig. Supp. 22). The output of the photo-sensor is 
measured twice, once without excitation light (LED-OFF), and once with excitation light (LED-ON).  
 
 
Figure Supp. 22: Concept of correlated double (CDS) sampling to remove dark current, 𝑰𝒅.   
 
For a given LED-ON cycle, n chip reading frames are down-sampled to one by using the mean frame 
value. For that specific frame, 𝐼𝑑 is defined to be the average of the measurements during two adjacent 
LED-OFF cycles. Therefore, the photocurrent, 𝐼𝑝ℎ(𝑖), is computed by 
 
𝐼𝑝ℎ(𝑖) = 
1
𝑛 ∑
𝐼(𝑖 + 𝑘) −
1
2
𝑛
𝑘=1
[
1
𝑛 ∑
𝐼𝑑(𝑖 + 𝑘 − 𝑛) +
1
𝑛
𝑛
𝑘=1
∑ 𝐼𝑑(𝑖 + 𝑘 + 𝑛)
𝑛
𝑘
],                  (1) 
 
where 𝐼(𝑡) is the measurement during LED-ON cycle and 𝐼𝑑(𝑡) is the measurement during LED-OFF cycle.
 
 
 
 
B. Background Subtraction 
Background subtraction corrects for any excitation light that passes through the filter and reaches the 
photodiode. To do that, specific pixels are left “blank” and without FAM-TAM probes and hence their 
corresponding readings are used to estimate background signal across the array.  
 
C. Calibration 
In the array, we take advantage of calibration probes with unique sequences that do not hybridize to 
any of the amplicons or primers. The purpose of using these probes is to: (1) Measure the temperature-
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 23 of 64 
 Hassibi et al. 
dependent quantum yield, bleaching, probe detachment or any other amplitude-affecting characteristic 
of fluorophore emission in the pixels; and (2) use the information to calibrate (correct) the signals of the 
other probes. The two assays (URP and MTB) described in this manuscript use 15 calibration probe 
replicates. The calibration signal, 𝐼𝑐
̅, is calculated after the removal of outliers from the set of calibration 
probe replicates, 𝐼𝐶(𝑖), where 
𝐼𝑐
̅ =
1
𝑛 ∑
𝐼𝐶(𝑖)
𝑛
𝑖=1
.                                                                    (2) 
In Fig. Supp. 23a and Fig. Supp. 23b, as an example, we show signal of probe D516V from the MTB 
assay, before and after calibration, respectively. As evident, prior to calibration, the signal decreases as a 
function of temperature after the melt has occurred. This is because of the quantum yield of the 
fluorophore decreases with increasing temperature, producing the temperature dependence. After 
calibration, the temperature dependence is corrected and the signal does reach the expected plateau. 
 
 
(a)                                                                                        (b) 
Figure Supp. 23: Signal from D516V WT probe from MTB Assay (a) before and (b) after calibration. The curves are the mean 
of 5 replicate probes from one experiment. 
D. De-noising 
The goal of de-noising is to compensate for errors in the data due to random fluctuations (e.g., thermal 
noise, shot noise, LED fluctuation and spontaneous drifts).  To accomplish this, we find the closest 
smooth signal 𝑥 to the measurements 𝑦 by penalizing the changes of the output signal 𝑥 by the penalty 
factor 𝜆. In the specific case of solid-phase melting curve analysis all signals should monotonically 
increase; therefore a non-decreasing constraint has been considered. 
 
The de-noising algorithm begins with a set of T noisy measurements that form the melting curve. Let 𝑥 
be the de-noised signal. The following formulation gives the convex optimization equation with the 
applied constrained to calculate 𝑥. 
 
 
min ‖𝑦 − 𝑥‖2 +  𝜆 ∑
(𝑥𝑖+1 − 𝑥𝑖)2
𝑇−1
𝑖=0
                                                      (3) 
𝑠. 𝑡.    𝑥𝑖+1 − 𝑥𝑖 ≥ 0.  for  𝑖 = 0, … , 𝑇 − 1 
 
 
 
 
 
     
To solve (3), we reformulate it to 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 24 of 64 
 Hassibi et al. 
 
𝑥 = (
𝑥0
𝑥1
⋮
𝑥𝑇−1
)  = (
𝑥0
𝑥0 + 𝛿1
⋮
𝑥0 + 𝛿1 + ⋯ + 𝛿𝑇−1
) = 𝟏𝑥0 + (
0
0
…
0
1
0
…
0
⋮
1
⋮
⋱
1
…
⋮
1
) (
𝛿1
𝛿2
⋮
𝛿𝑇−1
) = 𝟏𝑥0 + 𝑳𝜹 . 
 (4) 
 
 
Therefore, the optimization problem can be re-written in terms of 𝜹 as follows: 
 
min ‖𝑦 − 𝟏𝑥0 − 𝑳𝜹‖2 +  𝜆‖𝜹‖2                                                                (5) 
 
 
                                s.t. 𝜹 ≥ 𝟎 
 
 
 
 
 
 
Now, to remove the dependency on the decision variable 𝑥0, we find its optimal value by minimizing the 
objective with respect to it 
𝑥0 = 
𝟏′(𝑦−𝑳𝜹)
𝑇
                                                                            (6) 
 
 
 
 
 
 
By substituting 𝑥0 into (5), this equation can be expressed as the maximization of its dual function: 
 
max min(𝑦 −  𝑳𝜹)′(𝐼 − 
𝟏𝟏′
𝑇 )(𝑦 − 𝑳𝜹) +  𝜆‖𝜹‖2 − 2𝝁′𝜹                                (7) 
 
 
                      s.t  𝝁 > 𝟎 & 𝜹 ≥ 𝟎 
 
 
 
 
 
By applying KKT conditions to (7), we can use Algorithm 1, defined below, in order to compute 𝑥 in an 
iterative manner. 
𝜹 = [𝑺(𝐼𝛿, 𝐼𝛿)]−1𝑳(𝐼𝛿, : )′(𝑰 −
𝟏𝟏′
𝑇 )𝑦, and                                                 (8) 
 
𝝁 = 𝑺(𝐼𝜇, 𝐼𝛿)𝜹 − 𝑳(𝐼𝜇, : )′(𝑰 −
𝟏𝟏′
𝑇 )𝑦,                                                    (9) 
where 𝑆 =  𝜆𝐼 + 𝑳′(𝑰 −
𝟏𝟏′
𝑇 )𝑳 
 
Algorithm 1: De-noise by applying increasing constraint 
 
Input: Noisy observations 𝑦𝜖ℝ𝑇,smoothing coefficient λ and maximum number of iterations n 
1: Initialization: 𝐼𝛿 ← [1 2 … 𝑇], 𝐼𝜇 ← ∅, 𝑙 ← 1 
2: do 
3: 
Find 𝛿[𝑙]from equation 10, given 𝐼𝛿
[𝑙−1] 
4: 
if 𝛿[𝑙]  ≥ 0 𝑡ℎ𝑒𝑛 
5: 
 
break 
6: 
end if 
7:  
Find 𝜇[𝑙]from equation 11, given 𝐼𝜇
[𝑙−1] 
8: 
𝐼𝛿
[𝑙] ← (𝛿[𝑙]  ≥ 0) + (𝜇[𝑙] < 0) 
9: 
𝐼𝜇
[𝑙] ← (𝛿[𝑙] < 0) + (𝜇[𝑙] ≥ 0) 
10: 
𝑙 ← 𝑙 + 1 
11: while 𝑙 < 𝑛 
 
Output 𝑥 ← 𝑥0𝟏 + 𝑳(𝐼𝛿
[𝑙])′ 𝛿[𝑙] 
 
 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 25 of 64 
 Hassibi et al. 
E. Calculate Mutation “Score” 
The MTB assay requires not only the detection of the amplicon, but also a decision as to whether the 
WT or MT strain is present at each mutation site. To do this, we compute the integral of the area 
between the WT and MT probes. 
If 𝑁 is the number of measurements during the melt reaction, 𝐼𝑤 is the de-noised WT signal and 𝐼𝑀 is 
the de-noised MT signal, then we can define 𝑆, the score by  
 
𝑆 = 
1
𝑁 ∑
𝐼𝑊(𝑖) −
𝑁−1
𝑖=0
𝐼𝑀(𝑖)                                                                  (10) 
 
Now if 𝑆 ≥ 0 for a specific probe pair, we conclude the WT target is present, and if 𝑆 < 0, the MT is 
present. Fig. Supp. 24 shows the averaged raw data for a probe pair before and after de-noising and 
applying the increasing constraint. 
 
 
 
 
(a)                                                                                                          (b) 
 
Figure Supp. 24: Average MT-WT results (a) before and (b) after de-noising (𝒏 = 𝟓 replicate probes in one experiment).  
 
 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 26 of 64 
 Hassibi et al. 
Supplementary Note 10 
 
Description: 
Materials and methods for in-silico design of real-time probes and multiplex PCR 
primers used in the CMOS biochip platform. 
 
A. Thermodynamic Simulation Software Tools 
Optimal design of both primers and probes requires examination of the structure of the amplicon in the 
assay physiochemical condition. In this project, we have used Oligonucleotide Modeling Platform (OMP) 
software package (DNA Software, MI) to simulate the interactions of one or more oligonucleotides 
under user-specified solution conditions. This software computes a multi-state equilibrium model of 
competing interactions that considers the random coil state and a user-specified number of possible 
conformations6. Parameters that can be defined as input include, but not limited to the initial 
concentrations of each species, the temperature, monovalent and divalent ion concentrations, the 
concentrations of various additives, and the maximum number of suboptimal conformations of each 
species to consider.  
OMP is also capable of constructing a simulated melt curve for an oligonucleotide’s hybridization to an 
amplicon by running simulations at a variety of temperatures. OMP also calculates the energy required 
to unfold each region of the amplicon structure (target unfolding ΔGo); this output is particularly useful 
for selecting optimal regions for primer design in cases of highly structured amplicons. 
We have created a suite of in house tools in Perl and MATLAB to perform various functions relating to 
OMP simulations, including: 
1. Generation of probe candidates around mutation sites; 
2. Creation and evaluation of sticky-end probe candidates; and 
3. Automation of OMP simulations and extraction of relevant metrics. 
 
B. Primer Design for Multiplex PCR 
Our approach to primer design and qualification using OMP includes the following steps: 
1. Selection of regions for primer design: For highly structured amplicons, we use local unfolding 
energies calculated by OMP to focus primer design on regions that are most likely to be 
accessible for binding. 
2. Ensure that OMP predicts that the binding of the primer to the template is thermodynamically 
favorable. 
3. Ensure that the primer is predicted to exist primarily in a random coil state. 
4. Ensure that the region of the template, to which the primer binds, is accessible. In cases where 
no such region can be found, we place as much of the primer as possible in a random coil 
portion of the amplicon that we term the anchor region. This method as applied to probe design 
is described below; the application to primer design is analogous. 
5. Eliminate primers that are capable of self-priming.  
6. Eliminate amplicons that are capable of self-priming. 
7. Primer-dimer check: Once primers for the single-plex assays are designed, we check all possible 
pairs of primers for their potential to form primer dimers and redesign where necessary. 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 27 of 64 
 Hassibi et al. 
 
The URP assay utilizes primer regions previously described in the literature7-8, which were then 
subjected to the review described and possible redesign discussed above. Primers for the MTB assay 
were either designed using Primer39or were designed manually before undergoing the review described 
above. 
 
C. Probe Design 
In the NAAT assay presented in the manuscript, three (3) distinct probe design methodologies have 
been used: 
1. Quantification probes to monitor the depletion of the limiting primers during multiplex PCR. 
These probes were used in the URP assay. 
2. Detection probes to examine presence or absence of the target. These probes were used mainly 
in URP assay. 
3. SNP identification probe pairs to detect mutations within the ROIs. These probes were used in 
the MTB assay.   
 
C.1. Quantification Probes 
Each quantification probe for the URP assay is the reverse complement of, 𝑝𝑟, the limiting primer whose 
depletion it is designed to detect. The probe is labeled with FAM-TAM at its 3’-end, and its fluorescence 
is quenched when the BHQ2-labeled limiting primer binds. All simulations include the poly-T spacer at 
the 5’-end of the probe as described in manuscript and a 7-base poly-T stretch at the 3’-end as a stand in 
for FAM-TAM, which OMP is currently unable to simulate directly. Quantification probe sequences for 
the URP assay are given in Table Supp. II. 
 
PRIMER 
PRIMER SEQUENCE (5’->3’) 
SIMULATED PROBE SEQUENCE (5’->3’) 
FluA-1 
Limiting 
BHQ2-GTAAGGCTTGCATGAATGTTATTTGCTC 
TTTTTTGAGCAAATAACATTCATGCAAGCCTTACTTTTTTT 
FluA-2 
Limiting 
BHQ2-AGGGCATTYTGGACAAAKCGTCTA 
TTTTTTTAGACGCTTTGTCCACAATGCCCTTTTTTTT 
FluB 
Limiting 
BHQ2-CGGTGCTCTTGACCAAATTGG 
TTTTTTCCAATTTGGTCAAGAGCACCGTTTTTTTT 
RSV 
Limiting 
BHQ2-TCTTTTTCTAGGACATTGTAYTGAACAG 
TTTTTTCTGTTCACTACAATGTCCTAGAAAAAGATTTTTTT 
Para-2 
Limiting 
BHQ2-ACCTCCTGGTATAGCAGTGACTGAAC 
TTTTTTGTTCAGTCACTGCTATACCAGGAGGTTTTTTTT 
Adv-C 
Limiting 
BHQ2-GCCACAGGTCCTCATATAGCAA 
TTTTTTTTGCTATATGAGGACCTGTGGCTTTTTTT 
Adv-E 
Limiting 
BHQ2-CCTGGCTGTTATTTTCCACCAAC 
TTTTTTGTTGGTGGAAAATAACAGCCAGGTTTTTTTT 
 
Table Supp. II: URP assay quantification probe sequences. A poly-T spacer is added to the 5’-end of the reverse complement 
of the corresponding limiting primer sequence, and a 7-base poly-T stretch is added to the 3’-end to represent FAM-TAM in 
simulations. Limiting primers are labeled with black hole quencher 2 (BHQ2) at the 5’ end. 
 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 28 of 64 
 Hassibi et al. 
C.2. Detection Probes 
The detection probes used in the URP assay are designed to produce a signal when a particular target is 
present, and are placed close to the excess primer in order to facilitate the “sticky-end probe design” 
described in manuscript and below. In certain cases, we instead used probes described in the literature6-
7. All probes were simulated using OMP to ensure that the binding of the probe to the amplicon is 
thermodynamically favorable and that, whenever possible, the probes and their binding sites on the 
amplicon exist in a random coil state. Probes are simulated with the 5’ poly-T spacer and a 7-base poly-T 
stretch at the 3’-end.  
After these probes are designed, we convert them into probes that can capture the 5’-end of the primer 
region, i.e., the “sticky-end method”. This novel technique brings the quencher into close proximity of 
the fluorophore without the need for incorporation of quencher-modified nucleotides into the 
amplicon. To accomplish this, we attach a fluorophore to the 3’-end of the probe and a quencher to the 
5’-end of the excess primer so that the single-stranded amplicons produced by asymmetric PCR are 
quencher-labeled at the 5’ end. Then, in order to bring the 5’ end of the amplicon in close proximity to 
the fluorophore-labeled probe, we add a small number of bases to the 3’ end of the probe that are 
complementary to the 5’ end of the excess primer. These “sticky end” probes then hybridize to both the 
5’-end of the amplicon and to the region that is complementary to the original probe design. An 
example of this design is given in Fig. Supp. 25. 
 
Figure Supp. 25: “Sticky-end probe design”. (A) OMP predicts that the binding site for the probe is largely located in a 
random coil region of the most thermodynamically favorable conformation of the Para-2 amplicon. (B) Binding of the probe 
brings the 5’-end of the amplicon into close proximity of the 3’-end of the probe, which allows for contact quenching of the 
amplicon’s fluorophore. 
 
The sticky end of the probe must be sufficiently long to capture the 5’-end of the amplicon at the 
hybridization temperature while minimizing background signal produced by binding to the excess primer 
itself (Fig. Supp. 26). To balance these two competing factors, we create a series of probes with 4-15 
bases complementary to the 5’-end of the excess primers. We then run thermodynamic simulations of 
these candidates using OMP in the presence of either the amplicon or the excess primer and evaluate 
them for their ability to discriminate between these two species. For instance, in Fig. Supp. 27, adding 
11 bases that are complementary to the Para-2 excess primer yields a probe with a large separation 
between the melt curves at the hybridization temperature for the excess primer versus the amplicon.  
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 29 of 64 
 Hassibi et al. 
 
Figure Supp. 26: Sticky end probe design. (A) A short stretch of bases that are complementary to the excess primer (the 
primer section) is added to the probe in order to capture the 5’ end of the amplicon and bring the quencher in close 
proximity to the probe’s fluorophore. (B) If the primer section is too short, it will not capture the amplicon. (C) If it is too 
long, however, it will capture the excess primer and give rise to background signal. These competing effects determine the 
optimal length of the primer section. 
 
C.3. SNP Identification Probe Pairs 
The M. Tuberculosis (MTB) genotyping assay uses probe pairs that are designed to discriminate between 
the wildtype (WT) and mutant (MT) sequences. A flow chart of the probe design process is given in Fig. 
Supp. 28. For each mutation coordinate, we generate probe candidates by moving sliding windows of 
lengths 15 through 25 along the sequence such that the mutation is kept within the middle third of the 
probe. These specific lengths are selected to ensure that we create an exhaustive probe candidate list 
applicable to both CG-rich and AT-rich genomic regions. At each location for this window, we generate a 
pair of probes in which one probe is complementary to the wildtype target and the other probe is 
complementary to the target containing the mutation.  
We next assess in silico each candidate probe pair’s ability to discriminate between the wildtype and 
mutant sequences by simulating a melt curve at thermodynamic equilibrium using OMP. Clearly, 
sequence mismatches between the probe and its binding site on the amplicon will decrease the strength 
of the hybridization relative to a perfect match, and hence probes with more mismatches will begin to 
dissociate from the amplicon at lower temperatures than probes with fewer mismatches. This leads to a 
shift in the melt curve for the wildtype target bound to the mutant probe relative to the wildtype target 
bound to the wildtype probe, and similarly for the mutant target (Fig. Supp. 29). InSilixa’s assay makes 
use of the shifts in these characteristic melt curves to determine whether the target contains the 
wildtype or mutant sequence.  
 
A.�
Amplicon�
bound�
to�
sticky�
end�
probe;�
quenching.
B. Amplicon�
incompletely�
bound�
to�
sticky�
end�
probe;�
no�
quenching.
C.�
Quencher�
labeled�
primer�
bound�
to�
probe;�
quenching.
Fluorophore
Probe
(attached�
to�
surface)
Sticky�
end
Quencher
Amplicon
Fluorophore
Quencher
Primer
Probe
(attached�
to�
surface)
Contact�
quenching
Contact�
quenching
Fluorophore
Amplicon
Quencher
Amplicon
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 30 of 64 
 Hassibi et al. 
 
Figure Supp. 27: The sticky end must be sufficiently long to capture the 5’ region of the amplicon to allow quenching to 
occur, but not so long that it captures the excess primer itself and gives rise to background signal. Melt curves for both cases 
simulated by OMP allow for selection of a sticky end probe length that balances these competing factors. In the case of the 
Para-2-pb1 probe from the URP panel, a sticky end length of 11 bases minimizes background signal from the primer (blue) 
and maximizes signal from the amplicon (red). The hybridization temperature of 55C is indicated by a dashed line. 
 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 31 of 64 
 Hassibi et al. 
 
Figure Supp. 28: The design process for SNP detection probes. 
 
 
Figure Supp. 29: Differential melt curves for mutation detection. (A) Two mutations in close proximity are detected using two 
separate probe pairs. In this case, the amplicon contains the mutant base at position 1 (top) and a wildtype base at position 
2 (bottom). (B) Each probe pair gives rise to a pair of melt curves in which the probe that more closely matches the 
amplicon’s sequence gives rise to a melt curve that is shifted towards higher temperatures. (C) This separation between the 
melt curves allows us to determine whether the amplicon contains the wildtype or the mutant base at the position the probe 
pair assays. 
Automatic�
generation�
of�
probe�
pair�
candidates
OMP�
simulation�
of�
WT�
and�
MT�
amplicons�
against�
WT�
and�
MT�
probes
≥50%�
of�
amplicon�
hybridized�
to�
matching�
probe?
All�
4�
TM values�
between�
50°C�
and�
80°C?
Reject�
probe�
pair
Reject�
probe�
pair
No
No
Simulated�
melt�
curve�
analysis
Yes
Yes
Rank�
probe�
pairs�
and�
select�
best�
candidate
Design�
anchor-based�
probes
Input:�
location�
of�
SNP
Select�
candidates�
passing�
both�
tests
Experimental�
testing�
of�
probe�
pair
Good�
discrimination�
between�
WT�
and�
MT?
No
Accept�
probe�
pair
Yes
A.�
SOLID�
PHASE�
CAPTURING
x
x
x
x
x
x
g1
Amplicon
(ssDNA)
g1
Amplicon
(ssDNA)
Mutation�
Probe�
(g1,1)
Wild-Type�
Probe�
(g1,1)
Mutation�
Probe�
(g1,2)
Wild-Type�
Probe�
(g1,2)
1
2
B.�
�
MELT-CURVE�
ANALYSIS
C.�
DETECTION�
/�
BASE�
CALLING
Temp
Temp
Signal
Signal
W
M
W
M
(g1,1)�
Mutation
(g1,2)�
Mutation
(g1,1)�
:�
�
�
�
�
�
�
�
�
MUTANT�
(g1,2)�
:�
�
�
�
�
�
�
�
�
WILD-TYPE
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 32 of 64 
 Hassibi et al. 
We select the best wildtype/mutant probe pair by simulating melt curves for each probe’s hybridization 
to both the wildtype and mutant amplicon and ranking them by a heuristic parameter that increases as 
the area between the two pairs of resulting melt curves increases. This parameter is given by 
1
𝑁 √∑
(
Tmax
Tmin (𝐶WW − 𝐶MW)2 + (𝐶MM −  𝐶WM)
2)                                        (1) 
in which 𝐶WW is the concentration of the wildtype probe bound to the wildtype target, 𝐶MW is the 
concentration of the mutant probe bound to the wildtype target, 𝐶WM is the concentration of the 
wildtype probe bound to the mutant target, 𝐶MM is the concentration of the mutant probe bound to the 
mutant target, and 𝑁 is the number of temperatures at which these concentrations where calculated. 
Furthermore, we reject probes that bind to their intended targets with a TM of less than 50C or greater 
than 80°C, or for which less than 50% of amplicons are expected to bind to probe at the hybridization 
temperature. 
  
C.4. Anchor-based Probes 
In some cases probes cannot be placed in random coil regions, typically because a mutation we wish to 
detect is buried within a hairpin structure and hence is not readily accessible for binding to a probe. For 
instance, the A74S and D94G gyrA mutations on the TB1 amplicon are located within hairpins with high 
melting temperatures (Fig. Supp. 30a). To overcome this problem, we examine the secondary structure 
of the amplicon under the hybridization conditions and pick the nearest 12 -15 bases that are more 
readily accessible and that therefore can act as an anchor for probe binding. Once the anchor region 
binds, the remainder of the probe is able to compete more effectively for the portion of the binding site 
that is located within secondary structure. For example, an anchor consisting of bases 38-51 is used to 
aid detection of the A74S mutation (GCC-74-TCC) located in the first hairpin of the TB1 amplicon. 
In another example, bases 88-100 are selected to anchor the D94G mutation (GAC-94-GGC). However, 
the anchor region for the D94G probe is somewhat distant (18 bases) from the mutation site. In this 
case, the probe is designed to bind to two non-contiguous regions on the amplicon (positions 88-100 
and 112-128 in Fig. Supp. 30a) to enable discrimination between WT and MT sequences; inclusion of the 
intervening bases 101-111 in the probe would give rise to melt curves too similar for discrimination of a 
one base mismatch between the wildtype probe and mutant amplicon sequence (or vice versa). Six 
probe bases between the two regions are added to reduce steric hindrance without base pairing with 
the amplicon. The structure of the D94G probe bound to the amplicon is shown in Fig. Supp. 30b; OMP 
predicts that over 99% of both the wildtype and mutant amplicons will bind to the probes with exact 
sequence matches at thermodynamic equilibrium, and experimental results confirm that binding occurs 
at a rate that is sufficient for detection.  
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 33 of 64 
 Hassibi et al. 
 
   
Figure Supp. 30: Anchor-based probe design. (A) The A74S and D94G mutations in the TB assay’s gyrase A TB1 amplicon are 
both located within hairpin structures. Anchor regions consisting of significant stretches of bases that are more readily 
accessible to the probe serve to drive the kinetics of binding. (B) The D94G probe binds to two discontinuous regions of the 
amplicon, which keeps the probe length short enough to allow for discrimination of the bases while still taking advantage of 
the availability of a somewhat distant anchor site. 
 
 
 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 34 of 64 
 Hassibi et al. 
Supplementary Note 11 
 
Description: 
URP detection and quantification assay. 
 
 
The multiplexed URP assay discussed in the manuscript was first designed and verified using 
conventional molecular biology and PCR techniques. Subsequently, the optimized primers and probes 
were transferred to the CMOS biochip platform. Furthermore, in certain cases, the results generated 
were verified after CMOS biochip experiments. In this supplementary, we describe the methods 
employed and provide additional results and analysis. 
 
A. Materials and Methods 
A.1. Samples and Nucleic Acid Templates 
Synthetic nucleic acid templates for multiplex assay development and standard curve generation.  
Synthetic target DNA (ssDNA, dsDNA) was obtained from LGC BioSearch Technologies (Novato, CA) as 
PAGE purified material provided in Tris-HCl pH 8.5 at 1X106copies/µl.  Single stranded RNA (ssRNA) was 
produced via transcription from chemically synthesized double stranded DNA (dsDNA) containing an SP6 
promoter, DNaseI digested, PAGE purified and provided in sodium citrate pH 6.4 at 1X106copies/µl. All 
synthetic materials were separated into 10ul aliquots, stored at -80⁰C and used once as needed (to 
prevent freeze-thaw cycles). The sequences of the synthetic nucleic acids used to develop the assay and 
for standard curve generation along with the genome regions from which they originate and the viral 
genes they code for are listed in Table Supp. III.  
 
Whole genome material used for multiplex NAAT.  Total nucleic acid extracts from cultured viral material 
containing whole viral genomes was used for multiplex NAAT on chip (Fig. 4, and Fig. Supp. 31) 
experiments.  Two sources for whole genome material were used:  
I. 
 Inactivated, cultured viruses (NATrol® controls) purchased from Zeptometrix Corporation 
(Buffalo, NY).  For RNA viruses, RNA was extracted from this material using standard 
QIAamp® Viral RNA Mini Kit part number (p/n) 80204 (Qiagen, Hilden Germany) as per 
manufacturer’s instructions and quantitated using qRT-PCR as described below. For DNA 
viruses, DNA was extracted from this material using QIAmp® DNA/RNA Mini Kit p/n 52904 
(Qiagen) as per manufacturer’s instructions and quantitated using qPCR as described 
below.   
 
II. 
Total nucleic acid extracts from viral culture material were obtained from American Type 
Culture Collection (ATCC, Manassas, VA) and quantitated using qPCR as described below.  
Upon completion of nucleic acid extraction or receipt of total nucleic acid extracts, samples were split 
into 10µl aliquots and stored undiluted at -80⁰C and each aliquot used once as needed.  
 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 35 of 64 
 Hassibi et al. 
Table Supp. III: URP Assay Amplicons/Synthetic Nucleic Acid Sequences 
Amplicon 
Name 
Viral 
Gene 
Genome 
Region 
Sequence 
FluA-1 
NS1 
Segment 8 
Bases 636-793 
GGACCTCCACTTACTCCAAAACAGAAACGGAAAATGGCGAGAACAACTAGGTCAAAAGTTC
GAAGAGATAAGATGGCTGATTGAAGAAGTGAGACACAGACTGAAAACAACTGAGAATAGT
TTTGAGCAAATAACATTCATGCAAGCCTTAC 
FluA-2  
M 
Segment 7 
Bases 171-276 
GACCAATCCTGTCACCTCTGACTAAGGGGATTTTAGGATTTGTGTTCACGCTCACCGTGCCC
AGTGAGCGAGGACTGCAGCGTAGACGCTTTGTCCAAAATGCCCT 
FluB  
NS1 
Segment 8 
Bases720-822 
TCCTCAACTCACTCTTCGAGCGTCTTAATGAAGGACATTCAAAGCCAATTCGAGCAGCTGAA
ACTGCGGTGGGAGTCTTATCCCAATTTGGTCAAGAGCACCG 
RSV  
M 
3179-3262 
GGCAAATATGGAAACATACGTGAACAAACTTCACGAAGGCTCCACATACACAGCTGCTGTT
CAATACAATGTCCTAGAAAAAGA 
Para-2  
F 
7451-7540 
GCATTTCCAATCTTCAGGACTATGAAAACCATTTACCTAAGTGATGGAATCAATCGCAAAAG
CTGTTCAGTCACTGCTATACCAGGAGGT 
Adv-C  
E1A 
919-1100 
TCGATCTTACCTGCCACGAGGCTGGCTTTGCACCCAGTGACGACGAGGATGAAGAGGGTGA
GGAGTTTGTGTTAGATTATGTGGAGCAGCCCGGGCACGGTTGCAGGTCTTGTCATTATCACC
GGAGGAATACGGGGGACCCAGATATTATGTGTTCGCTTTGCTATATGAGGACCTGTGGC 
Adv-E  
E4 
34196-34349 
TGCAATTTTGTTGGGTTTCGATAACGGCGGGGGAGGGAAGAACAGGAAGAACCATGATTA
ATTTTATTCCAAACGGTCTCGGAACACTTCAAAATGCAGGTCCCGGAGGTGGCACCTCTCGC
CCCCACTGTGTTGGTGGAAAATAACAGCCAGG 
Pos. Cont. 
N/A 
N/A 
ATGGAGCGAATCCAGCAAACAGATAGATAATGAATCTCACTTTCACCGGATGGCCAATCCA
ATTCGCTTTATGATAACAATCTGTGATTGTCACCATAAGCAGCCACAATAAAATAAAAGGAA
ACACGGACACCCAAAGTAGTCGGTTCCGCCACGGACTTGCGCGTTACGACAGGCCAATCAC
TGG 
 
Data reported in Fig. 4b and Fig. 4c utilized a dilution series (10,000 copies/µl, 3,000 copies/µl, 1,000 
copies/µl, 300 copies/µl, 100 copies/µl) of Influenza A total nucleic acid extracts obtained from ATCC: 
VR-1680D Influenza A RNA, strain A/Aichi/2/68 (H3N2) plus synthetic polio RNA positive control (8,000 
copies/µl in each sample) performed in triplicate experiments. 
Data reported in Fig. Supp. 31a utilized 10,000 copies/µl of Influenza A total nucleic acid extracts 
obtained from ATCC: VR-1680D Influenza A RNA, strain A/Aichi/2/68 (H3N2) plus synthetic polio RNA 
positive control (8,000 copies/µl) 
Data reported in Fig. Supp. 31b utilized a mixture of total nucleic acid extracts from Influenza B (RNA 
virus) [NATtrol™ NATFLUB-ST Influenza B (B/Florida/02/06) Zeptometrix] spiked at high concentration 
(11,600 copies/µl) and Adenovirus E (DNA virus) at low concentration (170 copies/µl) [NATtrol™ 
Adenovirus Type 4 Stock Zeptometrix] plus positive control RNA (8,000 copies/µl).   
Data reported in Fig. Supp. 31c utilized a mixture of total nucleic acid extracts from: 
 
 
FluA [Influenza A/H3N2/Brisbane/10/07 NATtrol™ Flu Verification Panel Zeptometrix] at 1160 
copies/µl FluB [Influenza B/Florida/02/06 NATtrol™ Flu Verification Panel Zeptometrix] at 176 
copies/µl 
 
RSV-A [RSV A NATtrol™ Flu Verification Panel Zeptometrix] at 528 copies/µl 
 
Adenovirus C [AdvC ATCC VR-1: Adenovirus 1 strain Adenoid 71] at 232 copies/µl 
 
Adenovirus E [AdvE NATtrol™ Adenovirus Type 4 Stock Zeptometrix] at 17 copies/µl 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 36 of 64 
 Hassibi et al. 
 
Parainfluenza Virus 2 (PIV-2 NATtrol™ Respiratory Verification Panel Zeptometrix] at 72 
copies/µl 
 
Synthetic Poliovirus RNA (Positive Control) at 8,000 copies/µl 
 
Patient Clinical Samples.  Patient samples were collected with nasopharyngeal swabs, eluted into viral 
transport media and archived at -80°C.  One or more 200µL portions of each thawed sample were 
processed with the Qiagen EZ1 Virus Mini Kit v2.0 (p/n 955134) and supporting EZ1 Advanced XL 
instrument (p/n 9001492) and Virus Card v2.0 (p/n 9018708) (Qiagen, Hilden Germany).  Sixty microliter 
(60µL) elution volumes were divided into three equal 20µl aliquots, and stored at -80°C prior to use.  
Note: Each patient sample was previously tested with a respiratory virus panel (GenMark eSensor XT-8, 
Carlsbad, USA) at the Stanford University Clinical Virology Lab according to the manufacturer 
instructions. 
A.2. Assay Verification and Sample Qualification prior to CMOS Biochip Experiments 
Assay Verification. The multiplex assay used for the experiments described in Fig. 4 and Fig. Supp. 31 
utilized a combination of primer sequences derived from references.  The primer sequences utilized are 
listed in Table Supp. IV. 
Table Supp. IV: URP Assay Primer Sequences 
Primer Name 
Reaction 
Concentration 
Target 
Gene 
Genome Region 
Sequence 
FluA-1 Excess 
300nM 
NS1 
Segment 8 
Bases 636-793 
BHQ2-GGACCTCCACTTACTCCAAAACAGAAAC 
FluA-1 Limiting 
50nM 
BHQ2-GTAAGGCTTGCATGAATGTTATTTGCTC 
FluA-2 Excess 
300nM 
M 
Segment 7 
Bases 171-276 
BHQ2-GACCRATCCTGTCACCTCTGAC 
FluA-2 Limiting 
50nM 
BHQ2-AGGGCATTYTGGACAAAKCGTCTA 
FluB Excess 
300nM 
NS1 
Segment 8 
Bases720-822 
BHQ2-TCCTCAACTCACTCTTCGAGCG 
FluB Limiting 
50nM 
BHQ2-CGGTGCTCTTGACCAAATTGG 
RSV Excess 
300nM 
M 
Bases 3179-3262 
BHQ2-GGCAAATATGGAAACATACGTGAA 
RSV Limiting 
50nM 
BHQ2-TCTTTTTCTAGGACATTGTAYTGAACAG 
Para-2 Excess 
300nM 
F 
Bases 7451-7540 
BHQ2-GCATTTCCAATCTACAGGACTATGA 
Para-2 Limiting 
50nM 
BHQ2-ACCTCCTGGTATAGCAGTGACTGAAC 
Adv-C Excess 
300nM 
E1A 
Bases 919-1100 
BHQ2-TCGATCTTACCTGCCACGAG 
Adv-C Limiting 
50nM 
BHQ2-GCCACAGGTCCTCATATAGCAA 
Adv-E Excess 
300nM 
E4 
Bases 34196-34349 
BHQ2-TGCAATTTTGTTGGGTTTCGATAAC 
Adv-E Limiting 
50nM 
BHQ2-CCTGGCTGTTATTTTCCACCAAC 
Pos. Cont. Excess 
300nM 
N/A 
N/A 
BHQ2-ATGGAGCGAATCCAGCAAAC 
Pos. Cont. Limiting 
50nM 
BHQ2-CCAGTGATTGGCCTGTCGTA 
 
Iterative development of multiplex RT-PCR assay using off-chip RT-PCR and Luminex System. The assay 
was developed by iterative addition of primer sets together and tested using a mixture of synthetic 
templates and multiplex RT-PCR followed by hybridization to MagPix bead-conjugated probes and 
readout on a MagPix instrument (Millipore).  
 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 37 of 64 
 Hassibi et al. 
Synthetic templates for potential primer/probe sets included in reference7-8 were purchased as 
quantitated ssRNA (for RNA viruses targeted) or ssDNA (for dsDNA viruses targeted) synthetic nucleic 
acids as described. A mixture of all potential templates (including positive control template designed in 
house) was made at 1,000copies/µl and frozen in 10µl aliquots at -80°C until used. Each aliquot was 
used once to avoid freeze-thaw cycles. For each multiplex assay test initially conducted during the 
multiplex development phase, 1µl of this template mix was added per reaction.  
 
Table Supp. V: URP Assay Probe Sequences 
Probe Name 
Function 
Sequence 
FluA-1-Pb1 
Detection 
AminoC6-TTTTTTTTGACCTAGTTGTTCTCGCCAGTGGAGGTCC[T(FAM)]TTTTTT-TAMRA 
FluA-1-Pb2 
Detection 
AminoC6-TTTTTTTTGACCTAGTTGTTCTCGCCAGGAGGTCC[T(FAM)]TTTTTT-TAMRA 
FluA-1-PDPb 
Quantitation 
AminoC6-TTTTTT[Spacer 3]GAGCAAATAACATTCATGCAAGCCTTAC[T(FAM)]TTTTTT-TAMRA 
FluA-2-Pb1 
Detection 
AminoC6-TTTTTTCGGTGAGCGTGAACACAAATCCCAGGATTGGTC[T(FAM)]TTTTTT-TAMRA 
FluA-2-Pb2 
Detection 
AminoC6-TTTTTTCGGTGAGCGTGAACACAAATCCACAGGATTGGTC[T(FAM)]TTTTTT-TAMRA 
FluA-2-PDPb 
Quantitation 
AminoC6-TTTTTT[Spacer 3]TAGACGCTTTGTCCACAATGCCCT[T(FAM)]TTTTTT-TAMRA 
FluB-Pb1 
Detection 
AminoC6-TTTTTTCTCGAATTGGCTTTGAATGTCCTTCGAGTTGAGGA[T(FAM)]TTTTTT-TAMRA 
FluB-Pb2 
Detection 
AminoC6-TTTTTTCACCGCAGTTTCAGCTGCTCGAATTGGGAGTTGAGGA[T(FAM)]TTTTTT-
TAMRA 
FluB-PDPb 
Quantitation 
AminoC6-TTTTTT[Spacer 3]CCAATTTGGTCAAGAGCACCGT[T(FAM)]TTTTTT-TAMRA 
RSV-Pb1 
Detection 
AminoC6-TTTTTTCAGCAGCTGTGTATGTGGAGCTCCATATTTGCC[T(FAM)]TTTTTT-TAMRA 
RSV-Pb2 
Detection 
AminoC6-TTTTTTCTGTGTATGTGGAGCCTTCGTGAAGCTTCCATATTTGCC[T(FAM)]TTTTTT-
TAMRA 
RSV-PDPb 
Quantitation 
AminoC6-TTTTTT[Spacer 3]CTGTTCACTACAATGTCCTAGAAAAAGA[T(FAM)]TTTTTT-TAMRA 
Para-2-Pb1 
Detection 
AminoC6-TTTTTTGCGATTGATTCCATCACTTAGGTAAATTGGAAATGC[T(FAM)]TTTTTT-
TAMRA 
Para-2-Pb2 
Detection 
AminoC6-TTTTTTGCGATTGATTCCATCACTTAGGTAAGATTGGAAATGC[T(FAM)]TTTTTT-
TAMRA 
Para-2-PDPb 
Quantitation 
AminoC6-TTTTTT[Spacer 3]GTTCAGTCACTGCTATACCAGGAGGT[T(FAM)]TTTTTT-TAMRA 
Adv-C-Pb1 
Detection 
AminoC6-
TTTTTTTGCTCCACATAATCTAACACAAACTCCTCACCCCAGGTAAGATCGA[T(FAM)]TTTTTT-
TAMRA 
Adv-C-Pb2 
Detection 
AminoC6-
TTTTTTTGCTCCACATAATCTAACACAAACTCCTCACCCAGGTAAGATCGA[T(FAM)]TTTTTT-
TAMRA 
Adv-C-PDPb 
Quantitation 
AminoC6-TTTTTT[Spacer 3]TTGCTATATGAGGACCTGTGGC[T(FAM)]TTTTTT-TAMRA 
Adv-E Pb 
Detection 
AminoC6-TTTTTTTTAATCATGGTTCTTCCTGTTCTTCCCTCCCAAATTGCA[T(FAM)]TTTTTT-
TAMRA 
Adv-E-PDPb 
Quantitation 
AminoC6-TTTTTT[Spacer 3]GTTGGTGGAAAATAACAGCCAGGT[T(FAM)]TTTTTT-TAMRA 
Pos. Control Pb 
Detection 
AminoC6-TTTTTTTATCCGGTGAAAGTGAGATTCATTATCATTCGCTCCAT[T(FAM)]TTTTTT-
TAMRA 
Pos. Control-PDPb 
Quantitation 
AminoC6-TTTTTT[Spacer 3]TACGACAGGCCAATCACTGGT[T(FAM)]TTTTTT-TAMRA 
Neg. Control Pb 
Detection Baseline 
AminoC6-TTTTTTCAAAGTGGGAGACGTCGTTGT[T(FAM)]TTTTTT-TAMRA 
 
The SuperScriptIII® (SSIII) One-step RT-PCR enzyme system (Thermo Fisher) was used to generate RT-
PCR amplicons. Multiplex RT-PCR mix was composed of 2X SSIII Reverse Transcriptase + Platinum® Taq 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 38 of 64 
 Hassibi et al. 
Polymerase mix [1µl per 25µl reaction vs. the manufacturer recommended 0.5µl per 25µl], 1X SSIII RT-
PCR Buffer, 5mM MgSO4, plus primer mix to which was added the template mixture described above. 
The primer mix contained a 6:1 ratio of Excess vs. Limiting primers (300nM each excess primer and 
50nM each limiting primer). Additionally, all primers were labelled with Black Hole Quencher 2 (BHQ2) 
(LGC BioSearch) at their 5’ ends as shown in Table Supp. IV. Amplicons thus generated were then 
hybridized to a mixture of MagPix bead-conjugated fluorescent probes designed by InSilixa to detect the 
amplicons (Table Supp. V) and read on MagPix instrument.  Sub-optimal primer/probe combinations 
were eliminated from the multiplex panel and the final panel configurations for both Luminex and On-
Chip RT-PCR experiments are reported.  
 
NOTE: Quantitation probes were used only for On-Chip RT-PCR and not during development phase. 
 
Sample Qualification. Standard curves were generated using synthetic ssDNA templates or ssRNA 
templates ranging from 1 to 1,000,000 copies/µl in triplicate. qPCR was performed in 25µl volumes with 
2U Platinum Taq DNA Polymerase (Thermo Fisher), 1X Platinum Taq PCR Buffer, 5mM MgSO4, 200µM 
each dNTP, 400µM each primer, and 200µM TaqMan probe (LGC BioSearch). qRT-PCR was performed in 
25µl volumes using 2X SuperScriptIII Reverse Transcriptase + Platinum Taq Polymerase mix [1µl per 25µl 
reaction], 1X SuperScriptIII RT-PCR buffer, 5mM MgSO4, 400µM each primer, and 200µM TaqMan probe 
with FAM/BHQ1 pairs (Table Supp. VI). PCR reactions were performed in 96-well plates on a CFX1000 
Touch with an initial denaturation at 95°C for 2 min, 45 cycles at 95°C for 15 s, 62°C for 30 s, and 68°C 
for 30 s, followed by a final extension at 68°C for 3 min. RT-PCR reactions were run in 96-well plates on a 
CFX1000 Touch with 55°C reverse transcription for 5 min., RT Kill and denaturation at 95°C for 2 min, 45 
cycles at 95°C for 15 s, 62°C for 30 s, and 68°C for 30 s, followed by a final extension at 68°C for 3 min. 
Data was analyzed and standard curves were generated using the CFX Manager Software. 
 
Table Supp. VI: URP Assay TaqMan Primer/Probe Sequences 
Target 
F Primer 
R Primer 
Probe 
FluA-1 
GGACCTCCACTTACTCCAAAACAGAAAC 
GTAAGGCTTGCATGAATGTTATTTGCTC 
FAM-TTGACCTAGTTGTTCTCGCCA-BHQ1 
FluA-2 
GACCRATCCTGTCACCTCTGAC 
AGGGCATTYTGGACAAAKCGTCTA 
FAM-TGCAGTCCTCGCTCACTGGGCACG-
BHQ1 
FluB 
TCCTCAACTCACTCTTCGAGCG 
CGGTGCTCTTGACCAAATTGG 
FAM-CCAATTCGAGCAGCTGAAACTGCGGTG-
BHQ1 
RSV 
GGCAAATATGGAAACATACGTGAA 
TCTTTTTCTAGGACATTGTAYTGAACAG 
FAM-CTGTGTATGTGGAGCCTTCGTGAAGCT-
BHQ1 
Para-2 
GCATTTCCAATCTACAGGACTATGA 
ACCTCCTGGTATAGCAGTGACTGAAC 
FAM-
CCATTTACCTAAGTGATGGAATCAATCGCAAA-
BHQ1 
Adv-C 
TCGATCTTACCTGCCACGAG 
GCCACAGGTCCTCATATAGCAA 
FAM-
TGCTCCACATAATCTAACACAAACTCCTCACCC-
BHQ1 
Adv-E 
TGCAATTTTGTTGGGTTTCGATAAC 
CCTGGCTGTTATTTTCCACCAAC 
FAM-
TTAATCATGGTTCTTCCTGTTCTTCCCTCCC-
BHQ1 
Pos. 
Cont. 
ATGGAGCGAATCCAGCAAAC 
CCAGTGATTGGCCTGTCGTA 
FAM-CGACTACTTTGGGTGTCCGT-BHQ1 
 
Templates used for on-chip RT-PCR (prior to on-chip RT-PCR for commercial samples, after completion 
of on-chip RT-PCR for clinical samples) were quantitated via qRT-PCR in 25µl volumes using 2X SSIII 
Reverse Transcriptase + Platinum Taq Polymerase mix [1µl per 25µl reaction], 1X SSIII RT-PCR buffer, 
5mM MgSO4, 400µM each primer, and 200µM TaqMan probe utilizing FAM/BHQ1 pairs. Templates were 
diluted prior to qRT-PCR (typically 1:103 to 1:105 dilutions were used) and tested in triplicate reactions. 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 39 of 64 
 Hassibi et al. 
RT-PCR reactions were performed using 96-well plates on a CFX1000 Touch with 55°C reverse 
transcription for 5 min., RT Kill and denaturation at 95°C for 2 min, 45 cycles at 95°C for 15 s, and 62°C 
for 30 s, followed by a final extension at 68°C for 3 min. Data was analyzed against standard curves using 
the CFX Manager Software. Fluorescence measurements were taken at each annealing step. 
 
A.3. 
CMOS Biochip Layout and Probes 
URP Array Layout (Table Supp. VII). See key below for probe content. Probes not referenced in this 
study are labeled as Test Probes (T). B=Blank and denote areas where no probes were spotted; 
CP=Control Probe; PM=Process Monitor.  
The blank spots (B) are used to estimate the background optical signal. These spots are used to 
accurately perform background subtraction operation to obtain the signal values from the individual 
spots. 15 locations are spotted with the control probe (CP). These spots are used to obtain the 
characteristics of FAM-TAM fluorophore construct and enables the correction and calibration for the 
temperature dependence and bleaching of surface-bound fluorophores. 13 locations are spotted with 
the process monitor probe (PM). These spots are used to verify the quality of surface functionalization 
and spotting process. These probes are designed to be universal across the different panels.  
 
Table Supp. VII: URP Array Layout Key 
Identifier 
Probe Content 
 Identifier 
Probe Content 
 Identifier 
Probe Content 
 Identifier 
Probe Content 
001 
FluA-1-Pb1 
 
012 
RSV-PDPb 
 
023 
Neg. Control Pb 
 
T08 
Test_Probe_08 
002 
FluA-1-Pb2 
 
013 
Para-2-Pb1 
 
B 
Blank (No Probe) 
 
T09 
Test_Probe_09 
003 
FluA-1-PDPb 
 
014 
Para-2-Pb2 
 
CP 
Control Probe 
 
T10 
Test_Probe_10 
004 
FluA-2-Pb1 
 
015 
Para-2-PDPb 
 
PM 
Process Monitor 
 
T11 
Test_Probe_11 
005 
FluA-2-Pb2 
 
016 
Adv-C-Pb1 
 
T01 
Test_Probe_01 
 
T12 
Test_Probe_12 
006 
FluA-2-PDPb 
 
017 
Adv-C-Pb2 
 
T02 
Test_Probe_02 
 
T13 
Test_Probe_13 
007 
FluB-Pb1 
 
018 
Adv-C-PDPb 
 
T03 
Test_Probe_03 
 
T14 
Test_Probe_14 
008 
FluB-Pb2 
 
019 
Adv-E Pb 
 
T04 
Test_Probe_04 
 
T15 
Test_Probe_15 
009 
FluB-PDPb 
 
020 
Adv-E-PDPb 
 
T05 
Test_Probe_05 
 
T16 
Test_Probe_16 
010 
RSV-Pb1 
 
021 
Pos. Control Pb 
 
T06 
Test_Probe_06 
 
 
 
011 
RSV-Pb2 
 
022 
Pos. Control-PDPb 
 
T07 
Test_Probe_07 
 
 
 
 
 
 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 40 of 64 
 Hassibi et al. 
 
+ 
1 
2 
3 
4  5 
6 
7 
8 
9 
10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 
1 PM 
B T07 B  T08 B 016 B 017 B 019 B T09 B 021 B 
PM 
B 023 B T10 B T11 B T12 B T13 B 004 B 
B 
PM 
2 
B 
B 
B 
B  B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
3 005 B 007 B  008 B 013 B 014 B 010 B 011 B T14 B 
CP 
B T15 B 022 B 006 B 009 B 015 B 012 B 003 B 
4 
B 
B 
B 
B  B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
5 T16 B 018 B  020 B 001 B 002 B T01 B T02 B T03 B T04 B T05 B T06 B T07 B 
CP 
B T08 B 016 B 017 B 
6 
B 
B 
B 
B  B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
7 019 B T09 B  021 B 023 B 
B 
B 
CP 
B T10 B T11 B T12 B T13 B 
CP 
B 004 B 
B 
B 005 B 
CP 
B 007 B 
8 
B 
B 
B 
B  B 
B 
B 
B 
PM 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
PM 
B 
B 
B 
B 
B 
B 
B 
9 008 B 013 B  014 B 010 B 
B 
B 011 B T14 B T15 B 022 B 006 B 009 B 015 B 
B 
B 012 B 003 B T16 B 
10 
B 
B 
B 
B  B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
11 018 B 020 B  001 B 
CP 
B 001 B 002 B T01 B T02 B T03 B T04 B T05 B T06 B T07 B T08 B 002 B T01 B 
12 
B 
B 
B 
B  B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
13 T02 B T03 B  T04 B 016 B 017 B 019 B T09 B 021 B 023 B 
CP 
B T10 B T11 B T12 B T13 B T05 B T06 B 
14 
B 
B 
B 
B  B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
15 
B 
B 
CP 
B  T07 B 004 B 005 B 007 B 008 B 013 B 
B 
B 014 B 010 B 011 B T14 B T15 B T08 B 
B 
B 
16 PM 
B 
B 
B  B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
PM 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
PM 
17 
B 
B 016 B  017 B 022 B 006 B 009 B 015 B 
CP 
B 
B 
B 012 B 003 B 
CP 
B T16 B 018 B 019 B 
B 
B 
18 
B 
B 
B 
B  B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
19 T09 B 021 B  023 B 
CP 
B 020 B 001 B 002 B T01 B T02 B T03 B T04 B T05 B T06 B T07 B T10 B T11 B 
20 
B 
B 
B 
B  B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
21 T12 B T13 B  004 B T08 B 016 B 017 B 019 B T09 B 021 B 023 B T10 B T11 B T12 B T13 B 005 B 007 B 
22 
B 
B 
B 
B  B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
23 008 B 013 B  014 B 004 B 
B 
B 005 B 007 B 008 B 
CP 
B 013 B 014 B 010 B 
B 
B 
CP 
B 010 B 011 B 
24 
B 
B 
B 
B  B 
B 
B 
B 
PM 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
PM 
B 
B 
B 
B 
B 
B 
B 
25 T14 B T15 B  CP 
B 011 B 
B 
B T14 B T15 B 022 B 006 B 009 B 015 B 012 B 
B 
B 003 B 022 B 006 B 
26 
B 
B 
B 
B  B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
27 009 B 015 B  012 B T16 B 018 B 020 B 001 B 002 B T01 B T02 B T03 B T04 B T05 B T06 B 003 B T16 B 
28 
B 
B 
B 
B  B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
29 018 B 020 B  001 B 002 B T01 B T02 B T03 B T04 B T05 B T06 B 
CP 
B T07 B T08 B 016 B 017 B 019 B 
30 
B 
B 
B 
B  B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
31 
B 
B T09 B  021 B 023 B T10 B T11 B T12 B T13 B 
B 
B 004 B 005 B 007 B 008 B 013 B 014 B 
B 
B 
32 PM 
B 
B 
B  B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
PM 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
PM 
 
The signal probes are classified as two types. One is the “PbX” type, which is used to obtain the melt 
curve signatures. These probes employ the IFT technique for detection as shown in Fig. 2b.  The second 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 41 of 64 
 Hassibi et al. 
is the “PDPb” type, which are used for quantification during qPCR reaction. These probes monitor the 
depletion of limiting primer during the PCR cycling as explained before. At least 5 replicates of each 
signal probe is printed on the CMOS biochip as shown in the array layout. 
 
A.4. 
CMOS Biochip Experiments 
Three sets of experiments were conducted on the CMOS biochip to demonstrate the capabilities of our 
system.  Qualified and quantitated templates, as described above, were used for generation of data 
reported in Fig. 4 and Fig. Supp. 31 and 32. 
The first set of experiments reported in Fig. 4, were to demonstrate on-chip detection and quantitation 
of Influenza A.  We performed a total of 15 experiments utilizing 15 separate biochips to demonstrate 
the quantitation capability of our system.  Dilutions of total nucleic acid extract obtained from ATCC [VR-
1680D Influenza A RNA, strain A/Aichi/2/68 (H3N2)] containing FluA were generated.  These samples 
were then each mixed with positive control RNA and RT-PCR reaction mixtures (see below) to final 
concentrations of 10,000 copies/µl to 100 copies/µl of FluA as described above and 8,000 copies/µl of 
positive control and tested in triplicate. 
The second set of experiments reported in Fig. Sup 31 and 32, was to demonstrate detection and 
differentiation of one or multiple targets via melt curve analysis. Mixtures of templates obtained from 
commercial sources or a single template and quantitated as described above were used for three 
separate on-chip RT-PCR experiments.  Post RT-PCR melt curves which differentiate between the various 
generated amplicons. 
The third set of experiments reported in Fig. 4, was to demonstrate the ability of the CMOS biochip to 
detect pathogens in clinical nasopharyngeal swab samples. Each patient sample was previously tested 
with a respiratory virus panel (GenMark eSensor XT-8, Carlsbad, USA) at the Stanford University Clinical 
Virology Lab according to the manufacturer instructions. One of the three aliquots of each clinical 
sample extract was used for on-chip RT-PCR as described in “on-chip inverse fluorescence RT-PCR of 
clinical samples” described below. A separate aliquot of each clinical sample was used for quantitation 
of the pathogen nucleic acid detected in the clinical sample.  The summarized results of the CMOS 
biochip, GenMark tests, and qRT-PCR of those samples are presented in the manuscript. 
 
 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 42 of 64 
 Hassibi et al. 
Figure Supp. 31: Identification of one or multiplex pathogens in a sample via melt curve analysis post on-chip RT-PCR using 
CMOS biochip. (A) melt curves generated on FluA and positive control probes after CMOS biochip was spiked with a mixture 
containing total nucleic acid extracts from FluA at 10,000 copies/µl and positive control RNA at 8,000 copies/µl.  (B) Shows 
melt curves generated on FluB, Adenovirus E (AdvE), and positive control probes after CMOS biochip was spiked with a 
mixture of FluB at 11,600 copies/µl, AdvE at 170 copies/µl, and positive control RNA at 8,000 copies/µl.  (C) Shows melt 
curves generated on all amplicon-targeted probes after CMOS biochip was spiked with a mixture of FluA at 1160 copies/µl, 
FluB at 176 copies/µl, RSV-A at 528 copies/µl, AdvC at 232 copies/µl, AdvE at 17 copies/µl, PIV-2 at 72 copies/µl and positive 
control RNA at 8,000 copies/µl. In all the reported curves, the data points are the mean of 5 replicate probes on the same 
CMOS biochip. 
55
60
65
70
0
0.2
0.4
0.6
0.8
1
 
 
FluA(+)
Cntl (+)
AdvE
FluB
AdvC2
HPIV2
RSV
Cntl (-)
55
60
65
70
0
0.2
0.4
0.6
0.8
1
 
 
FluA
Cntl (+)
AdvE(+)
FluB(+)
AdvC2
HPIV2
RSV
Cntl (-)
55
60
65
70
0
0.2
0.4
0.6
0.8
1
 
 
FluA(+)
Cntl (+)
AdvE(+)
FluB(+)
AdvC2(+)
HPIV2(+)
RSV(+)
Cntl (-)
A
B
C
RFU
RFU
RFU
TEMPERATURE ( C)
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 43 of 64 
 Hassibi et al. 
On-Chip inverse-fluorescence NAAT qRT-PCR for commercial samples.  SuperScriptIII® (SSIII) One-step RT-
PCR reagent (Thermo Fisher) was used to generate RT-PCR amplicons. Multiplex RT-PCR mix consisted of 
2X SSIII Reverse Transcriptase + Platinum® Taq Polymerase mix [1µl per 25µl reaction], 1X SSIII RT-PCR 
Buffer, 5mM MgSO4, plus primer mix and synthetic positive control RNA and various targets as 
reported. The primer mix contained a 6:1 ratio of excess:limiting primers (300nM:50nM, respectively). 
All primers were BHQ2 labelled (LGC BioSearch) at the 5’ terminus. For each experiment, a total volume 
of 100µl of this mix was generated. The mix was staged on ice prior to loading. 
On-chip cycling conditions for commercial samples.  Chips were pre-treated by loading 60µl of a mix 
containing 2X SSIII Enzyme mix, 1X SSIII buffer and 5mM MgSO4 (no templates or primers) and the 
following heating protocol: 55°C for 5 min, 95°C for 3 min, 5 cycles at 95°C for 30 s, 60°C for 1 min, and 
one cycle of 68°C for 3min. After pre-treatment, the liquid was replaced with 60µl of the RT-PCR mix and 
thermal cycled as follows:  55°C for 5 min, 95°C for 3 min, 45 cycles at 95°C for 30 s, 60°C for 1 min, 
followed by a final extension at 68°C for 3 min. A 50µl aliquot of the same mix was loaded on to a 200ul 
well of a PCR plate and cycled using the same thermal profile on a CFX Touch instrument (BioRad, 
Hercules, CA) as a control to enable comparison of on-chip vs. off-chip RT-PCR efficiency. 
On-Chip inverse-fluorescence RT-PCR of clinical samples.  To three ZipScript (Enzymatics/Qiagen, Beverly, 
MA) one-step RT-PCR dried reagent beads was added an 8-plex mix of Excess and Limiting primers plus 
water and positive control synthetic poliovirus RNA diluted in water to a final volume of 110µl.   To this 
mix was added 15ul of a 20ul total nucleic acid extract from a clinical sample for a final volume of 125ul 
containing 300nM of each Excess primer, 50nM of each limiting primer, 8,000 copies/µl of positive 
control synthetic RNA, and 1X enzyme plus buffer mix. Sixty microliters (60µl) of this mix was drawn into 
a pipette and loaded by negative pressure on to one chip per clinical sample and cycled as follows: 55°C 
for 5 min, 95°C for 3 min, 45 cycles at 95°C for 30 s, 60°C for 1 min, followed by a final extension at 68°C 
for 3 min.  Another 50µl of the same mix was loaded on to a 200µl well of a PCR plate and cycled using 
the same thermal cycling parameters on a BioRad CFX Touch instrument as an off-chip RT-PCR control to 
enable comparison of on-chip vs. off-chip RT-PCR efficiency. 
Imaging and quantitation via primer depletion.  For all samples (clinical and commercial) beginning at 
PCR cycle 15, and at each subsequent cycle through the end of PCR, two images were collected at the 
end of each annealing/extension step. Fluorescent signals corresponding to FAM-TAM-labeled primer 
depletion probes (PDPr) were collected to produce a cycle to cycle comparison of signal. Measurements 
were compiled, normalized and reported (Fig. 4). 
On-chip hybridization and melt.  After completion of on-chip RT-PCR, the chip was heated at 55°C for 
30min and fluorescence measurements taken at 2min intervals. This was followed by a 20min melt from 
55-95°C using high frequency imaging. Again, measurements were compiled, normalized and reported 
(Fig. 4 and Fig. Supp. 31). 
A.5. 
Post CMOS Biochip Verification 
qPCR.  62°C for 30 s, and 68°C for 30 s, followed by a final extension at 68°C for 3 min. Fluorescence 
measurements were taken at each annealing step. 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 44 of 64 
 Hassibi et al. 
TaqMan quantitation of on-chip and off-chip amplicon generated.  After on-chip and off-chip 
amplification, amplicon was removed from chips/tubes and log-diluted in nucleic acid dilution buffer 
(10mM Tris-HCl pH8.2, 0.01% Tween 20) from 1:10 to 1:107.  Typically, 1:104, 1:105, and 1:106 dilutions 
were used.  Each dilution was tested in triplicate qPCR reactions. Each 25µl qPCR reaction contained 2U 
Platinum Taq DNA Polymerase, 1X Platinum Taq PCR Buffer, 5mM MgSO4, 200µM each dNTP, 400µM 
each primer, 200µM TaqMan probe, and 5ul of amplicon to be quantitated. PCR reactions were 
performed using 96-well plates on a CFX1000 Touch with an initial denaturation at 95°C for 2 min, 45 
cycles at 95°C for 15 s, Results for FluA detection/quantitation experiments are detailed in Table Supp. 
VIII. The amplification of the FluA template is marginally more efficient in tubes vs. on chip.  
 
* Average + standard deviation (SD)  
 
B. URP Assay Melt Signatures 
CMOS chip melt curves and URP signatures.  Fig. Supp. 32 shows the melt curve signatures for the 
different probes and targets obtained using the CMOS biochip.  The biochip experiment was performed 
by spiking the biochip with a mixture of FluA at 1160 copies/µl, FluB at 176 copies/µl, RSV-A at 528 
copies/µl, AdvC at 232 copies/µl, AdvE at 17 copies/µl, PIV-2 at 72 copies/µl and positive control RNA at 
8,000 copies/µl. Melt curve signatures are observed on Pb1 probe sequences for the six different 
pathogens.  
Fig. Supp. 32 shows the comparison between the obtained melt curve signatures and the simulated melt 
curve results obtained for probe/target interactions using VISUALOMP software. These simulation 
require special considerations as the probe sequences employ the IFT technique, as depicted in Fig. 2b. 
Each probes has two regions – the “sticky-end” region which is complementary to the 5’ end of the 
excess primer labelled with the quencher and the “anchor” region which is complementary to specific 
sequence on the target. Because of this structure, not all possible heterodimer duplexes between the 
probe and the target contribute to the quenching. Maximum quenching is obtained in those cases 
where the “sticky-end” region is bound to the target along with the “anchor”, bringing the fluorophore 
near 3’ end of the probe and quencher near the 5’ end of the target amplicon in close proximity.  
The simulated melt curve results are obtained by combining the results of two simulations explained 
below. The first simulation is done using only the target (𝑇) and the “anchor” region of the probe (𝐴) to 
estimate the [𝑇 + 𝐴] heterodimer concentration. Both the target and anchor regions are simulated with 
the same 10nM concentration. The second simulation is done using the target (𝑇) and the “sticky-end” 
region of the probe (𝑆𝐸) to estimate the [𝑇 + 𝑆𝐸] heterodimer concentration. In this case the effective 
concentration of the target is set to a significantly higher value of 3mM, to simulate the effect of target 
Table Supp. VIII: URP Assay post-RT-PCR Quantitation Results 
Initial FluA 
Concentration 
On-Chip RT-PCR 
Amplicon Concentration (µ±σ)* 
Off-Chip RT-PCR 
Amplicon Concentration (µ±σ) 
100,000 copies/ul 
57nM±5nM 
119nM±7nM 
10,000 copies/ul 
48nM±6nM 
89nM±7nM 
3,000 copies/ul 
55nM±10nM 
96nM±16nM 
1,000 copies/ul 
34nM±8nM 
71nM±12nM 
300 copies/ul 
30nM±2nM 
66nM±6nM 
100 copies/ul 
33nM±4nM 
49nM±6nM 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 45 of 64 
 Hassibi et al. 
enrichment near the surface due to the attachment of the “anchor” region. The value of 3mM is chosen 
as it corresponds to average loop distance of 15bp between the sticky end and anchor section on the 
target amplicon. The total effective heterodimer concentration is given by the product to the two 
heterodimer concentrations,  
[𝑇 + 𝑃] = [𝑇 + 𝐴][𝑇 + 𝑆𝐸]                                    (K1) 
The effective quenching signal is given by  
                          𝑄 = 1 − [𝑇 + 𝑃] = 1 − [𝑇 + 𝐴][𝑇 + 𝑆𝐸]                             (K2) 
The simulated melt curves obtained using the above method closely predicted the experimental data as 
shown in Fig. Sup. 32.  
 
 
Figure Supp. 32: Signature melt curve plots obtained for each of the six different pathogen targets FluA, AdvE, FluB, AdvC2, 
HPIV2, and RSV and the Cntl (+) with their corresponding Pb1 probes (Table K4). The experimental melt curve plot is in blue 
and the simulated result in dashed grey. The measured signals are the average of 5 probe replicated from a single CMOS 
biochip experiment.  
 
 
FluA
FluB
Cntl(+)
AdvC2
HPIV2
RSV
AdvE
Cntl(-)
NRFU
Temperature (°C)
NRFU
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 46 of 64 
 Hassibi et al. 
Supplementary Note 12 
 
Description: 
M. tuberculosis (MTB) drug resistance mutation detection assay. 
 
The multiplexed MTB assay discussed in the manuscript was first designed and verified using 
conventional molecular biology and PCR techniques. The multiplex assay was then transferred to the 
CMOS biochip platform for NAAT. In select cases, the results generated in the CMOS biochip 
experiments were validated using conventional qPCR. We describe the methods used and also provide 
additional information and analysis in the section below. 
 
A. Materials and Methods 
A.1. Samples and Nucleic Acid Templates 
Synthetic nucleic acid templates for multiplex standard curve generation. Synthetic single-stranded 
target DNAs of each amplicon sequence listed in Table Supp. IX were obtained from Integrated DNA 
Technologies (Redwood City, CA) as PAGE-purified Ultramers and were re-suspended in 10mM Tris-HCl, 
0.1mM EDTA, pH 8.0. The templates were quantified on a Beckman DU800 UV spectrophotometer and 
stored as aliquots at 10µM and 10nM concentrations in the -80°C freezer. Standard curves for qPCR 
quantifications were generated with serial dilutions generated from single-use 10nM aliquots. 
Wild-type MTB genomic DNA:  Wild-type H37Rv MTB genomic DNA (Table Supp. IX) was purchased from 
the American Type Culture Collection (Cat. No. 25618D-2) and quantified on a Beckman DU800 UV 
Spectrophotometer.  For all initial assay development testing, we used wild-type H37Rv to generate 
wild-type amplicons, which were then quantified via qPCR or directly hybridized to glass microarrays 
spotted with MTB capture probes.  
Clinical mutant MTB genomic DNA: Clinical mutant MTB genomic DNA thermolysates (Table Supp. IX) 
were obtained from the BCCM/ITM Mycobacteria collection ((http://bccm.belspo.be/about-us/bccm-
itm), Institute of Tropical Medicine, Antwerp, Belgium) as 0.5ml to 1ml bacterial suspensions cultured 
from single-colony isolates and heat inactivated in TE buffer.    
 
A.2. Sample Qualification and Assay Verification prior to CMOS Biochip Experiments 
Qualification of thermolysates using quantitative Real-Time quantitative PCR (qPCR). For each mutant 
strain, 200µl of the thermolysate was purified and concentrated using spin-columns (Qiagen, 
Cat.No.28104), according to the manufacturer’s protocol, and eluted in 30µl Qiagen Buffer EB (10mM 
Tris-Cl, pH 8.5). Purified thermolysates were then diluted 1000-fold and pre-amplified as described 
previously [L1]. Briefly, each 30µl pre-amplification PCR reaction consisted of 1x Advantage 2 Buffer 
(Clontech, Cat.No. 639202), 0.6µl of 10mM dNTP mix (Thermofisher, Cat. No. R0191), 0.6µl Advantage 2 
polymerase, 20.8µl of 100µM pre-amplification primers mix (equal volumes of forward and reverse 
primers for each of 743 genes, Biosearch), and 2µl of purified thermolysate. PCR was performed on an 
ABI 9800 Fast Thermocycler for 15 cycles at 95°C for 30 s, 60°C for 20 s, and 68°C for 1 min.  H37Rv 
genomic DNA from 104 to 106 copies was included as a standard curve reference. Pre-amplified material 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 47 of 64 
 Hassibi et al. 
was quantified using qPCR of 24 randomly selected genes from the 743-MTB gene primer mix. Each 
qPCR reaction consisted of 0.1µl pre-amplified DNA, 1x SensiFast Probe No-Rox PCR mix (Bioline, Cat. 
No. BIO-86005), 300nM each primer, and 100nM FAM/BHQ-labeled probe in a 10µl reaction volume. 
Reactions were performed in a 384-well plate on a LightCycler 480 (Roche) using the Mono Color 
Hydrolysis Probe detection format for FAM. Reactions were denaturated at 95°C for 5 min, followed by 
40 cycles at 95°C for 30 s and 60°C for 30 s, and a final cool down at 40°C for 30 s.  Data was obtained 
using the Second Derivative High Confidence algorithm in Roche’s LightCycler 480 software. 
Concentrations for purified thermolysates were calculated based on a standard curve using the median 
of Cts for all 24 individual genes in H37Rv from 104 to 106 copies.  Single-use aliquots were prepared at 
105 copies/2µl and stored at -40°C.  
 
 
 
 
 
Mutation 1 
Mutation 2 
Source 
Strain ID 
TDR-TB 
Strain ID 
Drug 
Resistance 
Gene 
Amino Acid 
Change 
Codon Change 
Gene 
Amino Acid 
Change 
Codon Change 
ATCC 
H37Rv 
wild-type 
none 
 
 
 
 
 
 
BCCM/ITM 
960854 
TDR0005 
FQ 
gyrA 
Ala 384 Val 
GCA 384 GTA 
 
 
 
BCCM/ITM 
970472 
TDR0009 
INH 
katG 
Ser 315 Ile 
AGC 315 ATC 
 
 
 
BCCM/ITM 
991451 
TDR0021 
RIF, INH 
rpoB 
Asp 516 Tyr 
GAC 516 TAC 
katG 
Ser 315 Thr 
AGC 315 ACC 
BCCM/ITM 
000930 
TDR0036 
RIF, INH 
rpoB 
His 526 Asp 
CAC 526 GAC 
katG 
Ser 315 Thr 
AGC 315 ACC 
BCCM/ITM 
041244 
TDR0117 
RIF, INH 
rpoB 
His 526 Tyr 
CAC 526 TAC 
katG 
Ser 315 Thr 
AGC 315 ACC 
BCCM/ITM 
041291 
TDR0133 
FQ 
gyrA 
Gly 247 Ser 
GGC 247 AGC 
 
 
 
BCCM/ITM 
042603 
TDR0160 
RIF 
rpoB 
Ile 572 Phe 
ATC 572 TTC 
 
 
 
BCCM/ITM 
042611 
TDR0168 
RIF, INH 
rpoB 
His 526 Arg 
CAC 526 CGC 
katG 
Ser 315 Asn 
AGC 315 AAC 
BCCM/ITM 
042924 
TDR0191 
RIF, INH 
rpoB 
Asp 516 Val 
GAC 516 GTC 
katG 
Ser 315 Asn 
AGC 315 AAC 
BCCM/ITM 
052785 
TDR0226 
FQ 
gyrA 
Asp 94 Gly 
GAC 94 GGC 
 
 
 
BCCM/ITM 
092045 
TDR0231 
FQ 
gyrA 
Ala 90 Val 
GCG 90 GTG 
 
 
 
 
Table Supp. IX: Bacterial strains and their associated drug resistance mutations. RIF: Rifampin, FQ: Fluoroquinolone, INH: 
Isoniazid. 
 
Multiplex PCR development using qPCR. For multiplex assay development, the initial focus was on 
product generation for the 5 primer sets (5-plex) covering the most challenging gene, rpoB, using wild-
type H37Rv as the DNA template.  Once the polymerase, buffer conditions, concentrations of BHQ10-
modified dCTP and of unlabeled dCTP, and the PCR thermoprofile were established, assay optimization 
was performed using all 16 primer sets (Table Supp. X) in asymmetric multiplex PCR.  Determination of 
primer concentrations was obtained systematically, as excess primer concentrations ranging from 
100nM to 500nM were tested along with excess to limiting primer ratios at 5:1, 10:1, 15:1, and 20:1.  
Amplicon quantification was performed using real-time quantitative PCR (Roche LightCycler480) as 
described in below.  Iterative primer concentration adjustments were made to specific individual primer 
sets until optimal amplicon yields were generated. 
 
 
 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 48 of 64 
 Hassibi et al. 
 
Gene 
Primer 
Primer Sequence (5’-3’) 
Amplicon Sequence (5’ – 3’) 
Mutations 
gyrA 
TB1 Excess 
GTGCTCTATGCAATGTTCGATTCC 
GTGCTCTATGCAATGTTCGATTCCGGCTTCCGCCCGGACCGCAGCCACGCCA
AGTCGGCCCGGTCGGTTGCCGAGACCATGGGCAACTACCACCCGCACGGCG
ACGCGTCGATCTACGACAGCCTGGTGCGCATGGCCCAGCCCTGGTCGCTGC
GCTACCCGCTGGTGGACGGCCAGGGCAACTTCGGCTCGCCAGGCAATGACC
CACCGGCGGCGATGAGGTACACCGAAGCCCGGCTGACCCCGTTGGCGATG
GAGATGCTGA 
A74S, T80A, 
G88C, D89N, 
A90G, A90V, 
D94G, D94H, 
D94N, D94Y   
TB1 Limiting 
TCAGCATCTCCATCGCCAAC 
TB2 Excess 
GGACTGATCGTCGGATC 
GGACTGATCGTCGGATCCCAGGGCACCGCTGATGCCTACAAAACTGGCCGC
GGCTCCATTCGAATGCGCGGAGTTGTTGAGGTAGAAGAGGATTCCCGC 
G247S 
TB2 Limiting 
GCGGGAATCCTCTTCTACCT 
TB3 Excess 
TCCGCTATTACGTTGACCA 
TCCGCTATTACGTTGACCACCAACTCGACGTCATTGTGCGGCGCACCACCTA
CCGGCTGCGCAAGGCAAACGAGCGAGCCCACATTCTGCGCGGCCTGGT 
A384V 
TB3 Limiting 
ACCAGGCCGCGCAGAAT 
gyrB 
TB4 Excess 
ACCGACATCGGTGGATTG 
ACCGACATCGGTGGATTGCCCGGCAAGCTGGCCGATTGCCGTTCCACGGAT
CCGCGCAAGTCCGAACTGTATGTCGTAGAAGGTGACTCGGCCGGCGGTTCT
GCAAAAAGCGGTCGCGATTCGATGTTCCAGGCGATACTTC 
D500N 
TB4 Limiting 
GAAGTATCGCCTGGAACATC 
TB5 Excess 
GATCATCAATGTGGAGAAAG 
GATCATCAATGTGGAGAAAGCGCGCATCGACCGGGTGCTAAAGAACACCGAA
GTTCAGGCGATCATCACGGCGCTGGGCACCGGGATCCACGACGAGTTCGAT
ATCGGCAAGCTGCGCTACCACAAGATCGTGCTGATGGC 
N538K1, 
N538K2 
TB5 Limiting 
GCCATCAGCACGATCTTGTG 
ahpC 
TB6 Excess 
TGGAATGTCGCAACCAAATG 
TGGAATGTCGCAACCAAATGCATTGTCCGCTTTGATGATGAGGAGAGTCATG
CCACTGCTAACCATTGGCGATCAATTCCCCGCCTACC 
L3K, P2S 
TB6 Limiting 
GGTAGGCGGGGAATTGATCG 
TB7 Excess 
GACCCGACGCTAGACG 
GACCCGACGCTAGACGCTGGCGAACTCCTCAAGGCTTCGGCCTAACCGGGA
TCTGGTTGGCCGGGAATCAA 
L191R 
TB7 Limiting 
TTGATTCCCGGCCAACCAGA 
fabG1-
inhA 
TB8 Excess 
GACATACCGATTTCGGCCCG 
GACATACCGATTTCGGCCCGGCCGCGGCGAGACGATAGGTTGTCGGGGTGA
CTGCCACAGCCACTGAAGGGGCCAAACCCCCATTCGTATCCCGTTCAGTCCT
GGTTACCGGAGGA 
C-15T, T-8C 
TB8 Limiting 
TCCTCCGGTAACCAGGACTG 
katG 
TB9 Excess 
GGCCATGAACGACGTCGAA 
GGCCATGAACGACGTCGAAACAGCGGCGCTGATCGTCGGCGGTCACACTTT
CGGTAAGACCCATGGCGCCGGCCCGGCCGATCTGGTCGGCCCCGAACCCG
AGGCTGCTCCGCTGGAGCAGATGGGCTTGG 
G273S 
TB9 Limiting 
CCAAGCCCATCTGCTCCAGC 
TB10 Excess 
CGTATGGCACCGGAACCG 
CGTATGGCACCGGAACCGGTAAGGACGCGATCACCAGCGGCATCGAGGTCG
TATGGACGAACACCCCGACGAAATGGGACAACAGTTTCCTCGAGATCCTGTA
CGGCTACGAGTGGGAGCTGACGAAGAG 
S315I, S315N, 
S315T1, 
S315T2, I335V 
TB10 Limiting 
CTCTTCGTCAGCTCCCACTC 
TB11 Excess 
GCCGAGATTGCCAGCCTTAA 
GCCGAGATTGCCAGCCTTAAGAGCCAGATCCGGGCATCGGGATTGACTGTCT
CACAGCTAGTTTCGACC 
R463L 
TB11 Limiting 
GGTCGAAACTAGCTGTGAGACA 
rpoB 
TB12 Excess 
GAGCAAAACAGCCGCTAGTC 
GAGCAAAACAGCCGCTAGTCCTAGTCCGAGTCGCCCGCAAAGTTCCTCGAAT
AACTCCGTACCCGGAGCGCCAAACCGGGTCTCCTTCGCTAAGCTGCGCGAA
CCACTTGAGGTTCCGGGACTCCTTGACGTCCAGACCGATTCGTTCGAGTGGC
TGATCGG 
P126L 
TB12 Limiting 
CCGATCAGCCACTCGAACGAA 
TB13 Excess 
CAACACCGGTGAGATCAAGAG 
CAACACCGGTGAGATCAAGAGTCAGACGGTGTTCATGGGTGACTTCCCGATG
ATGACCGAGAAGGGCACGTTCATCATCAACGGGACCGAGCGTGTGGTGGTC
AGCCAGCTGGTGCGGTCGCCCGGGGTGTACTTCGACGAGACCATTGACAAG
TCCACCGACAAGACGCTGCACAGCGTCAAGGTGATCCCG 
V251F 
TB13 Limiting 
CGGGATCACCTTGACGCTGT 
TB14 Excess 
CGAGCTGATCCAAAACCAGA 
CGAGCTGATCCAAAACCAGATCCGGGTCGGCATGTCGCGGATGGAGCGGGT
GGTCCGGGAGCGGATGACCACCCAGGACGTGGAGGCGATCACACCGCAGA
CGTTGATCAACATCCGGCCGGTGGTCGCCGCGATCAA 
Q490R 
TB14 Limiting 
TTGATCGCGGCGACCACC 
TB15 Excess 
CGATCAAGGAGTTCTTCGGC 
CGATCAAGGAGTTCTTCGGCACCAGCCAGCTGAGCCAATTCATGGACCAGAA
CAACCCGCTGTCGGGGTTGACCCACAAGCGCCGACTGTCGGCGCTGGGGC
CCGGCGGTCTGTCACGTGAGCGTGCCGGGCTGGAGGTCCGCGACGTGCAC
CC 
L511P, Q513K, 
Q513L, Q513P, 
D516F, D516G, 
D516V, D516Y, 
S522L, S522Q, 
S522T, H526C, 
H526D, H526L, 
H526N, H526R, 
H526Y, S531C, 
S531F, S531L, 
S531W, L533P 
TB15 Limiting 
GGGTGCACGTCGCGGACCTCC 
TB16 Excess 
CACTACGGCCGGATGTG 
CACTACGGCCGGATGTGCCCGATCGAAACCCCTGAGGGGCCCAACATCGGT
CTGATCGGCTCGCTGTCGGTGTACGCGCGGGTCAACCCGTTCGGGTTCATC
GAAACGCCGTACCGCAAGGTGGTCGACGGCGTGGTTAGCGACGAGATCGTG
TACCTGACCGCC 
I572F, F586V 
TB16 Limiting 
GGCGGTCAGGTACACGATCTC 
 
Table Supp. X: The Mycobacterium tuberculosis (MTB) multiplex asymmetric PCR assay was divided into 16 panels, covering 
54 drug-resistance mutations on 6 different genes. Primer sequences and wild-type excess-strand amplicons are indicated 
above. 
 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 49 of 64 
 Hassibi et al. 
Probe pair verification. The probe pairs specified in Table Supp. XI were designed for SNP identification. 
Fifty-four probe pairs were designed targeting 54 different mutations in gyrA, katG, aphC, inhA and rpoB 
genes, located in 16 different amplicons. The probes are named as 
<gene>_<amplicon>_<mutation>_wild/mutant.  The probes were printed on a 1”x3” silicon slide and 
qualified by hybridization to a unique synthetic target (300nM concentration) for each mutation in a 
50µl flow-through chamber. Hybridization was done at 45°C for 60 min and was followed by a 45-95°C 
melt over 25 min, during which the slides were imaged every 10 s using a Leica DMi8 inverted 
microscope. The probe pairs were qualified by verifying that the expected melting curve signatures were 
obtained for the wild-type and mutant targets for each individual probe pair. 
 
 
Probe Pair 
Wild-type Probe Sequence (5'-3') 
Mutant Probe Sequence (5'-3') 
gyrA_TB1_A74S 
AACCGACCGGGCCGACTTGGCGAAATGGCTGT 
AACCGACCGGGACGACTTGGCGAAATGGCTGT 
gyrA_TB1_T80A 
TGCGGGTGGTAGTTGCCCATGGTCTCGGCAA 
TGCGGGTGGTAGTTGCCCATGGCCTCGGCAA 
gyrA_TB1_G88C 
ACGCGTCGCCGTGCGGGT 
ACGCGTCGCAGTGCGGGT 
gyrA_TB1_D89N 
GACGCGTCGCCGTGC 
GACGCGTTGCCGTGC 
gyrA_TB1_A90G 
AGGCTTTATCGACGCGTCGCCGTGCGGGTGGTA 
AGGCTTTATCGACCCGTCGCCGTGCGGGTGGTA 
gyrA_TB1_A90V 
AGGCTTTATCGACGCGTCGCCGTGCGGGTGGTA 
AGGCTTTATCGACACGTCGCCGTGCGGGTGGTA 
gyrA_TB1_D94G 
ACCAGGCTGTCGTAGATTAATAGCGTGCGGGTGGTA 
ACCAGGCTGCCGTAGATTAATAGCGTGCGGGTGGTA 
gyrA_TB1_D94H 
ACCAGGCTGTCGTAGATGCCGTGCGGGTGGTA 
ACCAGGCTGTGGTAGATGCCGTGCGGGTGGTA 
gyrA_TB1_D94N 
ACCAGGCTGTCGTAGATGCCGTGCGGGTGGTA 
ACCAGGCTGTTGTAGATGCCGTGCGGGTGGTA 
gyrA_TB1_D94Y 
ACCAGGCTGTCGTAGATGCCGTGCGGGTGGTA 
ACCAGGCTGTAGTAGATGCCGTGCGGGTGGTA 
gyrA_TB2_G247S 
CCGCGGCCAGTTTTGTAGGT 
CCGCGGCTAGTTTTGTAGGT 
gyrA_TB3_A384V 
ACGCTCGTTTGCCTTGCGC 
ACGCTCGTTTACCTTGCGC 
gyrB_TB4_D500N 
GGCCGAGTCACCTTCTACGA 
GGCCGAGTTACCTTCTACGA 
gyrB_TB5_N538K1 
ACTTCGGTGTTCTTTAGCAC 
ACTTCGGTCTTCTTTAGCAC 
gyrB_TB5_N538K2 
ACTTCGGTGTTCTTTAGCA 
ACTTCGGTTTTCTTTAGCA 
ahpC_TB6_P2S 
AGGTTAGCAGTGGCATGACT 
AGGTTAGCAGTGACATGACT 
ahpC_TB6_L3K 
CAATGGTTAGCAGTGGCATGT 
CAATGGTTAGCTTTGGCATGT 
ahpC_TB7_L191R 
CGAAGCCTTGAGGAGTTC 
CGAAGCCTTGCGGAGTTC 
inhA_TB8_C-15T 
CGACAACCTATCGTCTCGCCGC 
CGACAACCTATCATCTCGCCGC 
inhA_TB8_T-8C 
GTCACCCCGACAACCTATCGTC 
GTCACCCCGACAGCCTATCGTC 
katG_TB9_G273S 
CATGGGTCTTACCGAAAGTGT 
CATGGGTCTTACTGAAAGTGT 
katG_TB10_S315I 
ACGATGCCGCTGGTGATCCTTACCGGTTCC 
ACGATGCCGATGGTGATCCTTACCGGTTCC 
katG_TB10_S315N 
ACGATGCCGCTGGTGATCCTTACCGGTTCC 
ACGATGCCGTTGGTGATCCTTACCGGTTCC 
katG_TB10_S315T1 
ACGATGCCGCTGGTGATCCTTACCGGTTC 
ACGATGCCTGTGGTGATCCTTACCGGTTCC 
katG_TB10_S315T2 
ACGATGCCGCTGGTGATCCTTACCGGTTCC 
ACGATGCCGGTGGTGATCCTTACCGGTTCC 
katG_TB10_I335V 
GTACAGGATCTCGAGGT 
GTACAGGACCTCGAGGT 
katG_TB11_R463L 
ATCCCGATGCCCGGATCTGT 
ATCCCGATGCCAGGATCTGT 
rpoB_TB12_P126L 
ACAAGGAGTCCCGGAACCTCAAGT 
ACAAGGAGTCCTAGAACCTCAAGT 
rpoB_TB13_V251F 
CAGCTGGCTGACCACCACA 
CAGCTGGCTGAACACCACA 
rpoB_TB14_Q490R 
TGTTGATCAACGTCTGCGGTGA 
TGTTGATCAACGTCCGCGGTGA 
rpoB_TB15_L511P 
AGAATTGGCTCAGCTGGCT 
AGAATTGGCTCGGCTGGCT 
rpoB_TB15_Q513K 
GTCCATGAATTGGCTCAGC 
GTCCATGAATTTGCTCAGC 
rpoB_TB15_Q513L 
TCCATGAATTGGCTCAGC 
TCCATGAATAGGCTCAGC 
rpoB_TB15_Q513P 
GGTCCATGAATTGGCTCAGT 
GGTCCATGAATGGGCTCAGT 
rpoB_TB15_D516F 
CGGGTTGTTCTGGTCCATGAATTGT 
CGGGTTGTTCTGGAACATGAATTGT 
rpoB_TB15_D516G 
GCGGGTTGTTCTGGTCCATGAATT 
GCGGGTTGTTCTGTCCCATGAATT 
rpoB_TB15_D516V 
GGGTTGTTCTGGTCCATGAAT 
GGGTTGTTCTGGACCATGAAT 
rpoB_TB15_D516Y 
GGGTTGTTCTGGTCCATGAATTGT 
GGGTTGTTCTGGTACATGAATTGT 
rpoB_TB15_S522L 
GGTCAACCCCGACAGCGGT 
GGTCAACCCCAACAGCGGT 
rpoB_TB15_S522Q 
GGGTCAACCCCGACAGCGGGT 
GGGTCAACCCCTGCAGCGGGT 
rpoB_TB15_S522T 
GGTCAACCCCGACAGCGGT 
GGGTCAACCCCGTCAGCGGGT 
rpoB_TB15_H526C 
AGTCGGCGCTTGTGGGTCAACCCC 
AGTCGGCGCTTGCAGGTCAACCCC 
rpoB_TB15_H526D 
GTCGGCGCTTGTGGGTCAACCCC 
GTCGGCGCTTGTCGGTCAACCCC 
rpoB_TB15_H526L 
AGTCGGCGCTTGTGGGTCAAC 
AGTCGGCGCTTGAGGGTCAAC 
rpoB_TB15_H526N 
GTCGGCGCTTGTGGGTCAACCCC 
GTCGGCGCTTGTTGGTCAACCCC 
rpoB_TB15_H526R 
AGTCGGCGCTTGTGGGTCAAC 
AGTCGGCGCTTGCGGGTCAAC 
rpoB_TB15_H526Y 
AGTCGGCGCTTGTGGGTCAACCC 
AGTCGGCGCTTGTAGGTCAACCC- 
rpoB_TB15_S531C 
CCCAGCGCCGACAGTCGGAAAATGTGGGTCAAC 
CCCAGCGCACACAGTCGGAAAATGTGGGTCAAC 
rpoB_TB15_S531F 
CCCAGCGCCGACAGTCGGTGTGGGTCAAC 
CCCAGCGCGAACAGTCGGTGTGGGTCAAC 
rpoB_TB15_S531L 
CCCAGCGCCGACAGTCGGTGTGGGTCAAC- 
CCCAGCGCCAACAGTCGGTGTGGGTCAAC 
rpoB_TB15_S531W 
CCCAGCGCCGACAGTCGGTGTGGGTCAAC 
CCCAGCGCCCACAGTCGGTGTGGGTCAAC 
rpoB_TB15_L533P 
TCACGTGACAGACGGGCCCCAGCGCCGACAGTGTGGGT 
TCACGTGACAGACGGGCCCCGGCGCCGACAGTGTGGGT 
rpoB_TB16_I572F 
CGAGCCGATCAGACCGATGT 
CGAGCCGAACAGACCGATGT 
rpoB_TB16_F586V 
CGTTTCGATGAACCCGAACGT 
CGTTTCGATGACCCCGAACGT 
 
Table Supp. XI: Wild-type and mutant probe pairs used to capture MTB amplicons during on-chip hybridization 
 
 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 50 of 64 
 Hassibi et al. 
A.3. CMOS Biochip Layout and Probes 
MTB Array Layout and Key (Table Supp. XII). The probe pairs for 54 different mutations were spotted 
on the biochip. In some cases, the wild type probes were shared across mutations in the same region 
such as in D94H, D94N and D94Y in gyrA. At least 5 replicates of each probe were spotted in the array, 
as shown in the array map. See key below for probe content. Probes not referenced in this study are 
labeled as Test Probes (T). B=Blank and denote areas where no probes were spotted; CP=Control Probe; 
PM=Process Monitor.  
 
Table Supp. XII: MTB Array Layout Key 
Identifier Probe Content 
 
Identifier Probe Content 
 
Identifier Probe Content 
 
Identifier Probe Content 
001 
gyrA_TB1_A74S_Mt 
 
031 
ahpC_TB6_P2S_Wt 
 
061 
rpoB_TB15_D516Y_Mt 
 
094 
rpoB_TB15_S531L_Mt 
002 
gyrA_TB1_A74S_Wt 
 
032 
ahpC_TB7_L191R_Mt 
 
062 
rpoB_TB15_D516Y_Wt 
 
095 
rpoB_TB15_S531W_Mt 
003 
gyrA_TB1_A90G_Mt 
 
033 
ahpC_TB7_L191R_Wt 
 
063 
rpoB_TB15_H526C_Mt 
 
096 
rpoB_TB15_S531W_Wt 
004 
gyrA_TB1_A90G_Wt 
 
034 
inhA_TB8_C-15T_Mt 
 
064 
rpoB_TB15_H526C_Wt 
 
rpoB_TB15_S531L_Wt 
gyrA_TB1_A90V_Wt 
 
035 
inhA_TB8_C-15T_Wt 
 
065 
rpoB_TB15_H526D_Mt 
 
rpoB_TB15_S531F_Wt 
005 
gyrA_TB1_A90V_Mt 
 
036 
inhA_TB8_T-8C_Mt 
 
066 
rpoB_TB15_H526D_Wt 
 
097 
rpoB_TB16_F586V_Mt 
006 
gyrA_TB1_D89N_Mt 
 
037 
inhA_TB8_T-8C_Wt 
 
067 
rpoB_TB15_H526L_Mt 
 
098 
rpoB_TB16_F586V_Wt 
007 
gyrA_TB1_D89N_Wt 
 
038 
katG_TB9_G273S_Mt 
 
068 
rpoB_TB15_H526L_Wt 
 
099 
rpoB_TB16_I572F_Mt 
008 
gyrA_TB1_D94G_Mt 
 
039 
katG_TB9_G273S_Wt 
 
069 
rpoB_TB15_H526N_Mt 
 
100 
rpoB_TB16_I572F_Wt 
009 
gyrA_TB1_D94G_Wt 
 
040 
katG_TB10_I335V_Mt 
 
070 
rpoB_TB15_H526N_Wt 
 
B 
Blank (No Probe) 
010 
gyrA_TB1_D94H_Mt 
 
041 
katG_TB10_I335V_Wt 
 
071 
rpoB_TB15_H526R_Mt 
 
CP 
Control Probe 
011 
gyrA_TB1_D94H_Wt 
 
042 
katG_TB10_S315I_Mt 
 
072 
rpoB_TB15_H526R_Wt 
 
PM 
Process Monitor 
gyrA_TB1_D94N_Wt 
 
043 
katG_TB10_S315N_Mt 
 
073 
rpoB_TB15_H526Y_Mt 
 
T01 
Test_Probe_1 
gyrA_TB1_D94Y_Wt 
 
044 
katG_TB10_S315T1_Mt 
 
074 
rpoB_TB15_H526Y_Wt 
 
T02 
Test_Probe_2 
012 
gyrA_TB1_D94N_Mt 
 
045 
katG_TB10_S315T2_Mt 
 
075 
rpoB_TB15_L511P_Mt 
 
T03 
Test_Probe_3 
013 
gyrA_TB1_D94Y_Mt 
 
046 
katG_TB10_S315T2_Wt 
 
076 
rpoB_TB15_L511P_Wt 
 
T04 
Test_Probe_4 
014 
gyrA_TB1_G88C_Mt 
 
katG_TB10_S315T1_Wt 
 
077 
rpoB_TB15_L533P_Mt 
 
T05 
Test_Probe_5 
015 
gyrA_TB1_G88C_Wt 
 
katG_TB10_S315N_Wt 
 
078 
rpoB_TB15_L533P_Wt 
 
T06 
Test_Probe_6 
016 
gyrA_TB1_T80A_Mt 
 
katG_TB10_S315I_Wt 
 
079 
rpoB_TB15_Q513K_Mt 
 
T07 
Test_Probe_7 
017 
gyrA_TB1_T80A_Wt 
 
047 
katG_TB11_R463L_Mt 
 
080 
rpoB_TB15_Q513K_Wt 
 
T08 
Test_Probe_8 
018 
gyrA_TB2_G247S_Mt 
 
048 
katG_TB11_R463L_Wt 
 
081 
rpoB_TB15_Q513L_Mt 
 
T09 
Test_Probe_9 
019 
gyrA_TB2_G247S_Wt 
 
049 
rpoB_TB12_P126L_Mt 
 
082 
rpoB_TB15_Q513L_Wt 
 
T10 
Test_Probe_10 
020 
gyrA_TB3_A384V_Mt 
 
050 
rpoB_TB12_P126L_Wt 
 
083 
rpoB_TB15_Q513P_Mt 
 
T11 
Test_Probe_11 
021 
gyrA_TB3_A384V_Wt 
 
051 
rpoB_TB13_V251F_Mt 
 
084 
rpoB_TB15_Q513P_Wt 
 
T12 
Test_Probe_12 
022 
gyrB_TB4_D500N_Mt 
 
052 
rpoB_TB13_V251F_Wt 
 
085 
rpoB_TB15_S522L_Mt 
 
T13 
Test_Probe_13 
023 
gyrB_TB4_D500N_Wt 
 
053 
rpoB_TB14_Q490R_Mt 
 
086 
rpoB_TB15_S522L_Wt 
 
T14 
Test_Probe_14 
024 
gyrB_TB5_N538K1_Mt 
 
054 
rpoB_TB14_Q490R_Wt 
 
087 
rpoB_TB15_S522Q_Mt 
 
T15 
Test_Probe_15 
025 
gyrB_TB5_N538K1_Wt 
 
055 
rpoB_TB15_D516F_Mt 
 
088 
rpoB_TB15_S522Q_Wt 
 
T16 
Test_Probe_16 
026 
gyrB_TB5_N538K2_Mt 
 
056 
rpoB_TB15_D516F_Wt 
 
089 
rpoB_TB15_S522T_Mt 
 
T17 
Test_Probe_17 
027 
gyrB_TB5_N538K2_Wt 
 
057 
rpoB_TB15_D516G_Mt 
 
090 
rpoB_TB15_S522T_Wt 
 
T18 
Test_Probe_18 
028 
ahpC_TB6_L3K_Mt 
 
058 
rpoB_TB15_D516G_Wt 
 
091 
rpoB_TB15_S531C_Mt 
 
T19 
Test_Probe_19 
029 
ahpC_TB6_L3K_Wt 
 
059 
rpoB_TB15_D516V_Mt 
 
092 
rpoB_TB15_S531C_Wt 
 
T20 
Test_Probe_20 
030 
ahpC_TB6_P2S_Mt 
 
060 
rpoB_TB15_D516V_Wt 
 
093 
rpoB_TB15_S531F_Mt 
 
 
 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 51 of 64 
 Hassibi et al. 
 
+ 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 
1 PM 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
PM 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
PM 
2 T11 T12 CP 077 078 079 080 081 082 083 084 085 086 087 088 CP 089 090 091 092 093 096 095 096 097 098 CP 099 100 T13 T14 T15 
3 001 002 003 004 006 007 008 009 010 011 T17 011 013 011 014 015 T01 T02 T03 T04 016 017 018 019 020 021 T05 T06 022 023 T07 T08 
4 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
5 026 027 028 029 CP 030 031 032 033 034 035 CP 043 046 038 039 040 041 042 046 CP T13 044 046 094 096 047 048 061 062 051 052 
6 053 054 055 056 001 002 003 004 006 007 093 096 010 011 012 011 014 015 T01 T02 034 035 016 017 018 019 057 058 059 060 061 062 
7 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
8 063 064 065 066 018 019 020 021 PM T17 T18 022 023 T07 T08 024 025 026 027 T19 T20 030 031 CP PM T19 T20 T13 067 068 069 070 
9 071 072 073 074 075 076 043 046 094 096 040 041 042 046 043 046 045 046 CP 047 048 049 050 T19 T20 CP 053 054 T11 T12 079 080 
10 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
11 081 082 083 084 CP T09 T10 055 056 057 058 059 060 061 062 063 064 065 066 067 068 069 070 071 072 073 074 085 086 T14 087 088 
12 091 092 093 096 073 074 075 076 077 078 T16 T11 T12 079 080 081 082 083 084 T16 085 086 087 088 089 090 T14 095 096 097 098 CP 
13 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
14 099 100 T13 013 011 091 092 094 096 097 098 099 100 013 011 T15 001 002 005 004 006 007 008 009 013 011 005 004 003 004 005 004 
15 006 007 008 009 010 011 012 011 T17 T18 T01 T02 T03 T04 016 017 018 019 020 021 T05 T06 022 023 044 046 024 025 012 011 014 015 
16 PM 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
PM 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
PM 
17 T17 T18 CP T03 T04 024 025 026 027 028 029 030 031 032 033 034 035 036 037 038 039 CP 040 041 042 046 043 046 044 046 045 046 
18 T05 T06 T19 T20 045 046 047 048 049 050 051 052 T09 T10 053 054 055 056 T17 T18 059 060 061 062 063 064 065 066 T07 T08 024 025 
19 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
20 028 029 030 031 065 066 067 068 069 070 071 072 073 074 075 076 T11 T12 077 078 079 080 081 082 083 084 085 086 032 033 034 035 
21 036 037 038 039 CP 087 088 089 090 091 092 CP 093 096 095 096 097 098 099 100 095 096 094 096 CP 001 002 094 096 043 046 CP 
22 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
23 045 046 047 048 003 004 005 004 006 007 008 009 010 011 012 011 014 015 T01 T02 T03 T04 016 017 089 090 T15 049 050 T19 T20 CP 
24 053 054 055 056 020 021 T05 T06 PM 022 023 T07 T08 077 078 026 027 028 029 030 031 032 033 T14 PM 036 037 057 058 059 060 T15 
25 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
26 063 064 065 066 036 037 038 039 040 041 042 046 044 046 045 046 049 050 051 052 T09 T10 053 054 055 056 067 068 069 070 075 076 
27 071 072 T16 073 074 057 058 059 060 CP 061 062 063 064 065 066 067 068 069 070 T16 071 072 073 074 075 076 T13 T11 T12 077 078 
28 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
29 079 080 081 082 083 084 085 086 087 088 089 090 091 092 093 096 095 096 097 098 099 100 T14 013 011 001 002 003 004 005 004 T15 
30 008 009 010 011 012 011 014 015 T01 T02 T16 T03 T04 016 017 018 019 020 021 T05 T06 022 023 T09 T10 024 025 026 027 028 029 CP 
31 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
B 
32 PM 032 033 034 035 036 037 038 039 040 041 042 046 044 046 CP PM 047 048 049 050 051 052 T09 T10 T07 T08 055 056 057 058 PM 
 
 
 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 52 of 64 
 Hassibi et al. 
 
A.4. CMOS Biochip Experiments 
We conducted 12 experiments on 12 separate CMOS biochips to demonstrate the SNP detection 
capabilities of our system. In Fig. 5 and Table I, we demonstrate differential solid-phase melting curve 
identification of 13 SNP mutations that confer drug resistance in M. tuberculosis10. Melting curves for a 
probe pair designed in an easily accessible region, as in the case of I572F in the rpoB gene, and for a 
probe pair designed in a complex and thermodynamically stable secondary structure, as in the case of 
D94G mutation in gyrA, are shown in Fig. 5.  The results from screening one drug-sensitive wild-type 
strain (H37RV) and 11 drug-resistant mutant strains, which harbor 13 SNPs conferring antibiotic 
resistance are reported in Table I. The detailed methods of these biochip experiments can be found 
below. 
Multiplex Asymmetric PCR Amplification and Quencher Incorporation. Sixteen-plex asymmetric PCR was 
performed in the presence of BHQ10-modified dCTP for the purpose of generating single-stranded 
quencher-labeled PCR amplicons complementary to fluorophore-labeled capture probes (Fig. 2c). The 
ratio of excess to limiting primer (BioSearch Technologies & Integrated DNA Technologies) was 10:1 
(500nM excess primer, 50nM limiting primer), except TB1 and TB9 primers where used at 30:1 and 20:1 
ratios, respectively (1.5µM TB1 excess primer and 1.0µM TB9 excess primer, 50nM each limiting primer). 
PCR was performed in 25µl volumes using a modified PCR buffer generated in-house (20mM Tris-HCl, 
pH8.9, 50mM KCl, 30mM NH4Cl, 3.2mM MgCl2, 4mM CHAPS, and 1mg/ml BSA), 400µM each dNTP 
(400µM dATP, dTTP, and dGTP, 200µM dCTP [Thermo-Fisher Scientific], and 200µM BHQ10-dCTP 
[Biosearch Technologies]), 0.5U/µl Taq polymerase (New England Biolabs, Inc.), and 5000 copies of 
genomic DNA template/25µl reaction.  PCR was carried out in a C1000 Touch (BioRad Laboratories, Inc.) 
as follows: 1) reactions were heat denatured at 95°C for 3 min, followed by 2) five cycles of initial 
amplification at 95°C for 30 s, 62°C for 40 s, and 68°C for 40 s, then 3) an additional 50 cycles of 95°C for 
30 s, 58°C for 40 s, and 68°C for 40 s, and 4) a final extension step for 3 min extension at 68°C. For each 
biochip experiment, four individual 25µl reactions were run and pooled post-PCR. 
Purification of PCR Product. Desalting and removal of unincorporated BHQ10-dCTPs from amplified PCR 
product was performed using a Microcon YM-30 filter (EMD Millipore) according to the manufacturer’s 
recommendations. Briefly, 80µl of PCR product was brought up to 200µl volume in 10mM Tris-HCl pH 
8.5, applied to the Microcon filter device, and centrifuged at 5000 xg for 12 min, until 20-30µl of 
concentrate remained. A second wash step was performed by bringing the volume of concentrate up to 
200µl with 10mM Tris-HCl pH 8.5 and centrifuging at 5000 xg for 12 min. The concentrate was collected 
into a new microfuge tube by inverting the column and spinning at 1000 xg for 1 min. Concentrate 
volume was brought up to 40µl with 10mM Tris-HCl pH 8.5 and diluted 1:1 in 2X Hybridization Buffer 
(50mM Tris, 110mM NaCl, 7mM MgCl2). 
Hybridization and Melt of PCR Products on CMOS Biochip. Purified PCR mix was heat denatured at 95°C 
for 5 min, cooled in an ice water bath, and centrifuged at 10,000 xg for 1 min. Sixty-two µl was then 
loaded into the chamber of the CMOS biochip. The remaining volume was saved for amplicon 
quantification via qPCR. A two-temperature hybridization for probe capture of amplicons was 
performed on-chip for 90 min at 55°C and 30 min at 45°C, followed by a melt from 45°C to 95°C over 25 
min. 
 
 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 53 of 64 
 Hassibi et al. 
A.5. Post-CMOS Biochip Verification 
qPCR Confirmation of 16-Plex Asymmetric PCR Products. Quantification of the 16-plex asymmetric PCR 
products loaded on the biochip was conducted to confirm depletion of limiting primers and the 
generation of single-stranded PCR product (Table Supp. XIII). Purified 16-Plex PCR products for each M. 
tuberculosis strain tested (Fig 5. and Table I) were diluted either 103-fold or 104-fold and added to a 10µl 
final volume reaction mix containing 1X SensiFast Probe No-Rox PCR mix (Bioline), 0.3µM each primer, 
and 0.1µM TaqMan probe (BioSearch Technologies & Integrated DNA Technologies). The qPCR reactions 
were carried out in a 384-well plate on a LightCycler 480 (Roche), with an initial denaturation step at 
95°C for 5 min, followed by 40 cycles at 95°C for 30 s and 60°C for 30 s, and a final cool down at 40°C for 
30 s. Amplicon yields were calculated based on standard curves generated using synthetic ssDNA 
templates ranging from 0.05 to 10pM (n=6 replicates). Because it takes one cycle to generate dsDNA 
from ssDNA template, one Cq was subtracted from each threshold value obtained with the single-
stranded template to generate a double-stranded template calibration curve. Amplicon yields over 
50nM, the concentration of each limiting primer, indicated that the limiting primer was depleted and 
that single-stranded product was generated in the original asymmetric PCR.  
 
 
 
Strain 
 
 
H37Rv 
TDR0005 
TDR0009 
TDR0021 
TDR0036 
TDR0117 
TDR0133 
TDR0160 
TDR0168 
TDR0191 
TDR0226 
TDR0231 
Concentration (nM) 
TB1 
67/66 
95/124 
77/82 
73/60 
127/122 
109/101 
94/96 
114/112 
89/85 
123/120 
103/74 
51/52 
TB2 
455/604 
510/507 
538/522 
573/593 
570/563 
476/499 
463/410 
447/429 
519/465 
535/507 
493/487 
434/419 
TB3 
158/155 
189/189 
192/194 
199/167 
170/199 
171/182 
191/198 
173/155 
151/165 
192/195 
140/151 
111/136 
TB4 
185/182 
212/232 
240/228 
237/202 
242/232 
225/248 
149/220 
216/199 
206/194 
257/260 
187/182 
132/137 
TB5 
201/183 
252/252 
261/268 
297/252 
285/231 
281/264 
259/259 
249/218 
202/226 
261/270 
188/224 
192/178 
TB6 
337/349 
363/346 
337/337 
380/370 
406/425 
358/393 
289/307 
316/291 
218/191 
372/393 
213/244 
264/225 
TB7 
377/379 
431/381 
416/390 
450/447 
429/442 
527/497 
281/377 
320/341 
379/364 
458/429 
395/362 
395/311 
TB8 
224/221 
265/258 
239/226 
296/265 
311/307 
241/244 
146/136 
256/220 
236/235 
283/277 
215/259 
173/191 
TB9 
93/101 
117/107 
107/107 
124/119 
126/116 
103/112 
96/109 
125/108 
109/111 
125/129 
109/84 
62/77 
TB10 
190/179 
220/218 
226/226 
194/226 
235/235 
206/221 
206/240 
207/202 
191/189 
208/211 
233/203 
196/182 
TB11 
735/644 
339/499 
408/408 
772/897 
967/853 
370/534 
657/717 
682/609 
730/772 
726/699 
739/758 
230/228 
TB12 
129/137 
157/164 
150/152 
170/133 
178/145 
130/156 
135/149 
185/165 
148/104 
173/166 
157/127 
109/97 
TB13 
277/258 
332/343 
277/315 
399/407 
374/410 
306/319 
364/347 
371/379 
343/350 
371/394 
336/310 
167/142 
TB14 
370/325 
481/429 
258/286 
457/512 
570/542 
394/441 
512/494 
795/859 
470/445 
586/603 
558/695 
108/108 
TB15 
330/320 
378/365 
352/446 
357/418 
431/431 
373/337 
443/421 
456/389 
327/286 
480/450 
395/440 
224/278 
TB16 
114/113 
158/143 
141/130 
162/162 
172/173 
141/137 
72/69 
161/160 
157/162 
200/186 
158/162 
82/80 
 
Table Supp. XIII: Measured final product concentrations, conducted by qPCR for all MTB amplicons and strains (2 replicates 
separated by “/”).  
 
 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 54 of 64 
 Hassibi et al. 
B. Amplicon Structure, Mutation Coordinates, and Probe Sequences  
Shown below are the optimal monomer structures of each individual amplicon simulated using the OMP 
software, along with the location of each individual mutation (Fig. Supp. 33-48). Each structure was 
simulated using 87mM monovalent salt and 3.56mM divalent salt at 55°C. The table shows the mutation 
name, probe name for identifying the mutation, the probe pair sequences, and the probe type. Random 
coil probes are the simplest probes and are directly complementary to a continuous region on the 
amplicon surrounding the mutation. This is used when the mutation lies in the random coil region of the 
amplicon, see I572F mutation in rpoB gene of TB16 amplicon (Fig. 5a). Anchor probes are designed for 
mutations, which lie in the hairpin structure and are not readily accessible to probe binding. In this case, 
the probes have an “anchor” section, which binds to a nearby more readily accessible region, for 
example the D94G mutation in gyrA of the TB1 amplicon (Fig. 5b). 
 
Figure Supp. 33: Secondary structure of TB1 amplicon at 55°C, location of the mutations and IFT probes sequences. 
Amplicon: 
Amplicon: TB1 gyrA 
 
 
 
 
Mutation 
Probe 
Sequence 
Probe Type 
1 
GCC-74-TCC 
gyrA_TB1_A74S_Wt 
Amino C6-TTTTTTAACCGACCGGGCCGACTTGGCGAAATGGCTGT-T(FAM)-TTTTTT-TAMRA 
Anchor 
gyrA_TB1_A74S_Mt 
Amino C6-TTTTTTAACCGACCGGGACGACTTGGCGAAATGGCTGT-T(FAM)-TTTTTT-TAMRA 
Anchor 
2 
ACC-80-GCC 
gyrA_TB1_T80A_Wt 
Amino C6-TTTTTTTGCGGGTGGTAGTTGCCCATGGTCTCGGCAA-T(FAM)-TTTTTT-TAMRA 
Anchor 
gyrA_TB1_T80A_Mt 
Amino C6-TTTTTTTGCGGGTGGTAGTTGCCCATGGCCTCGGCAA-T(FAM)-TTTTTT-TAMRA 
Anchor 
3 
GGC-88-TGC 
gyrA_TB1_G88C_Wt 
Amino C6-TTTTTTACGCGTCGCCGTGCGGGT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
gyrA_TB1_G88C_Mt 
Amino C6-TTTTTTACGCGTCGCAGTGCGGGT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
4 
GAC-89-AAC 
gyrA_TB1_D89N_Wt 
Amino C6-TTTTTTGACGCGTCGCCGTGC-T(FAM)-TTTTTT-TAMRA 
Random Coil 
gyrA_TB1_D89N_Mt 
Amino C6-TTTTTTGACGCGTTGCCGTGC-T(FAM)-TTTTTT-TAMRA 
Random Coil 
5 
GCG-90-GGG 
gyrA_TB1_A90G_Wt 
Amino C6-TTTTTTAGGCTTTATCGACGCGTCGCCGTGCGGGTGGTA-T(FAM)-TTTTTT-TAMRA 
Anchor 
gyrA_TB1_A90G_Mt 
Amino C6-TTTTTTAGGCTTTATCGACCCGTCGCCGTGCGGGTGGTA-T(FAM)-TTTTTT-TAMRA 
Anchor 
6 
GCG-90-GTG 
gyrA_TB1_A90V_Wt 
Amino C6-TTTTTTAGGCTTTATCGACGCGTCGCCGTGCGGGTGGTA-T(FAM)-TTTTTT-TAMRA 
Anchor 
gyrA_TB1_A90V_Mt 
Amino C6-TTTTTTAGGCTTTATCGACACGTCGCCGTGCGGGTGGTA-T(FAM)-TTTTTT-TAMRA 
Anchor 
7 
GAC-94-GGC 
gyrA_TB1_D94G_Wt 
Amino C6-TTTTTTACCAGGCTGTCGTAGATTAATAGCGTGCGGGTGGTA-T(FAM)-TTTTTT-TAMRA 
Anchor 
gyrA_TB1_D94G_Mt 
Amino C6-TTTTTTACCAGGCTGCCGTAGATTAATAGCGTGCGGGTGGTA-T(FAM)-TTTTTT-TAMRA 
Anchor 
8 
GAC-94-CAC 
gyrA_TB1_D94H_Wt 
Amino C6-TTTTTTACCAGGCTGTCGTAGATGCCGTGCGGGTGGTA-T(FAM)-TTTTTT-TAMRA 
Anchor 
gyrA_TB1_D94H_Mt 
Amino C6-TTTTTTACCAGGCTGTGGTAGATGCCGTGCGGGTGGTA-T(FAM)-TTTTTT-TAMRA 
Anchor 
9 
GAC-94-AAC 
gyrA_TB1_D94N_Wt 
Amino C6-TTTTTTACCAGGCTGTCGTAGATGCCGTGCGGGTGGTA-T(FAM)-TTTTTT-TAMRA 
Anchor 
gyrA_TB1_D94N_Mt 
Amino C6-TTTTTTACCAGGCTGTTGTAGATGCCGTGCGGGTGGTA-T(FAM)-TTTTTT-TAMRA 
Anchor 
10 
GAC-94-TAC 
gyrA_TB1_D94Y_Wt 
Amino C6-TTTTTTACCAGGCTGTCGTAGATGCCGTGCGGGTGGTA-T(FAM)-TTTTTT-TAMRA 
Anchor 
gyrA_TB1_D94Y_Mt 
Amino C6-TTTTTTACCAGGCTGTAGTAGATGCCGTGCGGGTGGTA-T(FAM)-TTTTTT-TAMRA 
Anchor 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 55 of 64 
 Hassibi et al. 
 
Figure Supp. 34: Secondary structure of TB2 amplicon at 55°C, location of the mutations and IFT probes sequences. 
 
Figure Supp. 35: Secondary structure of TB3 amplicon at 55°C, location of the mutations and IFT probes sequences. 
 
Figure Supp. 36: Secondary structure of TB4 amplicon at 55°C, location of the mutations and IFT probes sequences. 
 
Amplicon: 
Amplicon: TB2 gyrA 
 
 
 
Mutation 
Probe 
Sequence 
Probe Type 
1 
GGC-247-AGC 
gyrA_TB2_G247S_Wt 
Amino C6-TTTTTTCCGCGGCCAGTTTTGTAGGT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
gyrA_TB2_G247S_Mt 
Amino C6-TTTTTTCCGCGGCTAGTTTTGTAGGT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
Amplicon: 
Amplicon: TB3 gyrA 
 
 
 
 
Mutation 
Probe 
Sequence 
Probe Type 
1 
GCA-384-GTA 
gyrA_TB3_A384V_Wt 
Amino C6-TTTTTACGCTCGTTTGCCTTGCGC-T(FAM)-TTTTTT-TAMRA 
Random Coil 
gyrA_TB3_A384V_Mt 
Amino C6-TTTTTACGCTCGTTTACCTTGCGC-T(FAM)-TTTTTT-TAMRA 
Random Coil 
Amplicon: 
Amplicon: TB4 gyrB 
 
 
 
 
 
Mutation 
Probe 
Sequence 
Probe Type 
1 
GAC-500-AAC 
gyrB_TB4_D500N_Wt 
Amino C6-TTTTTTGGCCGAGTCACCTTCTACGA-T(FAM)-TTTTTT-TAMRA 
Random Coil 
gyrB_TB4_D500N_Mt 
Amino C6-TTTTTTGGCCGAGTTACCTTCTACGA-T(FAM)-TTTTTT-TAMRA 
Random Coil 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 56 of 64 
 Hassibi et al. 
 
Figure Supp. 37: Secondary structure of TB5 amplicon at 55°C, location of the mutations and IFT probes sequences. 
 
Figure Supp. 38: Secondary structure of TB6 amplicon at 55°C, location of the mutations and IFT probes sequences. 
 
Figure Supp. 39: Secondary structure of TB7 amplicon at 55°C, location of the mutations and IFT probes sequences. 
 
Amplicon: 
Amplicon: TB5 gyrB 
 
 
 
 
 
Mutation 
Probe 
Sequence 
Probe Type 
1 
AAC-538-AAG 
gyrB_TB5_N538K1_Wt 
Amino C6-TTTTTTACTTCGGTGTTCTTTAGCAC-T(FAM)-TTTTTT-TAMRA 
Random Coil 
gyrB_TB5_N538K1_Mt 
Amino C6-TTTTTTACTTCGGTCTTCTTTAGCAC-T(FAM)-TTTTTT-TAMRA 
Random Coil 
2 
AAC-538-AAA 
gyrB_TB5_N538K2_Wt 
Amino C6-TTTTTTACTTCGGTGTTCTTTAGCA-T(FAM)-TTTTTT-TAMRA 
Random Coil 
gyrB_TB5_N538K2_Mt 
Amino C6-TTTTTTACTTCGGTTTTCTTTAGCA-T(FAM)-TTTTTT-TAMRA 
Random Coil 
Amplicon: 
Amplicon: TB6 ahpC 
 
 
 
 
Mutation 
Probe 
Sequence 
Probe Type 
1 
CCA-2-TCA 
ahpC_TB6_P2S_Wt 
Amino C6-TTTTTAGGTTAGCAGTGGCATGACT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
ahpC_TB6_P2S_Mt 
Amino C6-TTTTTAGGTTAGCAGTGACATGACT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
2 
CTG-3-AAG 
ahpC_TB6_L3K_Wt 
Amino C6-TTTTTTCAATGGTTAGCAGTGGCATGT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
ahpC_TB6_L3K_Mt 
Amino C6-TTTTTTCAATGGTTAGCTTTGGCATGT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
Amplicon: 
Amplicon: TB7 ahpC 
 
 
 
 
Mutation 
Probe 
Sequence 
Probe Type 
1 
CTC-191-CGC 
ahpC_TB7_L191R_Wt 
Amino C6-TTTTTTCGAAGCCTTGAGGAGTTC-T(FAM)-TTTTTT-TAMRA 
Random Coil 
ahpC_TB7_L191R_Mt 
Amino C6-TTTTTTCGAAGCCTTGCGGAGTTC-T(FAM)-TTTTTT-TAMRA 
Random Coil 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 57 of 64 
 Hassibi et al. 
 
Figure Supp. 40: Secondary structure of TB8 amplicon at 55°C, location of the mutations and IFT probes sequences. 
 
 
Figure Supp. 41: Secondary structure of TB9 amplicon at 55°C, location of the mutations and IFT probes sequences. 
 
Amplicon: 
Amplicon: TB8 fabG1-inhA 
 
 
 
 
Mutation 
Probe 
Sequence 
Probe Type 
1 
T(-8)C 
inhA_TB8_C-15T_Wt 
Amino C6-TTTTTTCGACAACCTATCGTCTCGCCGC-T(FAM)-TTTTTT-TAMRA 
Random Coil 
inhA_TB8_C-15T_Mt 
Amino C6-TTTTTTCGACAACCTATCATCTCGCCGC-T(FAM)-TTTTTT-TAMRA 
Random Coil 
2 
C(-15)T 
inhA_TB8_T-8C_Wt 
Amino C6-TTTTTTGTCACCCCGACAACCTATCGTC-T(FAM)-TTTTTT-TAMRA 
Random Coil 
inhA_TB8_T-8C_Mt 
Amino C6-TTTTTTGTCACCCCGACAGCCTATCGTC-T(FAM)-TTTTTT-TAMRA 
Random Coil 
Amplicon: 
Amplicon: TB9 katG 
 
 
 
 
Mutation 
Probe 
Sequence 
Probe Type 
1 
GGT-273-AGT 
katG_TB9_G273S_Wt 
Amino C6-TTTTTTCATGGGTCTTACCGAAAGTGT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
katG_TB9_G273S_Mt 
Amino C6-TTTTTTCATGGGTCTTACTGAAAGTGT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 58 of 64 
 Hassibi et al. 
 
Figure Supp. 42: Secondary structure of TB10 amplicon at 55°C, location of the mutations and IFT probes sequences. 
 
 
Figure Supp. 43: Secondary structure of TB11 amplicon at 55°C, location of the mutations and IFT probes sequences. 
 
 
Figure Supp. 44: Secondary structure of TB12 amplicon at 55°C, location of the mutations and IFT probes sequences. 
Am
Amplicon: 
plicon: TB10 katG 
 
 
 
Mutation 
Probe 
Sequence 
Probe Type 
1 
AGC-315-ATC 
katG_TB10_S315I_Wt 
Amino C6-TTTTTACGATGCCGCTGGTGATCCTTACCGGTTCC-T(FAM)-TTTTTT-TAMRA 
Anchor 
katG_TB10_S315I_Mt 
Amino C6-TTTTTACGATGCCGATGGTGATCCTTACCGGTTCC-T(FAM)-TTTTTT-TAMRA 
Anchor 
2 
AGC-315-AAC 
katG_TB10_S315N_Wt 
Amino C6-TTTTTACGATGCCGCTGGTGATCCTTACCGGTTCC-T(FAM)-TTTTTT-TAMRA 
Anchor 
katG_TB10_S315N_Mt 
Amino C6-TTTTTACGATGCCGTTGGTGATCCTTACCGGTTCC-T(FAM)-TTTTTT-TAMRA 
Anchor 
3 
AGC-315-ACA 
katG_TB10_S315T1_Wt 
Amino C6-TTTTTACGATGCCGCTGGTGATCCTTACCGGTTCC-T(FAM)-TTTTTT-TAMRA 
Anchor 
katG_TB10_S315T1_Mt 
Amino C6-TTTTTACGATGCCTGTGGTGATCCTTACCGGTTCC-T(FAM)-TTTTTT-TAMRA 
Anchor 
4 
AGC-315-ACC 
katG_TB10_S315T2_Wt 
Amino C6-TTTTTACGATGCCGCTGGTGATCCTTACCGGTTCC-T(FAM)-TTTTTT-TAMRA 
Anchor 
katG_TB10_S315T2_Mt 
Amino C6-TTTTTACGATGCCGGTGGTGATCCTTACCGGTTCC-T(FAM)-TTTTTT-TAMRA 
Anchor 
5 
ATC-335-GTC 
katG_TB10_I335V_Wt 
Amino C6-TTTTTTGTACAGGATCTCGAGGT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
katG_TB10_I335V_Mt 
Amino C6-TTTTTTGTACAGGACCTCGAGGT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
Amplicon: 
Amplicon: TB11 katG 
 
 
 
 
 
Mutation 
Probe 
Sequence 
Probe Type 
1 
CGG-463-CTG 
katG_TB11_R463L_Wt 
Amino C6-TTTTTTATCCCGATGCCCGGATCTGT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
katG_TB11_R463L_Mt 
Amino C6-TTTTTTATCCCGATGCCAGGATCTGT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
Amplicon: 
Amplicon: TB12 rpoB 
 
 
 
Mutation 
Probe 
Sequence 
Probe Type 
1 
CCG-126-CTA 
rpoB_TB12_P126L_Wt 
Amino C6-TTTTTACAAGGAGTCCCGGAACCTCAAGT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
rpoB_TB12_P126L_Mt 
Amino C6-TTTTTACAAGGAGTCCTAGAACCTCAAGT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 59 of 64 
 Hassibi et al. 
 
Figure Supp. 45: Secondary structure of TB13 amplicon at 55°C, location of the mutations and IFT probes sequences. 
 
Figure Supp. 46: Secondary structure of TB14 amplicon at 55°C, location of the mutations and IFT probes sequences. 
 
Amplicon: 
Amplicon: TB13 rpoB 
 
 
 
 
 
Mutation 
Probe 
Sequence 
Probe Type 
1 
GTC-251-TTC 
rpoB_TB13_V251F_Wt 
Amino C6-TTTTTTCAGCTGGCTGACCACCACA-T(FAM)-TTTTTT-TAMRA 
Random Coil 
rpoB_TB13_V251F_Mt 
Amino C6-TTTTTTCAGCTGGCTGAACACCACA-T(FAM)-TTTTTT-TAMRA 
Random Coil 
Amplicon: 
Amplicon: TB14 rpoB 
 
 
 
Mutation 
Probe 
Sequence 
Probe Type 
1 
CAG-490-CGG 
rpoB_TB14_Q490R_Wt 
Amino C6-TTTTTTTGTTGATCAACGTCTGCGGTGA-T(FAM)-TTTTTT-TAMRA 
Random Coil 
rpoB_TB14_Q490R_Mt 
Amino C6-TTTTTTTGTTGATCAACGTCCGCGGTGA-T(FAM)-TTTTTT-TAMRA 
Random Coil 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 60 of 64 
 Hassibi et al. 
 
Figure Supp. 47: Secondary structure of TB15 amplicon at 55°C, location of the mutations and IFT probes sequences. 
 
Amplicon: 
Amplicon: TB15 rpoB 
 
 
 
 
Mutation 
Probe 
Sequence 
Probe Type 
1 
CTG-511-CCG 
rpoB_TB15_L511P_Wt 
Amino C6-TTTTTAGAATTGGCTCAGCTGGCT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
rpoB_TB15_L511P_Mt 
Amino C6-TTTTTAGAATTGGCTCGGCTGGCT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
2 
CAA-513-AAA 
rpoB_TB15_Q513K_Wt 
Amino C6-TTTTTTGTCCATGAATTGGCTCAGC-T(FAM)-TTTTTT-TAMRA 
Random Coil 
rpoB_TB15_Q513K_Mt 
Amino C6-TTTTTTGTCCATGAATTTGCTCAGC-T(FAM)-TTTTTT-TAMRA 
Random Coil 
3 
CAA-513-CTA 
rpoB_TB15_Q513L_Wt 
Amino C6-TTTTTTTCCATGAATTGGCTCAGC-T(FAM)-TTTTTT-TAMRA 
Random Coil 
rpoB_TB15_Q513L_Mt 
Amino C6-TTTTTTTCCATGAATAGGCTCAGC-T(FAM)-TTTTTT-TAMRA 
Random Coil 
4 
CAA-513-CCA 
rpoB_TB15_Q513P_Wt 
Amino C6-TTTTTTGGTCCATGAATTGGCTCAGT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
rpoB_TB15_Q513P_Mt 
Amino C6-TTTTTTGGTCCATGAATGGGCTCAGT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
5 
GAC-516-TTC 
rpoB_TB15_D516F_Wt 
Amino C6-TTTTTTCGGGTTGTTCTGGTCCATGAATTGT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
rpoB_TB15_D516F_Mt 
Amino C6-TTTTTTCGGGTTGTTCTGGAACATGAATTGT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
6 
GAC-516-GGA 
rpoB_TB15_D516G_Wt 
Amino C6-TTTTTTGCGGGTTGTTCTGGTCCATGAATT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
rpoB_TB15_D516G_Mt 
Amino C6-TTTTTTGCGGGTTGTTCTGTCCCATGAATT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
7 
GAC-516-GTC 
rpoB_TB15_D516V_Wt 
Amino C6-TTTTTTGGGTTGTTCTGGTCCATGAAT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
rpoB_TB15_D516V_Mt 
Amino C6-TTTTTTGGGTTGTTCTGGACCATGAAT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
8 
GAC-516-TAC 
rpoB_TB15_D516Y_Wt 
Amino C6-TTTTTTGGGTTGTTCTGGTCCATGAATTGT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
rpoB_TB15_D516Y_Mt 
Amino C6-TTTTTTGGGTTGTTCTGGTACATGAATTGT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
9 
TCG-522-TTG 
rpoB_TB15_S522L_Wt 
Amino C6-TTTTTTGGTCAACCCCGACAGCGGT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
rpoB_TB15_S522L_Mt 
Amino C6-TTTTTTGGTCAACCCCAACAGCGGT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
10 
TCG-522-CAG 
rpoB_TB15_S522Q_Wt 
Amino C6-TTTTTTGGGTCAACCCCGACAGCGGGT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
rpoB_TB15_S522Q_Mt 
Amino C6-TTTTTTGGGTCAACCCCTGCAGCGGGT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
11 
TCG-522-ACG 
rpoB_TB15_S522T_Wt 
Amino C6-TTTTTTGGTCAACCCCGACAGCGGT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
rpoB_TB15_S522T_Mt 
Amino C6-TTTTTTGGGTCAACCCCGTCAGCGGGT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
12 
CAC-526-TGC 
rpoB_TB15_H526C_Wt 
Amino C6-TTTTTTAGTCGGCGCTTGTGGGTCAACCCC-T(FAM)-TTTTTT-TAMRA 
Random Coil 
rpoB_TB15_H526C_Mt 
Amino C6-TTTTTTAGTCGGCGCTTGCAGGTCAACCCC-T(FAM)-TTTTTT-TAMRA 
Random Coil 
13 
CAC-526-GAC 
rpoB_TB15_H526D_Wt 
Amino C6-TTTTTTGTCGGCGCTTGTGGGTCAACCCC-T(FAM)-TTTTTT-TAMRA 
Random Coil 
rpoB_TB15_H526D_Mt 
Amino C6-TTTTTTGTCGGCGCTTGTCGGTCAACCCC-T(FAM)-TTTTTT-TAMRA 
Random Coil 
14 
CAC-526-CTC 
rpoB_TB15_H526L_Wt 
Amino C6-TTTTTTAGTCGGCGCTTGTGGGTCAAC-T(FAM)-TTTTTT-TAMRA 
Random Coil 
rpoB_TB15_H526L_Mt 
Amino C6-TTTTTTAGTCGGCGCTTGAGGGTCAAC-T(FAM)-TTTTTT-TAMRA 
Random Coil 
15 
CAC-526-AAC 
rpoB_TB15_H526N_Wt 
Amino C6-TTTTTTGTCGGCGCTTGTGGGTCAACCCC-T(FAM)-TTTTTT-TAMRA 
Random Coil 
rpoB_TB15_H526N_Mt 
Amino C6-TTTTTTGTCGGCGCTTGTTGGTCAACCCC-T(FAM)-TTTTTT-TAMRA 
Random Coil 
16 
CAC-526-CGC 
rpoB_TB15_H526R_Wt 
Amino C6-TTTTTTAGTCGGCGCTTGTGGGTCAAC-T(FAM)-TTTTTT-TAMRA 
Random Coil 
rpoB_TB15_H526R_Mt 
Amino C6-TTTTTTAGTCGGCGCTTGCGGGTCAAC-T(FAM)-TTTTTT-TAMRA 
Random Coil 
17 
CAC-526-TAC 
rpoB_TB15_H526Y_Wt 
Amino C6-TTTTTTAGTCGGCGCTTGTGGGTCAACCC-T(FAM)-TTTTTT-TAMRA 
Random Coil 
rpoB_TB15_H526Y_Mt 
Amino C6-TTTTTTAGTCGGCGCTTGTAGGTCAACCC-T(FAM)-TTTTTT-TAMRA 
Random Coil 
18 
TCG-531-TGT 
rpoB_TB15_S531C_Wt 
Amino C6-TTTTTTCCCAGCGCCGACAGTCGGAAAATGTGGGTCAAC-T(FAM)-TTTTTT-TAMRA 
Anchor 
rpoB_TB15_S531C_Mt 
Amino C6-TTTTTTCCCAGCGCACACAGTCGGAAAATGTGGGTCAAC-T(FAM)-TTTTTT-TAMRA 
Anchor 
19 
TCG-531-TTC 
rpoB_TB15_S531F_Wt 
Amino C6-TTTTTTCCCAGCGCCGACAGTCGGTGTGGGTCAAC-T(FAM)-TTTTTT-TAMRA 
Anchor 
rpoB_TB15_S531F_Mt 
Amino C6-TTTTTTCCCAGCGCGAACAGTCGGTGTGGGTCAAC-T(FAM)-TTTTTT-TAMRA 
Anchor 
20 
TCG-531-TTG 
rpoB_TB15_S531L_Wt 
Amino C6-TTTTTTCCCAGCGCCGACAGTCGGTGTGGGTCAAC-T(FAM)-TTTTTT-TAMRA 
Anchor 
rpoB_TB15_S531L_Mt 
Amino C6-TTTTTTCCCAGCGCCAACAGTCGGTGTGGGTCAAC-T(FAM)-TTTTTT-TAMRA 
Anchor 
21 
TCG-531-TGG 
rpoB_TB15_S531W_Wt 
Amino C6-TTTTTTCCCAGCGCCGACAGTCGGTGTGGGTCAAC-T(FAM)-TTTTTT-TAMRA 
Anchor 
rpoB_TB15_S531W_Mt 
Amino C6-TTTTTTCCCAGCGCCCACAGTCGGTGTGGGTCAAC-T(FAM)-TTTTTT-TAMRA 
Anchor 
22 
CTG-533-CCG 
rpoB_TB15_L533P_Wt 
Amino C6-TTTTTTTCACGTGACAGACGGGCCCCAGCGCCGACAGTGTGGGT-T(FAM)-TTTTTT-TAMRA 
Anchor 
rpoB_TB15_L533P_Mt 
Amino C6-TTTTTTTCACGTGACAGACGGGCCCCGGCGCCGACAGTGTGGGT-T(FAM)-TTTTTT-TAMRA 
Anchor 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 61 of 64 
 Hassibi et al. 
 
Figure Supp. 48: Secondary structure of TB16 amplicon at 55°C, location of the mutations and IFT probes sequences. 
 
C. Example Result for Detecting the Exact Base Change  
Single base specificity.  One of the major concerns with hybridization-based solid-phase arrays is the 
ability to identify the specific mutation of interest, at the individual base level, in cases where several 
mutations are located in the same codon. In this section, we focus on the H526 codon region in rpoB 
(TB15 amplicon) where detecting one of seven different amino acid configurations (C, D, L, N, R and Y) is 
necessary in order to correctly classify a mutant strain (Table Supp. XIV). 
 
Mutation name 
Codon change 
Base change 
H526C 
CAC-526-TGC 
CA/TG 
H526D 
CAC-526-GAC 
C/G 
H526L 
CAC-526-CTC 
A/T 
H526N 
CAC-526-AAC 
C/A 
H526R 
CAC-526-CGC 
A/G 
H526Y 
CAC-526-TAC 
C/T 
 
Table Supp. XIV: Multiple mutations in the same codon (H526_rpoB) region 
CMOS biochip experiments were performed with three clinical mutant genomic DNA thermolysates, 
strains TDR0036, TDR0168 and TDR0117  (that have H526D, H526R and H526Y mutations, respectively) 
and one wild-type H37Rv M. tuberculosis genomic DNA, using the protocol described before. The 
generated experimental data was compared with the simulated melting curve data obtained using the 
OMP software. In Fig. Supp. 49, the simulated graphs for heterodimer % vs. temperature for four 
different targets (3 mutant + 1 wild-type) on each of the seven different probe pairs are shown. ∆Tm 
Amplicon: 
Amplicon: TB16 rpoB 
 
 
 
 
 
Mutation 
Probe 
Sequence 
Probe Type 
1 
ATC-572-
TTC 
rpoB_TB16_I572F_Wt 
Amino C6-TTTTTTCGAGCCGATCAGACCGATGT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
rpoB_TB16_I572F_Mt 
Amino C6-TTTTTTCGAGCCGAACAGACCGATGT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
2 
TTC-586-
GTC 
rpoB_TB16_F586V_Wt 
Amino C6-TTTTTTCGTTTCGATGAACCCGAACGT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
rpoB_TB16_F586V_Mt 
Amino C6-TTTTTTCGTTTCGATGACCCCGAACGT-T(FAM)-TTTTTT-TAMRA 
Random Coil 
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 62 of 64 
 Hassibi et al. 
between the wild-type and mutant-type probe (Table Supp. XV) clearly show different values for each 
amplicon-probe pair interaction, with the most negative ∆Tm observed for the most specific cases 
(H526D, H526R and H526Y detection probe pairs).  
The results from the four CMOS biochip experiments are shown for the seven probe pairs in Fig. Supp. 
50, along with the integral metric shown in Table XVI. As expected, the integral metric shows the most 
negative value for the specific SNP; thus, it is possible to identify the correct mutation. By collectively 
looking at the data from all the probe pairs, not only can we identify the region where the mutation is 
present, but we can also identify the specific mutation to a single-base accuracy.  
 
 
Figure Supp. 49: Simulation results for 7 probe pairs in H526 region with four different target strains. The signal from WT 
probe is in red and signal from MT probe is in blue for all cases. 
 
 
 
∆Tm (WT
(WT-MT
MT) (°C)
) (°C) 
Target
Target 
H526C
H526C 
H526D
H526D 
H526L
H526L 
H526N
H526N 
H526R
H526R 
H526Y
H526Y 
Wild
Wild 
9.6 
6.68 
5.39 
6.72 
5.91 
6.79 
H526Y
H526Y 
1.71 
2.38 
3.28 
1.56 
4.35 
-2.01
2.01 
H526D
H526D 
4.34 
-5.24
5.24 
6.04 
-0.8 
5.36 
0.43 
H526R
H526R 
2.98 
6.26 
1.56 
6.26 
-5.08
5.08 
6.35 
  
Table Supp. XV: Predicted ∆Tm through VISUALOMP tool for the 7 probe pairs in H526 region with four different target 
strains.  
 
Wild 
Target
H526Y 
Target
H526D 
Target
H526R 
Target
RFU
RFU
RFU
RFU
Temperature (°C)
H526C
H526D
H526L
H526N
H526R
H526Y
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 63 of 64 
 Hassibi et al. 
 
Figure Sup. 50: Experimental data from the 7 probe pairs in the H526 region from four different targets (three with mutations 
in H526 regions and one wild type. Each target was tested once. The curves are the average of 5 replicate probes.  
 
 
Integral Metric 
Target 
H526C 
H526D 
H526L 
H526N 
H526R 
H526Y 
Wild 
6.46 
7.69 
3.64 
5.61 
3.41 
6.17 
H526Y 
1.44 
4.06 
1.51 
0.84 
0.93 
-3.48 
H526D 
1.51 
-4.23 
0.53 
-0.8 
0.82 
-0.15 
H526R 
5.48 
9.23 
-0.33 
4.75 
-1.49 
5.63 
 
Table Supp. XVI: Integral metric calculated from experimental data for the 7 probe pairs in H526 region with four different 
targets.  
 
 
 
Wild 
Target
H526Y 
Target
H526D 
Target
H526R 
Target
RFU
RFU
RFU
RFU
Temperature (°C)
H526C
H526D
H526L
H526N
H526R
H526Y
Nature Biotechnology: doi:10.1038/nbt.4179
 High-Multiplex Semiconductor Biochip  
Page 64 of 64 
 Hassibi et al. 
Supplementary References: 
1. https://www.thermofisher.com/us/en/home/references/molecular-probes-the-handbook/   
 
2. Grimm, J.B., English, B.P., Chen, J., Slaughter, J.P., Zhang, Z., Revyakin, A., Patel, R., Macklin, J.J., 
Normanno, D., Singer, R.H. and Lionnet, T., 2015. A general method to improve fluorophores for 
live-cell and single-molecule microscopy. Nature methods, 12(3), pp.244-250.  
3. Schuler, B., Lipman, E.A., Steinbach, P.J., Kumke, M. and Eaton, W.A., 2005. Polyproline and the 
“spectroscopic ruler” revisited with single-molecule fluorescence. Proceedings of the National 
Academy of Sciences of the United States of America, 102(8), pp.2754-2759.  
4. Preus, S., Kilså, K., Miannay, F.A., Albinsson, B. and Wilhelmsson, L.M., 2012. FRETmatrix: a 
general methodology for the simulation and analysis of FRET in nucleic acids. Nucleic acids 
research, 41(1), pp.e18-e18.  
5. Claudio, G.C. and Bittner, E.R., 2003. Excitation transfer in aggregated and linearly confined poly 
(p-phenylene vinylene) chains. The Journal of Physical Chemistry A, 107(37), pp.7092-7100. 
6. SantaLucia, J., 2007. Physical principles and visual-OMP software for optimal PCR design. PCR 
Primer Design, pp.3-33.  
7. Létant, S.E., Ortiz, J.I., Tammero, L.F.B., Birch, J.M., Derlet, R.W., Cohen, S., Manning, D. and 
McBride, M.T., 2007. Multiplexed reverse transcriptase PCR assay for identification of viral 
respiratory pathogens at the point of care. Journal of clinical microbiology, 45(11), pp.3498-
3505.  
8. Weinberg, G.A., Schnabel, K.C., Erdman, D.D., Prill, M.M., Iwane, M.K., Shelley, L.M., Whitaker, 
B.L., Szilagyi, P.G. and Hall, C.B., 2013. Field evaluation of TaqMan Array Card (TAC) for the 
simultaneous detection of multiple respiratory viruses in children with acute respiratory 
infection. Journal of Clinical Virology, 57(3), pp.254-260.  
9. Koressaar, T. and Remm, M., 2007. Enhancements and modifications of primer design program 
Primer3. Bioinformatics, 23(10), pp.1289-1291. 
10. Galagan, J. and Schoolnik, G., 2013.  The Mycobacterium Tuberculosis regulatory network and 
hypoxia. Nature, 499 (7457), pp. 178-183. 
Nature Biotechnology: doi:10.1038/nbt.4179
