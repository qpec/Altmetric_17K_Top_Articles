 Report
Neural Integration Underlying a Time-Compensated
Sun Compass in the Migratory Monarch Butterfly
Graphical Abstract
Highlights
d A model for time-compensated sun compass used by
monarch butterflies is developed
d Neural oscillations encoding solar azimuth and time of day
are proposed
d Special integration of neural oscillations enables correction
to southwest flight
d The model explains flight simulator tracks and supports
northeast remigration
Authors
Eli Shlizerman, James Phillips-Portillo,
Daniel B. Forger, Steven M. Reppert
Correspondence
forger@umich.edu
In Brief
Migrating monarch butterflies use a time-
compensated sun compass to maintain
southerly flight. Shlizerman et al. present
a model that integrates neuronal
oscillations of the sun’s horizontal
position and the circadian clock to direct
flight. The model explains flight simulator
tracks and proposes a space-time
integration mechanism for directional
flight.
Shlizerman et al., 2016, Cell Reports 15, 683–691
April 26, 2016 ª2016 The Authors
http://dx.doi.org/10.1016/j.celrep.2016.03.057
 Cell Reports
Report
Neural Integration Underlying
a Time-Compensated Sun Compass
in the Migratory Monarch Butterfly
Eli Shlizerman,1 James Phillips-Portillo,2 Daniel B. Forger,3,* and Steven M. Reppert2
1Departments of Applied Mathematics and Electrical Engineering, University of Washington, Seattle, WA 98195, USA
2Department of Neurobiology, University of Massachusetts Medical School, Worcester, MA 01605, USA
3Departments of Mathematics and Computational Medicine and Bioinformatics, University of Michigan, Ann Arbor, MI 48104, USA
*Correspondence: forger@umich.edu
http://dx.doi.org/10.1016/j.celrep.2016.03.057
SUMMARY
Migrating eastern North American monarch butter-
flies use a time-compensated sun compass to adjust
their flight to the southwest direction. Although the
antennal genetic circadian clock and the azimuth of
the sun are instrumental for proper function of the
compass, it is unclear how these signals are repre-
sented on a neuronal level and how they are inte-
grated to produce flight control. To address these
questions, we constructed a receptive field model
of the compound eye that encodes the solar azimuth.
We then derived a neural circuit model that integrates
azimuthal and circadian signals to correct flight
direction. The model demonstrates an integration
mechanism, which produces robust trajectories
reaching the southwest regardless of the time of
day and includes a configuration for remigration.
Comparison of model simulations with flight trajec-
tories of butterflies in a flight simulator shows analo-
gous behaviors and affirms the prediction that
midday is the optimal time for migratory flight.
INTRODUCTION
Each fall, eastern North American monarch butterflies (Danaus
plexippus) fly up to 4,000 km to specific overwintering sites in
central Mexico. Throughout this journey, monarchs constantly
correct their flightdirection to maintain a southerly orientation,us-
ing a time-compensated sun compass. Laboratory observations
from a flight simulator, capable of tracking flight direction, show
that migrant monarchs orient toward the southwest (SW) direc-
tion by visual cues, relying primarily on the horizontal (azimuthal)
position of the sun (Mouritsen and Frost, 2002; Froy et al., 2003;
Zhu et al., 2009; Merlin et al., 2009; Guerra et al., 2012). Migrants
use their circadian clocks to compensate for the changing sun
position and thereby maintain a fixed flight bearing.
Monarch antennae contain an intracellular, light-sensitive
clock mechanism, which has been shown to be responsible for
calibrating the sun compass (Merlin et al., 2009). As in Drosophila
and mice, the primary molecular mechanism of the monarch
clock is an autoregulatory transcriptional feedback loop. In the
monarch, the feedback loop utilizes two distinct cryptochromes
(CRYs), a blue light circadian photoreceptor (CRY1) and a
transcriptional repressor (CRY2). Transcription factors CLOCK
(CLK) and CYCLE (CYC) drive the transcription of the period
(per), timeless (tim), and cry2 genes, which are translated into
PER, TIM, and CRY2 proteins, respectively (Zhu et al., 2008).
While the monarch time-compensation clocks are housed in
the antennae, the sun’s azimuthal position is detected by the
eyes. Neuronal signals originating from photoreceptors in each
ommatidial unit of the compound eye are processed by several
optic neuropils before they are relayed to the central brain.
A main target for visual neurons in the central brain is the anterior
optic tubercle (AoTU), a structure that is connected to the central
complex (CX), the presumed site of the sun compass (Heinze
et al., 2013; Heinze and Reppert, 2012). Within the CX, the lateral
accessory lobes (LALs) are of particular relevance because neu-
rons within them connect to descending motor pathways that
ultimately control behavior.
A long-standing, fundamental question about monarch migra-
tion has been how the circadian clock interacts with the changing
position of the sun to form a time-compensated sun compass that
directs flight. Here, we propose a neuronal model for both encod-
ingofthesun’sazimuthalposition,andmoleculartimekeeping sig-
nals, and how they can be compared to form a time-compensated
sun compass. Our results propose a simple neural mechanism
capable of producing a robust time-compensated sun compass
navigation system through which monarch butterflies could main-
tain a constant heading during their migratory flight.
RESULTS
A basic assumption of our model is that time and solar signals
are encoded by neuronal firing rate. This allows us to propose
a mechanism, which uses a small number of neurons, to
compare the firing rate of azimuthal neurons, responding to the
luminance detected by the eyes, with neurons whose firing
rate shows a circadian rhythm, as seen in ‘‘clock’’ neurons in
other species, (see Colwell, 2011; Belle et al., 2009) and as an
outcome directs flight. We first define the neural input signals
into such a mechanism.
Cell Reports 15, 683–691, April 26, 2016 ª2016 The Authors
683
This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).
 For neural representation of the clock, we postulate two neu-
rons, NCLK1 and NCLK2, whose firing rates oscillate in accor-
dance with two primary molecular oscillations generated by the
monarch circadian clock (Figure 1A1) (Merlin et al., 2009).
NCLK1 is linked to the oscillations of cry2 transcription factor
through a neuron called NCLK1_C. In the absence of input,
NCLK1 fires with constant background firing rate (BG) and re-
ceives inhibitory input from NCLK1_C that follows oscillations
of cry2 ðNCLK1 = BG � NCLK1 CÞ. As a result, the NCLK1
firing rate is anti-phase to the oscillation pattern of cry2.
NCLK2 follows the oscillation pattern of per/tim transcription
factors directly (Figure 1A3). Analogously, we introduce a
neuron labeled NCLK2_C with a firing rate that is anti-phase
to the oscillation patterns found in NCLK2 and per/tim. These
links between neural and molecular representations of the
circadian rhythm are motivated by recent work describing the
Figure 1. Circadian and Solar Azimuth Signals
(A) The antennal clock of the monarch.
(A1) Molecular time course curves involved in keeping the circadian rhythm. The per/tim/cry2 (blue/red/green) relative mRNA levels measured in the antennae
(Merlin et al., 2009). Antennal circadian clocks coordinate sun compass orientation in migratory monarch butterflies. Science 325, 1700–1704. (Reprinted with
permission from AAAS.)
(A2) Signals recorded from the antenna using EAG over 2 days (D1-cyan and D2-magenta; normal L:D [12:12] regime; and freq. >65 Hz). The points in each light
segment are fitted with a third order polynomial fit (dashed curves) and globally with a cosine fit (solid blue curve: max = 9 ZT; min = 18 ZT).
(A3) Firing rate profiles of neurons NCLK1_C (light green; accords with cry2), NCLK1 (cyan), NCLK2_C (dark green), and NCLK2 (navy; accords with per/tim).
(B) ‘‘The butterfly eyes’’, Graphium cloanthus kuge butterfly eyes reflecting the direction of the light (Credit: Yung Samuel. The Butterfly eyes. http://www.
samuelphotos.com).
(B1) Luminance of rotating light source captured by two hemispheres that model the monarch eyes.
(B1) Luminance captured by left/right hemispheres (top).
(B1) Luminance captured by back/front hemispheres (bottom).
(B2) Firing rate curves of NS1 and NS2 neurons which receptive fields cover the right and the front hemisphere, respectively.
684
Cell Reports 15, 683–691, April 26, 2016
 neuronal activity of clock neurons in various species (DeWoskin
et al., 2015; Myung et al., 2015; Ukai-Tadenuma et al., 2008).
The particular configuration of these links is phenomenolog-
ical and aimed to show that a neural mechanism from molecu-
lar rhythms to firing rate with these phase relationships could
exist.
Each of the firing rate curves is non-monotonic, that is, they
do not produce a unique firing rate during the daylight hours.
This property precludes a single curve from being used to
identify the time of day. However, we note that due to the 6 hr
phase shift between the curves, a simple correction for this
ambiguity could be to consider a sum of the NCLK1 and
NCLK2 curves, which produces a monotonic curve. To gain
further information on electrical signals possibly related to the
circadian clock, we performed electro-antennogram (EAG) re-
cordings over the course of several days under normal light/
dark (L:D) conditions (see Supplemental Information). Fre-
quency analysis of the electrical activity suggests that intrinsic
antennal electrical activity increases during the day and de-
creases during the night, illustrated in Figure 1A2. During the
day, when the sun compass is active, the signal power curve ap-
pears to be non-monotonic with lowest activity at T = 0 and a
peak near mid afternoon at T = 8. This is surprisingly similar to
the predicted activity of NCLK1. Non-monotonicity of the
electric antennal signal has been also detected in Drosophila
(Tanoue et al., 2004).
For neural encoding of the solar azimuth, we consider neurons
with visual receptive fields carrying information from the com-
pound eye. A simple and robust way for detecting the solar azi-
muth is integration of luminance captured by all ommatidia in a
wide receptive field that a neuron subtends (see Figure 1B and
Supplemental Information). We note that when the eyes are
modeled as two hemispheres separated by 180�, as approxi-
mately appears in the monarch, integration of the luminance
from a single eye indeed provides azimuthal information, how-
ever, in just one Cartesian direction. This implies that azimuth
detection is ambiguous. For example, azimuthal sun positions
in front and behind the animal would yield the same integrated
luminance in both left and right eye (Figure 1B1). A simple
and sufficient way to measure the solar position in two Cartesian
dimensions would be to consider receptive fields arranged 90�
apart instead of 180�, implying that the solar azimuth is minimally
encoded with two rhythms. We follow this reasoning and intro-
duce two types of neurons, NS1 and NS2, with the simplest
anatomical arrangement of receptive fields that allow unambig-
uous encoding of solar azimuth. The receptive field of NS1 com-
prises all ommatidia in a single eye (e.g., right eye), and its firing
rate is proportional to the integrated luminance signal of the
eye it subtends. The NS2 neuron has a receptive field composed
of two quadrants of the two eyes (e.g., frontal hemisphere)
and will produce a luminance signal and firing rate curve
shifted by 90� relative to the NS1 response, see Figure 1B2.
The curves that we propose have been described in the insect
visual system. Similar curves were obtained from recordings
from Drosophila lobular plate tangential neurons (H and V neu-
rons) (Neri, 2006). Further, recent studies in monarchs and other
insects have documented single, wide receptive field tangential
neurons with dendrites that cover the whole lobula plate (Heinze
et al., 2013). We expect NS1 and NS2 neurons to be of a similar
type.
To propose a mechanism for integration of clock and azimuth
neural signals into a time-compensated sun compass, we intro-
duce two control neurons, whose firing rate is denoted by fl and
fr. These neurons receive clock and azimuth signals and match
them according to a particular wiring, denoted as Il and Ir, to indi-
cate whether a current flight angle is correct or whether to steer
toward left ðflÞ or right ðfrÞ directions. We then propose the
following equations for modeling the firing rates of left and right
control neurons,
dfl
dt = � afl + b4ðIlÞ;
dfr
dt = � afr + b4ðIrÞ;
4ðxÞ =
�
0 x < 0;
x xR0:
(Equation 1)
The parameter a denotes the decay rate of the firing rate in the
absence of input, and b4ðxÞ denotes that only positive inputs
elicit response. Since neurons can encode motion, we assume
that input wirings Il and Ir correspond to the force used for
steering and the firing rates will indicate the angular velocity
used by the monarch for correction in each direction. Given
the axisymmetric anatomy of the monarch, it is reasonable to
assume that there are two parallel pathways, controlling
leftward and rightward turns. Generally, in insect flight, turns
come from opposite forces being applied to the left and
right wings. Similarly, in our model, the total angular velocity is
represented by the difference between left and right firing rate
units,
F = fl � fr = dA
dt ;
(Equation 2)
with A representing the azimuthal angle between the sun’s posi-
tion and the SW. We note that although the system in Equation 1
was derived based on neural firing rate principles, it is directly
related to flight commands, as it is analogous to a formalism
based on Newton’s first law (Bergou et al., 2010),
m d2A
dt2 + v dA
dt = I;
(Equation 3)
in which the force ðIÞ equals the mass times the acceleration
and a damping coefficient ðvÞ times the angular velocity.
In our model, F represents dA=dt such that the system in
Equation 1 is equivalent to the system in Equation 3. F positive
designates correction to the left, and F negative designates
correction to the right. When the flight angle relative to the
sun is correct, the firing rates of the two units will be equal
and F = 0. We define this state as the balanced state (fixed
point).
For the integration mechanism to be viable, it has to maintain
the balanced state once achieved. Because the solar azimuth in-
creases approximately linearly over the day (Figure 2A1), the
balanced state is represented as a line ðAfpÞ in a plane consisting
of the time of day ðTÞ and the azimuthal angle ðAÞ. We require
that the integration mechanism will return to the balanced
state at any time ðTÞ, i.e., requiring the system in Equation 1 to
Cell Reports 15, 683–691, April 26, 2016
685
 implement Afp as a line attractor (Figure 2A2) (Amit, 1992). We
then ask, for the given firing rate curves of clock neurons
NCLK1 and NCLK2 and azimuth neurons NS1 and NS2, what
are the input wirings Il and Ir that implement such a mechanism?
We address this question by deriving a potential function VðA; TÞ
(see Supplemental Information for the derivation), which spec-
ifies the conditions for testing given clock and azimuth wirings,
as to whether the line Afp is a line attractor, and we use it to detect
candidate integration mechanisms. From this formalism, we first
note that straightforward matching of single clock and sun sig-
nals (e.g., NCLK1 and NS1), the simplest candidate mechanism,
will not satisfy the required conditions, as this results in multiple
balanced states. Alternatively, we find that matching all four sig-
nals, in a particular way, such that the left unit subtracts the sun
azimuth inputs from the clock inputs and the right unit imple-
ments the opposite,
Il = D1 + D2;
D1 = NCLK1 � NS1;
Ir = � D1 � D2 = � ll;
D2 = NCLK2 � NS2;
(Equation 4)
will satisfy the derived conditions. We illustrate this input wiring
and the associated potential function VðA; TÞ in Figures 2A3
and 2A4. We also show that for the specified input signals and
their addition or subtraction (256 variations), this is the only wir-
ing possibility that produces a robust flight direction for the dura-
tion of the day (see Supplemental Information).
In addition to the line attractor, there is another solution (fixed
flight angle) that satisfies the equation F = 0. Stability analysis of
Figure 2. Integration Mechanism for Flight Orientation Control
(A) Fall migration to the SW direction.
(A1) SW measurements (early fall, MA, USA from the United States Naval Observatory) with respect to the solar azimuth (gray). Line approximation ðAfpÞ to these
points shown in blue.
(A2) Control requirements for the line-attractor: all points in the plane will converge to the SW.
(A3) Potential (Lyapunov) function VðA; TÞ that determines the direction of the change of the angular position for each point in ðT; AÞ plane. As required, VðA; TÞ > 0
everywhere except on the line attractor. Its derivative, vVðA; TÞ=vA, points toward the line attractor.
(A4) Input wiring diagram of L and R neurons indicative into which direction to turn. Such wiring produces the function VðA; TÞ, which guarantees a line attractor.
(A5) Angular position of fixed points (stable-black and unstable-cyan), directions of correction of flight (blue-right and red-left), and the angle Afp (gray) in the
compass view at different times of day (T = 0, 3, 6, 9, and 12).
(B) Schematic indicating spring remigration.
(B1) Reflected integration circuit (NCLK1_C and NCLK2_C replace NCLK1 and NCLK2; sign of connections is flipped) produces a circuit that keeps the NE flight
direction (used in spring remigration).
686
Cell Reports 15, 683–691, April 26, 2016
 this fixed point shows that it is unstable and as such serves as a
separatrix; trajectories initiated near it are repelled. The balanced
state and the separatrix merge at the SW direction, at T = 0 and
T = 12, and become apart with maximal separation at T = 6 (Fig-
ure 2A5). For further insight, we performed inceptive intracellular
recordings from interneurons within the LALs responding to
rotating light stimuli at different times of day. We find the re-
corded firing rates sensitive to time (firing rate increases with
time), azimuthal position of the light, and rotation direction. By
taking the difference between clockwise (left) and counter-
clockwise (right) rotation responses, as in Tammero et al.
(2004), and comparing the outcome with F, we observe some
qualitative features that our model indicates, in particular, pres-
ence of fixed points and opposite signals in between the fixed
points (see Figure S1).
Our formalism allows us to examine rewiring of input signals
(e.g., inclusion of NCLK1_C and NCLK2_C) to test whether the
modified circuit could support other stable directions. We find
that such a configuration exists; when clock input signals
NCLK1 and NCLK2 are replaced by NCLK1_C and NCLK2_C
and the connections are flipped (excitatory connections become
inhibitory and vice versa), the circuit will implement a stable
northeast (NE) flight for the whole light phase of the day (Fig-
ure 2B1). This mechanism is unique as the mechanism for SW
flight. We thus conclude that for all neural input signals that we
defined in Figure 1, the wirings, depicted in Figure 2, are the
only two stable plausible mechanisms. As such, the integration
supports only two flight directions: SW or NE. Remarkably, the
NE flight direction is actually used by remigrant monarchs in
the spring (Guerra and Reppert, 2013).
To simulate the time-compensated sun compass, we use the
control units model (Equation 1), which produces the signal F
(angular velocity) and compute the angular position A from it
(Equation 2). The outcome is a ‘‘self-correcting’’ model in which
the simulated dynamics (flight tracks) converge to the balanced
state from any initial angular position (except the degenerate
case of zero velocity exactly at the separatrix). The transient dy-
namics, however, will depend on the choice of the parameter a,
initial angular position A, and initial velocities fl and fr. We explore
these dynamics by computational simulations and compare
them with experimental flight paths recorded during tethered
flight (Guerra et al., 2012; Merlin et al., 2009) in which dynamical
features have not been analyzed before. As a particular example,
we illustrate the convergence to the balanced state for two sce-
narios, morning and afternoon (Figure 3; Movies S1 and S2 ).
When the simulations are initiated with zero angular velocity,
the dynamics follow the direction that does not require separatrix
crossing. These trajectories may reach the balanced state at
different times and with non-zero velocity, continue beyond it,
change their direction, and return back to the fixed point with
slower velocity in the opposite direction exhibiting ‘‘ease-in’’ dy-
namics to the balanced state. Indeed, such dynamics are
characteristic to butterflies in a flight simulator (as we show in
Figure 4C and observed in Merlin et al., 2009; Mouritsen and
Frost, 2002).
To determine the time it takes for the angular position to settle
to the SW, we set the angular velocity to zero and initialize sim-
ulations from various angular positions (Figure 4A). During after-
noon, (zeitgeber time = 4:8) average convergence time is on the
order of 10 secð ± 8 secÞ. However, for morning and evening
times, we observe much slower convergence, with average
times of about 30 secð ± 25 secÞ. To further explore this variance,
we depict the spatial distribution of convergence times. In the af-
ternoon, most trajectories (except near the separatrix) quickly
converge to the SW. However, in the morning and in the evening,
slow convergence is extended up to a semi-circle, which in-
cludes the separatrix. Slow convergence in this region stems
from angular acceleration being small, hindering the trajectory
from gaining velocity. Our model, therefore, predicts that there
is a difference in convergence timescales between control and
clock-shifted tracks recorded in the afternoon. In particular, we
expect clock-shifted tracks to be scattered in the slow conver-
gence region. Such behaviors are typical for clock-shifted tracks
recordings as reported in Guerra et al. (2012) and Merlin et al.
(2009) and depicted in Figures 4D and S4.
A central feature in our model is the separatrix, which deter-
mines the time and the directionality of the flight correction to
the SW. We therefore validate its existence by analyzing the
changes in directions (turns and rotations) in experimental flight
track data (four tracks spanning 32 min of flight), see Figures 4B
and S4. We find that turns (extreme points of slope >0.01, farther
than 20� from the SW) are frequent and appear more regularly
than rotations. Their distribution is dense near the SW and be-
comes sparse as distance from the SW increases. Particularly,
we do not identify any turns in the interval 80–110�, the predicted
location of the separatrix (positioned at 105� at ZT = 8), and the
density in the right correction interval is higher than in the left in-
terval, another feature of the asymmetric position of the separa-
trix. The directionality of turns is consistent with the predicted left
and right correction regions in our model, indicating that turns in
flight tracks are in accord with the correction response of the
model. From analysis of rotations, defined as trajectories that
cross the separatrix region, we observe that they typically occur
in clusters (with average of three rotations per cluster) and occur-
rence of turns during rotations significantly decreases. Indeed,
our model indicates that once the trajectory crosses the separa-
trix, the correction direction is alternated, making a full rotation to
be favorable than a turn against the correction direction. To infer
the location of the separatrix, we compute the positions from
which full rotations are more probable. We find that positions
in the region of 80–140� have the highest probability to perform
a rotation, with a peak of P = 0:7 at 80–115� bin. Remarkably,
this position is in close agreement with the model prediction.
Since the compass is being activated by changes in the course
of flight, we examine the model’s behavior in the presence of
input noise. When perturbations originate from white noise
(e.g., due to cloudiness), the trajectory once converged, will
hover around the SW, a radius proportional to the magnitude
of the perturbations. Incorporating occasional kicks in the
model, that simulate strong perturbations, for example, caused
by wind bursts, occlusions, or effects of tethering, the angular
position may rapidly diverge from the fixed point, as we indeed
observe in recordings (Figure 4D). In such a case, the trajectory
could cross the separatrix and exhibit a full rotation or several ro-
tations before settling to the fixed point. Our model indicates that
compass sensitivity to such behaviors depends on the distance
Cell Reports 15, 683–691, April 26, 2016
687
 between the SW and the separatrix, which is minimal in the
morning and evening and maximal in the middle of the day.
Therefore, we expect that monarchs are more prone to frequent
rotations due to strong perturbations in the morning and evening
than in the middle of the day (see Movies S4, S5, and S6 ).
Figure 3. Flight Tracks Simulator
(A) Simulated flight tracks in a compass view (top),
with the sun at an angular position according to
time of day (here ZT = 3 : 9am). The butterfly ro-
tates to find the SW. Rotation angle is sampled
every 0.3 s and marked by blue dots. The simu-
lated flight tracks projected on the potential func-
tion VðA; TÞ are shown (bottom). The black ball
marks the current potential. As time progresses,
the ball slides on the surface of the potential
function toward the fixed point located on the
stable line of fixed points (red) without crossing the
separatrix line (blue).
(B) Illustration of convergence to the SW from rest
and initial angular position 110� to the left of the
sun, sampled at t = 2, 8.5, 11.5, and 25 s. In the
morning scenario (top), the initial position falls on
the right of the separatrix (cyan bar) and is followed
by rightward rotation to the SW (red bar). In the
afternoon scenario (bottom), the initial position falls
on the left of the separatrix, and followed by left-
ward rotation to the SW, produces a longer cycle,
unlike the morning scenario.
When we compare traces produced by
model simulations that included noise
and flight tracks of tethered migrants we
find similar behaviors (Figures 4C and
4D, purple versus orange). By examining
short time navigation (on the order of
seconds), we observe common small dis-
placements from the SW angle, large dis-
placements that cause full rotation, and
ease-in convergence to the SW angle in
both the model and the experiment (Fig-
ure 4C). For long periods of flight (order
of minutes), we have also compared the
distributions of angular position and ve-
locity. The comparison is done for flight
data (recorded during noon-2pm time
window, i.e., ZT = 6 � 8) with the normal
L:D cycle and with a 6 hr delayed L:D cy-
cle (Figure 4D). For the normal L:D cycle,
the distribution of the angular velocity
in the model and experiments shows
that the velocities are small near the sta-
ble fixed point and large at half circle dis-
tance from it. For the shifted L:D cycle, we
expect the trajectory to converge to the
NW direction (SW direction rotated by
90�). Tethered simulator tracks indeed
show that the trajectory is rotated and,
in addition to rotation, the trajectory is
noisier and slowly drifting toward the N
and NE directions. In the model, we adjust the clock input by
shifting NCLK1 and NCLK2 backward, which sets the compass
model to morning time ðZTz2Þ. The separatrix is then closer to
the balanced state and the velocity of returning back to the
balanced state is asymmetric, as shown in (Figure 4A), and
688
Cell Reports 15, 683–691, April 26, 2016
 indicated in model and experiment angular velocity distributions.
This produces a similar drift when we add noise to our model
simulations (Figure 4D, bottom).
DISCUSSION
The remarkable ability of monarch butterflies to migrate for thou-
sands of miles while keeping the southerly direction suggests
that they possess a neural circuit capable of integrating time of
day and the sun’s position into a compass useful for navigation.
Here, we derived a model that matches the firing rate of clock
and azimuth neural signals to provide angular position control.
We show that there are two fixed points in the model, one is sta-
ble and corresponds to the SW direction and the other is unsta-
ble and divides the rotation direction. Simulating trajectories in
the model and comparing them with flight trajectories recorded
from butterflies flying in a tethered simulator, we find similar flight
behaviors and distribution characteristics.
We propose two neural circuit components that allow us to
construct the compass model. The first component is the azi-
muth encoding model implemented by receptive fields covering
left/right and front/back hemispheres. Such receptive field
arrangement shows that azimuth can be computed directly
from sunlight intensity based on Lambert’s law, does not require
complex receptive fields or polarization patterns, and is robust to
natural overcasts and shadows, as opposed to mechanisms
based on small subsets of neurons (Figure S3). The second
component that we introduce is the derivation of integration
wiring for flight control. We discovered that straightforward
matching integration (NCLK1 and NS1) is incompatible with the
uniqueness condition of the balanced state. However, a single
integration
configuration
based
on
phase
shifted
signals
NCLK1 and NS1 and NCLK2 and NS2 will provide unique con-
trol. Simulations of the model confirm this analysis.
Comparison of flight tracks recorded in an outdoor flight simu-
lator with tracks produced by our model confirms the existence
Figure 4. Model Simulated Flight Angle Tracks Compared with Tethered Flight
(A) Convergence to the proper direction in the model and outdoors experiments.
(A1) Mean timescales for convergence to the SW in the model starting at rest from uniformly distributed angular positions (5� bins) computed at different times
of day.
(A2) Spatial distribution of convergence timescales at three times of day.
(A3) Spatial distributions in the afternoon ðZT = 6Þ with shifted L:D cycle by �5 hr or +5 hr; analogous to morning/evening distributions rotated by 90� clockwise/
counterclockwise.
(B) Changes of direction (turns/rotations) analyzed from raw data recorded in Guerra et al. (2012). See Figure S4 for particular datasets used here.
(B1) Direction changes in flight tracks.
(B2) Spatial distribution of turns. Each turn is marked by a magenta dot or, according to their direction, green: left and red: right. The red and blue radii denote the
positions of predicted stable and separatrix fixed points.
(B3) Rotations count.
(B4) Probability for full rotation (within ± 2 s) from uniformly distributed angular positions (6� bins).
(C) Typical flight signatures (10 s duration) within recorded (top) and model (for ZT = 8) (bottom) tracks. In the model, displacement is achieved by perturbing the
input force until angular position reaches 300� (small), 15� (large), or 65� (ease-in).
(D) Tracks for long period of flight (10 min) in a radial plot (time is the radius) and statistics of the angle/angular velocity.
(D1) Flight track in the afternoon for a monarch with regular L:D cycle (L is 6 am:6 pm).
(D2) Flight track in the afternoon for a monarch with a shifted L:D cycle by 6 hr backward (L is 12 pm:12 am).
Cell Reports 15, 683–691, April 26, 2016
689
 of two correction regions separated by a separatrix, whose po-
sition is in close agreement with our model. Additionally, our
model predicts extra sensitivity to perturbations in morning
and evening times, and those can cause a drift in a specific range
of angles. We indeed observe sensitivity and drifts in flight trajec-
tories of butterflies with shifted L:D cycles, in which flight was re-
corded in the afternoon, but corresponds to morning time.
Furthermore, by comparing short and long time segments of
correction dynamics, we find similarity in flight dynamics pat-
terns, exhibited by ease-in, turns, and full rotations and an
accord between the distributions of angular velocities and posi-
tion. These findings suggest that when the monarch loses its
course, it rotates back with velocity proportional to the curves
of F described by our model.
In summary, our results indicate that both time of day and the
sun’s azimuthal position can be encoded using firing rate curves.
These curves provide robust non-monotonic signals for integra-
tion of clock and visual cues into flight steering control. The neu-
ral circuit and conditions that we derive show that only a specific
matching strategy will guarantee reaching the SW from almost
any heading at any time of day. We also propose a rewiring
that can support the NE bearing found in monarchs remigrating
out of Mexico in the spring (Guerra and Reppert, 2013) and show
that these are the only two plausible strategies for fixed flight di-
rection. The model that we have built closes the loop between
the time and azimuth stimuli and orientation control. As such, it
provides an important framework for future studies of the mon-
arch sun compass. Our framework can be used to design elec-
trophysiological and flight recordings experiments to compare
responses in monarchs’ neurons and model units and to deter-
mine the detailed architecture of neural circuits that implement
the integration mechanism postulated by our model. It also pro-
vides a simple mechanism for navigation that can be used in de-
vices that do not have the benefit of a global positioning system.
EXPERIMENTAL PROCEDURES
Integration Model
Sensory azimuth and time encoding signals (expressed by computational neu-
rons) are defined as the following functions NS1ðAÞ = ðIb=2Þð1 � sinðAp=180ÞÞ,
NS2ðAÞ = ðIb=2Þð1 + cosðAp=180ÞÞ; NCLK1ðTÞ = ðIb=2Þð1 � cosðpðT + 3Þ=12ÞÞ;
NCLK2ðTÞ = ðIb=2Þð1 � sinðpðT + 3Þ=12ÞÞ, where Ib is set to 40 Hz. The azimuth
function is determined from a half sphere model of the eyes, while the clock
function is determined according to recordings from antennae, molecular
curves, and requiring these signals to match in peak and trough amplitudes.
Potential (Lyapunov) function used to determine the stability of the integration
mechanism in Equation 4 is defined as VðA; TÞ = ð4ðIlÞ � 4ðIrÞÞ2. See further
details in the Supplemental Information. Simulations of the model were per-
formed using Mathworks MATLAB with our implementation of Euler-Muryama
stochastic integrator.
Experimental Procedures
EAGs were recorded as the potential difference between the tip of the antenna
and the head, over the course of several (4–5) days under normal L:D condi-
tions. To exclude olfactory and mechanosensory signals, antennae were
coated with transparent paint (Guerra et al., 2012; Merlin et al., 2009). EAG sig-
nals were sampled for 10 min every hour for the duration of the recording
period and analyzed using fast Fourier transform to determine the relative po-
wer at all frequencies above 65 Hz.
Intracellular recordings from the CX were conducted during the light phase
of each animals light dark cycle. For recordings, animals were mounted in the
experimental setup and aligned such that the light emitting diode-stimulating
apparatus was directly above the head and the recording electrode could ac-
cess the brain frontally. The LALs were chosen as the target recording site
because they receive both projections from the visual neuropils and from the
CX, the collection of midline neuropils thought to serve as the substrate for
sun compass integration (Heinze and Reppert, 2011). Intrinsic LAL-LAL neu-
rons were found to be sensitive to the azimuthal position of the light source.
They have been ordered by the zeitgeber time at which the recording was per-
formed. In analysis, BG were determined from intervals of no stimulus and dif-
ference between left and right rotation responses was computed for compar-
ison with F, the output of the model. See further details in the Supplemental
Information.
SUPPLEMENTAL INFORMATION
Supplemental Information includes Supplemental Experimental Procedures,
four figures, one table, and six movies and can be found with this article online
at http://dx.doi.org/10.1016/j.celrep.2016.03.057.
AUTHOR CONTRIBUTIONS
Conceptualization, S.M.R., D.B.F., and E.S.; Methodology, E.S., D.B.F.,
J.P.-P., and S.M.R.; Validation, E.S. and J.P.-P.; Formal Analysis, E.S. and
D.B.F.; Experiments, J.P.-P. and S.M.R.; Writing – Original Draft, E.S.; Writing –
Review & Editing, E.S., J.P.-P., D.B.F., and S.M.R.; and Funding Acquisition,
S.M.R., D.B.F., and E.S.
ACKNOWLEDGMENTS
We thank Patrick Guerra for generating the flight simulator data and Ira Kemel-
macher-Shlizerman for discussions on Lambertian reflectance. This work was
supported in part by NIH grant GM086794 and AFOSR grant FA9550-10-1-
0480 to S.M.R., NSF grant DMS-1361145 and WRF Fund to E.S., and AFOSR
grant W911NF-13-1-0449 to D.B.F.
Received: September 2, 2015
Revised: February 11, 2016
Accepted: March 15, 2016
Published: April 14, 2016
REFERENCES
Amit, D.J. (1992). Modeling Brain Function: The World of Attractor Neural Net-
works (Cambridge University Press).
Belle, M.D.C., Diekman, C.O., Forger, D.B., and Piggins, H.D. (2009). Daily
electrical silencing in the mammalian circadian clock. Science 326, 281–284.
Bergou, A.J., Ristroph, L., Guckenheimer, J., Cohen, I., and Wang, Z.J. (2010).
Fruit flies modulate passive wing pitching to generate in-flight turns. Phys. Rev.
Lett. 104, 148101.
Colwell, C.S. (2011). Linking neural activity and molecular oscillations in the
SCN. Nat. Rev. Neurosci. 12, 553–569.
DeWoskin, D., Myung, J., Belle, M.D., Piggins, H.D., Takumi, T., and Forger,
D.B. (2015). Distinct roles for GABA across multiple timescales in mammalian
circadian timekeeping. Proc. Natl. Acad. Sci. USA 112, E3911–E3919.
Froy, O., Gotter, A.L., Casselman, A.L., and Reppert, S.M. (2003). Illuminating
the circadian clock in monarch butterfly migration. Science 300, 1303–1305.
Guerra, P.A., and Reppert, S.M. (2013). Coldness triggers northward flight in
remigrant monarch butterflies. Curr. Biol. 23, 419–423.
Guerra, P.A., Merlin, C., Gegear, R.J., and Reppert, S.M. (2012). Discordant
timing between antennae disrupts sun compass orientation in migratory mon-
arch butterflies. Nat. Commun. 3, 958.
Heinze, S., and Reppert, S.M. (2011). Sun compass integration of skylight cues
in migratory monarch butterflies. Neuron 69, 345–358.
690
Cell Reports 15, 683–691, April 26, 2016
 Heinze, S., and Reppert, S.M. (2012). Anatomical basis of sun compass navi-
gation I: the general layout of the monarch butterfly brain. J. Comp. Neurol.
520, 1599–1628.
Heinze, S., Florman, J., Asokaraj, S., El Jundi, B., and Reppert, S.M. (2013).
Anatomical basis of sun compass navigation II: the neuronal composition of
the central complex of the monarch butterfly. J. Comp. Neurol. 521, 267–298.
Merlin, C., Gegear, R.J., and Reppert, S.M. (2009). Antennal circadian clocks
coordinate sun compass orientation in migratory monarch butterflies. Science
325, 1700–1704.
Mouritsen, H., and Frost, B.J. (2002). Virtual migration in tethered flying mon-
arch butterflies reveals their orientation mechanisms. Proc. Natl. Acad. Sci.
USA 99, 10162–10166.
Myung, J., Sungho, H., DeWoskin, D., De Schutter, E., Forger, D.B., and Ta-
kum, T. (2015). GABA-mediated repulsive coupling between circadian clock
neurons in the SCN encodes seasonal time. Proc. Natl. Acad. Sci. USA 112,
E3920–E3929.
Neri, P. (2006). Spatial integration of optic flow signals in fly motion-sensitive
neurons. J. Neurophysiol. 95, 1608–1619.
Tammero, L.F., Frye, M.A., and Dickinson, M.H. (2004). Spatial organization of
visuomotor reflexes in Drosophila. J. Exp. Biol. 207, 113–122.
Tanoue, S., Krishnan, P., Krishnan, B., Dryer, S.E., and Hardin, P.E. (2004).
Circadian clocks in antennal neurons are necessary and sufficient for olfaction
rhythms in Drosophila. Curr. Biol. 14, 638–649.
Ukai-Tadenuma, M., Kasukawa, T., and Ueda, H.R. (2008). Proof-by-synthesis
of the transcriptional logic of mammalian circadian clocks. Nat. Cell Biol. 10,
1154–1163.
Zhu, H., Sauman, I., Yuan, Q., Casselman, A., Emery-Le, M., Emery, P., and
Reppert, S.M. (2008). Cryptochromes define a novel circadian clock mecha-
nism in monarch butterflies that may underlie sun compass navigation. PLoS
Biol. 6, e4.
Zhu, H., Gegear, R.J., Casselman, A., Kanginakudru, S., and Reppert, S.M.
(2009). Defining behavioral and molecular differences between summer and
migratory monarch butterflies. BMC Biol. 7, 14.
Cell Reports 15, 683–691, April 26, 2016
691
