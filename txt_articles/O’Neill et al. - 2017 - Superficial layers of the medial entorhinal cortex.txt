 Superficial Layers of the Medial Entorhinal Cortex Replay Independent of the 
Hippocampus 
 
J. O’Neill*, C.N. Boccara, F. Stella, P. Schoenenberger†, J. Csicsvari* 
 
 
IST Austria, Am Campus 1, A – 3400 Klosterneuburg, Austria 
 
† Current Address: F. Hoffmann-La Roche Ltd, Roche Innovation Center Basel, Grenzacherstrasse 
124, 4070 Basel, Switzerland 
 
*Corresponding author.  E-mail: jozsef.csicsvari@ist.ac.at,  joneill@ist.ac.at 
 
 
 The hippocampus is thought to initiate systems-wide mnemonic processes through the reactivation 
of previously acquired spatial/episodic memory traces, which can recruit the entorhinal cortex as a 
first stage of memory redistribution to other brain areas. Hippocampal reactivation occurs during 
sharp wave/ripples, in which synchronous network firing encodes sequences of places.  We 
investigated the coordination of this replay by recording assembly activity simultaneously in the 
CA1 region and superficial layers of the medial entorhinal cortex. We found that entorhinal cell 
assemblies can replay trajectories, independent of the hippocampus and sharp wave/ripples. This 
suggests that the hippocampus is not the sole initiator for spatial/episodic memory trace 
reactivation. Memory systems involved in these processes may include non-hierarchical, parallel 
components.  
 
One Sentence Summary: 
Medial entorhinal cortex can reactivate movement trajectories independent of the hippocampus 
during waking and sleep periods. 
 
 
 The hippocampus plays a principal role in the encoding, consolidation and recall of spatial/episodic 
memories(1, 2), by forming cell assemblies that code for place and subsequently replaying their 
activity patterns(3, 4). This replay, which represents discrete places or entire movement trajectories, 
can occur both in waking periods(5), while animals actively engage in a spatial task(6–9),  and in 
periods of rest/sleep(10, 11); each facilitating different stages of memory processing(8). In 
immobility/sleep periods, replay occurs in highly synchronized network activity during sharp 
wave/ripple (SWR) and is associated with memory consolidation(8, 12, 13). However, SWR-related 
replay during spatial memory tasks can predict the future behavioral choice of the animal and have 
been linked to memory recall(8, 9).  Because highly-synchronized hippocampal SWR activity 
recruits multiple brain areas(14), the prevailing view suggests that the hippocampus initiates replay 
during SWRs, and in doing so, is the primary coordinator for the consolidation of memory traces 
associated with place(4, 13).   
By contrast, the entorhinal cortex (EC) is thought to primarily assist the hippocampus in 
replay-associated mnemonic processing.  During encoding, cells in the superficial layers of the 
medial EC (sMEC), particularly grid cells(15), provide the hippocampus with precise spatial coding 
through path integration(16).  However, during SWR-associated replay, the EC is considered to act 
primarily as a relay, facilitating the transfer of replayed hippocampal memory traces to other 
cortical areas(13). However, at the sMEC and hippocampus may be able to act independently; 
sMEC cells may take part in replay independently of hippocampal SWR, initiating memory 
consolidation or recall. This latter scenario is in agreement with the hypothesis that memory trace 
reactivation can originate from multiple brain regions(17).  
To test whether the sMEC replays waking experience, and to examine its relationship to 
hippocampal firing, we simultaneously recorded neurons from the CA1 region and sMEC (Fig. S1).  
Four rats were trained to perform a delayed non-match-to-sample spatial task on a continuous T-
maze (Fig. 1A, see methods)(18). Before the task, rats foraged in a large arena to test the 2-
dimensional spatial firing fields of our sMEC cells (Fig. 1B). 
First, we characterized how sMEC neurons encoded space on the maze.  Grid cell firing 
rates and spatial assembly patterns were better correlated between the open field and T-maze than 
non-grid cells (Fig. S3, 3A-C). This is in agreement with the tendency of grid cells to maintain 
similar firing fields in different environments(19). Nevertheless, the assemblies of sMEC neurons 
could represent unique locations on the maze, even when only considering grid cells(20); a 
Bayesian maximum likelihood method(21) accurately predicted the position of the animal on the 
track (reconstruction error; sMEC: 7.2 ± 0.6cm, n = 11 sessions. Grid cell only: 16.6433 ± 2.9cm, ≥ 
10 cells: n = 4 sessions, mean ± SEM, Fig. S4). 
EC cells can fire differentially at different phases of a spatial alternation task(22, 23). To 
 test whether units showed task-related changes, we analyzed firing rates on runs to the choice point 
for the 4 possible trial phases (i.e., left sample, left choice, right sample and right choice); and asked 
if firing rates exhibited significant differences independent of head direction, speed and lateral 
position (see methods, Fig. S5A-C).  CA1, grid and non-grid sMEC cells all showed significant rate 
modulation (Fig. S5F). Moreover, a similar proportion of cells exhibited significant rate changes on 
the return arms depending on trial type Fig. S5E,G).  However, the firing fields were highly 
correlated across trial phases (Fig. S3D-E), indicating that task-related firing is expressed mainly 
through rate remapping(24). This indicates that both grid and non-grid sMEC populations exhibited 
mnemonic coding beyond path integration, that was linked to both trial type and the future 
trajectory of the animal.   
 
Recent fMRI work in humans suggests that, similar to the hippocampus, the EC may 
reactivate imagined trajectories during recall(25). We looked for evidence of replay in the sMEC 
during transient periods of high network synchronization. Like the hippocampus, sMEC units 
showed transient increases in synchrony, during both waking and sleep/rest (high synchrony event: 
HSE, Fig. 2A-B, Fig. S6, see methods).  To quantify whether such HSEs encoded maze trajectories, 
we subdivided each HSE into short windows (20ms, 10ms overlap) and used the Bayesian 
algorithm to identify the locations represented in each window.  We then randomly rotated the 
linear place fields of cells within the event and asked whether the selected fit was better than that 
generated from the randomized place fields, for 95% of 1000 separate shuffles (Fig. 2B, Fig. S7, n 
= 11 sessions). Indeed, the distribution of the trajectory fit scores (replay score) were significantly 
different between the original and the place field randomized cases (P<10-27 Kolmogorov-Smirnov 
test, KS, Fig 2D). Moreover the z-score of the original trajectory fits, normalized according to the 
shuffled distribution, were positive (Fig. S8). Similar results were obtained when we jittered spikes 
times instead of their place fields (Fig. S7,8). These significant replay events were detected 
throughout the maze, including during the delay, at both low and high speeds and often reflected 
locations remote from the animal (Fig. S9). It is unlikely that these replay events occurred as a 
result of theta phase precession since they formed a mix of forward and reverse replay and had a 
slope that was 2-3 fold higher than that expected from phase precession (Fig. S10-11). 
 
Waking sMEC replay during the task may follow hippocampal SWR replay or 
alternatively operate independently.  We checked whether spiking in the CA1 encoded trajectories 
that were coherent with sMEC sequences.  We used the Bayesian decoding procedure to establish 
the places represented in the CA1 during sMEC events.  Having established the trajectory encoded 
by the sMEC sequence, we generated a replay coherence score to quantify fit of the sMEC 
trajectory to the encoded CA1 places (Fig. 2C). This score was compared to that generated 
following the shuffling of CA1 spike times within the event (see methods).   Surprisingly, sMEC 
 replay events were not accompanied by coherent CA1 activity: (the distribution of the coherence 
scores was similar to that of the shuffled scores (all p>0.6, KS test n = 8 sessions, Fig 2F, Fig. 
S12A-B).  Moreover, the shuffled distribution-normalized z-score of the coherence values were not 
above zero more often than chance (Fig. S13A-B, p>0.3 binomial test).  We also detected 
significant replay events in the CA1 (Fig. 2E, Fig. S14) and sMEC activity was not related to CA1 
replay (p>0.18, KS test, Fig. 2G, Fig. S12 A,B, but in z-scores: place field rotation sequences at low 
speed p=0.01795, all other  p>0.14, Fig S13 A-B). The lack of coherent activity was not due to the 
sparse firing within the other region: even one cell alone showed coherent activity with the 
remaining cells within the same region during replay, and coherence improves when 2 or 3 cells are 
tested with the rest (Fig. S13 C,D). Trajectories that encoded the current location of the animal 
within theta oscillatory cycles in a region always exhibited significantly stronger coherence with 
activity in the other region than during trajectory replay (p<10-15, Anova, , Fig. S15).  Performing a 
time-shifted coherence analysis did not significantly change the coherence values indicating that 
synaptic delay was not a cause of the lack of coherent trajectory replay (Fig S16). 
Significant CA1 and sMEC replay events were not correlated in time (Fig. 2I). Moreover, 
sMEC replay was not associated with an increase in ripple power or SWRs, while CA1 replay 
events at low speeds were (Fig. 2H,I).  This shows that sMEC can encode task-related mnemonic 
sequences independently from the hippocampus, suggesting an independent role for the sMEC in 
encoding/recall related to memory sequences. 
Our coherence analysis examined whether trajectory replay in one region aligned with 
places expressed in the other region. However, nonaligned trajectory segments could still overlap 
with places expressed in the other region. Therefore, we randomly selected places from other 
trajectory replay events and found that these randomized places exhibited weaker coherence scores 
than the original ones (Fig. S17A-B, all p<0.05 KS test). A possible explanation for this findings is 
that many of these replayed trajectories originate from the current location of the animal; hence 
place-related firing in one region overlapped with the replayed trajectory in the other.   
 
Entorhinal replay during active waking periods appeared to predominantly operate 
independently of hippocampal reactivation. Next we tested whether sMEC cells can replay 
trajectories independently from the hippocampus during rest/sleep epochs or whether these were 
driven by CA1 firing, similar to the deep medial EC layers, which are directly innervated by CA1 
place cells (26). We first asked whether sMEC sequences could be detected during rest, and then 
examined their relationship to hippocampal network activity (Fig. 3A-C).  Similar to waking 
epochs, HSEs during rest exhibited significant sMEC replay (Fig. 3E, Fig. S7, all P<10-27 KS test, 
see also Fig. S8).  The replay coherence analysis showed that sMEC replay events were not 
accompanied by related CA1 spatial firing (all P>0.1, KS test, Fig. 3F, Fig. S12C,13).  We then 
 examined the degree to which CA1 replay influences the activity of sMEC cells (Fig. 3D,E, Fig. 
S14). In this case sMEC assembly activity exhibited coherence with CA1 replay, when sequences 
were detected using the spike jittered shuffling (p<0.038 KS test, Fig. S12C), but not with place 
field rotation (p>0.07, KS test, Fig. 3F).  Given that hippocampal SWR-associated replay engage 
the majority of the dorsal hippocampus(9, 27), we examined the relationship of sMEC replay with 
SWRs. CA1 ripple power only showed a marginal increase during sMEC replay compared to CA1 
replay, even for sMEC events exhibiting coherent replay with CA1 (Fig. 3G). Indeed, out of 202 
events, only 5.9% of sMEC replay events were temporally aligned to detected SWR (peak of HSE ± 
25 ms from the peak of the SWR), in contrast to 29.9% (184/674) for CA1 replay (Fig. 3H).  HSEs 
in the two regions were also independent; only 4.4% of sMEC replay events occurred within 25ms 
of CA1 HSEs, whether or not we could detect replay there (Fig. 3H). However, CA1 activity 
expressed places that, higher than chance, overlapped with nonaligned parts of the sMEC 
trajectories, and vice versa. Therefore, even in rest the two regions could weakly interact during 
reactivation (Fig. S17C-D, all p<0.01, KS test). 
 
Our data showed that sMEC cells including grid cells fired in relation to the memory task 
on the maze. Furthermore, sMEC was involved in the mnemonic trajectory sequence coding: we 
saw that the sMEC produces bursts of activity, during both waking and sleep/rest that contained 
sequences reflecting task-related trajectories on the maze. Such events tended to occur 
independently from hippocampal trajectory replay and associated SWRs. Moreover, trajectory 
replay that occurred in the sMEC was not associated with temporally-aligned coherent activity in 
CA1. This suggests that the sMEC can trigger its own replay events and initiate recall and 
consolidation processes independent of hippocampal SWRs, whereas deep EC layers are directly 
influenced by CA1 replay(26).  However, some weak coordination may exist between CA1 and 
sMEC and in some instances replayed trajectories contain locations that were expressed in the other 
region.  
 
Overall, these findings indicate that the EC can act independently in mnemonic processes rather 
than having a subservient role to the hippocampus. Therefore, the hippocampus and EC may be 
considered as interrelated but parallel systems in initiating reactivation and they may recruit 
different brain pathways and may have different roles.  
 
 
 
 
 References and notes 
1.  
J. O’Keefe, L. Nadel, The Hippocampus as a Cognitive Map (Oxford University Press, 1978). 
2.  
G. Riedel et al., Reversible neural inactivation reveals hippocampal participation in several 
memory processes. Nat.Neurosci. 2, 898–905 (1999). 
3.  
G. Buzsaki, Two-stage model of memory trace formation: a role for “noisy” brain states. 
Neuroscience. 31, 551–570 (1989). 
4.  
J. L. McClelland, B. L. McNaughton, R. C. O’Reilly, Why there are complementary learning 
systems in the hippocampus and neocortex: insights from the successes and failures of 
connectionist models of learning and memory. Psychol.Rev. 102, 419–457 (1995). 
5.  
J. O’Neill, T. Senior, J. Csicsvari, Place-selective firing of CA1 pyramidal cells during sharp 
wave/ripple network patterns in exploratory behavior. Neuron. 49, 143–155 (2006). 
6.  
S. P. Jadhav, C. Kemere, P. W. German, L. M. Frank, Awake Hippocampal Sharp-Wave 
Ripples Support Spatial Memory. Science. 336, 1454–1458 (2012). 
7.  
D. J. Foster, M. A. Wilson, Reverse replay of behavioural sequences in hippocampal place 
cells during the awake state. Nature. 440, 680–683 (2006). 
8.  
D. K. Roumis, L. M. Frank, Hippocampal sharp-wave ripples in waking and sleeping states. 
Curr. Opin. Neurobiol. 35, 6–12 (2015). 
9.  
B. E. Pfeiffer, D. J. Foster, Hippocampal place-cell sequences depict future paths to 
remembered goals. Nature. 497, 74–79 (2013). 
10.  A. K. Lee, M. A. Wilson, Memory of sequential experience in the hippocampus during slow 
wave sleep. Neuron. 36, 1183–1194 (2002). 
11.  M. A. Wilson, B. L. McNaughton, Reactivation of hippocampal ensemble memories during 
sleep. Science. 265, 676–679 (1994). 
12.  G. Girardeau, K. Benchenane, S. I. Wiener, G. Buzsaki, M. B. Zugaro, Selective suppression 
of hippocampal ripples impairs spatial memory. Nat.Neurosci. 12, 1222–1223 (2009). 
13.  G. Buzsaki, The hippocampo-neocortical dialogue. Cereb.Cortex. 6, 81–92 (1996). 
14.  N. K. Logothetis et al., Hippocampal–cortical interaction during periods of subcortical silence. 
Nature. 491, 547–553 (2012). 
15.  T. Hafting, M. Fyhn, S. Molden, M. B. Moser, E. I. Moser, Microstructure of a spatial map in 
the entorhinal cortex. Nature. 436, 801–806 (2005). 
16.  B. L. McNaughton, F. P. Battaglia, O. Jensen, E. I. Moser, M. B. Moser, Path integration and 
the neural basis of the “cognitive map.” Nat.Rev.Neurosci. 7, 663–678 (2006). 
17.  G. R. Sutherland, B. McNaughton, Memory trace reactivation in hippocampal and neocortical 
neuronal ensembles. Curr.Opin.Neurobiol. 10, 180–186 (2000). 
18.  R. M. J. Deacon, J. N. P. Rawlins, T-maze alternation in the rodent. Nat. Protoc. 1, 7–12 
(2006). 
 19.  E. I. Moser et al., Grid cells and cortical representation. Nat. Rev. Neurosci. 15, 466–481 
(2014). 
20.  K. Gupta, L. A. Keller, M. E. Hasselmo, Reduced spiking in entorhinal cortex during the delay 
period of a cued spatial response task. Learn. Mem. Cold Spring Harb. N. 19, 219–230 (2012). 
21.  K. Zhang, I. Ginzburg, B. L. McNaughton, T. J. Sejnowski, Interpreting neuronal population 
activity by reconstruction: unified framework with application to hippocampal place cells. J. 
Neurophysiol. 79, 1017–1044 (1998). 
22.  L. M. Frank, E. N. Brown, M. Wilson, Trajectory encoding in the hippocampus and entorhinal 
cortex. Neuron. 27, 169–178 (2000). 
23.  P. A. Lipton, J. A. White, H. Eichenbaum, Disambiguation of overlapping experiences by 
neurons in the medial entorhinal cortex. J. Neurosci. Off. J. Soc. Neurosci. 27, 5787–5795 
(2007). 
24.  S. Leutgeb et al., Independent codes for spatial and episodic memory in hippocampal neuronal 
ensembles. Science. 309, 619–623 (2005). 
25.  A. J. Horner, J. A. Bisby, E. Zotow, D. Bush, N. Burgess, Grid-like Processing of Imagined 
Navigation. Curr. Biol. CB. 26, 842–847 (2016). 
26.  H. F. Ólafsdóttir, F. Carpenter, C. Barry, Coordinated grid and place cell replay during rest. 
Nat. Neurosci. (2016), doi:10.1038/nn.4291. 
27.  A. Ylinen et al., Sharp wave-associated high-frequency oscillation (200 Hz) in the intact 
hippocampus: network and intracellular mechanisms. J.Neurosci. 15, 30–46 (1995). 
28.  J. Csicsvari, H. Hirase, A. Czurko, A. Mamiya, G. Buzsaki, Oscillatory coupling of 
hippocampal pyramidal cells and interneurons in the behaving Rat. J.Neurosci. 19, 274–287 
(1999). 
29.  K. D. Harris, H. Hirase, X. Leinekugel, D. A. Henze, G. Buzsaki, Temporal interaction 
between single spikes and complex spike bursts in hippocampal pyramidal cells. Neuron. 32, 
141–149 (2001). 
30.  T. Stensola, H. Stensola, M.-B. Moser, E. I. Moser, Shearing-induced asymmetry in entorhinal 
grid cells. Nature. 518, 207–212 (2015). 
31.  R. F. Langston et al., Development of the Spatial Representation System in the Rat. Science. 
328, 1576–1580 (2010). 
32.  J. O’Neill, T. J. Senior, K. Allen, J. R. Huxter, J. Csicsvari, Reactivation of experience-
dependent cell assembly patterns in the hippocampus. Nat. Neurosci. 11, 209–215 (2008). 
33.  J. H. Zar, Biostatistical analysis (Prentice Hall, Upper Saddle River, N.J, 4th ed., 1999). 
34.  T. J. Davidson, F. Kloosterman, M. A. Wilson, Hippocampal Replay of Extended Experience. 
Neuron. 63, 497–507 (2009). 
35.  A. D. Grosmark, G. Buzsáki, Diversity in neural firing dynamics supports both rigid and 
learned hippocampal sequences. Science. 351, 1440–1443 (2016). 
36.  R. U. Muller, J. L. Kubie, The firing of hippocampal place cells predicts the future position of 
 freely moving rats. J. Neurosci. 9, 4101–4110 (1989). 
37.  W. E. Skaggs, B. L. McNaughton, M. A. Wilson, C. A. Barnes, Theta phase precession in 
hippocampal neuronal populations and the compression of temporal sequences. Hippocampus. 
6, 149–172 (1996). 
38.  T. Hafting, M. Fyhn, T. Bonnevie, M.-B. Moser, E. I. Moser, Hippocampus-independent phase 
precession in entorhinal grid cells. Nature. 453, 1248–1252 (2008). 
 
 
 Acknowledgments: 
We thank Peter Jonas for comments on an earlier version of the manuscript. This work was 
supported by European Research Council Consolidator Grant (281511). The authors declare no 
conflicts of interest. Original data and programs were stored in the scientific repository of the 
Institute of Science and Technology Austria and are available on request. 
  
 
 
 
 Fig. 1. sMEC and CA1 firing patterns on the T-maze. 
A) Behavioral paradigm.  Animals first explored a large arena, then slept in a sleep box.  Next the 
animal performed >30 trials of a non-match-to-sample task on a modified T-maze, followed by a 
second sleep session. The blue arrow marks the choice point, circle the goal location and blue-
highlighted region marks the central arm.   
B) Spatial firing patterns of simultaneously recorded sMEC putative excitatory units (17/27 
displayed, red) and a representative CA1 pyramidal cell (1/53 black, bottom right).  The position of 
spikes emitted (red dots) and path of the animal (grey) are shown as well as the smoothed rate 
maps.  The peak firing rate of each cell (Hz) is shown above the place-rate maps.  
C) Linear rate maps of all 27 sMEC excitatory units, ordered by the location of their peak firing rate 
on the right choice trial. 
 
Fig. 2.  sMEC replay during exploration 
A) Local field potential centered on a sMEC HSE (highlighted purple, peak: dotted grey line). 
Channels were taken from different tetrodes (black: CA1, red: sMEC). Raster plot: unit activity 
sorted by location of their peak firing rate on left choice trials (black: CA1, red: sMEC, blue:  
interneurons).   
B) Position reconstruction during the sMEC HSE shown in (A).  Left: linearized sMEC rate maps, 
sorted by the same order as the raster plot.  Middle panels: position reconstruction in MEC using 
maps for the 4 trial conditions (red line: line of best fit with the highest replay score). Black shading 
represents the location with the highest probability, within each window.  Right panel: Position of 
the animal (yellow dot) and reconstructed trajectory (red), overlaid on tracking data from the task 
(grey).  
C) Examples of sMEC (highlighted red) and CA1 position reconstruction using maps of trial 
conditions with the best fit, during sMEC HSEs. Each red line of best fit was generated from sMEC 
data.   
D,E) The cumulative distribution of replay scores for HSEs detected in the sMEC (D, red) and CA1 
(E, black). Shuffled distributions are shown in cyan. Top: HSE’s during pauses in exploration, 
bottom: during movement. ** P<10-27 KS test 
F,G) The cumulative distribution of replay coherence scores between sMEC repay andCA1 activity 
(F, red) and CA1 replay with sMEC (G, black). Shuffled distributions are shown in cyan. All 
P >0.18, KS test. Layout as in F&G. 
H) Normalized CA1 ripple power during replay. sMEC: red, CA1: black  
I) Cross correlation of event times between CA1 (black) and sMEC (red) significant replay and 
SWR, and between sMEC significant replay and all CA1 HSEs (blue).   
  
Blue arrow marks the choice point, circle the goal location. Error bars: SEM. 
Fig. 3. Independent sMEC and CA1 replay during rest in the sleep box 
A) Local field potential centered on a sMEC HSE (highlighted purple, peak: dotted line), detected 
during a rest session. Channels were taken from different tetrodes (black: CA1, red: sMEC). Raster 
plot: unit activity sorted by location of their peak firing rate on right choice trials (black: CA1, red: 
sMEC, blue:  interneurons).   
B) Linearized rate maps for CA1 (black) and sMEC (red) excitatory units, sorted as in (A).  
C,D) Examples of detected significant sMEC (C) and CA1 region (D) replay, with the 
corresponding position reconstruction in the other brain region using maps of trial conditions with 
the best fit. The left panel in (C) shows the position reconstruction for the sMEC HSE in (A). 
E) The cumulative distribution of replay scores for HSEs detected in sMEC (top panel) and CA1 
(bottom panel).  Shuffled distribution shown in cyan. ** P<10-44 KS test.   
F) The cumulative distribution of coherence for sMEC repay withCA1 activity (top, red) and CA1 
replay to sMEC (bottom, black). None of original and shuffled score distributions are significantly 
different. Shuffled distributions shown in cyan. sMEC-CA1 P>0.1, CA1-sMEC P>0.07, KS test. 
G) Normalized CA1 ripple power during replay. sMEC: red, CA1:black  
H) Cross correlation of event times between CA1 (black) and sMEC (red) significant replay and 
SWR, and between sMEC significant replay and all CA1 HSEs (blue).   
Blue arrow marks the choice point, circle the goal location. Error bars: SEM. 
Supplementary Materials: 
Materials and Methods 
Figures S1-S17 
References (28-38) 
 
  
 C
sample
choice
0
50
100 150 200
linear position (cm)
left
linear position (cm)
right
0
50
100 150 200
B
10.2
9.3
4.8
6.1
2.0
2.1
5.3
4.3
3.9
1.2
2.6
2.4
12.8
12.5
3.9
3.6
23
26.4
6.7
9.7
10
7.5
3.3
3.3
3
4.8
6.2
2.9
4
4.7
5
8.8
1.8
4.9
7
10.3
A
27
27
cell no. 
cell no. 
20 cm
delay
sample
choice
sleep
sleep
Z Z
Z
Z Z
Z
 50 ms
0.5 mV
A
sMEC
CA1
sMEC
CA1
-500
0
500
ms
0
1
0
1
CA1 ripple power 
H
.1
0
.1
0-500
0
500
prob. 
I
replay coherence(%)
D
replay score(%)
prob.
1
.5
1
.5
20
80
50
**
**
E
**
**
20
80
50
50
100
0
ns
ns
F
G
ns
ns
50
100
0
max
prob.
Replay duration
C
200
150
100
50
200
150
100
50
sMEC
CA1
sMEC
CA1
linear position (cm)
linear position (cm)
90ms
80ms
80 ms
170 ms
90 ms
160ms
200
150
100
50
200
150
100
50
70ms
80ms
80ms
80ms
150 ms
150 ms
linear position (cm)
0.2
prob.
linear position (cm)
choice
sample
cell no. 
33
cell no. 
33
0
100
200
left
0
right
100
200
Replay duration : 140 ms
sample
100
200
0
100
200
0
left
choice
right
B
ms
 0.5 mv
50 ms
A
D
C
B
0
50
100
150
200
24
cell no.
49
cell no.
80 ms 
90 ms 
50
100
150
200
50
100
150
200
120 ms 
130 ms 
220 ms 
70 ms 
50
100
150
200
50
100
150
200
210 ms 
CA1
sMEC
150 ms 
linear position cm
linear position cm
linear position (cm)
Replay duration
.3
.2
.1
0
prob. 
0
500
-500
ms
3
2
1
0
0
500
-500
ms
CA1 ripple power 
G
H
E
.5
F
20
80
1
1
.5
prob.
50 100
0
ns
ns
**
**
replay 
coherence(%)  
replay 
score(%)
50
CA1
sMEC
  
 
1 
 
 
 
 
 
Supplementary Materials for 
 
Superficial Layers of the Medial Entorhinal Cortex Replay Independent 
of the Hippocampus 
 
J. O’Neill*, C.N. Boccara, F. Stella, P. Schoenenberger†, J. Csicsvari* 
. 
 
*correspondence to:  jozsef.csicsvari@ist.ac.at,  joneill@ist.ac.at 
 
This PDF file includes: 
 
Materials and Methods 
Figs. S1 to S17 
 
 
 
 
  
 
2 
 
Materials and Methods 
Surgery 
Four male rats (300–400 g) were implanted with 16 independently movable wire 
tetrodes under deep anesthesia using isoflurane (0.5%–3%), oxygen (1–2 l/min), and an 
initial dose of buprenorphine (0.1 mg/kg).  Our electrodes were arranged in two bundles: 
one targeting CA1 and the other to target the superficial layers (II/III) of the medial 
entorhinal cortex (sMEC). The electrodes were constructed from four 17 um or 8 
individual 12 um tungsten wires respectively, twisted and then heated in order to bind 
them into a single bundle. The tips were then gold plated to reduce their electrode 
impedance to 200–600 kΩ. During surgery, two craniotomies were centered above the 
CA1 and the medial EC (MEC). The electrodes were then implanted at a 6-10 degree 
angle, relative to the skull.  In 3 animals the sMEC bundle consisted of 4 rows (anterior-
posterior axis) of 2 tetrodes, covering a total area of .4 mm (medial-lateral axis, ML) by 
1.2mm (anterior-posterior, AP), i.e. 400 µm separation. These electrodes were then 
implanted into a region between -4.0 and -4.4 ML and -7.6 and -8.8 mm AP, relative to 
bregma.  In a further rat, the electrodes were arranged (from anterior to posterior) in a 
row of two electrodes, followed by a row of 3 electrodes and finally by a row of two, the 
most lateral of which consisted of an 8-wire octrode.  In this case the electrodes were 
implanted within a region -3.8 and -4.6 ML and -8 and -8.8 mm AP, relative to bregma. 
The bundles targeting the CA1 (centered on -2.5 ML,-3.6 AP) were implanted into the 
deep layers of the neocortex. The electrodes targeting the MEC were 1-2.5mm longer, 
and implanted into the deep layers (V/VI) of the MEC.  Two screws positioned above the 
cerebellum served as ground and reference electrodes. Six additional stainless-steel 
anchor screws were used in order to permanently attach the microdrive assembly to the 
scull. The paraffin wax-coated electrodes and the microdrive apparatus were then daubed 
with dental acrylic to encase the electrode-microdrive assembly and anchor it to the 
screws in the skull. Following a recovery period of 7 days, the tetrodes were lowered in 
50–200 µm steps each day into the CA1 region and superficial layers of the MEC, over a 
further period of up to 7–14 days (see training procedures below). Two 32-channel unity-
gain preamplifier panels were used to reduce cable-movement artefacts. Wide-band (0.4 
Hz to 9 kHz) recordings were taken, and the amplified local field potential and multiple-
unit activity were continuously digitized at 24 kHz. All procedures involving 
experimental animals were carried out in accordance with Austrian (Austrian federal Law 
for experiments with live animals) animal law under a project license approved by the 
Austrian Federal Science Ministry. 
Apparatus and training procedures 
The animals were housed in a separate room and were taken to the recording room 
each day prior to the experiments.  Following the recovery period (7 days), the animal 
was exposed to both a large open field arena and T-maze apparatus, over a period of 14 
days.  The open field arena consisted of either a circular environment (radius 1.2 m), or a 
large rectangular arena (1.5m x 2m).  The T-maze comprised a central arm and two return 
arms, containing a total of 220cm of linear track for both left and right turns.  The animal 
was placed on food restriction (>85 % of initial weight with a 10 gram gain each week), 
once it had passed the 7 day recovery period and exceeded their pre-surgery weight. Each 
animal was then trained for pellet chasing in an open field environment and to collect 
rewards on the T-maze.  From this point, the animal experienced the same daily 
  
 
3 
 
procedure until the cessation of the experiment, which was as follows. At the beginning 
of each day electrodes were lowered. Following a break of 1 to 2 hours, the animal was 
then recorded in the rest box (see description of T-maze below), then placed in the open 
field, and then again in the rest box.  Next the animal was placed on the T-maze, for 
training or recording.  After the last trial, the animal remained in the rest box, for post 
task rest/sleep.  The final rest session was omitted in one rat (3 sessions out of 12 
recording days).    Two bundles of light emitting diodes mounted either side of the 
headstage were used to track the location and head direction of the animal, and the 
position/head direction of the animal sampled at 50 Hz. 
T-maze delayed non-match-to-sample task. 
The T-maze apparatus consisted of an octagonal rest box, from which the animal 
could travel directly to the central arm and return through two addition arms to the right 
and left (see Fig.1a).  This rest box contained 80 cm high pneumatically controlled doors, 
which were used to control the animals exit onto the central arm at the beginning of each 
trial sample and choice phase, or access from the return arms, on completion.  A single 
trial would first contain a sample phase, in which a door would be raised to prevent the 
animal from choosing one side of the maze.  When the animal reached the goal (placed at 
the far corner of the maze, see Fig. 1a), a pellet would be dropped from an overhead 
pellet feeder.  Following this, the door would be raised on the rest box to allow the 
animal to return. Once inside the rest area, the animal would receive another food pellet, 
and remain for a further 20-30 seconds, before lowering the door blocking the central 
arm, to provide a free choice of the left or right arms.  The animal would be rewarded 
with a pellet if it selected the opposite arm to that baited on the sample trial.  Regardless 
of whether the correct arm was selected, the door on the rest area would then be lowered, 
to allow the animal to return to the rest area, and subsequently begin a new trial.   The 
sample trials were pseudo-randomly organized so that the animal would be forced to go 
either left or right, with no more than 3 consecutive trials for either side.  In this way, a 
single traversal of the T-maze could be one of 4 trial phases: sample left or right and 
choice left or right.  Behavioral shaping for this task began by first training the animal to 
collect a pellet from the goal and return to the rest area.  This was performed by training 
blocks of 6 trials of sample trials for one side followed by another block of 6 for the 
alternate side to prevent the animal developing a preference to one arm.  Once the 
animal’s behavior had been shaped with this procedure, the animal was exposed to 10 
trials of rewarded alternation, without a delay in the rest area.  On the next day, the 
animal was exposed to 20 trials, this time with a 10 second delay.  This procedure was 
then repeated with a 20-30 second delay on the following day, which continued for a 
further day, if the animal had not yet reached a performance level of 70% correct trials.  
In this way the animal could perform the task with shaped behavior, without over 
training. All animals achieved greater than 75% accuracy on each recording day (mean: 
82.7%, n = 12 sessions, minimum 36 trials). 
Data Analysis 
Spike sorting 
The spike detection in the local field potential and sorting was performed as 
previously described(28).  Action potentials were extracted by first computing power in 
the 800-9000 Hz range within a in a sliding window (12.8 ms). Action potentials with a 
  
 
4 
 
power of >5 SD from the baseline mean were selected and spike features were then 
extracted by using principal components analyses. The detected action potentials were 
then segregated into putative multiple single units by using automatic clustering 
software(29) (http://klustakwik.sourceforge.net/). These clusters were then manually 
refined by a graphical cluster cutting program(28). Only units with clear refractory 
periods in their autocorrelation and well-defined cluster boundaries were used for further 
analysis. We further confirmed the quality of cluster separation by calculating the 
Mahalanobis distance(29) between each pair of clusters.  Periods of waking spatial 
exploration, immobility, and sleep were clustered together and the stability of the isolated 
clusters was examined by visual inspection of the extracted features of the clusters over 
time.  Pyramidal cells and interneurons in the CA1 region were discriminated by their 
autocorrelations, firing rate, and wave forms, as previously described(28).  Putative MEC 
excitatory cells were identified by their firing rate. In this way we were able to identify 
the activity of 295 putative excitatory MEC neurons, including 91 grid cells, as well as 
410 CA1 pyramidal units. 
Generation of rate maps 
Two-dimensional place-rate maps in the open field and T-maze were calculated 
using the following procedure.  First, the environment was subdivided into a grid, 
containing 2x2cm bins. A 2x2cm square was overlaid on this grid, for each spike of a 
given cell, centered on the position of the animal when the spike was emitted.  Each bin 
was then incremented by the degree to which this square overlapped with it.  The same 
procedure was then performed with the tracking data to produce a map of occupancy. 
Occupancy and spike matrices were then smoothed with a Gaussian kernel (SD = 3 bins), 
and divided to produce a place-rate maps.  To test for rate modulation of trial type and 
reconstruction of replayed trajectories, we transformed the T-maze into a linear track. We 
generated a line down the center of each section of the track totaling 220 cm for left and 
right turns. Linear position was calculated by detecting the closest point to the closest 
straight line segment, for each tracking sample.  Runs were segregated into left sample, 
left choice, right sample and right choice.  For the Bayesian reconstruction analysis, the 
linearized animal position was subdivided into 75 bins. Spike counts and occupancy in 
these bins were smoothed with a Gaussian kernel (SD: 2 bins) and divided to produce 
linear rate maps. For waking replay analysis time windows containing high synchrony 
windows (HSE's, described below) were removed from the data, prior to calculation of 
the linear rate maps. 
Grid score 
To identify grid cells among the set of cells recorded from MEC we first fitted an 
ellipse to the centres of the six innermost detected fields of the autocorrelogram (30). 
From this fit we obtained the ellipticity value (the ratio between the major and minor axis 
size) and the orientation of the major axis. We then computed the geometrical 
transformation necessary to morph this ellipse into a perfect circle (a compression along 
the major axis of a magnitude equivalent to the ellipticity score) and we applied it to the 
(x,y) value matrix of the autocorrelogram. The result of this operation, in the presence of 
an elongated grid, is to put the 6 peaks at the same distance from the centre, thus 
obtaining a regular hexagon on which to calculate the grid score. This was calculated 
using a measure similar to the one previously described in (31). For each cell the grid 
score was computed for the original autocorrelogram and then compared to a null 
  
 
5 
 
distribution of scores similarly computed on the autocorrelograms obtained from 100 
shuffling of the cell spike times. For each shuffle we generated a new firing rate map 
from data in which the cell’s spike train had been randomly permuted relative to the 
position of the animal by at least 30 s (26). A cell was labelled as a grid cell if its grid 
score exceeded the 95th percentile of the associated null distribution. With this procedure 
we identified 91 grid cells. 
Coherence and Sparsity 
Coherence(32) and sparsity(33) provide measures of rate map spatial selectivity. 
Coherence reflects the similarity of the firing rate in neighboring bins, and is the Fisher 
z–transform of the correlation between the rate in a bin and the average rate of its eight 
nearest neighbors. Sparsity represents the proportion of the environment in which a cell 
fires, corrected for dwell time, and is defined as (ΣPi Ri)2 / ΣPi Ri 2 , where Pi is the 
probability of the rat occupying bin i, Ri is the firing rate in bin i. 
Assembly similarity score 
We were interested in comparing spatial representations between environments of 
different geometries (i.e. T-maze vs. open field).  We thus used a method to compare 
spatial overlap between pairs of cells in different environments/conditions, as previously 
described(32).  In a given session, we calculated a pixel-by-pixel correlation between rate 
maps for each pair of cells, providing a matrix representing the similarity of place fields 
within a population of cells.  Correlating matrices produced from two sessions provided 
an indication of the similarity of spatial representation between them, independent of 
differences in the geometry of the environment or even any global rotational translations 
of the rate maps.  Matrices across all sessions for a given session type were concatenated, 
and a single correlation performed between the data from the two session types (e.g. open 
field vs. T-maze) to give an assembly similarity score (error bars: 95% CI of the 
correlation coefficient)(33). For consistency, the same method was used to compare 
similarity of spatial representation across different trial phases on the T-maze. 
Ancova analysis  
The ancova analysis was performed using rates established on the first 64 cm of the 
start track and last 64 cm of the return arm, which represented regions of the maze with 
the most stereotyped behavior. These sections were divided into 8 spatial bins along the 
path, in which rate, mean lateral position, head direction and speed were calculated on 
each trial.  Head direction was linearized using the following procedure. First the mean 
head direction was established across the whole session, on the section of the track being 
analyzed.  Tracking samples with a head direction that exceeded ± 90 degrees from this 
mean were excluded from further analysis, leaving a potential 180 degrees, which was 
transformed into 20 bins.  Lateral position was calculated as the deviation from the center 
of the track. We calculated an average speed, lateral position and head direction in each 
bin, as well as rate, for each trial.  Only units that fired >50 spikes within the section of 
the track in question were included for further analysis. Firing rates were considered 
separately for the left and the right returns arms when the return arm portions were 
analyzed. On the central arm: n = 150 CA1, n = 88 grid and n = 109 non-grid cells fired 
sufficient number of action potentials to perform the analysis whereas, on the return arms 
n = 273 CA1, n = 175 grid, n = 197 non-grid cells met the same criteria.  We then used an 
ancova (using R software package) in order to ask if rate varied with trial phase (factors: 
  
 
6 
 
sample/choice and additional factor of left/right when the central arm), given changes in 
the behavioral variables.   
Bayesian reconstruction of position  
We used Bayesian place prediction(21) to first establish whether our population of 
sMEC units would provide sufficient spatial information to reconstruct position during 
exploration. We established population vectors in 500 ms windows (250 ms overlap, each 
containing at least 1 spike) while the animal was engaged in the T-maze task (excluding 
delay periods). The linear rate maps established over the whole task provide a firing 
probability for each spatial bin.  The formula below gave the probability that a given 
population vector represented a given place:   
 
P(x|n) = P(n|x)P(x)/P(n).  
 
P(x) represent the probability that the animal is at a given location considering the 
exploration session was set to a uniform distribution not to bias our analysis by any place 
preference of the animal(21). P(n|x) represents the conditional probability that a given 
spike count occurs at a location. This was estimated using the firing rates of the place-rate 
maps, assuming that the number of spikes follow a Poisson distribution. P(n), the 
normalizing constant, was used to ensure that P(x|n) summed up to 1.  The location with 
the maximum probability was selected as the reconstructed position. In order to test the 
success of this prediction we used a cross-validation approach, by reconstructing the 
positions using maps established on all trials except the trial being currently decoded.  
Error measurements represented the absolute distance between the middle of the 
reconstructed bin to the real position of the animal.  One recording session contained less 
than 15 sMEC units, and was excluded for further decoding analysis.  
High Synchrony Events (HSE) 
High synchrony periods were detected using the multi-unit activity of clustered 
spikes, similar to that previously described(34).  We selected the clustered spikes from 
units designated as excitatory cells and segregated them according to where they were 
recorded (i.e., sMEC or CA1).  These two groups were then analyzed separately to 
calculate the times of HSE's in each region.  The combined activity of excitatory cells 
was binned into 1 ms bins and smoothed with a Gaussian kernel (SD = 15 ms), to 
produce a curve representing the synchronous spiking rate over time.  HSE detection 
began when this curve passed 3 SD above the mean. The envelope of the HSE was 
extended until the curve again reached the mean rate, either side of this crossing.  The 
peak of the HSE represented the peak of the curve within this envelope.  Events 
containing fewer than 5 spikes, 4 cells or with less than 10% of the population of neurons 
active were rejected, as were events shorter than 75ms or greater than 750 ms.   The 
beginning of the HSE was then adjusted to the time of the first spike.  The HSE was then 
subdivided into 20ms windows, with a 10 ms overlap, until the last window containing a 
spike was reached.  Following this procedure, all events with less than 5 windows were 
rejected from further analysis. 
Replay during HSE's 
HSE detection produced candidate events from which to detect replay. Within each 
event, we generated a series of population vectors within time windows defined by the 
  
 
7 
 
HSE detection. Using the same Bayesian analysis described above and linear rate maps 
established from each trial type we reconstructed probability density functions over 
position, for each time window in the event containing spikes.  We used the method 
previously described (34) to establish a linear fit through each reconstruction 
(representing a putative linear trajectory through the environment), as well as a score 
representing the quality of this fit. Briefly, we iteratively generated a series of all possible 
linear trajectories through the environment.  For each potential trajectory, we summed the 
probabilities from 4 position bins closest to the line, on both sides, to allow for 
trajectories with local variations in velocity.  Locations were wrapped at the end of the 
track. We then tallied these sums across all time windows.  This sum was normalized by 
the number of windows and expressed as a percentage, giving a replay score that 
provided a measure of the density of probability along a given trajectory.  From this fit 
we could extract the start and end location of the replay, as well as its velocity.  This was 
repeatedly performed across all possible trajectories in order to find the most likely 
replayed trajectory for a given trial phase.  Such reconstructed trajectories may reflect a 
single location.  We therefore first removed trajectories that either covered less than 4 
position bins (11.73 cm) or had a fitted trajectory with an absolute slope of less than 200 
cm/s from further analysis, un less indicated in the text (Fig. S11). The fit with the 
highest score across all trial phases (sample left/right and choice left/right) was selected 
as the replayed linear trajectory.   We compared such a fit against shuffled data to 
generate a significance value, through the following procedure.   First, for each cell, the 
linear place fields constructed from the same trial type were randomly shifted along the 
track independently, with bins extending off the end of the track wrapped to the start. 
Next, we established replay scores from the shuffled data, over 1000 different shuffles.  
This method preserved spike timing and firing rate statistics while disrupting the spatial 
coding of the units used in the reconstruction.  In order to test whether the sequences 
required assembly activity to follow a precise temporal order we employed a 'spike jitter' 
shuffling method. For this method the spike timing of each unit active HSE was 
redistributed within the event (i.e. 'jittered') to generate a different matrix of population 
vectors that contained the same cells and rate within the event.  We then established a 
distribution of replay scores by reconstructing from the same trial phase across 1000 
shuffles. From this shuffled data we established a further score (replay score-z) showing 
the distance of replay score from the mean of the shuffled distribution by subtracting the 
mean of the shuffled data from the replay score and normalizing by its standard deviation 
(35).  
Replay coherence score across brain regions 
Once we had established significant replay events, we asked if these events were 
accompanied by sequences in the other brain region that followed this replay, or fired 
independently.   To do so, we reconstructed a probability over position function for each 
window with spike data in the second brain region.  This time we used the fit from the 
significant replay to calculate the score, which reflected the degree of coherent sequence 
activity. This replay coherence score was calculated by again summing probabilities 
within ± 4 bins from the line of best fit and dividing it by the number of windows 
(containing spikes) and expressed as a precentage.  This score was compared to that 
produced from shuffled data (500 shuffles), which involved redistributing (i.e. jittering) 
the spike times derived from the second brain region within the event. With this 
  
 
8 
 
procedure we tested whether spiking in the second region took part in similar sequential 
firing and not merely the degree of spatial similarity between reconstructed locations in 
both brain regions.  We generated a replay coherence z-score that reflected the distance 
of the spiking coherence to the shuffled data by first establishing the mean and standard 
deviation of the shuffled distribution.  The replay coherence z-score (replay coherence z, 
Fig. S 13) represents the event replay coherence minus the mean of the shuffled data for 
that event, divided by its standard deviation. 
We used a second form of shuffling in order to test whether the reconstructed trajectory 
matched the places encoded in the other, distal region better than any other places 
expressed during other trajectory replays (Fig S17).  To produce a shuffled probability 
density function, we replaced each window containing no-zero probabilities with 
probabilities from other randomly selected windows taken from other significant replay 
events of the same trial type. Only time windows with non-zero probabilities were used 
to replace the original non-zero probabilities. 
Drop analysis (within-region coherence score) 
In order to validate our replay analysis and provide a comparison to the cross region 
replay coherence scores, we analyzed how 1, 2 or 3 cells within a given region followed 
replay exhibited within the same area.  Taking those HSE's that exhibited significant 
replay with the full data set, we reestablished trajectories using the same rate maps, but 
this time dropping 1, 2 or 3 cells from the unit pool.  Resultant trajectories that passed the 
criteria described above (i.e. maze coverage, replay speed and cell/spike number) were 
then used to generate within-region replay z scores with the dropped cells, as described 
above for the cross-region spike coherence.  We performed this analysis for each cell, 
each possible pair of cells and 1500 randomly selected triplets of cells. 
Local Field Potential (LFP) analysis 
To identify periods of theta activity, the theta/delta power ratio was measured in 
1600 ms segments (800 ms steps in between measurement windows), as previously 
described(5, 28). Exploratory epochs included periods of locomotion or the presence of 
theta oscillations in the CA1 (as seen in the theta/delta ratio), including a < 2.4 s (i.e., two 
consecutive windows) transient from immobility segments.  We then detected individual 
theta oscillations separately for each tetrode within both the CA1 and MEC, by filtering 
the LFP (5–28 Hz) during exploratory epochs and detecting the negative peaks of 
individual theta waves.    
Theta phase modulation of significant replay was calculated by first selecting those 
events in which the peak of the HSE fell within a detected theta oscillation, recorded on a 
single sMEC electrode.  The phase of the HSE was then calculated by performing a linear 
interpolation between the detected troughs of the cycle and calculating the mean angle, as 
previously described(33).  The phase histogram in Fig. 2F represents the number of 
events in each phase bin (30o), divided by the total number of replay events (i.e., the 
probability of an event occurring during theta, at a given phase). 
Ripple power during detected significant replay events was calculated using a 
channel from a single CA1 electrode with clear ripple oscillations, during sleep after 
exploration.   For each event, we took a series of time points in 20 ms steps ± 500 ms 
from the peak of each HSE containing replay.  Ripple power was then calculated in a 
50ms window, centered on each 20 ms time step.  The estimated ripple power in each 
step was normalized by calculating a z score, using the mean and SD of ripple power 
  
 
9 
 
established from the whole behavioral sessions (50ms windows, 50 ms steps).   This HSE 
ripple power profile was then averaged separately for sMEC and CA1 HSEs.   
SWR detection was performed as previously described(28). Local field potentials 
were band-pass filtered (150–250 Hz), and a reference signal (from a channel that did not 
contain ripple oscillations) was subtracted to eliminate common-mode noise (such as 
muscle artefacts). The power (root mean square) of the filtered signal was calculated for 
each electrode and summed across electrodes designated as being in the CA1 pyramidal 
cell layer. The SWR detection threshold (7 SD above baseline) was always set in the first 
available sleep session, and the same threshold used throughout.  
Cross-correlation analysis was performed to detect temporal alignment between 
significant replay and detected SWR, as well as between significant sMEC replay and 
CA1 HSEs.  For the SWR analysis, HSEs with significant replay were taken as a 
reference and the number of detected SWRs was calculated in 25ms windows, centered 
on the peak of the HSE and extending to ± 500 ms.  This was normalized by the total 
number of detected replay events. 
Theta phase precession and theta sequence analysis 
 Individual place fields were detected by first detecting the position with the 
highest firing rate.  A window was extended out from this peak until a bin was reached in 
which either the rate was greater than or equal to preceding bin. In order to avoid small 
fluctuation in the rate map, transitions that occurred above 70% of the peak rate were 
ignored. This process was then repeated iteratively on the remaining portions of the track 
until a peak of < 2 Hz was detected. Fields measuring narrower than 5 bins (14.67 cm) 
and with fewer than 50 spikes were disregarded from further analysis.  In order to 
calculate a phase vs position correlation for each field we transformed the animal’s 
position as a fraction of the length of the field.   
The mean theta sequence was established with spikes that occurred during theta, but 
outside of any detected HSE. The trough of sMEC theta was used as a reference time 
point for both CA1 and sMEC analysis.  Using the same algorithm described for the 
replay analysis, we generated a matrix of probability over position in 20 ms windows, 
with 10 ms steps between each window, up +-300 ms from each theta trough. For each 
set of position estimations, the positions were transformed from position to distance from 
the location of the animal as established at the time of the sMEC theta trough. The 
probabilities in each time window were normalized by the maximum probability, and the 
resulting matrices were then averaged across the whole recording.  In order to calculated 
the slope of the session-mean theta sequence we used same the algorithm for trajectory 
fitting described in the replay analysis to establish the line of best fit within the averaged 
matrix.  This was done iteratively in 100 ms windows in 10ms steps between -20 ms and 
+280ms, from which the steepest slope was selected.  From this analysis we established 
the average slope for each region across days (Fig. S 10) as well as the maximal slope. 
In addition to calculating the mean theta sequence slope for a given session, we also 
detected theta sequences outside of HSE epochs. Having done so we could ask if the 
spiking in one region was coherent with theta sequences detected in the other and how 
coherence scores compared to that observed during waking replay. In order to detect theta 
sequences, we first generated windows from the peak-to-peak times of individual sMEC 
theta cycles, detected while the animal was actively engaged in the task (outside of the 
delay, moving at > 5cm/sec).  Such windows that overlapped with a detected HSE or 
  
 
10 
 
contained fewer than 4 cells or 5 spikes were discarded from further analysis. Theta 
sequences were then reconstructed using the same algorithm described for the replay 
analysis, except that the reconstruction was only performed using the rate maps that 
related to the current trial type.  The significance of the trajectory was then established 
using the place field rotation shuffling.  To further ensure that the detected theta 
sequences did not represent undetected replay events, we selected the subset of 
trajectories with slopes <2 m/s and passed through or within 5cm of current location of 
the animal (CA1: N=2126, sMEC: n=665). Having established such theta sequences in 
both the sMEC and CA1, we then calculated the replay coherence scores for spiking in 
the other, distal brain region, using the same method described above. 
 
 
  
 
11 
 
 
Fig. S1. Histological verification of electrode positioning 
Sagittal Nissl-stained brain sections show electrode tracks terminating in the 
superficial layers of the medial entorhinal cortex for all rats. Inserts show the entire 
region; red boxes delineate the magnified region; red arrows indicate tracks in the area of 
interest, (A–C) rat 1, (D–F) rat 2, (G–H) rat 3, (I) rat 4 (correspond to units shown in 
Fig.1). 
 
 
  
 
12 
 
 
Fig. S2. Grid cell characterization 
(A) Distribution of grid scores within the recorded superficial layers of the medial 
entorhinal cortex (sMEC) population. Red solid bars mark cells with a grid score greater 
than the 95 percentile of the shuffle distribution. See methods, n=91 grid cells (gr) and 
204 non-grid cells (ngr).  
(B) Examples rate maps established in the open field and T-maze of non-grid (left 
panel, red outline) and grid cells (right panel, solid red). 
(C,D) Spatial characteristics of grid and non-grid cells. Rate map coherence(32) 
(left) and sparsity(33) (right) are shown for the sMEC population in the open field (left 
panel) and T-maze (right panel).  
 
 
prop. cells
0.2
0.1
0
-1
-0.5
0
0.5
1
grid score
0.3
0.2
0.1
0
prop. cells
0
0.8
0.4
1.2
1.6
spatial coherence
open field
10.0 Hz
20.5 Hz
cell 3:
cell 2:
1.0 Hz
1.8 Hz
23.1 Hz
22.3 Hz
cell 1:
23.1 Hz
11.0 Hz
cell 4:
3.7 Hz
7.1 Hz
cell 5:
cell 6:
4.4 Hz
6.4 Hz
0
0.5
1
spatial sparsity
0
0.5
1
spatial sparsity
0
0.8
0.4
1.2
1.6
spatial coherence
t-maze
A
B
C
ngr
gr
  
 
13 
 
 
Fig. S3. Reorganization of sMEC and CA1 region spatial firing patterns between 
environments and trial phases 
(A) Reorganization of spatial assembly patterns between the open field and the T-
maze. Assembly similarity compares the similarity between place-rate maps for pairs of 
cells in the open field to that in the T-maze (see methods). A high correlation indicates 
that cells with overlapping place fields in one environment are similarly overlapping in 
the second, and vice versa. Solid red bars, gr: sMEC grid cells (n=304 cell pairs); striped 
red bars, ngr: sMEC non-grid cells; dark grey bars, p1: CA1 region pyramidal cells. Error 
bars: 95% confidence intervals. ** p<0.00001, z-test(31). Note that the grid cell 
population shows a similar configuration of rate maps between the two environments, in 
contrast to non-grid cells and CA1 pyramidal cells. 
(B,C) Reorganization of spatial firing rates. We measured the peak firing rate within 
each rate map (i.e. from the bin in the rate map with the highest firing rate) in both the T-
maze and the open field and generated a normalized change in rate score (absolute value 
of the difference/sum), for each cell(24). Cells with a peak rate of less than 1 Hz in both 
environments were excluded (gr n=84, ngr: n=195, p1: n=375). The distribution of these 
scores is shown for each population of cells in (B) as well as the median in (C). Error 
assembly similarity (r)
0
0.2
0.4
0.6
0.8
1
change in rate score
0.5
0.5
0.5
0.5
0.3
0.1
0.7 0.9
gr
ngr
p1
proportion of cells
gr
ngr
assembly similarity (r)
0
0.2
0.4
0.6
0.8
1
gr
ngr
p1
assembly similarity (r)
0
0.2
0.4
0.6
0.8
1
gr
ngr
p1
S-C L-R
S-C L-R
S-C L-R
gr
ngr
p1
S-C L-R
S-C L-R
S-C L-R
central arm
return arms 
A
B
change in rate score
0.2
0.4
0.6
0.2
0.4
0.6
0.2
0.4
0.6
C
D
E
p1
  
 
14 
 
bars in (C): 95% bootstrapped confidence interval. Color code and abbreviations as in 
(A). Grey dotted line: the chance level, generated from shuffled data (see methods). Note 
that all three cell types show a weaker than chance spatial firing rate reorganization. 
(D,E) Reorganization of spatial assembly patterns between different trial phases on 
the T-maze.We used the assembly similarity score (described in (A) and methods) to 
compare changes in spatial coding across different trial phases (sample vs. choice: S-C 
and left vs. right: L-R). On the central arm (D, see blue highlighted region on figure 1), 
spatial assemblies were highly correlated between all phases (all r>0.5), regardless of cell 
type. Between the goal and the end of the track (E, return arms), sample and choice trials 
were significantly more correlated, than when comparing assembly organization between 
the left and right arms. Error bars: 95% confidence intervals(31). All **p<0.00001, z-test 
(24). Color code and abbreviations as in (A). 
 
 
  
 
15 
 
 
Fig. S4. Position reconstruction during exploration  
We used a Bayesian maximum likelihood method to reconstruct the position of the 
animal using previously established rate maps and instantaneous firing patterns as the 
animal performed the task (see methods). In order to quantify the accuracy of the position 
decoding, we employed a cross validation approach by constructing rate maps from all 
trials except from the one in which the error was measured. We repeated the same 
procedure for each trial to measure the mean error. Instantaneous firing rates measured in 
500 ms windows (250 ms overlap, see methods).  
(A) For each cell type we show the session-by-session cumulative errors. Note the 
high probability of reconstructing a similar position to which the animal was currently 
occupying, in all cases. Left panel, black: CA1 pyramidal cells (p1): n=9 sessions with an 
average of 45.56 cells (range: 27-63 cells). Middle panel, red: all sMEC: n=11 sessions, 
with an average of 24.6 cells (range: 19-44 cells). One session with <19 cells was 
excluded. Right panel, red: grid-cell only: n=4 sessions with at least 10 cells (10, 11, 12 
and 12 cells, respectively).  
(B) Example confusion matrices for all CA1 (left), all sMEC (middle) and grid cell 
only (right) reconstruction, using data gathered from a single animal.  
(C) The median error is shown for the different cell types (p1, black: CA1 pyramidal 
cells; sMEC, red: all sMEC cells; gr, red: grid cells only). Circles show the median error 
for each session. Error bars: SEM. 
 
 
0.8
1
0.2
0.4
0.6
0
cumulative prob.
A
50
150
200
100
0
10
20
30
40
50
median error (cm)
50
150
200
100
60
0
50
150
200
100
0
error cm
error cm
error cm
reconstructed position cm
50
100
150
200
0
0.1
0.3
0
0.2
50
100
150
200
position cm
50
100
150
200
position cm
0
50
100
150
200
position cm
0
B
C
p1
sMEC
grid cells
p1
sMEC
gr
  
 
16 
 
 
Fig. S5. Change in firing rate with trial phase 
(A-C) Example of a grid cell that shows elevated firing rate on right trials with an 
interaction with forced and choice (p<0.005, Ancova, see methods). (A) Spike position 
overlaid on tracking data (left) and rate maps (right) are shown for open field exploration 
(top) and T-maze task (bottom). Peak firing rate (top left of the rate map) in Hz. The start 
track is highlighted in blue. (B) Linearized rate maps (8cm bins) were calculated trial-by-
trial and averaged by trial phases. Top left: sample (grey) vs. choice (black); top right: 
left (green) vs. right (blue); bottom left: left sample (dark green) vs. right sample (dark 
blue); bottom right: left choice (light green) vs. right choice (light blue). (C) Along with 
rate presented in (B), we simultaneously calculated speed (top), lateral position (i.e. 
distance from the center of the track to the edge, ± 5cm, middle) and head direction 
(bottom) in each spatial bin. Head direction exceeding > ± 90o from the direction of travel 
5.3
4.6
A
B
sample
choice
left sample
right sample
left choice
right choice
firing rate (Hz)
firing rate (Hz)
C
D
E
choice
sample
firing rate (Hz)
speed (cm/s)
 
lat. pos (cm)
head dir (deg)
7.6
7.5
left
right
8
6
4
2
0
8
6
4
2
0
20
40
60
20
40
60
linear position (cm)
linear position (cm)
speed
40
0
head dir. 
-90
0
90
20
40
60
linear position (cm)
lat. pos.
-2
0
2
-90
-45
0
45
90
60
40
20
155
175
195
215
155
175
195
215
-2
0
2
10
8
6
4
2
linear position (cm)
linear position (cm)
0.2
0.4
0.6
0.2
0.4
0.6
F
S-C
L-R
int.
S-C
L-R
int.
S-C
L-R
int.
cell proportion
grid cells
non-grid cells
G
cell proportion
gr
ngr
p1
CA1 pyramidal cells
  
 
17 
 
were excluded from further analysis. Speed, lateral position (lat. pos.) and head direction 
(head dir.) are plotted as a function of linear position for different trial phases. Color code 
as in (B). Error bars: SEM. 
(D,E) Example of a grid cell exhibiting sample/choice rate modulation on the return 
arm (i.e. between goal and the delay area, highlighted blue, p<0.001, Ancova). Spike 
position and rate maps are shown (D) along with linearized rate maps and behavioral 
quantification (E). Layout, color code and abbreviations as in (A, B). 
(F,G) Percentage of cells that show significant rate modulation on the central track 
(F) and between the goal and the return arm (G). (F) Left, red: grid cells only; middle, red 
stripped: non-grid cells; right, dark grey: CA1 pyramidal cells. S-C: sample vs. choice, L-
R: left vs. right, int: interaction. Error bars: C.I. 95%. (G) gr: grid cells, ngr: non-grid 
sMEC. p1: CA1 pyramidal cells. Color code and error bars as in (F). 
 
 
  
 
18 
 
 
Fig. S6. Firing response during HSE 
(A,B) Firing response of CA1 (n=410, black line) and sMEC (n=295, red line) cells 
to the CA1 HSEs detected in waking (A, CA1 - waking) and in sleep (B, CA1 - post rest). 
We performed a cross-correlation (5 ms bins) to the HSE peak. For each cell, firing rate 
in the cross-correlation was transformed into a z-score by calculating the mean rate 
across all bins and dividing by the standard deviation. The resulting histogram was 
smoothed with a Gaussian kernel (sd=5 ms) and averaged across the population of cells. 
(C,D) We performed the same analysis as in (A) and (B) with sMEC HSEs. 
Similarly, CA1 showed little response during waking, while showing a weak increase 
during rest HSEs. Layout, color code and abbreviations as in (A, B). 
 
 
C
Firing rate response (z)
2
6
4
8
0
A
0
-150
-300
150
300
ms
0
-150
-300
150
300
ms
0
-150
-300
150
300
ms
0
-150
-300
150
300
ms
CA1 - waking
CA1 - post rest
sMEC - waking
sMEC - post rest
B
D
  
 
19 
 
 
Fig. S7. SMEC replay across all behavioral epochs 
0.02
0
0.04
0.06
0.08
0.02
0
0.04
0.06
0.08
0.02
0
0.04
0.06
0.08
20
40
60
80
20
40
60
80
20
40
60
80
A
B
prop. events
prop. events
prop. events
awake
rest
10
20
30
significant events %
D
0
awake - all - paused
awake - all - moving
post rest - reversed
post rest - forward
awake - reverse - paused
awake - forward - paused
awake - reverse - moving
awake - forward - moving
post rest - all
replay score
replay score
replay score
pf
spk
pf
spk
pf
spk
pf
spk
pf
spk
C
paused
moving
  
 
20 
 
Distribution sMEC replay scores are shown for different behavioral epochs, along 
with shuffled distributions (place field shift, pf: green and spike jitter, spk: blue, see 
methods).  
(A) We identified a total of 2178 high synchrony events (HSE) during periods when 
the animal paused (<5 cm/s, awake - all - paused, red), 4024 sMEC HSE's during active 
locomotion (>=5 cm/s, awake - all - moving, light red) and 1506 during rest (post rest – 
all, red). The distribution of replay scores was significantly different from shuffled data 
in all behavioral epochs, regardless of the type of shuffling (all p<10-27, KS test). 
(B,C) As in A, sMEC HSE's with reverse (B: paused n=1381, moving n=1977 and 
sleep n=756) and forward (C: paused n=1337, moving n=2027 and rest n=749) 
trajectories, which had significantly different distributions to that of both sets of shuffled 
data (all p<10-27, KS test). Layout, color code and abbreviations as in (A). 
(D) Proportion of HSE's showing significant replay, during waking (left) and rest 
(right). When considering place field shuffling (pf), we detected 321, 642 and 202 events 
with a score larger than the 95 percentile during pauses, movement or rest respectively. 
With spike jitter shuffling (spk), 624, 947 and 416 events showed significance for the 
same epochs.  Left panel: red bars: awake - all - paused; light red bars: awake - all - 
moving. 
 
 
  
 
21 
 
 
Fig. S8. Z-score of replay scores for forward and reverse replay  
We established a replay z-score for each event, to provide a measure of how each 
event related to the shuffled distribution (replay z-score, see methods). For each HSE we 
calculated the mean and standard deviation of the shuffled distribution and used these 
values to normalize each replay score. (A) Example. Dotted line: replay score for a single 
event (B) Reverse (rev) and forward (for) CA1 (grey) and sMEC (red) replay at all 
behavioral epochs more often exhibited positive z-scores than expected by chance, 
regardless of the shuffling method used (all p<10-16, binomial test). Left: awake - paused; 
middle: awake - moving, lighter colors; right: post rest. spk: spike jitter shuffling; pf: 
place field shuffling. Error bars: SEM. 
 
 
B
0
0.4
0.8
1.2
1.6
for
rev
spk
pf
shuffle proportions
for
rev
for
rev
for
rev
for
rev
spk
pf
for
rev
for
rev
for
rev
awake - paused
for
rev
spk
pf
for
rev
for
rev
for
rev
post rest
replay z-score
replay score (z)
A
0
0.05
0.1
0
-3
-6
3
6
awake - moving
MEC
CA1
  
 
22 
 
 
Fig. S9. Waking replay in the sMEC and the CA1 
(A,B) Distribution of HSE's containing significant sequences generated in the sMEC 
(A) and CA1 (B), selected using spike order jitter shuffling (see methods). Left panels 
show the proportion of events detected while the animal had either paused (< 5 cm/s; (A) 
sMEC, red; (B) CA1, black) or was actively engaged in locomotion (>= 5 cm/s; moving; 
(A) sMEC, pink; (B) CA1, grey), for delay epochs (delay area) and during the task itself 
(track area). Right panels show the locations of events during the task itself. Arrow 
indicates the choice point, while circle marks the goal. Color code as in left panel. 
(C,D) sMEC (C) and CA1 (D) waking replay often encodes locations related to the 
current position of the animal, as well as non-local positions. Shown is the distribution of 
A
prop. events
delay track
 0
 0.1
 0.2
 0.3
 0.4
 0.5
area
position on the track
prop. events
0.05
50
100
150
200
0
0.075
0.025
-200
0
200
Distance from the animal (cm)
C
0.2
0.4
prop. events
 0
0.2
0.4
 0 0
100 200 0
100 200
-200
0
200
E
prop. events
delay track
 0
 0.1
 0.2
 0.3
 0.4
 0.5
area
position on the track
prop. events
0.05
50
100
150
200
0
0.025
-200
0
200
Distance from the animal (cm)
G
0.2
0.4
prop. events
 0
0.2
0.4
 0 0
100 200 0
100 200
-200
0
200
B
prop. events
 0
 0.1
 0.2
 0.3
 0.4
 0.5
delay track
area
prop. events
position on the track
0
0.05
0.1
0.15
50
100
150
200
-200
0
200
0
100 200
-200
0
200
D
0.2
0.4
prop. events
 0
0.2
0.4
 0 0
100 200
Distance from the animal (cm)
F
prop. events
 0
 0.1
 0.2
 0.3
 0.4
 0.5
delay track
area
prop. events
position on the track
0
0.05
0.1
0.15
50
100
150
200
-200
0
200
0
100 200
-200
0
200
H
0.2
0.4
prop. events
 0
0.2
0.4
 0 0
100 200
Distance from the animal (cm)
delay
track
delay
track
delay
track
delay
track
paused
moving
paused
moving
paused
moving
paused
moving
paused
moving
paused
moving
paused
moving
paused
moving
  
 
23 
 
distances from the closest point (left) and furthest point of replay (middle left) that 
occurred during delay epochs, as well as on the track (closest point: middle right, furthest 
point: right). Only replay trajectories reflecting the same left-right turn are included in the 
analysis (sMEC paused: 45.7%, moving 50.8%, CA1 paused 54.13%, moving 69.1%). 
Top row: replay that occurred while the animal had paused (< 5cm/s, dark colors). 
Bottom row: replay detected when the animal was moving (≥5cm/s, light colors).  Color 
code as in (A,B). 
(E–H) Shows the same analysis for events detected with place field shift shuffling. 
On the track 53.8% and 63.67% of sMEC replay trajectories represented the same left-
right turn for when the animal paused, or was moving respectively. In the CA1, 65.1% of 
trajectories during pauses represent the same side as that occupied by the animal, and 
77% while the animal was moving. 
  
 
 
  
 
24 
 
 
Fig. S10. Phase precession and theta sequences in CA1 and the sMEC 
In the CA1 theta phase precession is known to give rise to the generation of spiking 
sequences that encode a series of positions, extending from behind to the front of the 
current location of the animal, within a single theta cycle(33). It has been shown that 
subsets of excitatory cells in the sMEC also phase precess(38), which may in turn be 
detected as sMEC replay during exploratory epochs. To examine this possibility we 
established the degree of theta phase-position coding within our population of sMEC 
0
0.4
0.8
0.05
1
0.15
prop. of fields
phase-position correlation(r)
0.4
0.8
0
C
0.2
0.4
*
0
50
100
150
200
A
B
Position on track (cm)
E
theta sequence slope (cm/s)
100
200
0
F
-360
-180
0
180
360
540
720
150
195
-360
-180
0
180
360
540
720
-360
-180
0
180
360
540
720
-360
-180
0
180
360
540
720
Phase (degrees)
10
30
170
205
165
185
-300 -200 -100
0
100
200 300
20
0
-20
ms 
0.6
0.4
0.2
max prob.
sMEC
CA1
20
0
-20
0.05
1
0.15
phase-position correlation(r)
prop. of fields
distance from animal position (cm)
D
sMEC
CA1
MEC
CA1
MEC
CA1
*
MEC
CA1
  
 
25 
 
cells, and the slope of the theta sequence that it may give rise to. Color code throughout: 
sMEC red, CA1 black. 
(A,B) Examples of the relationship between spike theta phase and position in three 
sMEC units (A) and a single CA1 unit (B). Left panels show the animal’s path and 
position of the spikes during open field exploration (furthest left) and running on the T-
maze (middle left). The middle right panel shows the phase and linear position of each 
spike, for a single arm of the T-maze. Blue doted box highlights the place field indicated 
by the blue arrow on the middle left panel. Right panel is a zoom in of the section of the 
track containing the place field highlighted in the middle right panel. 
 (C) Distribution of circular linear correlations for individual place fields detected 
from the sMEC population (n=570) and CA1 region pyramidal cells (n=337, see 
methods). (D) Comparison of the means of the distributions presented in (C) showing that 
such theta phase precession is significantly weaker in the sMEC units than for CA1.  
(E) Typical example of a mean theta sequence probability map and slope (see 
methods), established from a single recording day for the sMEC (top) and CA1 (bottom) 
populations. Position reconstruction is shown as a function the animal location in 10 ms 
steps +-300 ms from the trough of each theta cycle detected in the sMEC. Black line 
denotes the fit with the steepest slope within -20 ms and +280ms of the theta trough. 
(F) Across recording days, the mean slope was significantly weaker in the sMEC 
than in CA1.  
* p< 0.01, Kruskal Wallis test. 
 
 
  
 
26 
 
 
Fig. S11. Characterization of waking replay sequences 
(A,B) Analysis of all replay events detected during waking HSE's that showed a 
better replay score than that from either the spike order shuffling (A) or place field 
shuffling (B), including those that were below the replay slope threshold of 200 cm/s 
(spike order shuffling: sMEC n=1790, CA1 n=1042; place field shuffling: sMEC n=1183, 
CA1 n=1337). Throughout: top row sMEC (red), bottom row CA1 (black). The left 
panels show the proportion of significant events detected at different animal speeds. The 
middle panels show the mean replay speed (slope of the fitted replay trajectory), for 
different animal speeds. Bins with < 40 events were not included in the plot. Error bars 
SEM. Green dotted line: average mean theta sequence slope as shown in Fig. S9 (D). 
Solid green line: steepest mean-theta sequence slope across all sessions. Note that the 
mean replay speed is 2-3 fold faster than that seen from the mean-theta sequence 
proportions
0.4
0.2
0
10
20
30
40
50
animal speed (cm/s)
replay speed (cm/s)
400
200
0
600
800
0
10
20
15
5
reverse
forward
1
0.5
0
proportions
0.4
0.2
0
replay speed (cm/s)
400
200
0
600
800
reverse
forward
1
0.5
0
proportions
0.4
0.2
0
replay speed (cm/s)
400
200
0
600
800
reverse
forward
1
0.5
0
proportions
0.4
0.2
0
replay speed (cm/s)
400
200
0
600
800
reverse
forward
1
0.5
0
A
B
0
animal speed (cm/s)
0
10
20
15
5
animal speed (cm/s)
sMEC
sMEC
CA1
CA1
  
 
27 
 
analysis, for both the CA1 and sMEC. The right panels show the proportion of forward 
and reverse replay, for different animal speeds. Shaded region: 95% confidence intervals. 
Note that replay sequences in the sMEC continue to exhibit reverse replay, even when the 
animal is moving at faster velocities. 
 
 
  
 
28 
 
 
Fig. S12. Replay coherence between regions when replay trajectories were identified 
with order shuffling 
HSE's with significant replay were selected by order shuffling in both the sMEC 
(left panel, red lines), and the CA1 (right panel, black lines). Cumulative distributions are 
shown for replay coherence between detected sequences and spiking in the other brain 
area, along with the shuffled distribution (blue lines) for different behavioral epochs. (A) 
Waking immobility (< 5cm/s, paused, sMEC n=255, CA1 n=273). (B) Active locomotion 
(>= 5cm/s, moving, sMEC n=597, CA1 n=275 ). (C) Rest (sMEC n=366, CA1 n=296).  
Replay coherence was not significantly different from the shuffled distribution ( all 
p>0.1, KS test) when either considering sMEC replay with CA1 unit activity, or CA1 
replay with sMEC unit activity, except for post-rest epochs, where CA1 sequences show 
a significant relationship with sMEC unit activity (C, right panel p=0.038, KS test). 
 
 
0
0.5
1
0
0.5
1
0
50
100
0
0.5
1
0
50
100
paused
moving
rest
A
B
C
shuffled
sMEC
cumulative probability
ns
shuffled
CA1
ns
shuffled
sMEC
ns
shuffled
CA1
ns
shuffled
sMEC
ns
shuffled
CA1
*
cumulative probability
cumulative probability
replay coherence score
(%)
replay coherence score
(%)
  
 
29 
 
 
Fig. S13. Replay coherence within a region is stronger that between the sMEC and 
CA1 areas  
(A,B) Replay coherence z-scores (see methods) between significant sMEC and CA1 
ensemble firing patterns (left panel, red) and between CA1 sequences and sMEC activity 
(right panel, grey) for different behavioral epochs: waking immobility (< 5cm/s, paused); 
0
0.2
0.4
0.6
0.8
1
replay coherence (z)
0
0.2
0.4
0.6
0.8
1
replay coherence (z)
-0.2
0
0.2
0.4
0.6
0.8
1
replay coherence (z)
-0.2
0
0.2
0.4
0.6
0.8
1
replay coherence (z)
C
E
paused
A
-0.2
0
0.2
0.4
0.6
0.8
1
replay coherence (z)
spike order
post rest
moving
1
2
3
1
2
3
1
2
3
place field shift
paused
post rest
moving
1
2
3
1
2
3
1
2
3
D
B
F
paused
moving
post rest
paused
moving
post rest
paused
moving
post rest
paused
moving
post rest
MEC
CA1
MEC
CA1
1
2
3
1
2
3
1
2
3
1
2
3
1
2
3
1
2
3
*
*
***
  
 
30 
 
active locomotion (>= 5cm/s, moving, lighter colors); rest (post rest). (A) Sequences 
detected with spike order shuffling (paused: sMEC n=255, CA1 n=273; moving: sMEC 
n=597, CA1 n=275; rest: sMEC n=366, CA1 n=296). (B) Place field shift shuffling 
(paused: sMEC n=115, CA1 n=295, moving: sMEC n=412, CA1 n=363; post rest: sMEC 
n=173, CA1 n=293). *p<0.05, more events than expected by chance greater than 0, 
binomial test.  
(C,D) Within region sequence coherence based on spike order shuffling (C) or place 
field shift shuffling (D). In order to validate our replay event detection, we first dropped 
1, 2 or 3 cells from the sMEC (top panels, red) or the CA1 (bottom panels, grey) 
population and detected trajectories using the remaining population of units. These new 
trajectories allowed us to calculate coherence scores with the dropped cells (see 
methods). Significant trajectories were identified with the shuffling. Dropped cells 
showed sequence coherence z-scores that were significantly different from 0, in all cases. 
(p<0.000001, binomial test). Color code as in (A,B). 
(E,F) Cross-region sequence coherence analysis based on spike order shuffling (E) 
or place field shift shuffling (F). We calculated for each significant sMEC and CA1 
sequence the replay coherence z-scores for sequences in which 1, 2 or 3 units were active 
in the other brain region. Note that sequence coherence z-scores were weak in all cases, 
with few showing a coherence z-score significant ( *p<0.05, ***p<0.0005 binomial test). 
Error bars: SEM. Color code as in (A,B). 
 
 
  
 
31 
 
 
Fig. S14. CA1 replay across all behavioral epochs 
0.02
0
0.04
0.06
0.08
0.02
0
0.04
0.06
0.08
0.02
0
0.04
0.06
0.08
20
40
60
80
A
B
prop. events
prop. events
prop. events
D
awake - all - paused
awake - all - moving
post rest - reversed
post rest - forward
awake - reverse - paused
awake - forward - paused
awake - reverse - moving
awake - forward - moving
post rest - all
replay score
replay score
replay score
pf
spk
pf
spk
pf
spk
pf
spk
pf
spk
C
paused
moving
100
20
40
60
80
100
20
40
60
80
100
awake
rest
significant events %
30
20
10
0
  
 
32 
 
Distribution CA1 replay scores are shown for different behavioral epochs, along 
with shuffled distributions (place field shift, pf: green; spike jitter, spk: blue, see 
methods). 
 (A) We identified a total of 2750 HSE's during periods when the animal paused (<5 
cm/s, awake - all - paused, black), 1958 CA1 HSE's during active locomotion (≥5 cm/s, 
awake - all - moving, grey) and 1693 during post-rest (post rest - all, black). The 
distribution of replay scores was significantly different from shuffled data in all 
behavioral epochs, regardless of the type of shuffling (all p<10-44, KS test). 
(B,C) As in A, CA1 HSE's with reverse (B, paused n=1317, moving n=892 and 
sleep n=817) and forward (C, paused n=1433, moving n=1066 and rest n=876) 
trajectories had significantly different distributions to that of both sets of shuffled data 
(KS, all p<10-44). Layout, color code and abbreviations as in (A). 
(D) Proportion of HSE's showing significant replay, during waking (left) and rest 
(right). When considering place field shuffling (pf), we detected 605, 503 and 344 events 
with a score larger than the 95 percentile during pauses, movement or rest respectively. 
With spike jitter shuffling (spk), 580, 343 and 356 events showed significance for the 
same epochs. Left panel: dark grey bars: awake - all - paused; light grey bars: awake - all 
- moving. 
 
 
  
 
33 
 
 
Fig. S15 Replay coherence during theta oscillations 
Trajectory sequences were reconstructed during peak-to-peak theta oscillatory cycles 
taking only events with a minimum of 4 cells and 5 spikes, as well as trajectory slopes of 
<2m/s (see methods). The coherence of sMEC theta trajectories to CA1 activity (A) and 
CA1 trajectories to sMEC (B) were measured. For comparison, the coherence for theta 
oscillation-related trajectories (theta) are displayed with equivalent replayed trajectories 
during waking immobility (<5cm/s, paused) and active locomotion (≥5cm/s, moving). The 
left panels show that average replay coherence while the middle and right panels display 
the mean of events with a different number of cells or spikes that were present in the distant 
region, i.e., activity for CA1 (A) and sMEC (B). The coherence for trajectories during theta 
sequences were always significantly higher than that to replayed trajectories (all p<10-15, 
Anova).  Error bars: SEM.  
 
 
A
B
No. cells
1
2
3
No. spikes
1
2
3
4
5
all
replay coherence (%)
0
10
20
30
40
50
No. cells
1
2
3
No. spikes
1
2
3
4
5
all
0
10
20
30
40
50
theta
paused
moving
theta
paused
moving
  
 
34 
 
 
Fig. S16. Replay coherence at different time lags 
(A,B) Significant sMEC (top row, red) and CA1 (bottom row, black) replay events 
were selected by either place field shift (A, pf) or spike jitter shuffling (B, spk) for 
different behavioral epochs: waking immobility (< 5cm/s, awake - paused, left panel); 
active locomotion (>= 5cm/s, awake – moving. middle panel); rest (post rest, right panel). 
Replay coherence scores were calculated between significant events and spiking in the 
other brain region, at lags of ±50 ms, in steps of 5ms. No significant change in score 
could be seen with time lag (all p>0.08, anova Tukey HSD). Blue line: mean across all 
time windows. Shaded regions: SEM. 
 
 
post rest - pf
awake - paused - pf
awake - moving - pf
-50
-25
0
25
50
5
10
15
20
25
replay coherence (%)
msec
0
5
10
15
20
25
replay coherence (%)
0
5
10
15
20
25
replay coherence (%)
0
5
10
15
20
25
replay coherence (%)
0
-50
-25
0
25
50
msec
-50
-25
0
25
50
msec
B
A
-50
-25
0
25
50
msec
-50
-25
0
25
50
msec
-50
-25
0
25
50
msec
sMEC
CA1
sMEC
CA1
post rest - spk
awake - paused - spk
awake - moving - spk
  
 
35 
 
 
 
Fig. S17 Replay coherence between regions: checking for nonaligned matches 
between trajectory in one region and the expressed place in the other region 
HSE's with significant replay were selected by order shuffling (A,C) or place field rotation 
(B,D) in both the sMEC (top panels, red lines), and the CA1 (bottom panels, black lines). 
For the shuffled distributions, the Bayesian probability distributions of the distant brain 
area were randomly selected from other significant replay events (see methods). 
Cumulative distributions are shown for replay coherence between detected sequences and 
spiking activity in the other, distant brain area, along with the place-randomized shuffled 
distribution (blue lines) for different behavioral epochs. (A,B) Replay during waking 
immobility (< 5cm/s, paused) and active locomotion (≥ 5cm/s, moving). (C,D) Replay 
during rest.  Replay coherence was significantly different from the shuffled distribution 
(all p<0.05, KS test). 
 
A
B
spike order
place field shift
place field shift
spike order
paused
moving
paused
moving
rest
boot-strap
sMEC
boot-strap
CA1
0
0.5
1
0
0.5
1
0
50
100 0
50
100
C
boot-strap
sMEC
boot-strap
CA1
0
50
100
boot-strap
sMEC
boot-strap
CA1
0
50
100
0
50
100
0
50
100
replay coherence (%)
rest
D
prob.
prob.
