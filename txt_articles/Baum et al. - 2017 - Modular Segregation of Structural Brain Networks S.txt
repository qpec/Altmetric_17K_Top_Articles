 Modular segregation of structural brain networks supports the 
development of executive function in youth
Graham L. Bauma, Rastko Cirica, David R. Roalfa, Richard F. Betzelb, Tyler M. Moorea, 
Russell T. Shinoharac, Ari E. Kahnb, Simon N. Vandekarc, Petra E. Ruperta, Megan 
Quarmleya, Philip A. Cookd, Mark A. Elliottd, Kosha Ruparela, Raquel E. Gura, Ruben C. 
Gura, Danielle S. Bassettb,e,†, and Theodore D. Satterthwaitea,†,*
aDepartment of Psychiatry of the University of Pennsylvania, Philadelphia, PA 19104 USA
bDepartment of Bioengineering of the University of Pennsylvania, Philadelphia, PA 19104 USA
cDepartment of Biostatistics and Epidemiology of the University of Pennsylvania, Philadelphia, PA 
19104 USA
dDepartment of Radiology of the University of Pennsylvania, Philadelphia, PA 19104 USA
eElectrical and Systems Engineering of the University of Pennsylvania, Philadelphia, PA 19104 
USA
SUMMARY
The human brain is organized into large-scale functional modules that have been shown to evolve 
in childhood and adolescence. However, it remains unknown whether the underlying white matter 
architecture is similarly refined during development, potentially allowing for improvements in 
executive function. In a sample of 882 participants (ages 8–22) who underwent diffusion imaging 
as part of the Philadelphia Neurodevelopmental Cohort, we demonstrate that structural network 
modules become more segregated with age, with weaker connections between modules and 
stronger connections within modules. Evolving modular topology facilitates global network 
efficiency, and is driven by age-related strengthening of hub edges present both within and 
between modules. Critically, both modular segregation and network efficiency are associated with 
enhanced executive performance, and mediate the improvement of executive functioning with age. 
Together, results delineate a process of structural network maturation that supports executive 
function in youth.
Graphical abstract
Address correspondence to: sattertt@mail.med.upenn.edu.
†= Co-senior authors
*= Lead contact
Publisher's Disclaimer: This is a PDF file of an unedited manuscript that has been accepted for publication. As a service to our 
customers we are providing this early version of the manuscript. The manuscript will undergo copyediting, typesetting, and review of 
the resulting proof before it is published in its final citable form. Please note that during the production process errors may be 
discovered which could affect the content, and all legal disclaimers that apply to the journal pertain.
AUTHOR CONTRIBUTIONS
Conceptualization: T.D.S, D.S.B. and G.L.B.; Methodology: D.S.B, T.D.S., G.L.B., R.C., D.R.R., R.F.B., T.M.M., R.T.S., A.E.K., 
S.N.V., P.E.R., M.Q., P.A.C. and M.A.E.; Investigation and Resources: R.E.G., R.C.G., K.R. and T.D.S; Writing: G.L.B., T.D.S. and 
D.S.B.; Editing and Revision: all authors; Supervision: T.D.S. and D.S.B.
HHS Public Access
Author manuscript
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Published in final edited form as:
Curr Biol. 2017 June 05; 27(11): 1561–1572.e8. doi:10.1016/j.cub.2017.04.051.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 INTRODUCTION
Modularity is a fundamental feature of complex systems, including social groups, cyber-
physical systems, and diverse biological networks [1]. A network module is a group of 
densely interconnected nodes, which often are the basis for specialized subunits of 
information processing [2]. Functional neuroimaging studies have demonstrated that the 
human brain has a well-defined modular organization, as reflected in the presence of large-
scale functional networks [3–6]. While the exact number and spatial distribution of 
functional network modules varies somewhat by analytic approach, a remarkable 
convergence exists across independent datasets and laboratories [4–6].
Commonly described modules include somatomotor, visual, default mode, and frontoparietal 
control systems [5,6]. While brain network modules emerge very early in life [7], a growing 
body of work has shown that these functional modules are refined during youth. During 
childhood and adolescence, functional modules become more distinct: connectivity within 
modules increases while connectivity between modules declines [8–11]. Such development 
allows for functional specialization, reducing interference among systems and facilitating 
cognitive performance [12]. Modularity is particularly relevant for executive function, which 
relies on co-activation of executive regions and reciprocal suppression of non-executive 
regions such as the default mode network [13]. Thus, available data suggests that 
development of network modularity may serve as a substrate for the evolution of executive 
capability during youth.
Despite convergent evidence for the developmental emergence of functional network 
modularity, there is relatively scant data regarding the maturation of underlying structural 
brain networks that support this functional architecture [14]. Prior work demonstrates 
substantial correspondence between functional and structural measures of brain connectivity 
[15–17], although structural connections tend to be a subset of densely connected, 
polysynaptic functional networks [18]. Structural networks in adults are highly modular 
Baum et al.
Page 2
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 [19,20], but it remains unknown if this topology evolves substantially during youth. 
Correspondence between functional and structural data intuitively suggests that, like 
functional networks, structural networks should become increasingly segregated during 
development. However, prior studies using relatively small samples report conflicting 
results, including declining modularity [21], increasing modularity [22], or no change with 
age [23,24]. Larger sample sizes may be necessary for resolving the variability of findings 
reported in previous studies.
Beyond this mixed data regarding normative developmental trends, the impact of structural 
network development on cognitive performance remains poorly described. Cognitive 
capability improves substantially during youth, with executive function undergoing a 
protracted phase of development throughout adolescence and young adulthood [25]. 
Describing how underlying white matter architecture evolves to support executive function is 
necessary to understand the basis for many sources of adolescent morbidity and mortality, 
which are prominently associated with failures of executive function [26]. Finally, such data 
are a prerequisite for studies of neuropsychiatric disorders, which are increasingly 
understood as disorders of brain development [27], are marked by executive dysfunction 
[28], and are linked to the disruption of evolving network topology [29–31].
Here we sought to define the normative development of structural network modules, and 
delineate the impact of modular maturation on executive functioning. We tested the 
hypothesis that modules within structural brain networks become more segregated with age, 
as seen in functional brain networks. Further, we predicted that segregated structural 
modules would support enhanced executive functioning. To address these hypotheses, we 
capitalized upon a large sample of 882 youths who completed diffusion imaging as part of 
the Philadelphia Neurodevelopmental Cohort (PNC), a community-based study of brain 
development that includes rich neuroimaging and cognitive data [32]. As described below, 
results provide novel evidence that structural brain networks undergo a process of modular 
segregation analogous to prior accounts of functional network development. Critically, these 
data reveal that the refinement of structural network modules mediate the development of 
executive function.
RESULTS
We investigated the evolution of structural brain networks in a sample of 882 youth aged 8–
22 who completed neuroimaging as part of the PNC (Figure 1A). As expected, executive 
function improved markedly with age (p<1×10−10, Figure 1B). Structural brain networks 
were constructed using nodes defined based on a parcellation of each subject’s structural 
image into 234 anatomically defined regions [33]; structural connectivity between these 
nodes was estimated using deterministic tractography (Figure 2). Each network node was 
assigned a priori to one of the functional network modules defined by Yeo et al. [6]. 
Although these module partitions were defined in an independent dataset, using a different 
imaging modality, the modularity quality of the functional partition imposed on subject-level 
structural connectivity matrices (QYeo) was highly significant (p<1×10−10). Furthermore, 
data-driven analysis of structural networks using community detection procedures [34–36] 
Baum et al.
Page 3
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 identified network modules that showed significant similarity to the a priori functional 
modules (p<1×10−10; see Figures S1 and S2).
Segregation of structural network modules increases with age
We first sought to understand whether structural network modules became more segregated 
with age. To do this, we calculated the average participation coefficient for each subject’s 
network. The participation coefficient quantifies the relative balance of a brain region’s 
between-module versus within-module connectivity: regions with a high participation 
coefficient (approaching the maximum value of 1) have strong between-module connectivity 
and weak within-module connectivity, while regions with lower participation coefficient 
values (approaching the minimum value of 0) have relatively weak between-module 
connectivity and strong within-module connectivity [37]. Greater modular segregation is 
therefore indicated by lower participation coefficient values, with reduced between-module 
and elevated within-module connectivity. We examined the development of modular 
segregation using a generalized additive model with penalized splines, which allows for 
statistically rigorous modeling of both linear and non-linear effects while minimizing over-
fitting [38]. To ensure that results reflected changes in network topology rather than global 
differences in network connectivity, total network strength was also included as a covariate 
in all analyses [39], as was participant sex and in-scanner motion (see also below).
The participation coefficient declined significantly with age (Figure 3A; p<1×10−10), 
indicating enhanced modular segregation. While we report non-linear age effects throughout 
this study, we also estimated the effect size of the linear age effect on mean participation 
coefficient while controlling for age2, sex, motion, and total network strength (r=−0.31, 
p<1×10−10). Notably, random resampling procedures provided striking evidence of a high 
degree of replicability of these observed developmental effects: all 10,000 sub-samples of 
441 randomly-selected participants demonstrated significant modular segregation with age, 
while no subsamples with permuted data showed this effect (see Figure S3). Age-related 
increases in modular segregation were greatest during childhood and adolescence, and 
leveled off in early adulthood (Table S1). Developmental increases in modular segregation 
were differentially distributed across modules (Figure 3B), with the most robust declines 
observed in the somatomotor and default mode modules. To further understand which 
regions were driving these effects, we examined the participation coefficient of individual 
network nodes. As expected, the nodal participation coefficient declined in many regions 
(Figure 3C), with many of the most significant reductions occurring in regions within the 
default mode system. Two exceptions to this overall trend were observed, with increasing 
participation coefficient in the right rostral frontal gyrus and frontal operculum.
Next, we investigated the degree to which developmental effects on modular segregation 
were driven by changes in within-module connectivity, between-module connectivity, or 
both. We found that both effects were significant: within-module connectivity increased with 
age (Figure 4A; p<1×10−10), whereas between-module connectivity declined (Figure 4B; 
p<1×10−10). Moreover, modular segregation was reflected in individual network edges 
(Figure 4C), with permutation-based analysis revealing that a higher proportion of 
connections that strengthened with age were located within a module (Figure 4D; p<0.001).
Baum et al.
Page 4
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 Results are robust to methodological approach and potential confounding variables
Given this strong evidence for developmental modular segregation, we next pursued an 
extensive set of supplementary analyses to determine if our results were dependent upon 
specific methodological choices. First, we evaluated alternative network partitions and 
measures of network segregation, to ensure that results were not specific to the functionally-
defined partition used in the main analyses. Notably, the participation coefficient of a data-
driven partition of the structural connectivity data yielded very similar results (Figure 5B; 
p<1×10−10; see also Figure S4). To ensure that developmental effects on modular 
segregation were not driven by age-related changes in modular composition, we also defined 
representative data-driven partitions for three age groups (childhood, adolescence, and early 
adulthood) and found remarkably high partition similarity across groups (Figure S5; see 
STAR Methods). We also measured the modularity quality index (Q) of network partitions, 
which quantifies how well a given partition maximizes the strength of within-module 
connections relative to a specified null model [1]. Higher Q values indicate that modules are 
highly segregated within a network. Convergent results were obtained when evaluating 
either the modularity quality of the Yeo et al. partition [6] (QYeo) applied to each subject’s 
data (Figure 5A; p=1.06×10−9), or by calculating the modularity quality of subject-specific 
partitions (Qsubj; Figure 5C; p=0.0007).
Second, we examined the impact of alternative network node definitions, edge measures, 
and edge normalization. Use of a more fine-grained network parcellation (N=463 nodes) did 
not impact the observed results, with age-related declines in the participation coefficient 
remaining highly significant (Figure 5D; p<1×10−10). Similarly, different measures of 
structural connectivity including streamline count (Figure 5E; p=6.52×10−7) and volume-
normalized streamline density (Figure 5F; p=4.56×10−8) produced highly similar results. 
Additional analyses revealed that results were not driven by the potentially artifactual 
strengthening of short-range connections (Figure S6). Normalizing edges by total network 
strength (rather than including it as model covariate) also yielded similar results 
(p<1×10−10).
Third, we observed highly convergent results after applying multi-compartment diffusion 
modeling and probabilistic tractography, which may enhance sensitivity for detecting 
crossing fibers [40]. After constructing thresholded networks across a wide density range for 
each subject, we observed a significant age-related decrease in the integrated mean 
participation coefficient when edge weights in probabilistic connectivity matrices were 
defined by the inter-regional streamline count (Figure 5G; p=7.24×10−7), volume-
normalized streamline count (Figure 5H; p=2.98×10−8), and the inter-regional connectivity 
probability (Figure 5I; p=4.25×10−7).
Fourth, to evaluate the influence of other potentially confounding variables, we also included 
total brain volume, handedness, race, and maternal education as model covariates; age 
effects on modular segregation remained significant (p<1×10−10). Similarly, results were 
unchanged when white matter volume (p<1×10−10) or mean white matter fractional 
anisotropy (p<1×10−10) were added as covariates. Conversely, results also remained 
consistent when all covariates were removed from the model (p<1×10−10).
Baum et al.
Page 5
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 Fifth and finally, we evaluated the potential confounding influence of motion artifact [41]. 
Notably, all data included in this study passed a rigorous quality assurance procedure [42] 
and all high motion scans were excluded. Nevertheless, motion was associated with higher 
mean participation coefficient (p=6.08 × 10−7). Accordingly, all analyses described therefore 
included in-scanner motion as a covariate. However, to ensure that developmental effects on 
modular segregation were not driven by age-related differences in head motion, analysis in a 
very low motion sub-sample (where motion was unrelated to age or participation coefficient) 
produced highly similar results (p<1×10−10; Figure S7).
Modular segregation contributes to global network efficiency
Having established that network modules become more segregated with age, and that this 
finding was not dependent on specific analytic choices, we evaluated the impact of evolving 
network modularity on measures of global communication efficiency. Global network 
efficiency provides a measure of network integration by quantifying information flow across 
a network as the shortest path between pairs of nodes [43]. In many networks, modularity 
and global efficiency are inversely related, as a highly modular topology could require long 
communication paths to integrate information across the network. However, in some cases it 
is possible for networks to become both more modular and more efficient; this unusual 
situation occurs when connectivity within modules is efficiently organized and hub edges 
form strong links between otherwise segregated modules [2,44]. To determine which 
scenario characterized human neurodevelopment, we first examined the relationship between 
global efficiency and age while controlling for the covariates described previously. 
Replicating previous reports [21,23], we found that global efficiency increases with age 
(Figure 6A; p<1×10−10). Next, we calculated the correlation between modular segregation 
(mean participation coefficient) and global efficiency, while co-varying for age to control for 
shared developmental trends. Mean participation coefficient was negatively associated with 
global efficiency (Figure 6B; p<1×10−10), suggesting that the development of network 
modules does not result in fragmentation, but rather is associated with global network 
integration.
Age effects are concentrated in hub edges that promote network modularity and efficiency
To better understand this highly specialized association between network modularity and 
global efficiency, we evaluated the edge betweenness centrality for each network connection. 
Edge betweenness identifies hub connections by providing a measure of how much a given 
network edge lies upon the shortest path of communication through a network, and thus 
contributes to global efficiency [45]. Here we defined hub edges as those connections within 
the top quartile of edge betweenness across all network edges. Critically, edges that 
strengthened with age were enriched for hub edges (p<0.001; Figure 6C). Both within- 
(p<0.001) and between-module (p<0.001) edges that strengthened with age had higher 
betweenness than expected by chance (Figure 6D). Furthermore, the average strength of all 
within-module (Figure 6E; p<1×10−10) and between-module (Figure 6F; p<1×10−10) edges 
that strengthen with age was associated with global efficiency, suggesting that 
developmental effects are concentrated within connections that facilitate network 
integration. The striking combination of increasing modular segregation and enhanced 
global efficiency demonstrates that structural brain networks become both more modular and 
Baum et al.
Page 6
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 more integrated in development. These dual processes are driven by selective strengthening 
of network hub edges, which are present within network modules and also provide critical 
links between increasingly segregated modules.
Modular segregation mediates development of executive function in youth
Next, we evaluated the cognitive implications of modular segregation by examining 
associations with individual differences in executive function. Mean whole-brain 
participation coefficient was associated with improved executive performance (p=0.018). At 
the level of individual modules, we found that segregation of the frontoparietal control 
system was uniquely associated with executive ability (Figure 7A; p=0.005), suggesting a 
network-specific substrate for executive function. As a final step, we examined whether age-
related changes in executive function and modularity were related. Mediation analyses 
revealed that this was indeed the case (Figure 7B; p=0.006), suggesting that the development 
of segregated structural brain modules mediates the age-related improvement in executive 
function. These mediating effects were specifically driven by the frontoparietal module 
(p=0.012). Similarly, global efficiency was associated with executive functioning (p=0.037), 
and also mediated executive development (p=0.002).
To evaluate the specificity of these results, we examined associations with other domains of 
cognition, such as social cognition and memory performance. While no association with 
memory was found, modular segregation was also significantly associated with social 
cognition (p=0.022), which was driven by segregation of the default mode module 
(p=0.012). Further, segregation of the default network mediated age-related improvements in 
social cognition (p=0.008). Together, these results demonstrate that developmental 
segregation of specific structural network modules may support the development of disparate 
cognitive domains.
DISCUSSION
Capitalizing on a large sample of youth imaged as part of the PNC, we demonstrated that 
modules within human structural brain networks become increasingly segregated with age. 
This result was robust to specific methodological choices, and driven by a combination of 
enhanced within-module connectivity and declining between-module connectivity. Age 
related changes were concentrated within specific hub edges, allowing for networks to 
simultaneously become more modular and more globally integrated with age. Critically, 
segregation of network modules mediated the development of executive function during 
adolescence.
The delineation of robust, reproducible large-scale functional networks has had a 
tremendous impact on human neuroscience research [5,6]. As a result, functional network 
modules have evolved to become the dominant framework by which human imaging data is 
interpreted. The conceptualization of the brain as a modular entity has had a particularly 
pronounced effect on theories of development, where convergent results have shown that 
functional network modules are present early in life [7], and continue to develop during 
youth [8–11]. In contrast, smaller studies of structural brain networks have produced 
heterogeneous results regarding the development of structural network modules that have not 
Baum et al.
Page 7
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 aligned well with functional imaging data [21,22,24]. When considered in light of prior 
studies that have reported substantial correspondence between brain structure and function 
[15–18], the disparity between developmental accounts of structural and functional network 
modules has been difficult to reconcile.
Leveraging a large sample imaged as part of the PNC, we were able to resolve this 
discrepancy by demonstrating that structural network modules develop in a similar manner 
as functional brain networks, and become increasingly segregated with age. Modular 
segregation was present at every scale evaluated, including the whole network, individual 
network modules, and specific network nodes. In contrast to the widespread regional pattern 
of modular segregation, the right frontal operculum and rostral middle frontal cortex became 
more integrated across development. These regions may increasingly serve as integrative 
hubs in the ventral attention (cingulo-opercular) and default mode networks [46]. 
Importantly, results were consistent across tractography methods and a variety of definitions 
for network nodes, edges, and modules; such methodological replication is critical as 
parameter choices may sometimes impact inference [47].
In many networks, modular segregation is associated with reduced capacity for global 
communication. We found that this was not the case in development, and that increasing 
modularity was in fact associated with enhanced network efficiency. This robust association 
was the result of targeted strengthening of hub edges. These hub edges were present within 
but also between modules, allowing for integration across increasingly segregated networks. 
These results accord with prior studies that have demonstrated that connections between 
network hubs strengthen preferentially with age [48], and that network efficiency increases 
during development [21,23]. The present data emphasize that increasing modular 
segregation does not result in isolation of functional sub-systems, but is associated with 
global network integration through strengthening of hub edges that facilitate both intra- and 
inter-module connectivity.
Having defined a normative process of modular segregation, we evaluated the cognitive 
impact of this developmental effect. While controlling for age, we found that greater 
modular segregation of structural brain networks was associated with better executive 
performance. Critically, modular segregation mediated the observed improvement of 
executive performance with age, and was driven by segregation of the frontoparietal module. 
Associations between module segregation and cognition were domain-specific: segregation 
of the default mode mediated age-related improvements in social cognition, which is reliant 
on regions within that network [49]. The process of structural network segregation may 
allow for functional specialization, and reduce competitive interference between brain 
systems [50]. Furthermore, building on prior work that reported an association between 
intelligence and the global efficiency of structural and functional networks in relatively 
small adult samples, we found that global efficiency also mediated developmental 
improvements in executive function. Taken together, the current data suggest that structural 
brain networks re-configure with age, becoming both more modular and more globally 
integrated. This specific topology may allow for both functional specialization within 
modules as well as coordination across modules, which is necessary for effective 
implementation of dynamic executive processes [44,50–52].
Baum et al.
Page 8
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 Notwithstanding the strengths of this study, several limitations should be noted. First, this is 
a cross-sectional dataset, which has inherent limitations for studies of development [53]. The 
mediating role that network maturation plays in the development of executive function could 
be further interrogated using longitudinal data. These limitations offer clear directions for 
additional research. Ongoing follow-up of this cohort will yield informative data, as will 
other large-scale studies of brain development, including the IMAGEN consortium [54], the 
NKI-Rockland sample [55], and the forthcoming Adolescent Brain and Cognitive 
Development Study. Finally, it should be noted that diffusion-based tractography methods 
remain limited in their ability to fully resolve complex white matter trajectories in the human 
brain [56]. We attempted to overcome the tradeoff between connectome specificity and 
sensitivity [57,58] by replicating results using both tensor-based deterministic tractography 
and Bayesian probabilistic tractography procedures.
In summary, we demonstrated that structural brain modules become more segregated with 
age. Strengthening of specific within- and between-module hub edges allowed for a 
simultaneous process of network integration that evolves in concert with modular 
segregation. Finally, both modular segregation and global network efficiency mediated the 
development of executive function in youth. These data resolve an ongoing debate in the 
field regarding the normative development of structural brain networks, and delineate an 
important new mechanism for the development of executive functioning in youth. These 
findings may be relevant for understanding how individual differences in brain development 
associate with risk-taking behaviors, which are linked to failures of executive function, and 
are a major source of morbidity and mortality in adolescence [26]. Furthermore, as both 
abnormalities within developing networks and executive system dysfunction [28] are a 
common feature of diverse types of psychopathology [29–31], structural network 
development may evolve to become an important imaging biomarker of risk and resilience 
during the critical period of adolescence.
CONTACT FOR REAGENT AND RESOURCE SHARING
Further information and requests regarding resource sharing may be directed to the 
corresponding author (Theodore D. Satterthwaite; sattertt@mail.med.upenn.edu).
EXPERIMENTAL MODEL AND SUBJECT DETAILS
Participants—Diffusion tensor imaging (DTI) datasets were acquired as part of the 
Philadelphia Neurodevelopmental Cohort (PNC), a large community-based study of brain 
development. In total, 1601 subjects completed the cross-sectional neuroimaging protocol 
[32]. Datasets from 244 individuals were considered unusable due to lack of a complete 
diffusion scan (n=224), or incidental findings (n=20). The remaining 1357 participants 
underwent a rigorous manual and automated quality assurance protocol for DTI datasets 
[42], which excluded 157 subjects for poor data quality (e.g., low temporal signal-to-noise 
ratio). Of the remaining 1210 participants, 93 were excluded for low quality or incomplete 
FreeSurfer reconstruction of T1-weighted images. Of the remaining 1117 participants, 235 
subjects were excluded for meeting any of the following criteria: gross radiological 
abnormalities, history of medical problems that might affect brain function, history of 
inpatient psychiatric hospitalization, use of psychotropic medication at the time of data 
Baum et al.
Page 9
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 acquisition, and/or high levels of in-scanner head motion during the DTI scan (mean relative 
displacement between non-weighted volumes > 2mm), which has been shown to impact 
measures derived from diffusion-weighted imaging [41,42]. These exclusions produced a 
final sample consisting of 882 youths (mean age=15.06, SD=3.15; 389 males, 493 females). 
Study procedures were approved by the Institutional Review Board of the Children’s 
Hospital of Philadelphia and the Brain Behavior Laboratory at the University of 
Pennsylvania. All adult participants provided informed consent; all minors provided assent 
and their parent or guardian provided informed consent.
Cognitive assessment—The Penn computerized neurocognitive battery (Penn CNB) 
was administered to all participants. The CNB consists of 14 tests adapted from tasks 
applied in functional neuroimaging to evaluate a broad range of cognitive domains [25]. 
These domains include executive control (abstraction and flexibility, attention, working 
memory), episodic memory (verbal, facial, spatial), complex cognition (verbal reasoning, 
nonverbal reasoning, spatial processing), social cognition (emotion identification, emotion 
intensity differentiation, age differentiation) and sensorimotor and motor speed. Accuracy 
and speed for each test were z-transformed. Cognitive performance was summarized by a 
recent factor analysis of both speed and accuracy data [59], which delineated three factors 
corresponding to the efficiency of executive function, episodic memory, and social 
cognition. Two participants from the full 882 sample had incomplete cognitive datasets: 
subsequent analyses examining associations between executive function and modular 
segregation focused on the remaining 880 participants (Figure 1B and Figure 7).
METHOD DETAILS
Image acquisition—All MRI scans were acquired on the same 3T Siemens Tim Trio 
whole-body scanner and 32-channel head coil at the Hospital of the University of 
Pennsylvania. DTI scans were acquired using a twice- refocused spin-echo (TRSE) single-
shot echo-planar imaging (EPI) sequence (TR = 8100ms, TE = 82ms, FOV = 240mm2 /
240mm2; Matrix = RL: 128, AP:128, Slices:70, in-plane resolution (x and y) 1.875 mm2; 
slice thickness = 2mm, gap = 0; flip angle = 90°/180°/180°, volumes = 71, GRAPPA factor 
= 3, bandwidth = 2170 Hz/pixel, PE direction = AP). This sequence used a four-lobed 
diffusion encoding gradient scheme combined with a 90-180-180 spin-echo sequence 
designed to minimize eddy-current artifacts. For DTI acquisition, a 64-direction set was 
divided into two independent 32-direction imaging runs in order make scan duration more 
tolerable for young subjects. Each 32-direction sub-set was chosen to be maximally 
independent such that they separately sampled the surface of a sphere [60]. The complete 
sequence consisted of 64 diffusion-weighted directions with b=1000s/mm2 and 7 
interspersed scans where b=0 s/mm2. The total duration of DTI scans was approximately 11 
minutes. The imaging volume was prescribed in axial orientation covering the entire 
cerebrum with the topmost slice just superior to the apex of the brain [32]. In addition to the 
DTI scan, a map of the main magnetic field (i.e., B0) was derived from a double-echo, 
gradient-recalled echo (GRE) sequence, allowing us to estimate field distortions in each 
dataset.
Baum et al.
Page 10
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 Image quality assurance—All DTI datasets were subject to a rigorous manual quality 
assessment procedure involving visual inspection of all 71 volumes [42]. Each volume was 
evaluated for the presence of artifact, with the total number of volumes impacted summed 
over the series. This scoring was based on previous work describing the impact of removing 
image volumes when estimating the diffusion tensor [61,62]. Data was considered “Poor” if 
more than 14 (20%) volumes contained artifact, “Good” if it contained 1–14 volumes with 
artifact, and “Excellent” if no visible artifacts were detected in any volumes. All 882 
subjects included in the present study had diffusion datasets identified as “Good” or 
“Excellent”, and had less than 2mm mean relative displacement between interspersed b=0 
volumes. As described below, even after this rigorous quality assurance, motion was 
included as a covariate in all analyses, and the impact of motion was further evaluated in 
supplemental analyses.
Diffusion image preprocessing—Two consecutive 32-direction acquisitions were 
merged into a single 64-direction time-series. The skull was removed for each subject by 
registering a binary mask of a standard fractional anisotropy (FA) map (FMRIB58 FA) to 
each subject’s DTI image using a rigid-body transformation [63]. Eddy currents and subject 
motion were estimated and corrected using the FSL eddy tool [64]. Diffusion gradient 
vectors were then rotated to adjust for subject motion estimated by eddy. After the field map 
was estimated, distortion correction was applied to DTI data using FSL’s FUGUE [65].
Structural image processing and node definition—The structural image was 
processed using FreeSurfer (version 5.3) [66], and cortical and subcortical gray matter was 
parcellated according to the Lausanne atlas [33], which includes whole-brain sub-divisions 
of the Desikan-Killany anatomical atlas [67] at multiple spatial scales. Parcellations were 
defined in native structural space and co-registered to the first b=0 volume of each subject’s 
diffusion image using boundary-based registration [68]. To extend gray matter region labels 
beyond the gray-white boundary, the atlas labels were dilated by 4mm [69]. Dilation 
involved filling non-labeled voxels with the statistical mode of neighboring labels. Together, 
234 dilated brain regions defined the nodes for each subject’s structural brain network, 
which was represented as a weighted adjacency matrix A.
Deterministic tractography—DTI data was imported into DSI Studio software and the 
diffusion tensor was estimated at each voxel [70]. For deterministic tractography, whole-
brain fiber tracking was implemented for each subject in DSI Studio using a modified fiber 
assessment by continuous tracking (FACT) algorithm with Euler interpolation, initiating 
1,000,000 streamlines after removing all streamlines with length less than 10mm or greater 
than 400mm. Fiber tracking was performed with an angular threshold of 45°, a step size of 
0.9375mm, and a fractional anisotropy (FA) threshold determined empirically by Otzu’s 
method, which optimizes the contrast between foreground and background [70]. FA was 
calculated along the path of each reconstructed streamline. For each subject, deterministic 
tractography served as the primary basis for constructing structural brain networks. Edges 
were defined where at least one streamline connected a pair of nodes end-to-end. Edge 
weights were primarily defined by the average FA along streamlines connecting any pair of 
nodes [17,30,48] (see Figure 2). In addition to these FA-weighted networks, supplemental 
Baum et al.
Page 11
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 analyses evaluated edge weights defined as the streamline count and streamline density 
using deterministic tractography (see below).
Probabilistic tractography—While deterministic tractography has high specificity 
relative to probabilistic methods, it suffers from a lack of sensitivity to intra-voxel fiber 
crossings that occur frequently throughout the brain [57,71,72]. To ensure that our results 
were not impacted by the failure to reconstruct crossing fibers using deterministic 
tractography, we fitted a ball and two-sticks diffusion model to the DTI data using the FSL 
bedpostx algorithm [72], which uses Markov chain Monte Carlo sampling to estimate the 
uncertainty of fiber orientations at each voxel. For probabilistic tractography, we generated 
subject-specific seed volumes at the FreeSurfer GM-WM boundary [39,73]. We ran FSL 
probtrackx [40], initiating 1000 probabilistic samples in each GM-WM boundary voxel 
identified in the 234 seed regions. A FreeSurfer segmentation of ventricles was included as 
an “avoidance” mask to provide anatomical constraints on tractography: all probabilistic 
samples entering the ventricles were discarded, and excluded from regional tractography 
estimates. We otherwise used default tracking parameters (a step-length of 0.5mm, 2000 
steps maximum, curvature threshold of 0.02).
In order to ensure that our results were robust to different edge measures, we examined three 
measures of structural connectivity commonly used with probabilistic tractography. First, we 
constructed a symmetric N × N streamline count matrix for each subject, where edge 
weights were equal to the number of probabilistic streamlines connecting each pair of GM-
WM boundary nodes [39,74]. Second, we constructed networks where edge weights were 
equal to the total number of streamlines connecting a node pair divided by their total volume 
[48,75,76]. Third and finally, we also constructed networks where edge weights were equal 
to the connectivity probability between each pair of brain regions, which represents the 
proportion of total samples (probabilistic streamlines) initiated from the seed region that 
reached the target region [77–79]. Network construction using probabilistic tractography 
output was implemented in MATLAB (MathWorks, Natick, MA).
While anatomical networks are classically considered sparse relative to functional networks, 
probabilistic tractography yields dense weighted networks that contain a large number of 
weak connections. The high false positive rate for probabilistic tractography often results in 
spurious inter-modular connections, which can have a significant detrimental impact on 
modularity maximization procedures, over and above the impact of false negatives [58]. 
Since the specificity of WM tractography methods is paramount in studies of network 
community structure [58], we applied a range of density thresholds to identify the strongest 
connections across subjects. For each of the edge-weighting schemes, probabilistic 
connectivity matrices were averaged across subjects, and a density threshold was applied to 
preserve an identical number and position of connections across subjects. Since there is no 
definitive choice for selecting a threshold, as in prior studies, we evaluated networks over a 
density range spanning 5– 60% (12 thresholds, at 5 % intervals) [73,77,80]. For example, to 
obtain a 5% density threshold, we retained only the 95th percentile of edge weights in the 
group-averaged connectivity matrix. In all cases, following thresholding, edge weights in 
each subject’s connectivity matrix were normalized by the total weight of network 
connections in order to delineate intrinsic topological differences across subjects 
Baum et al.
Page 12
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 [19,39,74,77,81–83]. For each subject, we calculated the modular segregation (mean 
participation coefficient) at each density threshold in order to derive integrated summary 
metrics [77].
Defining a priori network modules—The standard 7-system template image provided 
by Yeo et al. [6] was originally derived from a whole-brain clustering analysis, which 
yielded 7 large-scale functional networks. In order to obtain a finer-grained parcellation 
better suited to structural brain network construction, we calculated the purity index for the 
7-system parcellation and brain regions from the Lausanne atlas (234- and 463-region 
parcellations). This measure quantifies the maximum overlap of cortical Lausanne labels and 
functional systems defined by Yeo et al. [6]. Each cortical Lausanne label was assigned to a 
functional system by calculating the non-zero mode of all voxels in each brain region. 
Subcortical regions were assigned to an eighth, subcortical module. The primary modular 
partition defined for 234-node networks is shown in Figure 2 and Figure S1.
To determine whether the functionally-defined network partition significantly fit the 
structural connectivity data beyond chance, we quantified the modularity quality index 
(formally defined below) of the functional partition imposed on structural brain networks. 
Briefly, the modularity quality of a network partition quantifies how well that partition 
maximizes the strength of within-module connections relative to a specified null model. 
Higher Q values indicate that modules are highly segregated within a network, with strong 
within-module connectivity and relatively weak between-module connectivity. We 
performed a permutation test to examine the significance of the modularity quality of the 
functional partition (QYeo) imposed on structural connectivity matrices. First, we permuted 
the assignment of N nodes to functional modules 1000 times, preserving the number of 
nodes originally assigned to each module. We then calculated the modularity quality of 
randomly-defined network partitions (Qperm) imposed on each subject’s connectivity matrix, 
building a null distribution for Qperm. We used the calculated mean and standard deviation of 
the null distribution to derive a z-score based on the observed QYeo for each subject. Finally, 
we calculated the mean z-score across all subjects to assess the significance of QYeo.
Data-driven structural network modules—Primary analyses relied on an a priori 
functional partition to define network modules, as described above. We additionally defined 
network modules directly from the structural connectivity data using community detection 
procedures. Communities were defined by maximizing the modularity quality function using 
a generalization of the Louvain heuristic [34,35]. Because the Louvain algorithm is 
degenerate [34,84], it is essential to perform modularity maximization multiple times in 
order to identify a stable consensus partition that accurately reflects the solutions offered by 
each optimization. Accordingly, we applied a Louvain-like modularity-optimization 
procedure [34] 100 times for each subject in order to define an “agreement” matrix A′ 
where A′ij was equal to the probability that nodes i and j were assigned to the same 
community over the 100 iterations. If A′ was deterministic (edge weights were binary), then 
the algorithm had converged and the resultant partition was defined as the consensus. 
Otherwise, we performed 100 iterations of modularity optimization on A′ in order to 
generate a new agreement matrix A″. This procedure was repeated until convergence [85].
Baum et al.
Page 13
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 Once a consensus partition was identified for each subject, we computed a group-level 
consensus across the full PNC cohort (n=882). To do this, we used a Louvain-like procedure 
to detect communities in a group-level agreement matrix A′group. Edge weights in Agroup 
were equal to the proportion of times that each pair of nodes was assigned to the same 
community across subject-level consensus partitions. As above, 100 iterations of modularity 
optimization were performed on A′ until the resulting A” became binary, indicating that the 
algorithm had converged on a group-level consensus partition. Both subject-level and group-
level consensus partitions were computed over a wide range of γ ([0, 4], in increments of 
0.05) to explore variations in community structure. We plotted the number of group-level 
consensus modules as a function of γ, and found several plateaus indicating partition 
stability [86] (see Figure S2).
In order to directly compare the organization of data-driven, modularity-based partitions and 
the a priori functional partition, we quantified the partition similarity using the z-score of the 
Rand coefficient [87]. For two partitions X and Y, we calculated the Rand z-score in terms 
of the total number of node pairs in the network M, the number of pairs MX assigned to the 
same module in partition X, the number of pairs MY that are in the same module in partition 
Y, and the number of pairs of nodes wXY that are assigned to the same module both in 
partition X and in partition Y. The z-score of the Rand coefficient is defined by:
(1)
where σwXY is the standard deviation of wXY. The mean partition similarity is determined 
by the mean value of zXY over all possible partition pairs for X ≠ Υ. Moreover, zXY denotes 
the similarity of partitions X and Y beyond chance. Figure S2 shows the similarity between 
all group-level structural partitions and the primary functional partition used in this study 
[6].
QUANTIFICATION AND STATISTICAL ANALYSIS
Measures of modular segregation—We calculated the participation coefficient to 
quantify the relative balance of between-module versus within-module connectivity for each 
brain region [37]. Intuitively, this measure describes the degree to which a brain region 
integrates information across distinct modules, or the degree to which a brain region shows 
provincial connectivity among regions in its own module. We define the participation 
coefficient Pi of node i as
(2)
where m is a module in a set of modules M, and ki(m) is the weight of structural connections 
between node i and all nodes in module m [37,88]. Moreover, Piclose to 1 indicates that a 
brain region is highly integrated with regions in other modules, while a Pi close to 0 
Baum et al.
Page 14
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 indicates that a brain region is highly segregated, with strong connectivity among other 
regions in its own module. To quantify the segregation of specific modules, we average Pi 
across all brain regions assigned to the same module (see Figure 3B). To quantify global 
network segregation, we average Pi across all nodes in the network (see Figure 3A).
In addition to the participation coefficient, we calculated the average strength of all within-
module connections (a measure of structural coherence), and the average strength of all 
between-module connections (a measure of structural integration) in the network [69](see 
Figure 4). These metrics provide additional insights into the segregation of information 
processing within distinct modules, and the degree to which modules are integrated across 
the network. While our main analyses defined partitions based on the a priori mapping of 
nodes to the modules defined by Yeo et al. [6], we also examined age effects on modular 
segregation (mean participation coefficient) using a data-driven structural partition defined at 
the group level (Figure 5B).
Alternative measures of modular segregation—As an alternative measure of 
modular segregation, we also calculated the modularity quality index (Q) for both group-
level partitions and data-driven subject-level partitions. Q quantifies how well a given 
network partition maximizes the strength of within-module connections relative to a 
specified null model. Thus, in contrast to the participation coefficient, Q increases in more 
segregated brain networks. We calculated the modularity Q of a network partition S based on 
the following modularity quality function:
(3)
where m is the total weight of A, P represents the expected strength of connections 
according to a specified null model [1,89], γ is a structural resolution parameter that 
determines the size of modules, and δ(gi,gj) is equal to unity when brain regions i and j are 
assigned to same community gi, and is zero otherwise.
We re-evaluated developmental effects when network segregation was defined by the 
modularity quality of the Yeo partition [6] as applied to subject-level data (QYeo see Figure 
5A). Further, we defined data-driven network partitions of each individual’s structural 
connectivity matrix by repeating a Louvain-like modularity-optimization procedure 
[34,35]100 times, followed by the consensus clustering procedure described above. 
Consensus clustering procedures delineated subject-specific consensus partitions (defined 
across the optimal solutions from 100 iterations of community detection), which were used 
to calculate network modularity. This measure quantifies the strength of within-module 
connections relative to a specified null model (Qsubj; see Figure 5C), and was not dependent 
on a group-level partition.
Stability of data-driven modular partitions—To evaluate the stability of these subject-
specific modular partitions across the sample age range (8–22 years), we examined whether 
the number of detected modules changed with age. Across partitions defined using three 
Baum et al.
Page 15
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 different structural resolution parameters (highlighted in Figure S2), we found no significant 
change in the number of detected modules with age. To examine whether the composition of 
group-level modular partitions evolved across development, we split our sample into three 
age groups corresponding to childhood (8–12 years, n=241), adolescence (13–17 years, 
n=451), and early adulthood (18–22 years, n=190). Group-level consensus partitions were 
defined for each age group using the consensus procedure described above. We evaluated 
consensus partitions at γ=1.5, 2.5, and 3.1, resulting in nine total partitions. Next, we 
calculated the partition similarity across age groups using the normalized mutual 
information (NMI) between each pair of partitions [46,88]. We also calculated the NMI 
between partitions for each age group and the data-driven consensus partitions defined 
across the full 882-subject sample (NMIGroup; see Figure S5).
Quantification of network integration—While primary analyses evaluated age-related 
changes in modular segregation, we were also interested in whether structural brain 
networks become more globally integrated during development, as previously reported 
[21,23]. For each subject’s structural brain network represented as an adjacency matrix A, 
the topological length or distance of each edge Aij was computed as the reciprocal of the 
edge weight 
. The path length between any pair of nodes is defined as the sum of the 
edge lengths along the shortest path connecting them [88]. Global efficiency provides a 
theoretical prediction of how easily information can flow across a network via the shortest 
path between all pairs of nodes, and is defined by
(4)
where n is the number of nodes, and dij is the shortest path length between node i and node j. 
To examine the possible role of specific edges as integrative hub connections within the 
network, we calculated the weighted edge betweenness centrality for each edge. Edge 
betweenness centrality identifies important hub connections by providing a measure of how 
much a given connection participates in the shortest paths of communication through a 
network, and thus contributes to global efficiency [45].
(5)
where ρhkij denotes the number of shortest paths between nodes h and k that include edge ij, 
and ρhk denotes the total number of shortest paths between h and k. After calculating edge 
betweenness centrality individually for each weighted network A (n=882), we normalized 
each subjects’ edge betweenness centrality values by their maximum observed edge 
betweenness centrality, resulting in a bounded measure [0,1] [77]. We calculated the mean 
Baum et al.
Page 16
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 normalized edge betweenness centrality for each network edge across subjects, and defined 
hub edges as those connections within the top quartile of normalized edge betweenness 
across all network edges. Following group-level analysis, which identified a subset of edges 
that significantly strengthened with age, we performed a permutation-based test to assess 
whether connections that significantly strengthened with age were enriched for hub edges 
(see below).
Group-level analyses: Modular segregation—Prior work has demonstrated that brain 
development is not a linear process [90,91]. Accordingly, group-level analyses of structural 
brain network metrics were flexibly modeled using penalized splines within General 
Additive Models (GAM) implemented in the R package “mgcv” (https://cran.r-
proiect.org/web/packages/mgcv/index.html) [38,92]. Such an approach allows for detection 
of nonlinearities in the relationship between age and measures of modular segregation 
without defining a set of functions a priori (such as polynomials). Importantly, the GAM 
estimates nonlinearities using restricted maximum likelihood (REML), and determines a 
penalty with increasing nonlinearity in order to avoid over-fitting the data. Due to this 
penalty, the GAM only models nonlinearities when they explain additional variance in the 
data above and beyond linear effects.
We used penalized splines to estimate nonlinear developmental patterns of modular 
segregation (Figure 3A). Within this model we included covariates for sex, head motion, and 
total network strength. Accordingly, the final model equations for estimating age effects on 
modular segregation (mean participation coefficient) were as follows:
An identical model was used when estimating age effects on the participation coefficient of 
individual brain regions (Figure 3C). Similarly, we applied this model across all network 
edges in order to assess linear and nonlinear age effects on the strength of individual 
connections. For all analyses, multiple comparisons were controlled using the False 
Discovery Rate (q<0.05) [93]. Unless otherwise specified, all statistical analyses included 
data from the entire sample of 882 participants.
In addition to evaluating the entire sample in one model, we also estimated age effects on 
modular segregation within three distinct age groups corresponding to early childhood (8–12 
years, n=241), adolescence (13–17 years, n=451), and early adulthood (18–22 years, n=190) 
using the same model.
Group-level analyses: Network integration—To assess linear and nonlinear age 
effects on global network efficiency, we used the same GAM as above, controlling for the 
effects of sex, head motion, and total network strength (see Figure 6A). The relationship 
between global efficiency and modular segregation was assessed within a GAM while 
controlling for age in addition to other covariates described above (Figure 6B). To evaluate 
whether global efficiency was related to the weight of specific network connections that 
strengthened with age, we assessed the relationship between global efficiency and the 
average strength of within-module edges (Figure 6E), or the relationship between global 
Baum et al.
Page 17
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 efficiency and the average strength of between-module edges (Figure 6F), while controlling 
for age and the same covariates described above.
Associations with executive function—We assessed linear and nonlinear age effects 
on executive function by modeling a spline age term within a GAM while controlling for sex 
(Figure 1B). To examine the association between modular segregation and executive 
efficiency, we included a spline age term in the model to account for the variance associated 
with linear and nonlinear age-related changes in executive ability. The final model equation 
was as follows:
We also evaluated the association between the segregation of individual modules (e.g., 
frontoparietal) and three cognitive efficiency factor scores: executive function, memory, and 
social cognition (see Figure 7A). Two participants from the full 882 sample had incomplete 
cognitive datasets; thus associations with cognition were evaluated in the remaining 880 
participants.
Mediation analyses—Linear mediation analyses investigated whether age-related 
improvement in executive function was mediated by modular segregation and/or global 
efficiency [94]. First, we regressed out the effects of nuisance covariates (sex, head motion, 
and total network strength) on the independent (X), dependent (Y), and mediating (M) 
variables. The residuals were then used in our mediation analysis. The significance of the 
indirect effect was evaluated using bootstrapped confidence intervals within the R package 
“lavaan” (https://cran.r-project.org/web/packages/lavaan/).
Specifically, we examined the total effect of age on executive performance (c path; Figure 
7B), the relationship between age and modular segregation (a path), the relationship between 
modular segregation and executive function (b path), and the direct effect of age on 
executive efficiency after including modular segregation as a mediator in the model (c’ 
path). The significance of the indirect effect of age on executive function through the 
proposed mediator (modular segregation) was tested using bootstrapping procedures, which 
minimize assumptions about the sampling distribution [94]. This approach involves 
calculating unstandardized indirect effects for each of 10,000 bootstrapped samples and 
calculating the 95% confidence interval. This procedure was repeated to assess both other 
domains of cognition (memory, social cognition) as well as the specific mediating effects of 
each network module (e.g., the frontoparietal module). Finally, we evaluated whether age-
related increases in global efficiency also mediated improvements in executive function.
Edge-based permutation testing—We performed permutation-based tests across 
network edges in order to assess (i) whether the edges that significantly strengthened with 
age were localized to within-module connections beyond chance, (ii) whether edges that 
significantly strengthen with age were enriched for hub edges, and (iii) whether these edges 
that strengthen with age had elevated edge betweenness centrality beyond chance.
Baum et al.
Page 18
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 First, we permuted a binary edge label specifying whether each edge connects nodes within 
or between modules 1000 times. Then for permuted samples of within- and between-module 
edges, we counted the number of edges that were shown to significantly strengthen with age 
in group-level analysis. We then rank-ordered the number of edges shown to significantly 
strengthen with age for permuted within-module edge samples, and determined where the 
observed number of within-module edges that strengthen with age falls relative to this null 
distribution (see Figure 4D).
Second, we evaluated whether edges that significantly strengthen with age were enriched for 
hub edges. We permuted a binary edge label defining hub or non-hub edges 1000 times. For 
each permuted sample, we counted the number of edges that significantly strengthened with 
age in group-level analysis. Then, we rank-ordered the number of permuted hub edges 
shown to significantly strengthen with age, and compared these values with the observed 
number of hub edges that strengthened with age.
Third, we evaluated whether edges that significantly strengthen with age had higher edge 
betweenness centrality than anticipated by chance. We permuted normalized edge 
betweenness centrality values 1000 times. For each permuted sample, we calculated the 
mean edge betweenness centrality of within-module edges and between-module edges that 
significantly strengthened with age. We rank-ordered the mean edge betweenness centrality 
of permuted within-module and between- module edges that strengthened with age, and 
separately compared these values with the observed mean of within- and between-module 
edges (see Figure 6D).
Overview of sensitivity analyses—We conducted a thorough set of analyses to 
examine whether our results were dependent on specific analytic choices. These included 
alternative node and edge definitions, use of probabilistic instead of deterministic 
tractography, and alternative network normalization. Furthermore, we conducted sensitivity 
analyses to examine the potential impact of short-range connections, and un-modeled 
subject variables.
Alternative node and edge definitions—In order to evaluate whether our results were 
dependent on a specific aspects of network definition, we examined alternative node and 
edge definitions. First, we examined modular segregation (mean participation coefficient) 
using the a priori functional partition assigned to a higher-resolution parcellation of the brain 
from the Lausanne atlas (463 nodes instead of 234; see Figure 5D).
Next, we examined alternative edge weight definitions. While primary analyses focused on 
FA-weighted structural networks, we also measured modular segregation in streamline-
weighted networks (see Figure 5E), where edge weights were equal to the number of 
streamlines connecting a pair of nodes [19]. Additionally, we measured modular segregation 
in streamline density-weighted networks, where edge weights were defined as the number of 
connecting streamlines divided by the total regional volume of each node pair [48] (see 
Figure 5F).
Baum et al.
Page 19
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 Alternative tractography method—We also assessed developmental effects on modular 
segregation using brain networks constructed with probabilistic tractography (see above). 
Mean participation coefficients were calculated for each subject’s connectivity matrix and 
integrated across the 12 density thresholds to derive a summary metric of modular 
segregation [77]. Integrated participation coefficients were calculated for networks with 
three different edge weight definitions: probabilistic streamline count, probabilistic 
streamline density, and inter-regional connectivity probability (see Figure 5G–I).
Alternative network normalization—Network normalization is imperative when 
evaluating between-subject differences in network topology [39,77,81], as global effects 
may mask intrinsic topological differences. Normalization can be applied at either the 
subject-level or group-level [81,82]. Subject-level normalization has been widely applied in 
brain network studies using probabilistic tractography, and involves dividing each unique 
element of the weighted connectivity matrix by the sum of all connection weights 
[74,77,82,83]. Based on the work of Yan et al. [81], which suggests that subject-level 
normalization may introduce artifactual relationships with response variables, we applied a 
group-level normalization by including total network strength as a covariate in GAMs. To 
ensure that results were robust to an alternative subject-level normalization procedure, we 
recalculated network measures after dividing elements of each subject’s FA-weighted 
connectivity matrix by the total network strength. We then estimated age effects on 
normalized topological measures using a GAM, including sex and in-scanner motion as 
covariates as above.
Assessment of short-range connections—Estimates of short-range connectivity are 
often inflated due to the well-documented distance-related bias in diffusion tractography 
methods [95]. To determine the extent to which age effects on modular segregation were 
driven by the (potentially artifactual) strengthening of short-range connections, we applied 
Euclidean distance-based thresholds to subject connectivity matrices, removing all 
connections less than 20mm, 25mm, and 30mm [5,96]. We then recalculated measures of 
modular segregation (mean participation coefficient) for each subject and estimated age 
effects at the group level (see Figure S6).
Potentially confounding subject variables—Brain developmental processes are 
extremely complex, with multiple factors potentially influencing network-level measures of 
brain maturation [97]. Accordingly, as a final step, we evaluated whether results could be 
explained by un-modeled covariates which could potentially confound inference. First, to 
ensure that the observed age-related increase in modular segregation was not driven by 
global changes in white matter volume or anisotropy, we included these measures as 
additional covariates in the GAM described above. Second, we evaluated whether other 
subject-level covariates could explain the observed developmental effects. We also found 
convergent results when including total brain volume, handedness, race, and maternal 
education as covariates in GAMs estimating age effects on modular segregation. Conversely, 
results remained consistent when all covariates were removed from the model. Third and 
finally, in order to ensure that our results were not driven by age-related differences in head 
motion, we conducted a sensitivity analysis in a sub-sample of subjects who had low head 
Baum et al.
Page 20
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 motion (less than 0.5mm mean frame-wise displacement). In this subset of 619 subjects, 
there was no longer a significant correlation between age and motion, or between modular 
segregation and motion. See Figure S7.
DATA AND SOFTWARE AVAILABILITY
The data reported in this paper have been deposited in the database of Genotypes and 
Phenotypes (https://www.ncbi.nlm.nih.gov/proiects/gap/cgi-bin/study_cgi?
study_id=phs000607.v1.p1). Table S2 details publicly-available MATLAB code used to 
calculate brain network measures.
TABLE FOR AUTHOR TO COMPLETE
Please upload the completed table as a separate document. Please do not add subheadings 
to the Key Resources Table. If you wish to make an entry that does not fall into one of the 
subheadings below, please contact your handling editor.
Supplementary Material
Refer to Web version on PubMed Central for supplementary material.
Acknowledgments
We thank the acquisition and recruitment team, including Karthik Prabhakaran and Jeff Valdez. Thanks to Chad 
Jackson for data management and systems support and Monica Calkins for phenotyping expertise. Supported by 
grants from the National Institute of Mental Health: R01MH107703 (TDS), R21MH106799 (DSB & TDS). DSB 
acknowledges support from the John D. and Catherine T. MacArthur Foundation, the Alfred P. Sloan Foundation, 
the Army Research Laboratory and the Army Research Office through contract numbers W911NF-10-2-0022 and 
W911NF-14-1-0679, the National Institute of Mental Health (R01-DC-009209-11), the National Institute of Child 
Health and Human Development (R01HD086888-01), the Office of Naval Research, and the National Science 
Foundation (BCS-1441502, BCS-1430087, and PHY-1554488). The PNC was funded through NIMH RC2 grants 
MH089983 and MH089924 (REG). Additional support was provided by R01MH107235 (RCG), K01MH102609 
(DRR), P50MH096891 (REG), R01NS085211 (RTS), and the Dowshen Program for Neuroscience. Support for 
developing statistical analyses (RTS & TDS) was provided by a seed grant by the Center for Biomedical Computing 
and Image Analysis (CBICA) at Penn.
References
1. Newman MEJ. Modularity and community structure in networks. Proc Natl Acad Sci USA. 2006; 
103:8577–82. [PubMed: 16723398] 
2. Sporns O, Betzel RF. Modular Brain Networks. Annu Rev Psychol. 2016; 67:613–640. [PubMed: 
26393868] 
3. Biswal B, Yetkin FZ, Haughton VM, Hyde JS. Functional connectivity in the motor cortex of resting 
human brain using echo-planar MRI. Magn Reson Med. 1995; 34:537–41. [PubMed: 8524021] 
4. Damoiseaux JS, Rombouts S, Barkhof F, Scheltens P, Stam CJ, Smith SM, Beckmann CF. 
Consistent resting-state networks across healthy subjects. Proc Natl Acad Sci USA. 2006; 
103:13848–13853. [PubMed: 16945915] 
5. Power JD, Cohen AL, Nelson SM, Wig GS, Barnes KA, Church JA, Vogel AC, Laumann TO, 
Miezin FM, Schlaggar BL, et al. Functional network organization of the human brain. Neuron. 
2011; 72:665–78. [PubMed: 22099467] 
6. Yeo BTT, Krienen FM, Sepulcre J, Sabuncu MR, Lashkari D, Hollinshead M, Roffman JL, Smoller 
JW, Zöllei L, Polimeni JR, et al. The organization of the human cerebral cortex estimated by 
intrinsic functional connectivity. J Neurophysiol. 2011; 106:1125–1165. [PubMed: 21653723] 
Baum et al.
Page 21
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 7. van den Heuvel MP, Kersbergen KJ, de Reus MA, Keunen K, Kahn RS, Groenendaal F, de Vries 
LS, Benders MJNL. The Neonatal Connectome During Preterm Brain Development. Cereb Cortex. 
2015; 25:3000–13. [PubMed: 24833018] 
8. Fair DA, Cohen AL, Power JD, Dosenbach NUF, Church JA, Miezin FM, Schlaggar BL, Petersen 
SE. Functional brain networks develop from a “local to distributed” organization. PLoS Comput 
Biol. 2009; 5:e1000381. [PubMed: 19412534] 
9. Gu S, Satterthwaite TD, Medaglia JD, Yang M, Gur RE, Gur RC, Bassett DS. Emergence of system 
roles in normative neurodevelopment. Proc Natl Acad Sci USA. 2015; 112:13681–13686. [PubMed: 
26483477] 
10. Dosenbach NUF, Nardos B, Cohen AL, Fair DA, Power JD, Church JA, Nelson SM, Wig GS, 
Vogel AC, Lessov-Schlaggar CN, et al. Prediction of individual brain maturity using fMRI. 
Science. 2010; 329:1358–61. [PubMed: 20829489] 
11. Satterthwaite TD, Wolf DH, Ruparel K, Erus G, Elliott MA, Eickhoff SB, Gennatas ED, Jackson 
C, Prabhakaran K, Smith A, et al. Heterogeneous impact of motion on fundamental patterns of 
developmental changes in functional connectivity during youth. Neurolmage. 2013; 83:45–57.
12. Hampson M, Driesen N, Roth JK, Gore JC, Constable RT. Functional connectivity between task-
positive and task-negative brain areas and its relation to working memory performance. Magn 
Reson Imaging. 2010; 28:1051–7. [PubMed: 20409665] 
13. Satterthwaite TD, Wolf DH, Erus G, Ruparel K, Elliott MA, Gennatas ED, Hopson R, Jackson C, 
Prabhakaran K, Bilker WB, et al. Functional Maturation of the Executive System during 
Adolescence. J Neurosci. 2013; 33:16249–16261. [PubMed: 24107956] 
14. Betzel RF, Byrge L, He Y, Goñi J, Zuo XNN, Sporns O. Changes in structural and functional 
connectivity among resting-state networks across the human lifespan. NeuroImage. 2014; 102(Pt 
2):345–357. [PubMed: 25109530] 
15. Honey CJ, Sporns O, Cammoun L, Gigandet X, Thiran JP, Meuli R, Hagmann P. Predicting human 
resting-state functional connectivity from structural connectivity. Proc Natl Acad Sci USA. 2009; 
106:2035–2040. [PubMed: 19188601] 
16. Goñi J, van den Heuvel MP, Avena-Koenigsberger A, de Mendizabal N, Betzel RF, Griffa A, 
Hagmann P, Corominas-Murtra B, Thiran JPP, Sporns O. Resting-brain functional connectivity 
predicted by analytic measures of network communication. Proc Natl Acad Sci USA. 2014; 
111:833–838. [PubMed: 24379387] 
17. Mišić B, Betzel RF, de Reus MA, van den Heuvel MP, Berman MG, McIntosh AR, Sporns O. 
Network-Level Structure-Function Relationships in Human Neocortex. Cereb Cortex. 2016; 
26:3285–3296. [PubMed: 27102654] 
18. Hermundstad AM, Bassett DS, Brown KS, Aminoff EM, Clewett D, Freeman S, Frithsen A, 
Johnson A, Tipper CM, Miller MB, et al. Structural foundations of resting-state and task-based 
functional connectivity in the human brain. Proc Natl Acad Sci USA. 2013; 110:6169–6174. 
[PubMed: 23530246] 
19. Bassett DS, Brown JA, Deshpande V, Carlson JM, Grafton ST. Conserved and variable architecture 
of human white matter connectivity. NeuroImage. 2011; 54:1262–1279. [PubMed: 20850551] 
20. Bassett DS, Greenfield DL, Meyer-Lindenberg A, Weinberger DR, Moore SW, Bullmore ET. 
Efficient physical embedding of topologically complex information processing networks in brains 
and computer circuits. PLoS Comput Biol. 2010; 6:e1000748. [PubMed: 20421990] 
21. Chen Z, Liu M, Gross DW, Beaulieu C. Graph theoretical analysis of developmental patterns of the 
white matter network. Front Hum Neurosci. 2013; 7:716. [PubMed: 24198774] 
22. Huang H, Shu N, Mishra V, Jeon T, Chalak L, Wang ZJ, Rollins N, Gong G, Cheng H, Peng Y, et 
al. Development of human brain structural networks through infancy and childhood. Cereb Cortex. 
2015; 25:1389–404. [PubMed: 24335033] 
23. Hagmann P, Sporns O, Madan N, Cammoun L, Pienaar R, Wedeen VJ, Meuli R, Thiran JPP, Grant 
PE. White matter maturation reshapes structural connectivity in the late developing human brain. 
Proc Natl Acad Sci USA. 2010; 107:19067–19072. [PubMed: 20956328] 
24. Lim S, Han CE, Uhlhaas PJ, Kaiser M. Preferential detachment during human brain development: 
age- and sex-specific structural connectivity in diffusion tensor imaging (DTI) data. Cereb Cortex. 
2015; 25:1477–89. [PubMed: 24343892] 
Baum et al.
Page 22
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 25. Gur RC, Richard J, Calkins ME, Chiavacci R, Hansen JA, Bilker WB, Loughead J, Connolly JJ, 
Qiu H, Mentch FD, et al. Age group and sex differences in performance on a computerized 
neurocognitive battery in children age 8–21. Neuropsychology. 2012; 26:251–65. [PubMed: 
22251308] 
26. Casey BJ, Jones RM, Hare TA. The Adolescent Brain. Ann N Y Acad Sci. 2008; 1124:111–126. 
[PubMed: 18400927] 
27. Insel TR. Rethinking schizophrenia. Nature. 2010; 468:187–193. [PubMed: 21068826] 
28. Shanmugan S, Wolf DH, Calkins ME, Moore TM, Ruparel K, Hopson RD, Vandekar SN, Roalf 
DR, Elliott MA, Jackson C, et al. Common and Dissociable Mechanisms of Executive System 
Dysfunction Across Psychiatric Disorders in Youth. Am J Psychiatry. 2016; 173:517–526. 
[PubMed: 26806874] 
29. Di Martino A, Fair DA, Kelly C, Satterthwaite TD, Castellanos FX, Thomason ME, Craddock RC, 
Luna B, Leventhal BL, Zuo XNN, et al. Unraveling the miswired connectome: a developmental 
perspective. Neuron. 2014; 83:1335–1353. [PubMed: 25233316] 
30. Bohlken MM, Brouwer RM, Mandl RCW, den Heuvel MP, Hedman AM, De Hert M, Cahn W, 
Kahn RS, Hulshoff Pol HE. Structural Brain Connectivity as a Genetic Marker for Schizophrenia. 
JAMA Psychiatry. 2016; 73:11–19. [PubMed: 26606729] 
31. Kessler D, Angstadt M, Sripada C. Growth Charting of Brain Connectivity Networks and the 
Identification of Attention Impairment in Youth. JAMA Psychiatry. 2016; 73:481–489. [PubMed: 
27076193] 
32. Satterthwaite TD, Elliott MA, Ruparel K, Loughead J, Prabhakaran K, Calkins ME, Hopson R, 
Jackson C, Keefe J, Riley M. Neuroimaging of the Philadelphia neurodevelopmental cohort. 
NeuroImage. 2014; 86:544–553. [PubMed: 23921101] 
33. Cammoun L, Gigandet X, Meskaldji D, Thiran JP, Sporns O, Do KQ, Maeder P, Meuli R, 
Hagmann P. Mapping the human connectome at multiple scales with diffusion spectrum MRI. J 
Neurosci Methods. 2012; 203:386–397. [PubMed: 22001222] 
34. Blondel VD, Guillaume JLL, Lambiotte R, Lefebvre E. Fast unfolding of communities in large 
networks. J Stat Mech Theory Exp. 2008; 2008:P10008.
35. Mucha PJ, Richardson T, Macon K, Porter MA, Onnela JPP. Community structure in time-
dependent, multiscale, and multiplex networks. Science. 2010; 328:876–878. [PubMed: 20466926] 
36. Bassett DS, Porter MA, Wymbs NF, Grafton ST, Carlson JM, Mucha PJ. Robust detection of 
dynamic community structure in networks. Chaos. 2013; 23:13142.
37. Guimerà R, Amaral LAN. Cartography of complex networks: modules and universal roles. J Stat 
Mech. 2005; 2005:nihpa35573. [PubMed: 18159217] 
38. Wood SN. Stable and efficient multiple smoothing parameter estimation for generalized additive 
models. J Am Stat Assoc. 2012
39. Li L, Rilling JK, Preuss TM, Glasser MF, Hu X. The effects of connection reconstruction method 
on the interregional connectivity of brain networks via diffusion tractography. Hum Brain Mapp. 
2012; 33:1894–1913. [PubMed: 21928316] 
40. Behrens TEJ, Berg HJ, Jbabdi S, Rushworth MFS, Woolrich MW. Probabilistic diffusion 
tractography with multiple fibre orientations: What can we gain? NeuroImage. 2007; 34:144–155. 
[PubMed: 17070705] 
41. Yendiki A, Koldewyn K, Kakunoori S, Kanwisher N, Fischl B. Spurious group differences due to 
head motion in a diffusion MRI study. Neuroimage. 2014; 88:79–90. [PubMed: 24269273] 
42. Roalf DR, Quarmley M, Elliott MA, Satterthwaite TD, Vandekar SN, Ruparel K, Gennatas ED, 
Calkins ME, Moore TM, Hopson R. The impact of quality assurance assessment on diffusion 
tensor imaging outcomes in a large-scale population-based cohort. NeuroImage. 2016; 125:903–
919. [PubMed: 26520775] 
43. Latora V, Marchiori M. Efficient behavior of small-world networks. Phys Rev Lett. 2001; 
87:198701. [PubMed: 11690461] 
44. Bertolero MA, Yeo BTT, D’Esposito M. The modular and integrative functional architecture of the 
human brain. Proc Natl Acad Sci USA. 2015; 112:E6798–807. [PubMed: 26598686] 
45. Brandes U. A faster algorithm for betweenness centrality. J Math Sociol. 2001; 25:163–177.
Baum et al.
Page 23
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 46. Marek S, Hwang K, Foran W, Hallquist MN, Luna B. The Contribution of Network Organization 
and Integration to the Development of Cognitive Control. PLoS Biol. 2015; 13:e1002328. 
[PubMed: 26713863] 
47. Zalesky A, Fornito A, Harding IH, Cocchi L, Yücel M, Pantelis C, Bullmore ET. Whole-brain 
anatomical networks: does the choice of nodes matter? NeuroImage. 2010; 50:970–983. [PubMed: 
20035887] 
48. Baker STE, Lubman DI, Yücel M, Allen NB, Whittle S, Fulcher BD, Zalesky A, Fornito A. 
Developmental Changes in Brain Network Hub Connectivity in Late Adolescence. J Neurosci. 
2015; 35:9078–9087. [PubMed: 26085632] 
49. Buckner RL, Andrews-Hanna JR, Schacter DL. The brain’s default network: anatomy, function, 
and relevance to disease. Ann N Acad Sci. 2008; 1124:1–38.
50. Fornito A, Harrison BJ, Zalesky A, Simons JS. Competitive and cooperative dynamics of large-
scale brain functional networks supporting recollection. Proc Natl Acad Sci USA. 2012; 
109:12788–93. [PubMed: 22807481] 
51. Braun U, Schäfer A, Walter H, Erk S, Romanczuk-Seiferth N, Haddad L, Schweiger JI, Grimm O, 
Heinz A, Tost H, et al. Dynamic reconfiguration of frontal brain networks during executive 
cognition in humans. Proc Natl Acad Sci USA. 2015; 112:11678–11683. [PubMed: 26324898] 
52. Mohr H, Wolfensteller U, Betzel RF, Mišić B, Sporns O, Richiardi J, Ruge H. Integration and 
segregation of large-scale brain networks during short-term task automatization. Nat Commun. 
2016; 7:13217. [PubMed: 27808095] 
53. Kraemer HC, Yesavage JA, Taylor JL, Kupfer D. How can we learn about developmental processes 
from cross-sectional studies, or can we? Am J Psychiatry. 2000; 157:163–171. [PubMed: 
10671382] 
54. Schumann G, Loth E, Banaschewski T, Barbot A, Barker G, Büchel C, Conrod PJ, Dalley JW, Flor 
H, Gallinat J, et al. The IMAGEN study: reinforcement-related behaviour in normal brain function 
and psychopathology. Mol Psychiatry. 2010; 15:1128–39. [PubMed: 21102431] 
55. Nooner KB, Colcombe SJ, Tobe RH, Mennes M, Benedict MM, Moreno AL, Panek LJ, Brown S, 
Zavitz ST, Li Q, et al. The NKI-Rockland Sample: A Model for Accelerating the Pace of 
Discovery Science in Psychiatry. Front Neurosci. 2012; 6:152. [PubMed: 23087608] 
56. Jbabdi S, Sotiropoulos SN, Haber SN, Van Essen DC, Behrens TE. Measuring macroscopic brain 
connections in vivo. Nat Neurosci. 2015; 18:1546–1555. [PubMed: 26505566] 
57. Thomas C, Ye FQ, Irfanoglu MO, Modi P, Saleem KS, Leopold DA, Pierpaoli C. Anatomical 
accuracy of brain connections derived from diffusion MRI tractography is inherently limited. Proc 
Natl Acad Sci USA. 2014; 111:16574–16579. [PubMed: 25368179] 
58. Zalesky A, Fornito A, Cocchi L, Gollo LL, van den Heuvel MP, Breakspear M. Connectome 
sensitivity or specificity: which is more important? NeuroImage. 2016; 142:407–420. [PubMed: 
27364472] 
59. Moore TM, Reise SP, Gur RE, Hakonarson H, Gur RC. Psychometric Properties of the Penn 
Computerized Neurocognitive Battery. Neuropsychology. 2014
60. Jones DK, Griffin LD, Alexander DC, Catani M, Horsfield MA, Howard R, Williams SCR. Spatial 
normalization and averaging of diffusion tensor MRI data sets. NeuroImage. 2002; 17:592–617. 
[PubMed: 12377137] 
61. Chen Y, Tymofiyeva O, Hess CP, Xu D. Effects of rejecting diffusion directions on tensor-derived 
parameters. NeuroImage. 2015; 109:160–170. [PubMed: 25585018] 
62. Jones DK, Basser PJ. Squashing peanuts and smashing pumpkins”: How noise distorts diffusion-
weighted MR data. Magn Reson Med. 2004; 52:979–993. [PubMed: 15508154] 
63. Jenkinson M, Bannister P, Brady M, Smith S. Improved optimization for the robust and accurate 
linear registration and motion correction of brain images. NeuroImage. 2002; 17:825–841. 
[PubMed: 12377157] 
64. Andersson JLR, Sotiropoulos SN. An integrated approach to correction for off-resonance effects 
and subject movement in diffusion MR imaging. NeuroImage. 2016; 125:1063–78. [PubMed: 
26481672] 
65. Jenkinson M, Beckmann CF, Behrens TE, Woolrich MW, Smith SM. Fsl. Neuroimage. 2012; 
62:782–790. [PubMed: 21979382] 
Baum et al.
Page 24
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 66. Fischl B. FreeSurfer. NeuroImage. 2012; 62:774–781. [PubMed: 22248573] 
67. Desikan RS, Ségonne F, Fischl B, Quinn BT, Dickerson BC, Blacker D, Buckner RL, Dale AM, 
Maguire RP, Hyman BT, et al. An automated labeling system for subdividing the human cerebral 
cortex on MRI scans into gyral based regions of interest. NeuroImage. 2006; 31:968–980. 
[PubMed: 16530430] 
68. Greve DN, Fischl B. Accurate and robust brain image alignment using boundary-based 
registration. NeuroImage. 2009; 48:63–72. [PubMed: 19573611] 
69. Gu S, Pasqualetti F, Cieslak M, Telesford QK, Yu AB, Kahn AE, Medaglia JD, Vettel JM, Miller 
MB, Grafton ST, et al. Controllability of structural brain networks. Nat Commun. 2015; 6:8414. 
[PubMed: 26423222] 
70. Yeh FC, Verstynen TD, Wang Y, Fernández-Miranda JC, Tseng WYI. Deterministic Diffusion 
Fiber Tracking Improved by Quantitative Anisotropy. PLoS ONE. 2013; 8:e80713. [PubMed: 
24348913] 
71. Jeurissen B, Leemans A, Tournier JDD, Jones DK, Sijbers J. Investigating the prevalence of 
complex fiber configurations in white matter tissue with diffusion magnetic resonance imaging. 
Hum Brain Mapp. 2013; 34:2747–66. [PubMed: 22611035] 
72. Behrens TEJ, Woolrich MW, Jenkinson M, Johansen-Berg H, Nunes RG, Clare S, Matthews PM, 
Brady JM, Smith SM. Characterization and propagation of uncertainty in diffusion-weighted MR 
imaging. Magn Reson Med. 2003; 50:1077–88. [PubMed: 14587019] 
73. Li L, Hu X, Preuss TM, Glasser MF, Damen FW, Qui Y, Rilling J. Mapping putative hubs in 
human, chimpanzee and rhesus macaque connectomes via diffusion tractography. NeuroImage. 
2013; 80:462–74. [PubMed: 23603286] 
74. Duarte-Carvajalino JM, Jahanshad N, Lenglet C, McMahon KL, de Zubicaray GI, Martin NG, 
Wright MJ, Thompson PM, Sapiro G. Hierarchical topological network analysis of anatomical 
human brain connectivity and differences related to sex and kinship. Neuroimage. 2012; 59:3784–
804. [PubMed: 22108644] 
75. van den Heuvel MP, Sporns O. Rich-club organization of the human connectome. J Neurosci. 
2011; 31:15775–86. [PubMed: 22049421] 
76. van den Heuvel MP, de Reus MA, Feldman Barrett L, Scholtens LH, Coopmans FMT, Schmidt R, 
Preuss TM, Rilling JK, Li L. Comparison of diffusion tractography and tract-tracing measures of 
connectivity strength in rhesus macaque connectome. Hum Brain Mapp. 2015; 36:3064–75. 
[PubMed: 26058702] 
77. Gong G, Rosa-Neto P, Carbonell F, Chen ZJ, He Y, Evans AC. Age- and gender-related differences 
in the cortical anatomical network. J Neurosci. 2009; 29:15684–93. [PubMed: 20016083] 
78. Johansen-Berg H, Behrens TEJ, Sillery E, Ciccarelli O, Thompson AJ, Smith SM, Matthews PM. 
Functional-anatomical validation and individual variation of diffusion tractography-based 
segmentation of the human thalamus. Cereb Cortex. 2005; 15:31–9. [PubMed: 15238447] 
79. Cao Q, Shu N, An L, Wang P, Sun L, Xia MRR, Wang JHH, Gong GLL, Zang YFF, Wang YFF, et 
al. Probabilistic diffusion tractography and graph theory analysis reveal abnormal white matter 
structural connectivity networks in drug-naive boys with attention deficit/hyperactivity disorder. J 
Neurosci. 2013; 33:10676–87. [PubMed: 23804091] 
80. Achard S, Bullmore E. Efficiency and cost of economical brain functional networks. PLoS Comput 
Biol. 2007; 3:e17. [PubMed: 17274684] 
81. Yan CGG, Craddock RC, Zuo XNN, Zang YFF, Milham MP. Standardizing the intrinsic brain: 
towards robust measurement of inter-individual variation in 1000 functional connectomes. 
NeuroImage. 2013; 80:246–62. [PubMed: 23631983] 
82. Zhan L, Zhou J, Wang Y, Jin Y, Jahanshad N, Prasad G, Nir TM, Leonardo CD, Ye J, Thompson 
PM, et al. Comparison of nine tractography algorithms for detecting abnormal structural brain 
networks in Alzheimer’s disease. Front Aging Neurosci. 2015; 7:48. [PubMed: 25926791] 
83. Dennis EL, Jahanshad N, McMahon KL, de Zubicaray GI, Martin NG, Hickie IB, Toga AW, 
Wright MJ, Thompson PM. Development of brain structural connectivity between ages 12 and 30: 
a 4-Tesla diffusion imaging study in 439 adolescents and adults. NeuroImage. 2013; 64:671–84. 
[PubMed: 22982357] 
Baum et al.
Page 25
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 84. Good BH, de Montjoye YAA, Clauset A. Performance of modularity maximization in practical 
contexts. Phys Rev E Stat Nonlin Soft Matter Phys. 2010; 81:46106.
85. Lancichinetti A, Fortunato S. Consensus clustering in complex networks. Sci Rep. 2012; 2:336. 
[PubMed: 22468223] 
86. Fenn DJ, Porter MA, McDonald M, Williams S, Johnson NF, Jones NS. Dynamic communities in 
multichannel data: an application to the foreign exchange market during the 2007–2008 credit 
crisis. Chaos. 2009; 19:33119.
87. Traud A, Kelsic E, Mucha P, Porter M. Comparing Community Structure to Characteristics in 
Online Collegiate Social Networks. SIAM Rev. 2011; 53:526–543.
88. Rubinov M, Sporns O. Complex network measures of brain connectivity: uses and interpretations. 
NeuroImage. 2010; 52:1059–1069. [PubMed: 19819337] 
89. Newman MEJ, Girvan M. Finding and evaluating community structure in networks. Phys Rev E 
Stat Nonlin Soft Matter Phys. 2004; 69:26113.
90. Gogtay N, Giedd JN, Lusk L, Hayashi KM, Greenstein D, Vaituzis AC, Nugent TF, Herman DH, 
Clasen LS, Toga AW, et al. Dynamic mapping of human cortical development during childhood 
through early adulthood. Proc Natl Acad Sci USA. 2004; 101:8174–9. [PubMed: 15148381] 
91. Shaw P, Greenstein D, Lerch J, Clasen L, Lenroot R, Gogtay N, Evans A, Rapoport J, Giedd J. 
Intellectual ability and cortical development in children and adolescents. Nature. 2006; 440:676–
679. [PubMed: 16572172] 
92. Wood SN. Fast stable restricted maximum likelihood and marginal likelihood estimation of 
semiparametric generalized linear models. J R Stat Soc Ser B Stat Methodol. 2011; 73:3–36.
93. Genovese CR, Lazar NA, Nichols T. Thresholding of statistical maps in functional neuroimaging 
using the false discovery rate. NeuroImage. 2002; 15:870–8. [PubMed: 11906227] 
94. Preacher KJ, Hayes AF. Asymptotic and resampling strategies for assessing and comparing indirect 
effects in multiple mediator models. Behav Res Methods. 2008; 40:879–91. [PubMed: 18697684] 
95. Girard G, Whittingstall K, Deriche R, Descoteaux M. Towards quantitative connectivity analysis: 
reducing tractography biases. NeuroImage. 2014; 98:266–78. [PubMed: 24816531] 
96. Power JD, Schlaggar BL, Lessov-Schlaggar CN, Petersen SE. Evidence for hubs in human 
functional brain networks. Neuron. 2013; 79:798–813. [PubMed: 23972601] 
97. Hagmann P, Grant PE, Fair DA. MR connectomics: a conceptual framework for studying the 
developing brain. Front Syst Neurosci. 2012; 6:43. [PubMed: 22707934] 
Baum et al.
Page 26
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 Figure 1. Executive functioning improves with age
(A) Age distribution of 882 youth completing diffusion imaging as part of the PNC. (B) 
Executive performance on a neurocognitive battery improves with age (n=880). Blue line 
represents the best fit from a general additive model; shaded area indicates 95% confidence 
interval.
Baum et al.
Page 27
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 Figure 2. Connectome construction
For each subject, the T1 image was processed using FreeSurfer and parcellated into 234 
network nodes on an individualized basis. Deterministic streamline tractography was used to 
create a symmetric adjacency matrix (234×234), where the edge weight was defined as the 
mean fractional anisotropy (FA) along the connecting streamlines. Network nodes were each 
assigned to one of the seven large-scale functional modules defined by Yeo et al. [6]; 
subcortical nodes were assigned to an eighth module. VIS=visual, SOM=somatomotor, 
Baum et al.
Page 28
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 DOR=dorsal attention, VEN=ventral attention, LIM=limbic, FPC=frontoparietal control, 
DMN= default mode network, SUB=subcortical.
Baum et al.
Page 29
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 Figure 3. Structural brain network modules become increasingly segregated with age
Modular segregation was quantified as the mean participation coefficient across all network 
nodes, with lower values indicating more segregation. (A) Mean participation coefficient 
values declined significantly with age. (B) Modular segregation is differentially distributed 
across functional systems. Age-related modular segregation is most robust in the 
somatomotor and default mode systems, but also present in other networks. (C) Age-related 
changes in participation coefficient provide convergent results for individual nodes, and 
demonstrate widespread declines with age, particularly within default mode regions such as 
Baum et al.
Page 30
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 the posterior cingulate. Two exceptions to this overall trend were the right rostral frontal 
gyrus and frontal operculum, where participation coefficient increased with age. Blue line 
represents the best fit from a general additive model; shaded area indicates 95% confidence 
interval. Color palette represents z-transformed p-values from a general additive model. 
Images are thresholded to control for multiple comparisons using the False Discovery Rate 
(q<0.05). *indicates p<0.001. See also Figures S1, S3, S6, S7, and Table S1.
Baum et al.
Page 31
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 Figure 4. Modular segregation is driven by a combination of both enhanced within-module 
connectivity and reduced between-module connectivity
(A) Average strength of within-module connectivity increases with age. (B) Between-
module connectivity decreases across development. (C) Convergent effects are seen at the 
level of individual graph edges (image thresholded using Bonferroni corrected p<0.05 for 
clarity). (D) A higher percentage of within-module connections (red) strengthen with age 
than expected by chance. * indicates p<0.001. See also Figure S1.
Baum et al.
Page 32
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 Figure 5. Results are robust to methodological choices
Regardless of specific processing decisions, an increase in modular segregation with age was 
observed. (A) Convergent findings result when using an index of the modularity quality for 
the Yeo partition [6], where higher Q indicates more segregated modules. (B) When using a 
group-level structural partition, modular segregation (mean participation coefficient) 
decreases with age. (C) Modularity quality of subject-level connectivity matrices also 
increases with age. (D) Results remain unaffected when a higher-dimensional parcellation is 
used (n=463 nodes), (E) when streamline count is used instead of FA as an edge weight, and 
(F) when normalized streamline density is used as the edge weight. For brain networks 
derived from probabilistic tractography, mean participation coefficients were integrated 
across a wide density range (5–60%). We observed an age-related increase in modular 
segregation when edge weights were defined by (G) probabilistic streamline count, (H) 
Baum et al.
Page 33
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 probabilistic streamline density, and (I) inter-regional connectivity probability. Lower 
participation coefficient indicates more segregated modules. Blue line represents the best fit 
from a general additive model; shaded area indicates 95% confidence interval. See also 
Figures S1, S2, S4, and S5.
Baum et al.
Page 34
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 Figure 6. Modular segregation promotes global network efficiency, and is driven by 
developmental strengthening of specific hub edges
(A) Replicating prior work, global network efficiency increases with age. (B) While 
controlling for age, lower mean participation coefficient is associated with greater network 
efficiency, indicating a positive association between modular segregation and network 
efficiency. (C) Connections that strengthen with age are enriched for hub edges (47%). Hub 
edges are defined as connections in the top quartile of edge betweenness centrality, which 
quantifies how often a given edge lies on the shortest path between nodes and thus facilitates 
global efficiency. Image thresholded using Bonferroni corrected p<0.05 for clarity. (D) Both 
within-module and between-module connections that strengthen with age have higher edge 
betweenness centrality than expected by chance. The average weight of (E) within-module 
and (F) between-module edges that strengthen with age are positively associated with global 
efficiency. Blue line represents the best fit from a general additive model, shaded area 
indicates 95% confidence interval; * indicates p<0.001. Error bar represents standard error 
of the mean. See also Figure S1.
Baum et al.
Page 35
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 Figure 7. Segregation of structural modules mediates the development of executive function in 
youth
(A) While controlling for age, greater modular segregation in the frontoparietal control 
network is uniquely associated with better executive performance (n=880). (B) Segregation 
of structural modules mediates the improvement of executive function with age. Mediation 
results shown as standardized regression coefficients. Significance of indirect effect 
(c’=0.03) was assessed using bootstrapped confidence intervals [0.008–0.045]. The asterisk 
(*) indicates p<0.01. See also Figure S1.
Baum et al.
Page 36
Curr Biol. Author manuscript; available in PMC 2018 June 05.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
Baum et al.
Page 37
KEY RESOURCES TABLE
REAGENT or RESOURCE
SOURCE
IDENTIFIER
Deposited Data
Philadelphia Neurodevelopmental Cohort
[32]
https://www.ncbi.nlm.nih.gov/projects/gap/cgi-bin/study.cgi?study_id=phs000607.v1.p1
Software and Algorithms
MATLAB R2014B
MathWorks, 
Natick, MA, 
USA
http://www.mathworks.com/
FSL 5.0.5
Oxford 
Centre for 
Functional 
MRI of the 
Brain, 
Oxford, UK
https://fsl.fmrib.ox.ac.uk/fsl/fslwiki
FreeSurfer 5.3
Massachusetts 
General 
Hospital, 
Harvard 
Medical 
School, MA, 
USA
http://surfer.nmr.mgh.harvard.edu/
DSI Studio
University of 
Pittsburgh, 
PA, USA
http://dsi-studio.labsolver.org/
Brain Connectivity Toolbox
[88]
https://sites.google.com/site/bctnet/
genlouvain
University of 
Northern 
Carolina, 
NetWiki
http://netwiki.amath.unc.edu/GenLouvain/GenLouvain
Other
3 Tesla Siemens TIM Trio whole-body 
MRI
Siemens 
Medical 
Solutions 
USA, Inc, 
Malvern, PA, 
USA
https://usa.healt.hcare.siemens.com/
Curr Biol. Author manuscript; available in PMC 2018 June 05.
