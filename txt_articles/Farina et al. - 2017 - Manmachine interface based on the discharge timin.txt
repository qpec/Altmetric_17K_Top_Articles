  
1 
 
MAN/MACHINE INTERFACE BASED ON THE DISCHARGE TIMINGS OF SPINAL 
MOTOR NEURONS AFTER TARGETED MUSCLE REINNERVATION 
Dario Farina1,2*, Ivan Vujaklija1,2, Massimo Sartori2†, Tamás Kapelner2†, Francesco Negro2,3, Ning 
Jiang4, Konstantin Bergmeister5,6, Arash Andalib7, Jose Principe7, and Oskar C. Aszmann5,6 
1Department of Bioengineering, Imperial College London, London, UK 
2Clinic for Trauma Surgery, Orthopaedic Surgery and Plastic Surgery - Research Department of 
Neurorehabilitation Systems, University Medical Center Göttingen, Göttingen, Germany 
3Department of Clinical and Experimental Sciences, University of Brescia, 25123 Brescia, Italy 
4Department of Systems Design Engineering, Faculty of Engineering, University of Waterloo, 
Waterloo, CANADA 
5Christian Doppler Laboratory for Restoration of Extremity Function, Medical University of Vienna, 
AUSTRIA 
6Division of Plastic and Reconstructive Surgery, Department of Surgery, Medical University of Vienna, 
AUSTRIA 
7Department of Electrical and Computer Engineering, University of Florida, Gainesville, FL, USA 
†These authors contributed equaly to this work 
 
 
  
2 
 
Abstract 
The intuitive control of upper-limb prostheses requires a man/machine interface that directly 
exploits biological signals. Here, we define and experimentally test an offline man/machine interface 
that takes advantage of the discharge timings of spinal motor neurons. The motor-neuron behaviour 
is identified by deconvolution of the electrical activity of muscles reinnervated by nerves of a missing 
limb in patients with amputation at the shoulder or humeral level. We mapped the series of motor-
neuron discharges into control commands across multiple degrees of freedom via the offline 
application of direct proportional control, pattern recognition and musculoskeletal modelling. A 
series of experiments performed on six patients reveal that the man/machine interface has superior 
offline performance than conventional direct electromyographic control applied after targeted 
muscle innervation. The combination of surgical procedures, decoding and mapping into effective 
commands constitutes an interface with the output layers of the spinal cord circuitry that allows for 
the intuitive control of multiple degrees of freedom. 
 
  
3 
 
Natural and intuitive control of upper limb prostheses requires the establishment of a 
man-machine interface that explores the perception-action cycle directly based on biological 
signals1–3. These signals are processed to extract information about the user's intent and are 
translated into commands for the prosthesis. The neuromuscular system can be interfaced 
at various levels to extract neural signals that code the intended movement, e.g., via brain, 
nerve or muscle recordings4–9. Although direct brain signal decoding provides the neural 
information associated to movement intention and control10–12, peripheral approaches 
(nerves or muscles) are so far the only clinically viable solutions for re-establishing upper 
limb function in amputees4,13. In these patients, the availability of nerve and muscle 
structures above the amputation allows access to neural information at the output of the 
spinal cord circuitries. 
Muscle interfacing is generally possible only when relevant remnant muscle tissue is 
available following the amputation. The higher the amputation level, the greater the need 
for control signals, with fewer muscles available to interface for intuitive control. 
Nonetheless, muscles can be denervated and reinnervated by nerves that used to carry the 
neural code to the missing limb14. This procedure is known as targeted muscle reinnervation 
(TMR)2,15,16 and it constituted a breakthrough in prosthetics17. In TMR, muscles serve as 
biological amplifiers of nerve activity because of the association between the action 
potentials discharged by the efferent nerve fibers (axons of motor neurons) and the action 
potentials of the innervated muscle fibers. Each nerve action potential is transduced into a 
compound muscle fiber action potential that carries the same neural information, coded by 
its timing of occurrence. 
  
4 
 
TMR and electromyographic (EMG) recordings from reinnervated muscles determine 
a man-machine interface that, in principle, allows the indirect detection (from muscle 
signals) of the ensemble efferent activity of any nerve once it is directed to an accessible 
target muscle. However, the classic use of TMR and EMG for man-machine interfacing does 
not aim at decoding the underlying neural information (timings of occurrence of action 
potentials) sent to muscles by motor neurons. Rather, this interface uses the EMG as an 
interferent signal (colored noise) from which few global features are extracted18, e.g. 
amplitude or spectral moments, for either direct control or for identifying sets of predefined 
movements19. This global approach is common to previous TMR investigations, even when 
more advanced (multi-channel) EMG systems have been employed19. This procedure limits 
the decoding quality of the neural interface because the global EMG is a spatio–temporal 
summation of action potentials that creates correlations amongst multiple channels and 
therefore determines an ill posed inverse problem for decoding20. Similarly, control methods 
based on more selective intramuscular EMG recordings have been so far based on global 
EMG analysis without decoding the contributions of individual motor neurons21,22 or on a 
very small number of decoded motor neurons (e.g., two experimentally decoded motor 
neurons from intramuscular EMG signals in23). Decoupling the neural information contained 
in the EMG signals, which exactly correspond to the timings of discharge of the efferent 
nerve fibers, from the shapes of the muscle fiber action potentials would determine a direct 
interface with the spinal motor neurons. 
Here we describe a neural interface that, following TMR24,25, extracts the sources of 
neural information – the discharge timings of motor neurons – through EMG deconvolution. 
The decoded neural information is then mapped into effective commands for intuitive 
prosthetic control. The effectiveness of the decoded neural information potential prosthesis 
  
5 
 
control is demonstrated offline by associating the activity of motor neurons innervating the 
missing limb of amputees with the kinematics of intended motor tasks. We experimentally 
validate this association for multiple degrees of freedom in six patients following TMR. 
Therefore, here we present and substantiate the concept of a man-machine interface that 
extracts neural information sent from the output spinal cord circuitries by a combination of 
surgical procedures, advanced neural decoding, and mapping into multiple degrees of 
freedom.  
Results 
The approach is based on recording multi-channel (>50 channels) EMG signals from 
reinnervation sites following TMR. The EMG signals are decoded by using a blind source 
separation method that separates the timings of activation of each motor unit from the 
waveforms representing the muscle fiber action potentials. The decoding thus provides 
multiple series of discharge timings of motor neurons reinnervating the target muscles. The 
discharge timings are projected into degrees of freedom by various mapping methods. Fig. 1 
schematically presents the processing steps common to all the analyses performed. Three 
main experimental tests were conducted on TMR patients (Table 1) to present and validate 
the decoding and mapping approach. The aim of each experiment was to highlight different 
characteristics of the proposed approach. Experiment 1 presents the classification of the 
motor neuron activity into discrete classes. Experment 2 shows proportional control based 
on motor neuron discharges. Finally, Experiment 3 presents simulataneous and proportional 
mapping over multiple degrees of freedom. 
Experiment 1 
  
6 
 
Experiment 1 was performed on patients T1, T2, and T3 (Table 1) and was designed 
to compare the use of motor neuron discharge timings with respect to classic global EMG 
features for the classification of intended tasks into a pre-defined set of classes (motor 
tasks). For this purpose, the EMG signals recorded from the reinnervation sites (6 
reinnervation sites for patient T1, 4 for T2, and 5 for T3; Table 1) were decomposed 
(decoded) into the contributions of individual motor units, separating the discharges of the 
innervating motor neurons from the waveforms of the muscle fiber action potentials. The 
discharge timings were then pooled to obtain series of ensemble discharge timings for the 
muscle regions where the recording EMG electrode grids were located (the area covered by 
each recording EMG grid was divided into four muscle regions). These series of ensemble 
discharges represented the neural drive sent to the corresponding muscle regions and were 
used as features for offline classification into 9, 7, and 11 classes (movements) for the three 
patients investigated.  
The average number of motor units identified by decomposition of the multi-channel 
EMG signals in each reinnervation site during the executed tasks was 23.1 ± 11.2 (mean ± SD, 
average over the three patients and all reinnervation sites and tasks).  
 
 
  
7 
 
Table I. Characteristics of the patients investigated 
Patient 
T1 
T2 
T3 
T4 
T5 
T6 
Age 
25 
32 
40 
31 
17 
51 
Sex 
M 
M 
M 
M 
M 
M 
Amputation 
Gleno-
humeral right 
Gleno-
humeral left 
Gleno-
humeral left 
Trans-
humeral left 
Trans-
humeral left 
Trans-
humeral left 
Time since 
amputation 
3 years,  
2 months 
3 years,  
2 months 
>5 years 
2 years,  
3 months 
>5 years 
>10 years 
Time since TMR 
surgery 
10 months 
9 months 
1 year,  
5 months 
9 months 
4 years,  
2 months 
4 years,  
4 months 
Nerve in m. 
pectoralis major 
clavicular head 
musculo-
cutaneous 
ulnaris 
musculo-
cutaneous 
- 
- 
- 
Nerve in m. 
pectoralis major 
sternocostal part 
medianus 
medianus 
medianus 
- 
- 
- 
Nerve in  
m. pectoralis 
major abdominal 
part 
medianus 
- 
medianus 
- 
- 
- 
Nerve in 
m. pectoralis 
minor 
ulnaris 
medianus 
ulnaris 
- 
- 
- 
Nerve in 
m. latissimus 
dorsi 
radialis 
radialis 
radialis 
- 
- 
- 
Nerve in 
m. infraspinatus 
radialis 
- 
- 
- 
- 
- 
Nerve in 
m. Biceps 
brachii 
caput longum 
- 
- 
- 
medianus 
medianus 
medianus 
Nerve in 
m. Biceps 
brachii 
caput breve 
- 
- 
- 
ulnaris 
ulnaris 
ulnaris 
Nerve in m. 
caput laterale 
tricipitis 
- 
- 
- 
radialis 
radialis 
radialis 
 
  
8 
 
 
Figure 1 - Interfacing spinal motor neurons in humans. Nerves are surgically re-directed to 
innervate accessory muscles used as biological amplifiers of nerve activity by targeted 
muscle reinnervation (TMR). The discharge timings of the innervating motor neurons are 
decoded by deconvolution of the surface electromyographic signals. The series of discharge 
timings are then mapped into degrees of freedom. The mapping is obtained by diferent 
approaches, demonstrated in this study with three experiments. The interfacing provides 
access to the output from the spinal cord, as schematically represented by the colors of the 
series of discharges. The discharge patterns shown here are extracted from data acquired 
from patient T1. These discharge timings are represented here with the sole purpose of 
describing the general concept proposed in this work. 
There were no significant differences in the number of decoded motor units nor in 
the accuracy of decoding between reinnervation sites, an observation that was valid for all 
experiments and all patients. This result is in agreement with several previous studies on 
EMG decoding in able-bodied individuals across a variety of muscles and contraction types26. 
The use of motor neuron discharge timings for motion classification provided an almost 
perfect classification accuracy of >97% as an average over the three patients (Fig. 2). In the 
current experimental conditions, this performance was superior to both the use of the EMG 
  
9 
 
root mean square (RMS) (average accuracy of 71% across all patients), and the use of RMS 
together with time domain (TD) features (average accuracy of 85%). The difference was 
particularly evident for patient T3, who could execute the greatest number of tasks (11 
classes) and for whom the classification accuracy was only ~70% when using the classic EMG 
features and >95% when using the decoded motor neuron discharge timings (Fig. 2). Fig. 2 
presents the confusion matrices for the classification. 
 
Figure 2 - Confusion matrices for the classification of motions of patients T1, T2 and T3 when 
using features extracted from global EMG analysis (root mean square (RMS), RMS and time 
domain (TD)) and when using the neural information as motor neuron discharge timings. The 
classified tasks are: elbow extension/flexion (EE/EF), hand close/open (HC/HO), wrist 
extension/flexion (WE/WF), wrist pronation/supination (WP/WS), thumb 
abduction/adduction (TAb/TAd), thumb extension/flexion (TE/TF), and no movement (NoM). 
The color scale represents the accuracy (%) in discrimination between pairs of classes in the 
confusion matrices. 
Fig.3 highlights one of the reasons for the effective discrimination of motor tasks 
based on motor neuron discharge timings with respect to global EMG features. The action 
potentials of three motor units are representatively shown as detected over the surface of 
  
10 
 
the pectoralis muscle in subject T1 during hand closing and wrist supination. The spatial 
mapping of the global EMG amplitude and the action potentials of the motor units are 
presented. The global EMG amplitude, which is shown as an amplitude map (Fig. 3a), is 
similar for the two tasks, which are therefore difficult to discriminate using this feature. The 
spatial distribution of amplitude is indeed localized in the same area, represented by the 
upper left corner of the spatial amplitude maps in Fig. 3a. Therefore, the two tasks are 
executed by a neural drive reaching similar regions of the reinnervated muscles. A direct 
control of these two tasks in a physiological way (i.e., with natural muscle contractions 
corresponding to the two tasks) would not be possible because of this overlap. Classification 
of these two classes with global EMG features is, however, possible to some extent since 
classification uses features that may differ between the two tasks. Nonetheless, the 
similarity of the two EMG amplitude maps and the variability in execution over multiple 
trials reduces the classification performance when using global features. The spatial-
temporal structure of the active motor units during the tasks is conversely very different and 
can be used for more robust discrimination.  
  
11 
 
 
Figure 3 - Single channel electromyographic (EMG) recordings obtained from subject T1 
during hand close and wrist supination of the phantom limb. (a) The colormap images 
represent the EMG root mean square (RMS) value for all electrodes of the matrix used for 
recording. (b) The EMG was decomposed into individual motor units. For clarity, only three 
representative motor units per task are represented with their multi-channel action 
potentials. The locations of the channels in the multichannel action potentials are coded 
with four colors. They represent an arbitrary partinioning applied to the grid to assign motor 
units to different regions of the reinnervated muscles. Each motor unit was assigned one of 
the four regions, according to the location of the peak value of the action potential 
waveforms. (c) The discharge timings of the motor units were pooled into ensemble 
discharge timings. These ensemble motor neuron discharges represent the neural drives 
reaching the four muscle regions. (d) Single-channel EMG signals synchronized with the 
discharge timings of motor neurons. In this example, the task “hand close” is performed with 
motor units assigned to the green and red portions of the grid, therefore the pooled 
discharge patterns are shown in green and red, respectively, for this task. Conversely, “wrist 
supination” is performed with motor units all detected in the red portion of the grid. The 
colormaps for surface EMG amplitude are relatively similar between the two tasks, whereas 
the motor unit activity is different and represented by neural drives reaching different 
regions of the reinnervated muscles. This representative data explain the reason for the 
superior classification performance obtained when using motor neuron discharge timings 
with respect to global EMG features. In all cases, poor discrimination by surface EMG was 
due to similar EMG amplitude spatial distribution between two or more classes whereas the 
motor neuron pooled discharge timings differed between classes, as in the example 
reported here. 
  
12 
 
This experiment showed that the extraction of the timings of discharge of motor 
neurons may be beneficial for discriminating tasks of the missing limb with respect to global 
EMG feature classification. In the proposed approach, contrary to the global EMG that 
represents an average activity over the skin surface, each motor neuron may provide 
discriminating information from its series of discharges as well as from the location of the 
innervated muscle fibers. 
Experiment 2 
Experiment 2 (patients T4, T5, and T6) was designed to test the use of motor neuron 
discharge timings for proportional control. This has implications in methods for direct 
control following TMR. The tests were done on a single degree of freedom which was 
mapped proportionally from global EMG amplitude and from motor neuron discharge 
timings during slow-varying force contractions, in the full range of muscle activation. In this 
experiment, the average number of motor units identified by decomposition of the multi-
channel EMG signals at the observed reinnervation site across all three patients was 11.8 ± 
3.8. Fig. 4 presents an example of slow linear increase and decrease in intensity of activation 
by patient T4. Decomposition of the generated signals qualitatively revealed the two 
physiological mechanisms for increasing the level of activation: recruitment of additional 
motor neurons and modulation of the discharge frequency of the active motor neurons (Fig. 
4c). It was also evident that the information in the population activity of motor neurons was 
highly correlated to the intensity of muscle activity and this was repeatable over different 
trials of the same task (Fig. 4e). 
  
13 
 
 
Figure 4 – Motor neuron behavior during linearly increasing and decreasing intensity of 
activation in patient T4. (a) Amplitude maps of the interference electromyographic (EMG) 
activity during a contraction of increasing and decreasing force (linear). (b) The cue that was 
given to the patient as visual feedback to modulate the intensity of the contraction is shown 
as a black line. The surface EMG amplitude is shown as a red line. (c) Discharge timings of 
motor neurons decoded through EMG decomposition. (d) Smoothed discharge rates of 
individual motor neurons with respect to the cue. (e) Instantaneous discharge rate 
estimated over intervals of 200 ms computed from the ensemble of motor neuron 
discharges for three repetitions of the same task (circles; each repetition is represented with 
a different color), showing the association between the instantaneous rate of motor neurons 
and intensity of activity. The behavior of motor neurons during the ramp contractions in this 
representative example fully reflects the general observation on all patients tested and all 
trials. This is evident from the results on each patient shown in Fig. 5. 
  
14 
 
The representative results shown in Fig. 4 were confirmed in the three tested 
patients. Fig. 5 shows representative estimates of contraction intensity for one patient as 
well as the individual results for each patient. The motor neuron discharge timings have 
been pooled to obtain the ensemble of discharge timings of all motor neurons, as an 
estimate of the neural drive. This estimate was compared with the global EMG amplitude. 
The estimates using motor neuron discharge timings outperformed those obtained with 
surface EMG for a large range of processing intervals and for all patients (Fig. 5). 
 
Figure 5 – (a) Force estimates for patient T4, based on the envelope of the 
electromyographic (EMG) signals (blue) and motor neuron discharge timings (red) with 
respect to the cue (black). (b) Force estimates for patient T4 with post processing based on 
averaging over three consecutive past intervals.  (c) Standard deviation (σ) of estimation 
(color coded for each of the three patients T4-T6) after linear de-trending when varying the 
duration of the processing interval. (d) Standard deviation of estimation when applying the 
post processing to force estimates. 
  
15 
 
This experiment showed that it is possible to extract direct proportional commands 
from motor neuron discharge timings and these commands are more accurate than those 
obtained with classic EMG amplitude. 
Experiment 3 
Finally, a direct mapping between decoded motor neuron discharge rates and 
kinematics was performed in Experiment 3, only for patient T6. The mapping into 
mechanical function was performed with two methods, either signal- or model-based. The 
signal-based approach applied a dimensionality reduction to the motor neuron discharge 
timing series without requiring kinematic labelling. The model-based approach projected the 
series of discharge timings into degrees of freedom by a forward biomechanical estimation 
of joint moments.  
The signal-based approach was applied to 244 unsorted extended sources (over all 
reinnervaton sites) during a recording of 30 s. The sources were extended by the EMG 
decomposition approach (see Methods) and all extensions were maintained for this 
estimation approach, contrary to all other methods presented for which the extended 
sources were not used. The extensions of the sources represent redundant information, but 
redundancy is exploited to define appropriate subspace projections with this approach. Due 
to the inclusion of extended sources for this approach, the number of sources used (244) 
was greater than for all other methods.  
Fig. 6 shows the analysis made on three trials of the same composite movement with 
three concurrently active degrees of freedom. The third trial was used for test purposes, 
after calibration in the first two trials. The estimate on the train/test trials in this 
representative example corresponded to an average R2 in the estimation of kinematics of 
  
16 
 
0.87/0.73. It has to be noted that it is impossible to guarantee that the mirror movements 
were identical for the two sides and therefore the obtained R2 is an underestimate of the 
actual performance. The performance obtained with three concurrently active degrees of 
freedom was similar to that obtained for two active degrees of freedom with an average R2 
of 0.65/0.72, and for one degree of freedom 0.81/0.76, for train and test trials, respectively. 
Fig. 6 shows the quality of the matching. 
 
Figure 6 – (a) Performance of signal-based estimation on projecting three degrees of 
freedom composite movements. The dotted lines represent the recorded (Rec.) kinematics 
of the contraleral (contralat.) side for patient T6, while the solid ones depict the first three 
principal components after VARIMAX rotation (see Methods) which estimate elbow flexion 
(EF) in blue, wrist pronation (WP) in red, and wrist flexion (WF) in green. (b) The raster plot 
of the corresponding 244 motor neuron discharge timings (with the delayed replicas 
extracted by decomposition of electromyographic signals; see Methods). The first two tasks 
have been used for calibration and the last for testing. 
The second mapping approach in this experiment was based on biomechanical 
modeling. Neural data-driven musculoskeletal modeling was used to demonstrate the 
possibility of reconstructing the neuro-mechanical function of the patient’s phantom limb. 
This approach enabled translating motor neuron discharge timings, decoded from 
reinnervated residual muscles, into the forces simultaneously produced by 12 musculo-
tendon units acting on a mechanical model of the amputee’s missing limb (Fig. 7). The forces 
  
17 
 
of the muscle-tendon units were concurrently projected to three degrees of freedom of the 
missing limb (elbow flexion/extension, forearm pronation/supination, wrist 
flexion/extension). The similarity between joint moments in the intact (as reference) and 
missing limb was quantified using both R2 and the root mean squared difference (RMSD). 
Fig. 7 shows a representative example, which involved elbow flexion/extension (R2=0.82, 
RMSD=0.91Nm), forearm rotation (R2=0.77, RMSD=0.04Nm), and wrist flexion/extension 
(R2=0.60, RMSD=0.02Nm), simultaneously. When decoding mechanical function for two 
degrees of freedom simultaneously – wrist rotation and flexion/extension – the performance 
corresponded to R2=0.72, RMSD=0.04Nm, and R2=0.73, RMSD=0.05Nm, respectively. When 
only a single degree of freedom was estimated (elbow flexion/extension), the performance 
corresponded to R2=0.79, RMSD=1.24Nm. 
 
Figure 7 – (a) Subject-specific musculoskeletal geometry model built for patient T6. The 
model incorporates wire-like muscle-tendon units and wrapping surfaces to bones on both 
the intact and missing limb. One out of the three electrode grids used in the experiments is 
shown. (b) Decomposed motor neuron discharge timings are pooled into populations that 
represent the neural drive to 12 muscle-tendon units in the individual’s missing limb. (c) The 
  
18 
 
forces of the muscle-tendon units of the missing limb are estimated with the musculo-
skeletal model driven by motor neuron discharges. Muscles of the model are: biceps brachii 
long head (BIClong) and short head (BICshort), brachialis (BRA), brachioradialis (BRD), 
extensor carpi radialis longus (ECRL), extensor carpi radialis brevis (ECRB), extensor carpi 
ulnaris (ECU), flexor carpi radialis (FCR), flexor carpi ulnaris (FCU), flexor digitorum 
superficialis on middle finger (FDSM), flexor digitorum profundus on middle finger (FDPM) 
and extensor digitorum communis on middle finger (EDCM) (d) The muscle-tendon unit 
forces are simultaneously projected, via moment arms, to 3 degrees of freedom. Joint 
moments predicted in the missing limb are depicted together with those experimentally 
measured from the intact limb during a bi-lateral mirror task involving simultaneous elbow 
flexion, forearm pronation and wrist flexion. These results indicate the reconstruction of a 
missing limb biomechanics from the neural activity of the motor neuron pools which 
previously innervated the missing limb by using accessary muscles as an interface with these 
motor neurons.   
These results illustrate the possibility, in principle, of estimating the biomechanics of 
a missing limb by decoding the neural drive to the muscle units and therefore the ultimate 
neural code representing the motor tasks. With this approach, predicted limb biomechanics 
can be translated into mechatronic functions of external devices that can be as complex as 
an intact biological limb. 
Discussion 
We have presented a new neural interface based on the decoding of the discharge 
timings of spinal motor neurons that provides the neural drive to muscles of missing limbs in 
amputees, to generate intuitive commands for potential prosthesis control. The interface is 
realized by the combination of TMR, that connects the axons of the target motor neurons to 
available muscle fibers, and the decoupling, by deconvolution, of the electrical activity of the 
muscle fibers innervated by each axon from multi-channel EMG recordings. We have shown 
that this interface enables the generation of meaningful and accurate control signals for 
potential prosthetic control, both in the context of pattern recognition with a large number 
of classes and within the paradigm of simultaneous and proportional control of multiple 
degrees of freedom. 
  
19 
 
 
The proposed interface allowed detecting a large number of motor neurons  (on 
average >10) for each reinnervation site. The series of discharges of these motor neurons 
could be accurately identified, so that the neural information sent from the pools of motor 
neurons previously innervating the missing muscles in the patients could be assessed. At a 
theoretical level, the decoded motor neuron behavior from EMG recordings may be 
considered a new EMG feature for use in myocontrol, however we consider it as 
conceptually different from any previous attempt for myocontrol. The main breakthrough is 
the change of analysis scale from macroscopic (EMG) to microscopic (timing of motor 
neuron discharges). Because the EMG is a signal generated by the spatio-temporal 
convolution of thousands of motor neuron discharges, any set of mathematically derived 
EMG features will reflect the temporal and spatial resolution of the EMG as a random 
process. In contrast, motor neuron discharge timings have a precise physiological meaning 
and represent the way in which movement is naturally coded at the spinal level. It is the 
same set of features that direct intrafascicular nerve interfacing attempts to extract5. 
Therefore, our results are on par with the identification of discharges directly from axonal 
interfacing with implanted intrafascicular electrodes. Nonetheless, with respect to implanted 
nerve recodings, the proposed system identifies a greater number of motor neurons and 
extracts the complete series of discharges of these motor neurons (see for comparison, e.g. 
Reference 27 where the error rate is approximately 30% with at most 5-6 decoded efferent 
fibers from nerve interfacing). In this view, the proposed approach constitutes the ultimate 
exploitation of TMR as a means for neural interfacing using muscles as biological amplifiers. 
The results presented show that direct access to the neural code sent by peripheral nerves 
to muscles is possible and practical following TMR. Moreover, this study also shows that 
motor neuron spike trains can be effectively used as a relevant source of information for 
  
20 
 
synthesizing complex prosthetic commands. In comparison, direct neural recordings have 
been usually applied to map commands using global features of the interference nerve 
signals without spike sorting (e.g., 28). 
 
The accuracy of the proposed interface has been proven with various control 
approaches and experimental designs on patients with amputations at different levels. First, 
we applied methods for signal classification, which are dominant in the scientific literature 
on myocontrol29, to the decoded series of discharge timings. The classification results 
indicated an almost perfect discrimination (on average >97%) of up to 11 classes. The results 
obtained from global EMG analysis in this study are partly in agreement with those reported 
in previous studies (e.g.,15,19,30). However, given the relatively small number of available TMR 
patients in the current and previous studies and differences in the experimental and analysis 
conditions, comparisons between studies are difficult. For example, using classic EMG 
features, a classification accuracy of 98% and 93% was previously reported for two patients 
and 8 classes30, which is a similar result as obtained in the present study for patients T1 and 
T2 for 7 and 9 classes, respectively. In our experiment, however, the performance with 
classic EMG features degraded for patient T3 when classifying 11 classes and was lower than 
that previously reported in four patients for 16 classes19. However, three of the four patients 
in this previous study were transhumeral amputees with physiological innervation of the 
lateral heads of biceps and triceps and the window duration used for the analysis (256 ms) 
was longer than in our study (100 ms). In the experimental conditions of our study and with 
the choices we have made for the processing parameters, the proposed approach based on 
decoding motor neurons led to greater accuracy than the classic pattern recognition 
approach. Given the relatively small number of patients in this and previous studies, 
however, this result cannot be generalized. 
  
21 
 
 
Furthermore, we tested the possibility for the patients to proportionally control one 
degree of freedom through decoded motor neuron activity (direct control). The decoded 
neural information allowed a finer separation of intensity levels than surface EMG 
amplitude. Surface EMG has indeed an associated estimation variance that is limited by the 
bandwidth of the signal31 while the extracted neural information can in principle exactly 
predict force because force is generated as a direct linear transformation of the decoded 
neural activity32. Accordingly, the variability in force control shown in Fig. 5 was lower when 
using the motor neuron discharge timings than with EMG amplitude in almost all conditions 
and patients tested. These results indicate the possibility of superior precision in 
proportional control by using the discharge patterns of motor neurons with respect to EMG 
amplitude. 
 
The final experiment was related to the simultaneous and proportional control of 
multiple degrees of freedom, shown for two approaches. The signal-based approach 
identifies the control signals without labeling of the kinematics during training whereas the 
model-based approach is based on training and relies on the subject’s anatomy. Both 
methods provided an estimate of the mechanics of multiple degrees of freedom. The TMR 
procedure allows the full reconstruction of the neural signals sent to the muscles of the 
missing limb, despite the absence of these muscles, so that the biomechanics of the missing 
limb can be estimated, in principle, accurately. This experiment was performed on only one 
of the patients, due to limited availability of the other patients. However, the patient who 
participated in this test did not show EMG signals of better quality than the other patients 
and, importantly, the decomposition was of the same quality in this and other patients. 
Moreover, the patients who participated in the second experiment, including the one who 
took part to the third experiment, had very similar performance in their motor neuron 
  
22 
 
proportional control (Fig. 5). Therefore, the patient selected for the third experiment on 
simultaneous and proportional control was similar to the others for the type and quality of 
neural information extracted and for the control he could achieve using this neural 
information in a previous experiment. There is no reason to believe that the results of the 
third experiment are specific to the patient selected.   
The superior performance of the use of motor neuron discharge timings with respect 
to global EMG in some of the conditions analyzed has several biophysical reasons. The global 
EMG features vary for changes in the waveforms of muscle fiber action potentials. This 
factor of variability is removed by separating the neural information from the muscle fiber 
action potentials. Moreover, the decoding method does not use clustering based on the 
shape of the action potentials but rather identifies the discharge timings by sparseness 
constraints (see Methods). Therefore, changes in the action potential shapes do not 
influence the decomposition. The separation of action potentials from the neural drive also 
eliminates the effect of EMG amplitude cancellation31, which poses an intrinsic limit to the 
accuracy of EMG amplitude estimates. This partly explains, for example, the observations of 
the second experiment. In the specific clinical case of TMR patients, there are additional 
reasons for the effectiveness of the proposed approach with respect to global EMG analysis. 
The discharge patterns of reinnervated motor units are likely easier to discriminate than for 
physiological innervaton due to a reduced complexity of the interference signal. 
Moreover, the reinnervation causes a loss of the natural relation between muscle unit size 
and recruitment order so that the amplitude of the EMG signals is likely a poorer indicator of 
muscle activation in these patients than in physiological conditions, as suggested in23. Finally, 
the territories of the muscle units of different motor neuron pools tends to overlap during 
  
23 
 
the reinnervation process and their activities are therefore difficult to differentiate from the 
global EMG analysis.  
 
The proposed interface can presumably be applied to any nerve that can be 
redirected to accessory muscles. Even in the absence of target muscle tissue, this may be 
obtained either with transplants of small muscle portions33 or, in the future, by growing 
muscle tissue around the terminal portion of the nerve34. Therefore, the proposed system 
should be seen as a general neural interface that accurately decodes the efferent activity of 
nerves without inserting electrodes into nerves. Moreover, although the current system was 
tested with non-invasive EMG recordings, the same concepts and algorithms can be directly 
translated to implanted multi-site muscle electrodes, such as the intramuscular arrays we 
have recently proposed35 or multi-channel extensions of epimysial devices already tested in 
patients36. These muscle implants could be surgically realized at the same time as the TMR 
procedure. 
 
Although obtained under several experimental conditions and on patients with 
different characteristics, the presented results are currently limited to an offline analysis. 
The training and use of the proposed interface needs to be performed online and should 
explore the perception action cycle of the user in a closed-loop scenario to fine tune motor 
control to achieve the desired movements. While these future steps are needed for a full 
appreciation of the potential of the approach, the current work provides proof of the 
feasibility of decoding motor neuron behavior in amputees and of using motor neuron 
behavior for man-machine interfacing. 
 
The online implementation of the proposed concepts for the control of prostheses in 
daily-life activities requires the solution of practical challenges. The first of these challenges 
  
24 
 
is the requirement for an online EMG deconvolution that is computationally complex. 
Nonetheless, this operation is now feasible due to speed of current microprocessors37. The 
performance with the online user’s control may differ from the offline results38. However, 
because motor neurons acting on a degree of freedom receive predominantly common 
input39, the identification of different sets of motor neurons in different sessions would not 
influence the mapping and control. Despite these promising features, the performance of 
the system over different conditions without re-training during online use has not been 
tested and constitutes a challenge for the clinical translation. Morever, the clinical efficacy of 
any of the control schemes proposed will depend on the design of the mechatronics of a 
given prosthetic limb. The current study focuses on an extensive offline experimental 
validation on patients that provides a proof-of-concept for an innovation in myocontrol 
whose clinical translation needs further efforts. 
In conclusion, we have proven the possibility of decoding the behavior of virtually all 
the pools of motor neurons that physiologically innervated the muscles responsible for the 
movement of a missing limb and that are reinnervated to other muscle tissues by TMR. This 
decoding was demonstrated in six patients with different amputation levels and TMR 
procedures, and was shown to provide information that can be used for intuitive and 
effective commands over multiple degrees of freedom. The approach is the ultimate 
exploitation of the TMR concept that allows spinal interfacing by using muscles as natural 
amplifiers of nerve activity. A full clinical translation of this new concept requires online 
implementation of the proposed algorithms and testing the long-term adaptation with the 
user in the loop. 
Methods 
  
25 
 
Patients 
Measurements were performed on six TMR patients, whose characteristics relevant 
for this study are reported in Table 1. The patients were referred to O.C.A. for prosthetic 
fitting and underwent TMR surgery. The characteristics of the patients reported in Table 1 
refer to the time when each patient was included in the experimental measurements. The 
TMR procedures for all patients were performed at the Medical University of Vienna, 
Austria. In patients T1, T2, T3, all major nerves of the brachial plexus were redirected into 
muscles of the chest region (Table 1). Patients T4, T5 and T6 are transhumeral amputees for 
whom the TMR procedure resulted in the medianus, ulnaris, and radialis nerves being 
reinnervated into the brachialis, caput breve bicipitis, and caput laterale tricipitis muscles, 
respectively. 
The experimental protocols as well as the informed consent forms for the 
experiments were approved by the ethics committee “Ethikkommission der Medizinischen 
Universität Wien” (approval numbers 1279/2014, for patients T1-T3, and 1234/2015, for 
patients T4-T6). 
Experimental set-up 
Three experiments were performed with the aim of showing different control 
strategies for active prostheses, all based on the decoded activity of the motor neurons 
reinnervating muscles above the amputation. The patient selection for each experiment was 
not randomized since the measurements were performed over the course of two years and 
designed with the purpose of presenting progressively more advanced features of the 
proposed interface. The six patients participated in the different experiments depending on 
their availability at the time when the methods applied in the three experiments were 
  
26 
 
developed. Therefore, the experimental work represents a case series of several 
experimental sessions on a total of six patients with the purpose of presenting the concept 
of spinal interfacing via TMR and motor neuron activity decoding. Fig. 1 shows the general 
concept underlying the methods applied in all experiments. Grids of 64 electrodes for 
surface EMG recordings were located over each reinnervation point. The multi-channel EMG 
signals were processed to extract the series of discharges of the innervating motor 
neurons24,40. The identified spike trains were then used to define control commands. The 
mapping between neural information and motion of degrees of freedom varied in the three 
experiments, as described in the following, with the aim of showing different control 
solutions. 
EMG recording and processing 
In all of the experiments, surface EMG signals were recorded with high-density and 
flexible electrode grids. The placement of the grids differed across individuals and 
corresponded to the locations of reinnervation following surgery. The EMG electrode grids 
incorporate copper tracks on a kapton support and each grid comprises 64 sensors (8×8 
electrodes, 1-mm diameter; Spes Medica, Italy) with an inter-electrode distance of 10 mm in 
both directions. The grids were applied on the skin surface by a 1-mm thick double adhesive 
foam with holes in correspondence to the electrode locations. The skin-electrode contact 
was facilitated by the use of conductive paste. The multi-channel signals were amplified by a 
multi-channel amplifier (EMGUSB2, OTBioelettronica, Italy, cutoff frequencies 3–900 Hz), 
sampled at 2048 Hz, and A/D converted with 12 bit precision. Although a surface recording 
system was chosen for this study, the same processing methods and experimental tests can 
be also applied with implanted muscle electrodes40. The only fundamental characteristics of 
  
27 
 
the EMG recording for the proposed approach is the availability of several (>30) channels per 
reinnervated site, as it can be achieved with invasive technology by, e.g., our recently 
developed thin-film electrodes35. 
The EMG signals were decomposed by a blind source separation algorithm40. The 
decomposition provided the discharges of activation of the innervating motor neurons. The 
decomposition algorithm is described in detail in 40 but we also provide here a brief 
description of its basic working principles. 
Multi-channel EMG signals are observations that contain the convolutive mixtures of 
motor neuron spike trains. For each observation (EMG channel), unknown finite impulse 
response filters (motor unit action potentials) act on the sources (series of motor neuron 
discharge timings). This convolutive mixture of sources can be converted into a linear 
instantaneous mixture by extending the sources to include the 𝑛 original sources as well as 
their delayed versions, with delays from 1 to the filter length 𝐿40. The 𝑚 original 
observations (EMG channels) are also extended, by a factor 𝑅, in order to maintain a greater 
number of observations than sources.  
Indicating with 𝑠(𝑘) = [𝑠1(𝑘), 𝑠2(𝑘), … , 𝑠𝑛(𝑘)]𝑇, 𝑥(𝑘) = [𝑥1(𝑘), 𝑥2(𝑘), … , 𝑥𝑚(𝑘)]𝑇 
and 𝑛(𝑘) = [𝑛1(𝑘), 𝑛2(𝑘), … , 𝑛𝑚(𝑘)]𝑇 the original sources, observations, and noise, 
respectively, the extended model is as follows: 
𝑥(𝑘) = [𝐻𝑠(𝑘) +  𝑛(𝑘)] 
𝑘 = 0, … , 𝐷𝑅 
(1) 
where the extended observations, sources, and noise are:  
𝑥𝑖
̃(𝑘) = [𝑥𝑖(𝑘), 𝑥𝑖(𝑘 − 1), … , 𝑥𝑖(𝑘 − 𝑅)]   𝑖 = 1, … , 𝑚 
(2) 
𝑠
𝑗
̃(𝑘) = [𝑠
𝑗(𝑘), 𝑠
𝑗(𝑘 − 1), … , 𝑠
𝑗(𝑘 − 𝐿 − 𝑅)]   𝑗 = 1, … , 𝑛 
(3) 
  
28 
 
𝑛𝑖
̃(𝑘) = [𝑛𝑖(𝑘), 𝑛𝑖(𝑘 − 1), … , 𝑛𝑖(𝑘 − 𝑅)]   𝑖 = 1, … , 𝑚 
(4) 
and the equivalent scalar mixing matrix representing the filters is: 
𝐻
̃ = [
ℎ11
̃
⋯
ℎ1𝑛
̃
⋮
⋱
⋮
ℎ𝑚1
̃
⋯
ℎ𝑚𝑛
̃
] 
(5) 
with: 
ℎ𝑖𝑗 = [
ℎ𝑖𝑗[0]
⋯
ℎ𝑖𝑗[𝐿 − 1]
0
⋱
⋱
⋮
⋱
⋱
0
⋯
0
    
0
⋯
0
⋱
⋱
⋮
⋱
⋱
0
ℎ𝑖𝑗[0]
⋯
ℎ𝑖𝑗[𝐿 − 1]
] 
(6) 
Where 𝐷𝑟 is the duration of the recordings and hij the action potential of the 𝑗-th 
motor unit recorded at the channel 𝑖. The noise in model (1) represents electronic noise as 
well as the activity of motor units represented at the skin surface by low-energy action 
potentials that are not separated.  
The linear instantaneous model of Eq. (1) is inverted to recover the matrix of the 
extended sources. In this study, the inversion is performed by spatial whitening followed by 
the fixed point optimization procedure with a cost function that maximizes the sparseness of 
the estimated sources40,41. The method extracts sources (series of motor neuron discharge 
timings) associated to individual motor neurons, as proven by the unique represention of the 
associated multi-channel surface action potentials42. The estimated sources are trains of 
delta functions centered at the instant of motor neuron activation, with an amplitude that 
may vary due to the estimation process. In order to extract the discharge timings 
information only, a local peak detector was applied to the estimated sources, by comparing 
each candidate peak with surrounding peaks, and considering a refractory period of 10 ms. It 
is relevant to note that the decomposition method extracts the original sources as well as 
  
29 
 
their delayed replicas, as defined by the extended source model of Eq. (3). For all analyses 
performed in this study, the delayed replicas were excluded and only the estimated original 
sources were further processed for the mapping procedures. The only exception is the 
signal-based mapping for simultaneous and proportional control of multiple degrees of 
freedom based on principal component analysis (PCA) (Experiment 3) for which we used as 
input the full extended estimated sources as in Eq. (3). For this reason, the number of time 
series of discharge timings used as input with that approach is much greater than for the 
others (𝐿 times greater).  
Applying the above decomposition procedure, Fig. 1 shows an example of sets of 
discharge times of populations of motor neurons during tasks of wrist flexion and extension 
by a patient following TMR. These discharge timings are not abstract mathematical features, 
as in classic myocontrol, but instead correspond to the natural neural code sent from the 
spinal cord to the muscles. 
After EMG decomposition, the neural drive to muscles was estimated by pooling the 
discharge timings of groups of identified motor neurons39,43. The selection of these groups 
depended on the analysis and is detailed for each experiment in the following. For each 
group of motor neurons, the corresponding neural drive was the ensemble of discharge 
timings of the motor neurons. The signal of delta functions centered at each discharge of 
activation of each motor neuron in a defined group of neurons represents all timings of 
discharge of the motor neurons in the group. It is simply obtained by summing the series of 
discharge timings of the motor neurons in the group and corresponds physiologically to the 
neural drive sent to the reinnervated muscles by the defined motor neuron group. The 
estimated neural drives to the reinnervated muscles were then used to map control signals 
  
30 
 
into multiple degrees of freedom in three experiments. The common procedures used in all 
experiments for EMG processing to extract the neural activation signals are schematically 
shown in Fig. 1. 
Experiment 1: Classification 
Patients T1-T3 (Table 1) participated in experiment 1. The patients were asked to 
attempt the following tasks of their missing limb: hand opening, hand closing, wrist 
extension, wrist flexion, thumb adduction, thumb abduction, pronation, supination, elbow 
extension, elbow flexion. Due to different reinnervation profiles and levels of training, not all 
subjects were able to perform all these tasks. The order of the attempts was randomized. 
For patient T1 each attempt lasted 10 s, for patients T2 and T3 the trials lasted 5 s, with 5 s 
of rest in between trials. Patients T1 and T2 performed each trial twice, while patient T3 
repeated each trial three times. These differences in experimental choices for the different 
patients were due to the conditions and capabilities of the patients. 
The neural drives to muscle regions were estimated, as described above, by pooling 
the discharge timings of groups of motor neurons. The groups were defined based on the 
location of the muscle units in the areas covered by the recording electrode grids. Each grid 
was divided into four regions and each motor neuron was associated to the muscle unit in 
the region of the grid where the corresponding motor unit action potential had the greatest 
amplitude. In this way, we defined the neural drives to reinnervated muscle sites by 
partitioning each grid into four parts and associating to them the ensembles of discharges of 
the innervating motor neurons.  
Classification into the discrete classes was performed using a support vector machine 
classifier with linear kernel, with 5-fold cross-validation. The input to the classifier was the 
  
31 
 
number of discharges in each 100-ms interval for each muscle region, with a 10-ms overlap 
between consecutive intervals. For comparison with surface EMG classification, the EMG 
RMS of all channels as well as the TD features were computed in the same intervals used for 
spike classification and classified with the same classifier. For global EMG features, the 
feature space was reduced in dimensionality using Principal Component Analysis (PCA), 
retaining 95% of the signal power.  
Experiment 2: Direct control 
The aim of experiment 2 was to establish if it was possible to extract a proportional 
command from motor unit discharges (direct control). The experiment was performed on 
patients T4, T5 and T6, who are all transhumeral amputees (Table 1). The patients were 
seated comfortably facing a computer screen. One surface EMG electrode grid was mounted 
over the reinnervated short head of the biceps. Initially, all participants were asked to 
perform a maximal voluntary contraction by attempting a hand open gesture of their missing 
limb. The maximum EMG envelope during this task was taken as reference for providing 
feedback in percent of the maximum intensity. Each subject was then prompted to increase 
and decrease the intensity of muscle activity from the relaxed state to the maximal intensity, 
over 20 s. This contraction duration determined a slow-varying force contraction. This choice 
was made in order to assess accurate control, which requires slow variations, and in the full 
activation range of the muscle, to prove that the analysis methods proposed are not 
influenced by the strength of activation. The contractions performed by the patients 
represent accurate force control, as it can be seen in fine object manipulation. Conversely, 
Experiment 3 focused on faster contractions, as typical of reaching tasks. 
  
32 
 
The intensity of muscle activation was estimated using the EMG envelope, as a classic 
reference approach, and the neural drive, as direct neural information. These approaches 
were compared varying the processing interval from 50 ms to 500 ms, with an interval 
overlap of 50%. Moreover, a post processing was applied by averaging over three 
consecutive past intervals. For each condition, the standard deviation of the intensity 
estimate, after linear de-trending, was computed to determine the accuracy in the control. 
Experiment 3: Control of multiple degrees of freedom 
Among the tested patients, patient T6 (Table 1) volunteed for a further experimental 
session that involved attempted mirror movements of the missing and the contralateral arm 
with the purpose of testing the ability of the proposed approach to map the neural drive into 
multiple degrees of freedom activated concurrently during natural movements. For this 
purpose, motion capture data and EMG signals were recorded concurrently. Upper limb 
kinematics were recorded (256 Hz sampling frequency) using a seven-camera system 
(Qualisys, Göteborg, Sweden) and a set of 18 retro-reflective markers placed on the patient’s 
intact left upper extremity, residual right upper extremity, trunk, and pelvis. High-density 
EMG was recorded using electrode grids located in correspondence of the residual upper 
arm frontal, lateral, and dorsal compartments to cover the targeted reinnervations. Data 
were recorded during one static anatomical pose and 13 dynamic trials involving mirrored 
bi-lateral motions that simultaneously articulated elbow flexion, forearm pronation, and 
wrist flexion, both in the intact and missing limb. These three degrees of freedom were 
chosen since in transhumeral amputees the precise proportional and simultaneous control 
over elbow and wrist is the biggest challenge in prosthetic fitting. Precise proportional and 
simultaneous control over these three degrees of freedom allows natural object reaching for 
  
33 
 
transhumeral amputees, which is not possible with current systems. The hand opening-
closing task was not included in this experiment since this can be achieved without 
simultaneous control, by an hybrid scheme as proposed in 7, whereas the focus of this 
experiment was on concurrent and proportional activation of degrees of freedom. The 
estimate of the kinematics from neural information was performed with both a signal-based 
and a model-based estimation approach. 
Signal-based estimation. An approach for extracting control signals using 
unsupervised subspace mapping was developed, which receives as input the full extended 
sources [Eq. (3)] and transforms them in direct control signals. The central idea of the 
method is to preserve the metric of the high-dimensional space where the multidimensional 
time series of motor neuron dischages exists and to project the data to a subspace of 
dimension specified by the degrees of freedom of the prosthetic hand. The simplest of the 
metric projections uses the Mahalanobis distance36, which is defined by the covariance of 
discharge time series. Principal component analysis (PCA) was used to explore the spatio-
temporal correlation between the time series in high-dimensional space and to project the 
data to an orthogonal lower dimensional space. Let 𝐗𝑛×𝐷, be the input data matrix 
representing the 𝑛 discharge time series over 𝐷 channels. Then PCA performs a singular 
value decomposition (SVD) of 𝐗 = 𝐔𝚺𝐕T, where 𝐔 and 𝐕 are 𝑛 × 𝑛 and 𝐷 × 𝐷 unitary 
matrices, respectively, and 𝚺 is a 𝑛 × 𝐷 rectangular diagonal matrix with diagonal values 𝜎𝑖 
known as the singular values of 𝐗. The columns of 𝐕 are the eigenvectors of the covariance 
matrix and they serve as the principal directions or axes of the PCA sub-space. The principal 
components UΣ are projections of 𝐗 on sub-space axes. PCA achieves a projection that maps 
most of the relevant information (variance) to a 𝑑-dimensional manifold, where 𝑑 (𝑑 ≪ 𝐷) 
is any suspace. It can be shown that this mapping is formed by the first 𝑑 eigenvectors, i.e., 
  
34 
 
columns of 𝐕, noted as 𝐕𝑑. In our case, 𝑑 is specified by the number of degrees of freedom 
to be controlled, and the goal is to associate each principal component to a degree of 
freedom. Therefore, the problem reduces to appropriately assigning the outputs of the PCA 
projected data to the corresponding degree of freedom. However, the two orthogonal 
coordinate systems (that of PCA and that of the degrees of freedom) of the same dimension 
are not necessarily the same because the PCA eigenvectors are solely defined by the data, 
hence an orthogonal rotation 𝐑𝑑×𝑑 is needed to align the principal directions with the 
external basis of degrees of freedom. Moreover, the external basis coordinates are the 
canonical sparse basis of 𝑅𝑛 (each component only moves one degree of freedom of the 
prosthesis), while the PCA eigenvectors are not sparse and are ordered by projected 
variance. Therefore, we sought to find the rotation matrix in the principal component 
subspace that is the most sparsified to mimic the canonical basis of 𝑅𝑛. Here, we applied the 
VARIMAX orthogonal rotation37,38 𝐑VARIMAX: 
𝐑VARIMAX = 𝑎𝑟𝑔 max
𝑅
(1
𝑑 ∑ ∑(𝐋𝐑)𝑖𝑗
4
𝑑
𝑖=1
𝑛
𝑗=1
− ∑ (1
𝑑 ∑(𝐋𝐑)𝑖𝑗
2
𝑑
𝑖=1
)
2
𝑛
𝑗=1
) 
(7) 
where 𝐋𝑛×𝑑  = 𝚺𝑛×𝑑𝐕𝑑×𝑑/(√𝑛 − 1) are referred to as the loadings37. Once the PCA and 
VARIMAX rotation are obtained in a training set (without any kinematic labeling), the control 
of the prosthesis test is achieved by inputing the motor neuron discharge time series in real 
time to the PCA subspace and VARIMAX projections, which can be combined to decrease the 
computational complexity.  
Model-based estimation. The open-source software OpenSim44 was used to scale a 
generic upper extremity model of the musculoskeletal geometry45 to match the patient’s 
anthropometry. The musculoskeletal geometry model had seven upper extremity degrees of 
  
35 
 
freedom and incorporated a total of 14 muscle-tendon units, spanning the shoulder, elbow, 
wrist and hand joints (Fig. 7). During the scaling process, virtual markers were placed on the 
generic musculoskeletal geometry model based on the position of the experimental markers 
from the static pose. The model anthropomorphic properties as well as the muscle-tendon 
unit insertion, origin and their bone wrapping points were linearly scaled on the basis of the 
relative distances between experimental and corresponding virtual markers44. Inverse 
kinematics was solved for three-dimensional joint angles that minimized the least-squared 
error between experimental and virtual marker locations during dynamic trials46. The 
generated kinematics were then used to obtain dynamically consistent joint moments via 
residual reduction analysis, i.e. joint moments reconstructing experimental joint angles 
when driving forward dynamics arm simulations47. We refer to these as “experimental joint 
moments”.  
The estimates of joint moments were based on neural data-driven musculoskeletal 
modeling. The motor neuron discharges were converted into continuous neural activations 
using a twitch model based on a time-history dependent recursive filter and a non-linear 
transfer function48. Experimental joint angles were used as input to a multidimensional cubic 
B-splines set that synthetized the OpenSim subject-specific geometry of muscle-tendon units 
and computed their resulting length and moment arms49,50. Neural activations and muscle-
tendon unit length were used to control a Hill-type muscle model and estimate 
instantaneous length, contraction velocity, and force in the muscle fibers, and strain and 
force in the series-elastic tendon within each muscle-tendon unit49. The computed forces 
were projected onto all upper extremity degrees of freedom simultaneously via the moment 
arms.  
  
36 
 
The neural-driven model was calibrated to map neural activations to individual 
muscle-tendon units. After the calibration, the model was used to convert neural inputs into 
the resulting joint moments produced in the missing limb elbow, forearm and wrist. 
Data availability 
 
The data and the codes used for the results presented in this study are available upon 
request.  
 
 
  
37 
 
References 
1. 
Farina, D. & Aszmann, O. Bionic limbs: clinical reality and academic promises. Sci. Transl. Med. 
6, 257ps12 (2014). 
2. 
Kuiken, T. a et al. Targeted reinnervation for enhanced prosthetic arm function in a woman 
with a proximal amputation: a case study. Lancet 369, 371–80 (2007). 
3. 
Tan, D. W. et al. A neural interface provides long-term stable natural touch perception. Sci. 
Transl. Med. 6, 257ra138-257ra138 (2014). 
4. 
Lebedev, M. A. & Nicolelis, M. A. L. Brain-machine interfaces: past, present and future. Trends 
Neurosci. 29, 536–546 (2006). 
5. 
Dhillon, G. S., Lawrence, S. M., Hutchinson, D. T. & Horch, K. W. Residual function in 
peripheral nerve stumps of amputees: implications for neural control of artificial limbs. J. 
Hand Surg. Am. 29, 605-15–8 (2004). 
6. 
Wodlinger, B. & Durand, D. M. Peripheral nerve signal recording and processing for artificial 
limb control. 2010 Annu. Int. Conf. IEEE Eng. Med. Biol. Soc. EMBC’10 6206–6209 (2010). 
doi:10.1109/IEMBS.2010.5627735 
7. 
Amsuess, S. et al. Context-Dependent Upper Limb Prosthesis Control for Natural and Robust 
Use. IEEE Trans. Neural Syst. Rehabil. Eng. 1–1 (2015). doi:10.1109/TNSRE.2015.2454240 
8. 
Gilja, V. et al. A high-performance neural prosthesis enabled by control algorithm design. Nat. 
Neurosci. 15, 1752–7 (2012). 
9. 
Donoghue, J. P. Connecting cortex to machines: recent advances in brain interfaces. Nat. 
Neurosci. 5 Suppl, 1085–8 (2002). 
10. 
Hochberg, L. R. et al. Reach and grasp by people with tetraplegia using a neurally controlled 
robotic arm. Nature 485, 372–375 (2012). 
11. 
Collinger, J. L. et al. High-performance neuroprosthetic control by an individual with 
tetraplegia. Lancet 381, 557–564 (2013). 
12. 
Bouton, C. E. et al. Restoring cortical control of functional movement in a human with 
quadriplegia. Nature 533, 247–250 (2016). 
13. 
Jiang, N., Dosen, S. & Farina, D. Myoelectric control of artificial limbs: is there the need for a 
change of focus? IEEE Signal Process. Mag. 12–15 (2012). 
14. 
Hoffer, J. & Loeb, G. Implantable electrical and mechanical interfaces with nerve and muscle. 
Ann. Biomed. Eng. 8, (1980). 
15. 
Kuiken, T. a et al. Targeted muscle reinnervation for real-time myoelectric control of 
multifunction artificial arms. JAMA 301, 619–628 (2009). 
16. 
Gart, M. S., Souza, J. M. & Dumanian, G. A. Targeted Muscle Reinnervation in the Upper 
Extremity Amputee: A Technical Roadmap. J. Hand Surg. Am. 40, 1877–1888 (2015). 
17. 
Kuiken, T. a et al. The use of targeted muscle reinnervation for improved myoelectric 
prosthesis control in a bilateral shoulder disarticulation amputee. Prosthet. Orthot. Int. 28, 
245–253 (2004). 
  
38 
 
18. 
Cheesborough, J. E., Dumanian, G. A., Smith, L. H. & Kuiken, T. A. Targeted Muscle 
Reinnervation and Advanced Prosthetic Arms. Semin. Plast. Surg. 1, 62–72 (2015). 
19. 
Zhou, P. et al. Decoding a new neural machine interface for control of artificial limbs. J. 
Neurophysiol. 98, 2974–82 (2007). 
20. 
Tikhonov, A. N. On the stability of inverse problems. Dokl. Akad. Nauk SSSR 39, 195–198 
(1943). 
21. 
Birdwell, J. A., Hargrove, L. J., Weir, R. F. & Kuiken, T. A. Extrinsic finger and thumb muscles 
command a virtual hand to allow individual finger and grasp control. IEEE Trans. Biomed. Eng. 
62, 218–226 (2015). 
22. 
Cipriani, C., Segil, J. L., Birdwell, J. A. & Weir, R. F. Dexterous control of a prosthetic hand using 
fine-wire intramuscular electrodes in targeted extrinsic muscles. IEEE Trans. Neural Syst. 
Rehabil. Eng. 22, 828–836 (2014). 
23. 
Li, Y., Smith, L. H., Hargrove, L. J., Weber, D. J. & Loeb, G. E. Sparse optimal motor estimation 
(SOME) for extracting commands for prosthetic limbs. IEEE Trans. Neural Syst. Rehabil. Eng. 
21, 104–111 (2013). 
24. 
Farina, D. et al. Non-Invasive, Accurate Assessment of the Behavior of Representative 
Populations of Motor Units in Targeted Reinnervated Muscles. IEEE Trans. Neural Syst. 
Rehabil. Eng. 4320, (2014). 
25. 
Kapelner, T., Jiang, N., Vujaklija, I., Aszmann, O. C. & Farina, D. Classification of Motor Unit 
Activity Following Targeted Muscle Reinnervation. in IEEE engineering in medicine and biology 
magazine : the quarterly magazine of the Engineering in Medicine & Biology Society 22–24 
(2015). 
26. 
Holobar, A., Glaser, V., Gallego, J. A., Dideriksen, J. L. & Farina, D. Noninvasive analysis of 
motor unit behavior in pathological tremor. Proc. Annu. Int. Conf. IEEE Eng. Med. Biol. Soc. 
EMBS 7512–7515 (2011). doi:10.1109/IEMBS.2011.6091852 
27. 
Djilas, M., Azevedo-Coste, C., Guiraud, D. & Yoshida, K. Spike sorting of muscle spindle 
afferent nerve activity recorded with thin-film intrafascicular electrodes. Comput. Intell. 
Neurosci. 2010, (2010). 
28. 
Jezernik, S., Grill, W. W. & Sinkjaer, T. Neural network classification of nerve activity recorded 
in a mixed nerve. Neurol. Res. 23, 429–434 (2001). 
29. 
Parker, P., Englehart, K. & Hudgins, B. Myoelectric signal processing for control of powered 
limb prostheses. J. Electromyogr. Kinesiol. 16, 541–548 (2006). 
30. 
Hargrove, L., Ping Zhou, Englehart, K. & Kuiken, T. A. The Effect of ECG Interference on 
Pattern-Recognition-Based Myoelectric Control for Targeted Muscle Reinnervated Patients. 
IEEE Trans. Biomed. Eng. 56, 2197–2201 (2009). 
31. 
Farina, D., Merletti, R. & Enoka, R. M. The extraction of neural strategies from the surface 
EMG. J. Appl. Physiol. 96, 1486–1495 (2004). 
32. 
Negro, F., Holobar, A. & Farina, D. Fluctuations in isometric muscle force can be described by 
one linear projection of low-frequency components of motor unit discharge rates. J. Physiol. 
587, 5925–5938 (2009). 
  
39 
 
33. 
Aszmann, O. C. et al. Bionic reconstruction to restore hand function after brachial plexus 
injury : a case series of three patients. Lancet 6736, 1–7 (2015). 
34. 
Ursu, D. C., Urbanchek, M. G., Nedic, A., Cederna, P. S. & Gillespie, R. B. In vivo 
characterization of regenerative peripheral nerve interface function. J. Neural Eng. 13, 26012 
(2016). 
35. 
Muceli, S. et al. Accurate and representative decoding of the neural drive to muscles in 
humans with multi-channel intramuscular thin-film electrodes. J. Physiol. n/a-n/a (2015). 
doi:10.1113/JP270902 
36. 
Ortiz-Catalan, M., Hakansson, B. & Branemark, R. An osseointegrated human-machine 
gateway for long-term sensory feedback and motor control of artificial limbs. Sci. Transl. Med. 
6, 257re6-257re6 (2014). 
37. 
Glaser, V., Holobar, A. & Zazula, D. Real-time motor unit identification from high-density 
surface EMG. IEEE Trans. Neural Syst. Rehabil. Eng. 21, 949–958 (2013). 
38. 
Jiang, N., Vujaklija, I., Rehbaum, H., Graimann, B. & Farina, D. Is accurate mapping of EMG 
signals on kinematics needed for precise online myoelectric control? IEEE Trans. Neural Syst. 
Rehabil. Eng. 22, 549–58 (2014). 
39. 
Farina, D., Negro, F. & Dideriksen, J. L. The effective neural drive to muscles is the common 
synaptic input to motor neurons. J. Physiol. 49, 1–37 (2014). 
40. 
Negro, F., Muceli, S., Castronovo, A. M., Holobar, A. & Farina, D. Multi-channel intramuscular 
and surface EMG decomposition by convolutive blind source separation. J. Neural Eng. 13, 
26027 (2016). 
41. 
Farina, D. & Holobar, A. Characterization of Human Motor Units From Surface EMG 
Decomposition. Proc. IEEE 104, 353–373 (2016). 
42. 
Farina, D., Negro, F., Gazzoni, M. & Enoka, R. M. Detecting the Unique Representation of 
Motor-Unit Action Potentials in the Surface Electromyogram. J. Neurophysiol. 100, 1223–1233 
(2008). 
43. 
Negro, F. & Farina, D. Factors Influencing the Estimates of Correlation between Motor Unit 
Activities in Humans. PLoS One 7, (2012). 
44. 
Delp, S. L. et al. OpenSim: Open-source software to create and analyze dynamic simulations of 
movement. IEEE Trans. Biomed. Eng. 54, 1940–1950 (2007). 
45. 
Saul, K. R. et al. Benchmarking of dynamic simulation predictions in two software platforms 
using an upper limb musculoskeletal model. Comput. Methods Biomech. Biomed. Engin. 1–14 
(2014). doi:10.1080/10255842.2014.916698 
46. 
Lu, T. W. & O’Connor, J. J. Bone position estimation from skin marker co-ordinates using 
global optimisation with joint constraints. J. Biomech. 32, 129–134 (1999). 
47. 
Thelen, D. G. & Anderson, F. C. Using computed muscle control to generate forward dynamic 
simulations of human walking from experimental data. J. Biomech. 39, 1107–1115 (2006). 
48. 
Manal, K. & Buchanan, T. S. A one-parameter neural activation to muscle activation model: 
Estimating isometric joint moments from electromyograms. J. Biomech. 36, 1197–1202 
(2003). 
  
40 
 
49. 
Sartori, M., Reggiani, M., Farina, D. & Lloyd, D. G. EMG-driven forward-dynamic estimation of 
muscle force and joint moment about multiple degrees of freedom in the human lower 
extremity. PLoS One 7, e52618 (2012). 
50. 
Sartori, M., Farina, D. & Lloyd, D. G. Hybrid neuromusculoskeletal modeling to best track joint 
moments using a balance between muscle excitations derived from electromyograms and 
optimization. J. Biomech. 47, 3613–3621 (2014). 
Acknowledgements: This work was supported by the European Research Council Advanced Grant 
DEMOVE (contract #267888) (to D.F.), by the Christian Doppler Research Foundation of the Austrian 
Federal Ministry of Science, Research and Economy (to O.C.A.), by the European Union’s Horizon 
2020 research and innovation programme under the Marie Skłodowska-Curie grant agreement No 
702491 (NeuralCon) (to F.N.), and DARPA HAPTIX (N66001-15-1-4054) (to J.P.). The authors are 
grateful to Drs. Meike Schweisfurth and Hubertus Rehbaum for support in the experimental 
measurements, to Dr. Margherita Castronovo for support in the data analysis, and to Drs. Christian 
Hofer and Stefan Salminger for clinical support. 
 
Author contributions: D.F. and O.C.A. conceived the study. I.V., T.K., M.S. and K.B. performed the 
acquisition. I.V., T.K., M.S., F.N., N.J., A.A. and J.P. conducted the analysis. D.F., I.V., T.K., M.S., F.N., 
N.J., K.B., J.P. and O.C.A. interpreted the data. D.F., I.V. and O.C.A. wrote and edited the manuscript. 
 
Additional information: 
*Address of Correspondence: 
Prof. Dr. Dario Farina 
Department of Bioengineering 
Imperial College London 
SW7 2AZ London, UK 
Tel: +44 (0)20 759 41387 
Email: d.farina@imperial.ac.uk 
 
Competing interests: The authors declare no financial competing interests. 
