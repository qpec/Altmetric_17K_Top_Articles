 Cerebellar granule cells acquire a widespread predictive 
feedback signal during motor learning
Andrea Giovannucci1,2,11, Aleksandra Badura1,3,11, Ben Deverett1,4, Farzaneh Najafi5,10, 
Talmo D Pereira1, Zhenyu Gao6, Ilker Ozden1,7, Alexander D Kloth1,10, Eftychios 
Pnevmatikakis2,8, Liam Paninski8, Chris I De Zeeuw3,6, Javier F Medina9, and Samuel S-H 
Wang1
1Princeton Neuroscience Institute and Department of Molecular Biology, Princeton University, 
Princeton, New Jersey, USA 2Center for Computational Biology, Flatiron Institute, Simons 
Foundation, New York, New York, USA 3Netherlands Institute for Neuroscience, Amsterdam, the 
Netherlands 4Robert Wood Johnson Medical School, New Brunswick, New Jersey, USA 
5Department of Biology, University of Pennsylvania, Philadelphia, Pennsylvania, USA 
6Department of Neuroscience, Erasmus MC, Rotterdam, the Netherlands 7School of Engineering, 
Brown University, Providence, Rhode Island, USA 8Departments of Statistics and Neuroscience, 
Columbia University, New York, New York, USA 9Department of Neuroscience, Baylor College of 
Medicine, Houston, Texas, USA
Abstract
Cerebellar granule cells, which constitute half the brain’s neurons, supply Purkinje cells with 
contextual information necessary for motor learning, but how they encode this information is 
unknown. Here we show, using two-photon microscopy to track neural activity over multiple days 
of cerebellum-dependent eyeblink conditioning in mice, that granule cell populations acquire a 
dense representation of the anticipatory eyelid movement. Initially, granule cells responded to 
neutral visual and somatosensory stimuli as well as periorbital airpuffs used for training. As 
learning progressed, two-thirds of monitored granule cells acquired a conditional response whose 
timing matched or preceded the learned eyelid movements. Granule cell activity covaried trial by 
trial to form a redundant code. Many granule cells were also active during movements of nearby 
Reprints and permissions information is available online at http://www.nature.com/reprints/index.html.
Correspondence should be addressed to S.S.-H.W. (sswang@princeton.edu) or J.F.M. (jfmedina@bcm.edu).
10Present addresses: Cold Spring Harbor Laboratory, Cold Spring Harbor, New York, USA (F.N.) and University of North Carolina, 
Chapel Hill, North Carolina, USA (A.D.K.).
11These authors contributed equally to this work.
Note: Any Supplementary Information and Source Data files are available in the online version of the paper.
AUTHOR CONTRIBUTIONS
A.G. designed behavioral and imaging experiments, established the behavioral and imaging setup and molecular methods, performed 
in vivo imaging experiments, developed analyses and drafted the manuscript. A.B., Z.G. and C.I.D.Z. designed and/or performed brain 
slice experiments. A.B. performed histological and combined behavioral-pharmacological experiments. F.N., I.O., B.D. and A.D.K. 
established the behavioral and imaging setup and methods. B.D. performed in vivo imaging experiments and developed analyses. 
T.D.P., E.P. and L.P. developed analyses. J.F.M. and S.S.-H.W. designed experiments and developed analyses. All authors edited the 
manuscript.
COMPETING FINANCIAL INTERESTS
The authors declare no competing financial interests.
HHS Public Access
Author manuscript
Nat Neurosci. Author manuscript; available in PMC 2018 May 01.
Published in final edited form as:
Nat Neurosci. 2017 May ; 20(5): 727–734. doi:10.1038/nn.4531.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 body structures. Thus, a predictive signal about the upcoming movement is widely available at the 
input stage of the cerebellar cortex, as required by forward models of cerebellar control.
The cerebellum is widely recognized as supporting associative learning necessary for 
generating predictive and corrective actions in specific contexts1. Contextual information is 
thought to be encoded at the input level of the cerebellum in the granule cell (GrC) 
population2 and may include peripheral and internally generated sensory signals1,3–5 as well 
as feedforward signals about a learned motor command6,7. However, little is known about 
actual GrC representations during the learning process, because cerebellar learning is slow8 
and single-cell recording methods only allow GrCs to be monitored on a single day for a 
brief period of time9–11.
The question of how GrCs represent contextual information during behavior can be 
understood in terms of several models of cerebellar information processing. In one 
longstanding hypothesis, contextual information is provided by a very small fraction of 
GrCs, speculatively as few as ~1% (ref. 3). For associative learning during eyeblink 
conditioning, such subpopulations of GrCs have been suggested as representing externally 
generated conditional stimuli (CSs), such as tones or light flashes12,13. The pairing of CSs 
with an unconditional stimulus (US), such as a corneal airpuff, triggers learning processes in 
which the resulting changes in CS-driven Purkinje cell spiking drive a well-timed blink that 
protects the eye—a conditional response (CR)12,13.
In the domain of continuous actions such as smooth movements, it has also been suggested 
that the cerebellum conveys a broader range of information as part of a feedback system for 
control of overall brain output14,15. In forward models for motor control, it is suggested that 
the outcomes of actions are continually being predicted, with the prediction being fed back 
within the brain as part of a dynamic process of adjustment14. Such models require that GrC 
inputs to the cerebellum convey not only external-world information such as CSs but also 
internally generated predictions of action on an ongoing basis.
We tested these ideas about neural representations in GrCs by using two-photon microscopy 
of calcium indicator protein GCaMP6f to image populations of GrCs while mice underwent 
classical eyeblink conditioning in a head-fixed apparatus. This combination of methods 
allowed us to follow the evolution of learned GrC representations over many days.
RESULTS
Monitoring cerebellar GrC calcium signals in behaving mice
We expressed GCaMP6f or fast-GCaMP6f-RS09 in cerebellar lobule VI (Fig. 1a) using two 
adeno-associated virus type 1 (AAV1)-based strategies. In wild-type mice, we injected an 
AAV1 construct that used the human synapsin (hSyn) promoter to drive widespread 
expression in the GrC layer16. In NeuroD1-cre mice from the laboratory of M.E. Hatten, we 
used a conditional strategy by injecting AAV1-Flex-GCaMP6f. Both strategies led to 
widespread expression in the GrC layer (Fig. 1b and Supplementary Fig. 1). We selected for 
monitoring regions of interest (ROIs) that met criteria of near-circularity and diameters of 
4.5–7.5 μm, often with an annular pattern of fluorescence. Positive staining for the GrC-
Giovannucci et al.
Page 2
Nat Neurosci. Author manuscript; available in PMC 2018 May 01.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 specific GABAA α6 subunit was found in 99.7 ± 0.1% of such ROIs in both hSyn-injected 
(wild-type) and NeuroD1-cre mice, indicating that virtually all monitored structures 
belonged to GrCs. We also found that 94 ± 2% of all ROIs were DAPI-positive at the center, 
completing their identification as GrC somata. No mossy fiber-like structures were observed 
to express GCaMP. As indicated by the pattern of nonexpressing voids (Fig. 1b), no Purkinje 
cells were seen; in the case of the synapsin promoter, this was consistent with previous 
results17,18. Larger, DAPI-positive and α6-negative structures were occasionally observed 
and tentatively classified as Golgi or Lugaro cells (Fig. 1b and Supplementary Fig. 1). Thus, 
our in vivo imaging criteria predominantly identify individual GrC somata (Fig. 1c).
In two NeuroD1-cre mice, we further confirmed GrC expression by imaging at molecular-
layer locations. We observed axon-like structures and boutons (Fig. 1d, e). These structures 
were active in the absence of any applied stimuli and responded to corneal airpuffs and light 
flashes (Fig. 1f and Supplementary Video 1). Signals from rows of mediolaterally aligned 
boutons were strongly correlated (Fig. 1d), consistent with a common origin from shared 
parallel fibers and indicative of the propagation of action potentials.
In brain slices, we measured GrC somatic fluorescence signals while evoking and 
monitoring action potentials electrically via mossy fiber stimulation or patch electrode 
(Supplementary Fig. 2). We recorded action potentials in cell-attached mode to prevent 
GCaMP wash-out, which occurs during whole-cell recording. Fluorescence signal amplitude 
increased monotonically as a function of the number of mossy fiber stimuli (Supplementary 
Fig. 2a, b) and as a function of action potentials, up to the highest number of spikes tested, 
20 spikes at 50–600 Hz (Supplementary Fig. 2c). In published observations of in vivo GrC 
activity recorded during awake behavior, including locomotion10 and whisker stimulation11, 
brief high-frequency bursts have been observed (10–14 spikes at 40–170 Hz (ref. 10) and 1–
25 spikes at 270–440 Hz (ref. 11), respectively). In this range of activity in brain slices, we 
found that the fluorescence increase ranged from ΔF/F0 = 24% to 155% (Supplementary Fig. 
2c). In our experiments, in vivo calcium imaging of 268 GrCs whose activity was highly 
correlated with locomotion (r > 0.6; n = 5 mice) revealed ΔF/F0 signals ranging from 23% to 
165%. Thus GCaMP signals in vivo were consistent with expectations from published 
electrophysiological observations of GrC activity.
Chronic in vivo imaging of cerebellar cortex during eyeblink conditioning
For in vivo imaging (Supplementary Video 2) of learned representations, we followed 128 
GrCs for up to 12 d of training in 3 mice in the same 3 fields of view (FOVs; Supplementary 
Fig. 3) and 268 ± 91 GrCs in FOVs reimaged over one or more sessions without one-to-one 
cell matching in 3 additional mice (98 FOVs). To investigate GrC representations, we used 
classical eyeblink conditioning (Fig. 2a), a form of Pavlovian learning that requires 
cerebellar activity and plasticity13,19. Mice were trained by pairing a CS in the form of a 
flash of light (n = 4) or a weak airpuff to the ipsilateral whisker area (n = 2) with an aversive 
US, a periorbital airpuff, which reliably evoked an unconditional reflex blink (UR; Fig. 2b). 
After repeated pairings of the CS and US over the course of multiple conditioning sessions, 
the CS alone came to elicit an anticipatory eyeblink CR that started before the time of the 
expected US onset and was part of a broader avoidance response20. By the end of training, 
Giovannucci et al.
Page 3
Nat Neurosci. Author manuscript; available in PMC 2018 May 01.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 CRs were elicited on an average of 73 ± 13% (range 58–96%) of all trials and CR amplitude 
reached 43 ± 7% of the US-triggered full eyelid closure (Fig. 2c).
In all mice (n = 6), we imaged GrCs near the surface of cerebellar lobule VI (Fig. 1a), an 
optically accessible region that, although not previously included among known regions 
necessary for the production of blinks21–23, receives excitation that drives movements of 
nearby trunk and neck regions (Supplementary Fig. 4) and is likely to be engaged during 
eyeblink conditioning because it receives climbing fiber inputs triggered by the periorbital 
airpuff US24,25. Indeed, in separate nonimaging experiments with five mice that were trained 
to a high fraction of conditional responses (CR rate > 70%), we found that injection of 
muscimol in the same region of cerebellar cortex led to a reversible reduction in CR 
probability and amplitude (Fig. 2d, e). CR probability decreased from 81% ± 5% (mean ± 
s.d.) during the baseline measurements to 39% ± 19% (Fig. 2d), an effect that was not seen 
after control injections of saline in the same animals (72% ± 6%; different from muscimol 
injection, P = 0.005; CR amplitude smaller in muscimol condition than saline injection, P = 
0.026; Fig. 2d). The degree of impairment caused by muscimol increased with the size of the 
injected area within the anterior-lateral lobule VI (Supplementary Fig. 5) indicating that this 
region played a significant role in modulating the production of learned blinks.
Figure 3 shows trial-by-trial recordings of calcium signals in a single GrC, along with 
simultaneously recorded behavioral responses over the course of 9 d of conditioning using a 
CS (Fig. 3a and Supplementary Fig. 6). To demix and denoise somatic signals from the 
surrounding neuropil, we used structured matrix factorization methods26 (Supplementary 
Video 2). In addition to measuring eyelid closure (Fig. 3a, b), we used computer-assisted 
analysis of video recordings to calculate treadmill speed (Fig. 3a, b) and combined whisker-
and-snout movement (Supplementary Fig. 7 and Supplementary Videos 3 and 4). These 
algorithms allowed us to resolve movements with single-frame resolution.
GrCs develop a trial-by-trial representation of the learned response
To assess the relationship between behavioral and cellular responses, we divided all data into 
trials in which only the periorbital puff was delivered (US), trials in which the animal 
produced no CR and showed no significant locomotion (speed < 2 cm/s) during the CS 
presentation (CR−; Fig. 3b), and trials in which the mouse produced a CR but showed no 
significant locomotion (speed < 2 cm/s) during the CS presentation (CR+; Fig. 3b). Trials 
with snout/whisker movements were kept because these are part of the CR8,20. The example 
neuron highlights three features of GrC responses. First, the US evoked a large calcium 
response in all trials (Fig. 3b and Supplementary Fig. 6). This response was consistent with 
drive either from activation of somatosensory inputs from the periorbital area or from motor 
signals linked to the reflex blink or high levels of movement. Second, presentation of the CS 
evoked a smaller calcium response detectable even on trials with no CR and no significant 
locomotion (Fig. 3b), suggesting that it could have been driven either by sensory inputs or 
by undetected movements. Third, individual GrC responses were substantially larger on CR+ 
trials than on CR− trials (Fig. 3b and Supplementary Fig. 6b), an effect that could be 
explained by activation of CR-related inputs. Thus, this example GrC was active during 
eyeblink conditioning and carried a signal correlated with the presence or absence of the CR.
Giovannucci et al.
Page 4
Nat Neurosci. Author manuscript; available in PMC 2018 May 01.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 GrCs acquire a predictive control signal
If GrC calcium signals were related to CRs, they would be expected to have temporal 
dynamics that matched the eyelid response and to grow in amplitude with learning (Fig. 4). 
For both light CS and whisker CS (Fig. 4a), the GrC population activity preceded the onset 
of the eyelid response on average (Supplementary Fig. 8a, b). In GrCs with a correlation 
with CR amplitude > 0.3, the signal preceded the start of eyelid closure by 68 ± 28 ms and 
the start of the snout or whisker movement by 142 ± 33 ms (185 neurons, 4 mice; 
Supplementary Fig. 8b), consistent with a predictive control signal and ruling out sensory 
reafference as the sole mechanism.
To test whether GrC responses grew with learning, we examined calcium responses and 
behavioral output across training days (Fig. 4). We quantified the magnitude of eyelid 
movement (Fig. 4a) and GrC calcium response (f*) in CR+ and CR− trials in an 85-ms time 
window preceding the UR. Figure 4b shows how calcium signals evolved over the course of 
9 d of conditioning for one FOV comprising 29 GrCs. In individual GrCs (Fig. 4b), CR+-
associated calcium responses grew with training while CR− associated responses did not. 
Calcium signals in CR+ trials increased in parallel with eyelid closure amplitude (Fig. 4b), 
while overall average animal locomotion was below 0.05 cm/s (Fig. 4b). We obtained 
similar results in all the other FOVs (n = 6 mice), after accommodating for the learning 
dynamics of the different animals by binning GrC activity according to the level of 
performance (Fig. 4c). Thus, across the population of GrCs, the average f* increased 
progressively for low-, medium- and high-probability CR epochs (Fig. 4c and 
Supplementary Fig. 8c; left: Pearson’s r = 0.21 ± 0.04, P = 1.8·10−6; right: r = 0.12 ± 0.04, P 
= 0.004; mean ± s.d. from bootstrapping procedure), indicating that learning was 
accompanied by the emergence of a CR-specific GrC signal.
GrC representations are dense on a subsecond time scale
Analysis of calcium responses in populations of GrCs revealed that most GrCs were 
activated by the CS in CR− trials (Fig. 4d and Supplementary Fig. 8d; 1 FOV per mouse), 
and they also carried a CR-related signal (defined as the difference in the f* signal between 
CR+ and CR− trials; Fig. 4d and Supplementary Fig. 8d). In fact, when we inspected 
individual GrCs across all FOVs in all mice (n = 6) we found that most of them (64 ± 18%) 
carried a signal that was CR-related (i.e., the trial-by-trial activity was significantly 
correlated with the eyelid response; see Online Methods).
Our custom matrix factorization algorithm26 recognized 58 ± 18 GrCs per 10,000 μm2. 
Based on a total density of 187 ± 27 GrCs per 10,000 μm2 as determined by histological 
analysis, this corresponds to an estimated 31 ± 10% of all GrCs. Thus, at a minimum, 0.64 × 
31% = 21% of all GrCs within the FOV encoded CR-related contextual information during 
the CS period.
Because optogenetic activation of mossy fibers innervating the imaged area of lobule VI 
resulted in neck, trunk and limb movements (Supplementary Fig. 4), we surmised that GrC 
activity in this region might be associated with actions other than the production of learned 
blinks. Indeed, we found GrCs with calcium signals that were correlated with eyelid 
Giovannucci et al.
Page 5
Nat Neurosci. Author manuscript; available in PMC 2018 May 01.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 movement, wheel speed or snout movement (Fig. 5a). We quantified these correlations 
computing the Pearson’s r coefficient between the GrC signals and behavior (Fig. 5b, c). In 
addition, some individual GrCs showed activity that correlated with multiple movement 
parameters (Fig. 5d). To categorize each GrC according to its preferred movement 
parameter, we identified the one movement (eyelid-CR, snout, wheel or eyelid-UR) that was 
most highly correlated with its calcium signal. In animals that reached the advanced stage of 
training and with behavioral data available (> 60% conditional responses, n = 3 mice), more 
GrCs were best correlated with eyelid-CR than with any of the other movements (Fig. 5e).
Redundant coding of the learned response
The strong correlation between calcium signals and behavior in many individual GrCs 
suggests that the code may be redundant at the level of the population. To test for 
redundancy in GrC representations, we used the previously computed Pearson’s correlation 
values for eyelid-CR to calculate the degree to which individual and multiple GrCs could 
encode a well-quantified movement parameter, CR amplitude. A linear regressor based on 
the activity of all the GrCs in the population was more correlated with CR amplitude than 
any single GrC (Fig. 6a), indicating that the CR was more accurately encoded by a 
distributed representation of GrC activity.
We quantified the degree of redundancy across the GrC population by computing the 
regressor’s capacity to predict CR amplitude trial by trial. Capacity was measured in units of 
Shannon mutual information between the regressor output and the eyelid trace. Mutual 
information increased with the number of neurons included in the regressor (Fig. 6b) but 
rapidly reached a plateau as more neurons were added. The amount of redundancy in the 
GrC population was calculated using a redundancy index, Λ, which was defined as the upper 
bound of information contained in the neurons individually, divided by the amount of 
information contained in the population regressor. Under this definition of redundancy, when 
Λ = 1, each GrC provides independent information. When all imaged neurons were 
included, the median value of Λ was 12 (range, 7 to 140; n = 6 mice), exceeding levels seen 
elsewhere in the central nervous system27,28. Λ increased proportionally with the number of 
GrCs monitored (r = +0.89), and since many active GrCs were not imaged in our 
experiments, the true degree of redundancy is likely to be even higher.
DISCUSSION
Our findings demonstrate that neural activity related to learned movements was available at 
the input stage of cerebellar cortex and in a notably high fraction of GrCs. This signal may 
arise from cells in the anterior interpositus nucleus that increase their firing during the 
CR8,13,29. Deep nuclear activity can lead to net excitation of GrCs by two routes: 
monosynaptic excitation, via collaterals of principal cells that terminate as mossy fibers7,30, 
and disynaptic disinhibition, via inhibitory deep nuclear neuron projections onto Golgi cells, 
which in turn inhibit GrCs31. Descending action-related information may also arrive in the 
cerebellum via corticopontine pathways, which can converge onto the same GrCs as sensory 
pathways6. It has been suggested that the cerebellum may use signals like those we have 
uncovered as a form of efference copy to compute forward models that overcome the 
Giovannucci et al.
Page 6
Nat Neurosci. Author manuscript; available in PMC 2018 May 01.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 problems associated with long delays in sensory feedback14,15. In this way, the duality 
between driving behavioral output and receiving a copy of the output may allow the 
cerebellum to participate in a closed feedback loop that regulates and adjusts ongoing 
predictive responses in real time15.
Single GrCs were activated during multiple distinct movements with specificity that was 
often, but not always, restricted to eyelid, snout or locomotion. These correlations described 
a representation of both unconditional and conditional movement and are consistent with the 
idea that the mossy fiber pathway in this region of lobule VI provides a stream of 
information that is available for the generation and control of movements by separate but 
nearby body structures32.
Dense coding: beyond the theories of Marr and Albus
Traditional theories of cerebellar function3,4 emphasize that the pattern of connectivity and 
the staggering number of GrCs in the cerebellar cortex makes these cells perfectly suited to 
produce high-dimensional representations, in which each context is encoded by a unique 
pattern of activity in the GrC population and a slight change in context strongly alters the 
pattern of activity. The theories of Marr and Albus suggest that (i) individual cells should 
fire only rarely and (ii) the activity of GrCs should be uncorrelated32. Until now, these 
predictions have not been tested directly because it was not technically possible to monitor 
activity in a population of GrCs during cerebellum-dependent tasks. Our evidence did not 
match these classical predictions. Instead, we observed contextual, redundant activity, 
consistent with a dense representation32.
Any distinction between the concepts of ‘sparse’ and ‘dense’ encounters the difficulty that a 
wide range of activity is often considered to be sparse, as long as “low levels of firing 
[occur] under some circumstances”4. We found that during the CS period, approximately 
two-thirds of imaged GrCs were active. This fraction is far from Albus’s original 
speculation, in which he suggested that an entire sensory context would be coded by a tiny 
fraction of GrCs: “if this density … is 1% or less, patterns are easily recognized and quickly 
learned.” The fraction of granule cells active in the CS period appears significantly larger 
than predicted by Marr as well (p. 469 of ref. 3): “the number of GrCs active at any one time 
(say in any 50 msec period) is a small fraction (less than 1/20) of all granule cells”. 
However, these comparisons are fair only if the interval of comparison is an entire action, 
i.e., the CR taken as a whole. GrC activity could transmit information on a finer time scale, 
as would occur if the CR were regulated dynamically in time, for instance, using a forward 
model. In a sense, whether the patterns we observed can be considered dense depends on 
how closely in time GrCs must fire in order to be considered simultaneously active. Future 
methods for monitoring activity with higher time resolution may help answer the sparse-
versus-dense question.
Dynamic regulation of behavior by efference copy
We found that, by the end of training, GrC responses were strongly dependent on whether a 
CR was produced. The population response contained temporal components that both 
preceded and occurred simultaneously with the motor command. This brings up the 
Giovannucci et al.
Page 7
Nat Neurosci. Author manuscript; available in PMC 2018 May 01.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 possibility that GrC populations act as a source of behavioral variation. Previously, it has 
been found that the firing rate of individual Purkinje cells is highly correlated with learned 
movements on a trial-by-trial basis33,34, suggesting that the firing of entire Purkinje cell 
populations must be highly correlated. Our finding of population-level covariation in GrC 
firing suggests that, in the production of cerebellar-driven movements, Purkinje cell 
populations could derive their correlation from the fact that they receive input signals that 
are themselves highly correlated35.
Since inhibition of the imaged locations leads to disruptions in learned blink amplitude, the 
observed learning-related neural responses in GrCs may drive Purkinje cell responses, 
whose firing carries a neural correlate of the CR (ref. 36). Lobule VI and its neighboring 
regions in simplex lobule and anterior vermis contribute to eyeblink conditioning, autonomic 
responses that accompany conditioning20, and neck, trunk and forelimb defensive 
movements21,37. In such a cerebellar region capable of forming multiple, related 
associations, redundancy might help the system amplify its learned blink response30 as well 
as increase its ability to discriminate between38, and generalize to, new stimuli5. In this way, 
a copy of the learned output may help the cerebellum to refine an action as brief as an 
eyeblink dynamically while it is being produced.
ONLINE METHODS
Animal preparation for in vivo two-photon calcium imaging
Experimental procedures were approved by the Princeton University Institutional Animal 
Care and Use Committee and performed in accordance with the animal welfare guidelines of 
the National Institutes of Health. Details of animal preparation were modified from 
previously published procedures24. For imaging experiments we used 5 male, 12- to 16-
week-old C57BL/6J mice (Jackson Laboratory) and 2 male, 20-week-old B6.Cg-
Tg.NeuroD1-Cre.GN135Gsat mice. All mice were group-housed on a reversed light cycle. 
During the surgery mice were anesthetized with isoflurane (5% for induction, 1.0–2.5% for 
maintenance) and a 3-mm-wide craniotomy was opened. A custom-made two-piece 
headplate24, with a removable part to allow repeated access for viral injections, was attached 
to the animal’s head. To increase stability, the skull was thoroughly cleaned in the region 
surrounding the target imaging zone (lobule VI of the cerebellar vermis) and except for the 
craniotomy zone, the skull surface was covered with Metabond (Parkell, S380) before 
opening a craniotomy. For imaging experiments, after an overnight delay for animal 
recovery, the top plate was removed for delivery of 400–800 nL (~50 nL/min) of virus (for 
C57BL/6J mice, AAV1.Syn.GCaMP6f.WPRE.SV40 virus (Penn Vector Core, lot AV-1-
PV2822) or AAV1.Syn.GCaMP6f-RS09.WPRE.SV40; for NeuroD1-cre mice, 
AAV1.CAG.Flex.GCaMP6f.WPRE.SV40) in two injections ~750 and ~1,250 μm lateral to 
the midline and 250 μm deep from the dura surface using borosilicate glass pipettes (World 
Precision Instruments, 1B100F-4, 1/0.58 mm OD/ID) beveled to 30 degrees with a 10- to 
20-μm tip opening. In two mice (one hSyn, one NeuroD1-cre), craniotomies and injections 
were performed during the same surgery, an imaging window was implanted and glued onto 
the skull, and a standard aluminum headplate was cemented to the skull for the purpose of 
head fixation. All animals were placed back in their home cage for 2 weeks of recovery.
Giovannucci et al.
Page 8
Nat Neurosci. Author manuscript; available in PMC 2018 May 01.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 Habituation and eyeblink training for chronic experiments
Two to 3 weeks after AAV injections, animals were trained as previously described8. 
Animals were first habituated to a freely-rotating treadmill for repeated intervals over at 
least 5 d of graded exposure. After habituation was complete, animals were trained while 
simultaneously measuring brain activity under a two-photon microscope. To minimize the 
learning time, animals were trained for up to 4 short sessions per d. The number and 
duration of training sessions were varied according to the type of CS and the behavioral state 
of the animal. If an animal showed signs of discomfort, it was returned to its home cage for 
up to 24 h. The US was a periorbital airpuff (10–20 psi, 30 ms in duration, delivered via a 
plastic needle placed 5 mm from the cornea and pointed at it). The conditional stimulus was 
a flash of light (400 nm, ‘light CS’, 500 ms, contralateral to the US) or an airpuff to whisker 
vibrissae (2–3 psi, ‘whisker CS’, 800 ms, ipsilateral to the US). Consistent with other recent 
eyeblink conditioning in mice8,34, the CS and US did not coterminate, which allows the CS–
US interval to be varied without changing the CS duration. In experiments using light CS, 
the CS–US interval was 250 ms from CS start to US start, and training spanned 7–12 d. In 
experiments using whisker CS, the CS–US interval was 440 ms since vibrissa stimulation 
allowed for larger interstimulus intervals; learning was faster8 and training spanned 6 d. For 
randomization purposes, the stimuli were randomly presented, with a proportion 80% CS + 
US, 10% CS alone and 10% US alone.
Identification of imaging zone
At the beginning of the first day of measurements, a CS-responsive cerebellar zone was 
identified by delivering 10 CS–US paired stimuli while imaging zones in the vermis of 
lobule VI, between the midline and the paravermal vein. The average fluorescence response 
to the CS in the zone was computed during the experiment using a custom ImageJ (http://
imagej.nih.gov) macro, and zones showing >20% ΔF/F were selected for further imaging. 
CS–US pairings were used to prevent delays in learning that can arise from latent inhibition 
caused by nonreinforced pre-exposure to the CS39. For later recording sessions, the FOV 
was matched first using surface landmarks such as blood vessels, then using the brain 
surface overlying the imaging zone for further localization and finally by comparing the 
fluorescent FOV itself with previous sessions.
Data acquisition
Behavioral data was collected using custom software in Python (https://www.python.org/). 
In the first set of experiments, imaging data was collected using ScanImage version 3.8.1 
(Vidrio Technologies). Behavioral acquisition software on one computer sent triggering 
signals to drive a National Instruments USB card (PCIe 6363) on a second computer for 
image acquisition. Calcium imaging was acquired at 128 × 64 pixels per frame at 15.6 Hz or 
128 × 128 at 3.9 Hz (64 or 256 ms per frame, 1 ms per line, bidirectional scanning), and 
behavioral data was acquired in 320 × 240-pixel movies at 100 Hz (Sony PS3 Eye, 
interfaced with custom software written in Python). Imaging and behavioral data were 
collected in 4-s epochs per trial. Within each trial, the CS stimulus was delivered 1.92 s 
(baseline activity) after the starting trigger. To synchronize data, ScanImage channel 2 was 
Giovannucci et al.
Page 9
Nat Neurosci. Author manuscript; available in PMC 2018 May 01.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 used to record the eyelid signal output from the Python module and channel 3 was used to 
record CS, CS–US and US triggers.
In the second set of experiments, imaging data was collected using ScanImage 2015 (Vidrio 
Technologies). Behavioral acquisition software on one computer sent triggering and 
synchronization signals via a National Instruments card (USB 8451) to a second computer 
for image acquisition. Calcium imaging was acquired at 512 × 512 pixels per frame at 29 Hz 
and behavioral data in 320 × 240-pixel movies at 60 Hz (Sony PS3 Eye, interfaced with 
custom software written in Python). Data were collected in 8-s epochs. Within each trial, the 
CS stimulus was delivered 4 s after the starting trigger. To synchronize data, an I2C-based 
synchronization protocol was used to send trial timing information from the behavior 
acquisition computer to the imaging computer in real time.
The number of trials per session depended on the animal stress level and ranged from 25 to 
100 trials. Eyelid position was extracted from the movies collected with the PS3 camera. 
During training, eyelid closure was measured as the integral of a manually defined zone 
enclosing the eye. Animal self-motion and locomotion were estimated from camera images 
through a custom-built image processing pipeline (see “Behavioral tracking” section, 
below). Each trial was initiated only if the animal was still, the eyelid was open and an 
interval of at least 12 s had elapsed from the previous trial. Thresholds for eyelid closure and 
movement were set from baseline signals at the time of the experiment. In the figures, 
example data came from mice using the two expression strategies as follows: NeuroD1-cre 
(Figs. 1c–e, 5a, d, e and 6b; Supplementary Videos 1 and 2 and Supplementary Figs. 1a, b 
and 8a–c, d) and AAV1-hSyn (Figs. 1b, 3, 4a, b, d, 5b, c, e and 6a, b and Supplementary 
Figs. 1b, 2, 3, 6 and 8b, c, d).
Channelrhodopsin-2 stimulation
B6.Cg-Tg(Thy1-COP4/EYFP)18Gfng/J mice (Jackson Laboratories, 007612) expressing 
channelrhodopsin-2 within the cerebellum exclusively in mossy fibers40 (Supplementary 
Fig. 4) under the Thy-1 promoter were implanted with an optical window as described 
above. After 1 week of recovery, they were habituated to the treadmill. Using an Olympus 
4× macro objective (NA = 0.28 and WD = 29.5 mm) light from a blue LED (470 nm, 
LUXEON Rebel, #SP-03-B4) was focused ~200–400 μm under the cerebellum surface 
(125–250 mW/mm2). Ten to 50 stimuli of 10 ms duration and 50 Hz frequency were 
delivered at different locations (crus I and II; lobules V, VI and simplex) of cerebellar 
surface. Movements were extracted as the frame-on-frame value among manually selected 
motion components and calculated as the squared interframe pixel difference averaged 
across manually selected regions of interest (limbs, whiskers, oral trunk–neck) from high-
speed infrared movies. The resulting traces were averaged after aligning to the light pulse 
triggers and removing the prestimulus baseline.
Offline analysis of blinks
CR+ (or CR−) trials were identified as responses greater (or smaller) than 10% of the full 
blink in a window from 50 ms before to 30 ms after the US trigger. Trials with only US 
presentation or CS presentation were termed US-alone and CS-alone trials.
Giovannucci et al.
Page 10
Nat Neurosci. Author manuscript; available in PMC 2018 May 01.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 Behavioral tracking
To isolate the effect of unrelated self-motion and/or proprioceptive sensory activity, we 
developed an image processing pipeline to extract quantitative measures of motor behaviors 
from videos recorded through a high-frame-rate camera positioned in front of (but not 
orthogonal to) the animal. As a proxy for locomotion, wheel velocity was estimated through 
a model-based approach to tracking wheel motion. First, a model of the wheel was 
constructed by measuring the physical dimensions of the uniformly spaced bumps (nubs) on 
the wheel surface. A simplified representation of the wheel (Supplementary Fig. 7 and 
Supplementary Video 3) was then manually registered to the surface of a minimally 
occluded region of the wheel. This enabled the calculation of a projective transformation 
matrix that corrected for the perspective distortion introduced by the nonorthogonal 
positioning of the behavior camera. The reprojected videos were contrast-normalized via 
CLAHE41 and an ROI was selected such that there was again minimal occlusion from the 
animal’s body. Next, HOG features42 centered at each pixel in the ROI were extracted as a 
way to describe the appearance of the local image region. This proved robust to differences 
in illumination artifacts and particularly to heterogeneity in the wheel’s texture. Extracted 
features were matched across subsequent frames by finding the nearest neighbor with a ratio 
of its Euclidean distance to that of the next nearest neighbor of at least 0.7. This matching 
procedure reduced the rate of ambiguous matches by ensuring they were sufficiently distinct 
but did not guarantee that there would be matches between frames; for these, linear 
interpolation was used to fill in missing data. Finally, the wheel velocity was estimated from 
the median displacement in the ROI converted to physical units by scaling to the wheel 
model.
To measure self-motion in the form of movement of snout and whisker muscles in the 
absence of locomotion or wheel displacement, we devised a method for tracking a set of 
manually selected seed points along the contour of the animal’s snout with the assumption 
that most self-motion would result in changes in its shape (Supplementary Fig. 7 and 
Supplementary Video 4). The snout was automatically segmented from the background 
using Otsu’s method43 to find an optimal threshold for separating distributions in the image 
intensity histograms. The points along the boundary of the mask were then used as candidate 
points for matching to the original seed points that traced the contour of the snout. As these 
motions were highly nonlinear and segmentation did not always result in perfect separation 
from the background, matching was achieved via coherent point drift44, a robust point set 
registration algorithm. Matching was performed across frames by selecting the closest 
contour-line point subject to rigidity constraints in deformation of the seed contour. The 
contour line traces were then used as trajectories of the snout shape used to estimate 
displacements in pixels per s. As imaging conditions varied greatly across videos, a 
secondary pipeline was developed to process videos that could not be tracked using the 
aforementioned method. For these cases, an ROI was selected such that only the upper part 
of the snout of the animal and no wheel pixels were included. This region was tiled into 
evenly spaced blocks (12 × 12 pixels) and matched across frames via normalized cross-
correlation, i.e., block matching. Tracking the trajectories of each block enabled results 
comparable to those returned by the shape-based approach but may not have included subtle 
motions of the tip of the snout.
Giovannucci et al.
Page 11
Nat Neurosci. Author manuscript; available in PMC 2018 May 01.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 Calcium imaging data analysis
Image data analysis was performed using custom Matlab, Python and ImageJ scripts. 
Movies were processed in batches containing a maximum of 18,000 frames per batch and 
were fragmented when changes in FOVs were too dramatic. As a first step, movies were 
motion-corrected using the ‘template matching and slice alignment’ ImageJ plugin (https://
sites.google.com/site/qingzongtseng/template-matching-ij-plugin), which is based on the 
‘opencv’ matching template function, or using an equivalent Python implementation (https://
github.com/simonsfoundation/CaImAn) for the second set of experiments. For slow scan 
(i.e., <25 Hz), in order to compensate for warping induced by brain movement and scanning 
microscopy, we separately corrected the top and bottom portions of each movie for motion 
and then stitched them back together. For the first batch of experiments, before matrix 
factorization, movies were preprocessed to set a baseline of 0 and a range of 0–1. Slow 
changes in the pixel fluorescence time series were removed by examining the distribution of 
fluorescence in a ±5-s interval around each sample time point and subtracting the 8th 
percentile value16. Finally, the movies were normalized to a range of 0–1. For the second 
batch, we used an updated version of CNMF that did not suffer from arbitrary signal scale or 
baseline.
For ROI identification, we used a Python package (https://github.com/simonsfoundation/
CaImAn) for calcium image source separation based on non-negative matrix factorization 
(NMF)26. The algorithm is specialized for separating signals from overlapping structures by 
relying on the fact that signals from different structures often have different time signatures. 
This algorithm allowed removal of activity from diffuse sources, a pattern consistent with 
ascending axons passing through neuropil (Supplementary Video 2). The resulting estimate 
of neuropil activity was removed from the movie, and a subset of the ROIs was selected that 
corresponded to GrCs. The neuropil-subtracted movie was renormalized to F values, and 
traces were extracted using the selected regions of interest. ΔF/F0 was computed as 
previously16 except using baseline (F0) values extracted using NMF. In slow-scanning 
experiments, temporal precision was corrected using the relationship between scanning 
position and time to remap each FOV to true time within the frame. When possible, neurons 
were matched across days or sessions (n = 3 mice). To match neurons across days, we wrote 
a special purpose script to align FOVs from different days using the opencv ‘template 
matching’ function and then matched the regions by maximizing an intersection over union 
metric (cells were matched when the ratio of overlapping pixels vs. total pixels was 
maximal). Imaging and behavioral data were synchronized by resampling both signals to 30 
Hz and aligning them based on the eyelid and trigger signals. Cells of the same identity were 
confirmed by exact location across days in three animals, and aggregated population analysis 
was done in three animals whose FOV changed slightly over multiple days (n = 2) or were 
imaged only after training (n = 1). The criteria for selecting GrCs were based on size (4.5–
7.5 μm), location within the brain (under the Purkinje cell layer) and range of activity (max 
range, 400% ΔF/F). In the first batch, GrCs were selected manually from the extracted 
components (n = 4 mice) and in the second were selected in a fully automatic manner (n = 2 
mice). The selection of GrCs did not depend on the experimental conditions but was the 
automatic/semimanual result of the CNMF algorithm plus selection criteria from histology 
(see “Histological procedures” section, below).
Giovannucci et al.
Page 12
Nat Neurosci. Author manuscript; available in PMC 2018 May 01.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 ΔF/F0 traces were aligned to the delivery of stimuli (0 s being the time of expected US), and 
the median value during baseline (1 s preceding CS or US stimulus delivery) was subtracted 
from the waveform.
Correlation computation
In order to quantify the similarity between GrC activities and behavioral responses, we first 
aligned and binned in 100 ms bins behavior and fluorescence. Then, correlation between 
neural activity and snout or wheel dynamics was quantified with the Pearson’s r coefficient 
between neural activity and GrC activity excluding the window of stimulus delivery 
(between 500 ms before and 1,500 ms after the US). In order to compute the regressor 
between neural activity and conditional or unconditional responses, the same correlation 
above was calculated during the stimulus delivery time: 500 ms before to 35 ms after US for 
CR correlation and from 35 before to 750 ms after the US for UR. To estimate the 
confidence interval for correlation, we repeated the procedure described after first shuffling 
the trials and then taking the 95th percentile of the distribution as the threshold.
Multivariate linear regression
In order to probe the redundancy in the population code, we implemented a multivariate 
linear regressor that was trained using half of the trials randomly selected and evaluated on 
the remaining half. The regressor was implemented by the scikit 
sklearn.linear_model.LinearRegression (http://scikit-learn.org/stable/modules/generated/
sklearn.linear_model.LinearRegression.html). This corresponds to the regression of an n-
dimensional response on a matrix of predictor variables, with normally distributed, 
potentially heteroscedastic and/or correlated errors. The regressor was run 100 times on 
different random subdivisions of trials (50% training and test sets), giving rise to a 
distribution of solutions. The fitness of each solution was quantified by computing the 
correlation coefficient between the predicted and actual values of the eyelid magnitude (e*) 
in test trials (Fig. 4c). To test the redundancies of the neural code, we trained it on smaller 
subsets of neurons to assess the performance degradation (Fig. 4d) and compared its 
performance to the highest-correlation cell in the remaining subpopulation (Fig. 4d).
Redundancy calculation
Redundancy was quantified by dividing the maximum possible amount of Shannon 
information present in GrC population activity by the actual amount of information found in 
GrC-based predictions of CR amplitude. The mutual information, M, between the regressor 
(or a single-neuron signal) prediction and eyeblink output amplitudes was calculated as M = 
−1/2 log2 (1 − r2), where r is the Pearson correlation coefficient between the predicted and 
actual eyeblink amplitude, calculated on a trial-by-trial basis. This expression is equivalent 
to M = 1/2 log2 (v/vδ), where v is the variance in eyelid position across trials and vδ is the 
residual variance that is unexplained by the regressor or single-neuron signal. The 
redundancy was calculated as Λ = ΣMi/Mregressor,, where the summation occurs across all 
individual neurons, i.
Giovannucci et al.
Page 13
Nat Neurosci. Author manuscript; available in PMC 2018 May 01.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 Statistics
Most of the statistics and grouping were performed using Python pandas (http://
pandas.pydata.org/). Values in text are reported as mean ± s.d. unless otherwise indicated. 
When reported, P-values are calculated employing two-tailed unpaired or paired t-tests. 
Regarding the assumption of normality, amplitudes and granule-cell fluorescence signals 
appeared bimodal when pooled across all trials and unimodal when sorted into responding 
(CR+) and nonresponding (CR−) trials. Therefore, sorted trials were used for statistical 
analysis. All the statistics on neural activity or behavior were calculated only if at least ten 
cells or at least eight trials were available per FOV or session, excepting UR-related 
computation, for which the number was lowered to four trials. Because we imaged anywhere 
from 30 to 400 GrCs per mouse, to obtain a uniformly distributed sample across mice (Fig. 
5e and Supplementary Fig. 8c), bootstrapping was done with 30 GrCs per animal. No 
statistical methods were used to predetermine sample sizes, but our sample sizes are similar 
to those reported in previous publications45. We also report the computed power of the study 
in the Supplementary Methods Checklist.
Histological procedures
Mice were anesthetized with pentobarbital and perfused with 4% paraformaldehyde. Brains 
were isolated and processed as previously described46,47. Following perfusion, brains were 
incubated in 10% sucrose, embedded in gelatin, rapidly frozen, sectioned coronally at 40 μm 
and collected in 0.1 M PBS. Sections were processed for immunohistology by washing with 
PBS and incubation in a blocking buffer (10% normal horse serum, 0.5% Triton X-100 in 
PBS) before a 3-d incubation at 4 °C in PBS buffer containing 2% NHS, 0.4% Triton X-100 
and the following primary antibodies: brains from mice used in the cerebellar-inactivation/
muscimol study (n = 5) were stained for zebrin bands using goat anti-aldolase-C antibody 
(sc-12065; Santa Cruz Biotechnology, 1:1,000, previously described in Zhou et al.48); brains 
from mice used for GrC identification and counts were stained with rabbit anti-GABAA α6 
receptor antibody (G0295; Sigma, 1:1,000, previously described in Jaarsma et al.47; n = 4 
mice; two C57BL/6J injected with AAV1.Syn.GCaMP6f.WPRE.SV40 virus and two B6.Cg-
Tg.NeuroD1-Cre.GN135Gsat mice injected with AAV1.CAG.Flex.GCaMP6f. 
WPRE.SV40). Viral injections and surgeries were performed as described above. One of the 
NeuroD1-cre mice used for histological studies was first used for in vivo calcium imaging 
experiments (Fig. 1e). Next, sections were washed in PBS, incubated for 2 h at room 
temperature (20–22 °C) in PBS buffer with secondary antibodies, counter stained with DAPI 
for 10 min (30 μl/mL) and mounted on glass slides with Vectashield antifade mounting 
medium (H-1000; Vector Laboratories, USA). Alexa Fluor 488-conjugated donkey anti-goat 
secondary antibody was used to visualize aldolase C immunoreactivity (Jackson 
ImmunoResearch, West Grove, PA; Invitrogen; 1:200) and Alexa Fluor 633-conjugated goat 
anti-rabbit secondary antibody (Jackson ImmunoResearch, West Grove, PA; Invitrogen; 
1:200) was used on brains incubated with rabbit anti-GABAA α6 receptor primary antibody. 
Sections stained for immunofluorescence were scanned with a Leica SP8 confocal laser-
scanning microscope (Leica Microsystems, Germany) using 10×, 40× and 63× objectives, 
hybrid (HyD) detectors for sensitive detection and sequential scan mode. To visualize 
expression of channelrhodopsin-2 in B6.Cg-Tg(Thy1-COP4/EYFP)18Gfng/J cerebellar 
Giovannucci et al.
Page 14
Nat Neurosci. Author manuscript; available in PMC 2018 May 01.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 tissue was cleared using passive clearing with CLARITY49 and imaged on a two-photon 
microscope under a 10× objective.
Characterization and quantification of GCaMP-positive cells
Cerebella of hSyn and NeuroD1-cre animals were sectioned coronally at 40 μm, processed 
for immunofluorescence staining of the GABAA α6 receptor and counterstained with DAPI 
as described above. All quantifications were performed manually in randomly selected 
FOVs of 104 μm2 using the ImageJ plugin Cell Counter. For each section, DAPI-positive 
cells were counted and scored for the expression of GCaMP and costaining of GABAA α6 
receptors. Next, GCaMP-positive structures with cell-like characteristics (round shape, > 4.5 
μm) but without DAPI counterstaining were scored and analyzed for costaining of GABAA 
α6 receptors. For quantification, cells were subdivided into two groups according to size, 
4.5–7.5 μm and >7.5 μm, and further characterized as follows: (i) GrCs: GABA α6 receptor-
positive, DAPI positive and 4.5–7.5 μm in size; (ii) non-GrCs: DAPI-positive, GCaMP-
positive structures >7.5 μm; and (iii) ‘potential’ GrCs: GCaMP-positive, DAPI-negative 
structures of 4.5–7.5 μm in size. Because of the limited number of large cells, to get a better 
estimate of cells >7.5 μm, we included counts of complete lobules (tile scan; ~25× bigger 
FOV) and normalized the counts to a FOV of 104 μm2. All cell count analysis was 
performed blind with respect to the genotype of the animal.
Acute brain slice experiments
Mossy fiber stimulation recordings and calcium imaging of GrCs: seven male, 6-week-old 
C5B7L/J6 mice were anesthetized with isoflurane and injected in lobule VIb with 
AAV1.Syn.GCaMP6f.WPRE.SV40 virus as described in the “Animal preparation” section, 
above. Four to 5 weeks later, 250-μm-thick sagittal cerebellar brain slices were prepared 
using ceramic blades (Lafayette Instrument Co., Lafayette, IN) on a vibratome (VT1000S, 
Leica, Germany) set to speed 1.0–2.5 and frequency 8–9 under immersion in oxygenated, 
ice-cold (~4 °C) artificial CSF (aCSF) containing (in mM) 126 NaCl, 3 KCl, 1 NaH2PO4, 20 
d-glucose, 25 NaHCO3, 2 CaCl2 and 1 MgCl2. Brain slices were preincubated at 34 °C for 
40–60 min, then kept at room temperature. For recording, slices were transferred to an 
immersion-type recording chamber perfused at 2–4 mL/min with oxygenated aCSF at 
~34 °C. For extracellular mossy fiber stimulation, a large patch electrode filled with aCSF 
was positioned at the surface of the slice. GrCs were imaged using a custom-built two-
photon laser scanning microscope using pulsed 900-nm excitation from a Ti:sapphire laser 
(Mira 900, Coherent). Excitation power was kept below 15 mW at the backplane of the 
objective (40×, NA 0.8, IR-Achroplan; Carl Zeiss, Thornwood, NY). Data acquisition was 
controlled by ScanImage v 3.6.1 (Vidrio Technologies).
Loose patch recordings/stimulation and calcium imaging of GrCs: eight male mice were 
used. Unless reported, animal and slice preparation was done as described above. Cerebella 
were removed and dissected in ice-cold oxygenated slicing medium containing (in mM): 93 
n-methyl-d-glucamine, 93 HCl, 2.5 KCl, 5 sodium ascorbate, 2 thiourea, 3 sodium pyruvate, 
0.5 CaCl2, 10 MgCl2, 30 NaHCO3, 1.2 NaH2PO4, 20 HEPES and 25 d-glucose (mOsm 300, 
pH 7.4). We cut 250-μm sagittal slices of the vermis on a vibratome (VT2000S, Leica, 
Germany). Slices were incubated in slicing medium at near-physiological temperature 
Giovannucci et al.
Page 15
Nat Neurosci. Author manuscript; available in PMC 2018 May 01.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 (34 °C) for 2 min and transferred to 34 °C aCSF for 30 min. Subsequently, slices were held 
in a chamber filled with oxygenated aCSF at room temperature, covered with aluminum foil 
to prevent too much light exposure and used within 6 h. Experiments were performed in 
aCSF at near-physiological temperature (~33 °C). Loose cell-attached recordings were 
performed under a multiphoton microscope (A1R MP+, Nikon, Japan) and Axon 
Multiclamp 700A amplifier. The patch pipettes (7–9 MΩ) were filled with intracellular 
solution containing (in mM): 120 potassium-gluconate, 9 KCl, 10 KOH, 3.48 MgCl2, 4 
NaCl, 10 HEPES, 4 Na2ATP, 0.4 Na3GTP, 17.5 sucrose and 10–20 μm Alexa Fluor 594 (at 
pH 7.25). To reliably elicit action potential firing in granule and Golgi cells, 100–200 mV of 
voltage steps lasting 1 ms were delivered through the patch pipettes. Imaging data was 
collected using NIS-Elements software (Nikon Instruments). Signals were synchronized 
using imaging software as an external trigger for the Axon Multiclamp 700A amplifier. 
Calcium imaging was acquired at 30 Hz (1 ms per line, bidirectional scanning).
Cerebellar inactivation experiments
Five male C5B7L/6J mice were equipped with a 3-mm-wide cranial window covered by a 
silicone plug (Kwik-Sil, WPI) and a custom-made two-piece headplate (see “Animal 
preparation” section, above, for details). Following a 3-d recovery period, mice were 
habituated and trained in the custom-built eyeblink setup described earlier34,50. Mice were 
habituated for 5 d and then trained for up to 1 h/d for a period of 11 d.
The US and CS were delivered as described above. For CS, a flash of light (400 nm, 500 ms, 
contralateral to the US) was used for all conditional mice. On average, mice received 220 
trials per d (200 CS–US paired trails and 20 CS-only probe trials). For randomization 
purposes, the stimuli were randomly presented, with 80% CS + US, 10% CS alone, 10% US 
alone. After 11 d of training, all mice reached stable performance levels (CR production 
~80%). On day 12, the first inactivation experiment was performed. Mice first received 110 
baseline trials (100 CS–US paired trails and 10 CS-only trials), and then they were taken out 
of the setup, lightly anesthetized with isoflurane and fixed in a stereotactic frame. The 
silicone plug was removed and 100-nL injections of either 0.5% muscimol (Tocris with 1% 
Evans Blue) dissolved in sterile saline (0.9% NaCl, Hospira) or the vehicle (saline) were 
given at the same coordinates used for imaging neural responses. In order to reach the GrC 
layer and ensure the reproducibility of the injection size, injections were made ~300 μm 
deep from the surface of the brain using a Nanoject II Auto-Nanoliter Injector (Drummond 
Scientific Company, USA). After injections, the brain was covered with the plug, mice were 
placed back in the setup, and after 15 min recovery time, they were subjected to 110 
eyeblink conditioning trials (100 CS–US paired trials and 10 CS-only trials). The next day 
(day 13) the inactivation experiment was repeated but the drug/vehicle condition was 
switched, meaning that mice that had received saline on day 12 were injected with 0.5% 
muscimol, and mice that had been injected with the drug received the vehicle. Immediately 
after acquiring the postinjection trials, an overdose of sodium pentobarbital (0.15 mL i.p.) 
was administered allowing transcardial perfusion (0.9% NaCl followed by 4% 
paraformaldehyde in 0.1 M phosphate buffer (PB); pH = 7.4) to preserve the tissue for 
histological verification of the injections. Data analysis was performed blind to the 
conditions of the experiments.
Giovannucci et al.
Page 16
Nat Neurosci. Author manuscript; available in PMC 2018 May 01.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 Data availability statement
The data that support the findings of this study are available from the corresponding author 
upon reasonable request. The code for calcium analysis is available for download from 
https://github.com/simonsfoundation/CaImAn (release 0.5, El Cocodrilo).
Supplementary Material
Refer to Web version on PubMed Central for supplementary material.
Acknowledgments
The authors thank L. Lynch for expert laboratory assistance, A.C.H.G. Ijpelaar for technical assistance and Dr. H. 
Boele of the Neuroscience department at the Erasmus Medical Center for their input in eyeblink recordings, M.J. 
Berry II for discussion of the information calculation, D. Dombeck, J.P. Rickgauer and C. Domnisoru for 
experimental advice, and D. Pacheco-Pinedo, J.L. Verpeut, P. Sanchez-Jauregui and I. Witten for comments and 
suggestions. This work was supported by National Institutes of Health grants R01 NS045193 (S.W.) and R01 
MH093727 (J.M.), New Jersey Council on Brain Injury Research fellowship CBIR12FEL031 (A.G.), the Searle 
Scholars program (J.M.), DARPA N66001- 15-C-4032 (L.P.), National Science Foundation Graduate Research 
Fellowship DGE-1148900 (T.P.), the Nancy Lurie Marks Family Foundation (S.W.), the Netherlands Organization 
for Scientific Research (Innovational Research Incentives Scheme Veni; A.B. and Z.G.), the Dutch Fundamental 
Organization for Medical Sciences (ZonMW; C.I.D.Z.), Life Sciences (NWO-ALW; C.I.D.Z.) and Social and 
Behavioral Sciences (NWO-MAGW; C.I.D.Z.), as well as ERC-adv and ERC-POC (C.I.D.Z.).
References
1. Ito M. Cerebellar circuitry as a neuronal machine. Prog Neurobiol. 2006; 78:272–303. [PubMed: 
16759785] 
2. Arenz A, Bracey EF, Margrie TW. Sensory representations in cerebellar granule cells. Curr Opin 
Neurobiol. 2009; 19:445–451. [PubMed: 19651506] 
3. Marr D. A theory of cerebellar cortex. J Physiol (Lond). 1969; 202:437–470. [PubMed: 5784296] 
4. Albus JS. A theory of cerebellar function. Math Biosci. 1971; 10:25–61.
5. Spanne A, Jörntell H. Questioning the role of sparse coding in the brain. Trends Neurosci. 2015; 
38:417–427. [PubMed: 26093844] 
6. Huang CC, et al. Convergence of pontine and proprioceptive streams onto multimodal cerebellar 
granule cells. Elife. 2013; 2:e00400. [PubMed: 23467508] 
7. Houck BD, Person AL. Cerebellar premotor output neurons collateralize to innervate the cerebellar 
cortex. J Comp Neurol. 2015; 523:2254–2271. [PubMed: 25869188] 
8. Heiney SA, Wohl MP, Chettih SN, Ruffolo LI, Medina JF. Cerebellar-dependent expression of 
motor learning during eyeblink conditioning in head-fixed mice. J Neurosci. 2014; 34:14845–
14853. [PubMed: 25378152] 
9. Eccles JC, Faber DS, Murphy JT, Sabah NH, Táboríková H. Afferent volleys in limb nerves 
influencing impulse discharges in cerebellar cortex. I In mossy fibers and granule cells. Exp Brain 
Res. 1971; 13:15–35. [PubMed: 4936708] 
10. Powell K, Mathy A, Duguid I, Häusser M. Synaptic representation of locomotion in single 
cerebellar granule cells. Elife. 2015; 4:e07290.
11. van Beugen BJ, Gao Z, Boele HJ, Hoebeek F, De Zeeuw CI. High frequency burst firing of granule 
cells ensures transmission at the parallel fiber to Purkinje cell synapse at the cost of temporal 
coding. Front Neural Circuits. 2013; 7:95. [PubMed: 23734102] 
12. Medina JF, Mauk MD. Computer simulation of cerebellar information processing. Nat Neurosci. 
2000; 3(Suppl):1205–1211. [PubMed: 11127839] 
13. Freeman JH, Steinmetz AB. Neural circuitry and plasticity mechanisms underlying delay eyeblink 
conditioning. Learn Mem. 2011; 18:666–677. [PubMed: 21969489] 
14. Shadmehr R, Smith MA, Krakauer JW. Error correction, sensory prediction, and adaptation in 
motor control. Annual Rev Neurosci. 2010; 33:89–108. [PubMed: 20367317] 
Giovannucci et al.
Page 17
Nat Neurosci. Author manuscript; available in PMC 2018 May 01.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 15. Wolpert DM, Miall RC, Kawato M. Internal models in the cerebellum. Trends Cogn Sci. 1998; 
2:338–347. [PubMed: 21227230] 
16. Ozden I, Dombeck DA, Hoogland TM, Tank DW, Wang SSH. Widespread state-dependent shifts in 
cerebellar activity in locomoting mice. PLoS One. 2012; 7:e42650. [PubMed: 22880068] 
17. Kuhn B, Ozden I, Lampi Y, Hasan MT, Wang SSH. An amplified promoter system for targeted 
expression of calcium indicator proteins in the cerebellar cortex. Front Neural Circuits. 2012; 6:49. 
[PubMed: 22866030] 
18. Yaguchi M, et al. Characterization of the properties of seven promoters in the motor cortex of rats 
and monkeys after lentiviral vector-mediated gene transfer. Hum Gene Ther Methods. 2013; 
24:333–344. [PubMed: 23964981] 
19. Boele HJ, Koekkoek SKE, De Zeeuw CI. Cerebellar and extracerebellar involvement in mouse 
eyeblink conditioning: the ACDC model. Front Cell Neurosci. 2010; 3:19. [PubMed: 20126519] 
20. Thompson RF, Krupa DJ. Organization of memory traces in the mammalian brain. Annu Rev 
Neurosci. 1994; 17:519–549. [PubMed: 8210186] 
21. Heiney SA, Kim J, Augustine GJ, Medina JF. Precise control of movement kinematics by 
optogenetic inhibition of Purkinje cell activity. J Neurosci. 2014; 34:2321–2330. [PubMed: 
24501371] 
22. Hesslow G. Correspondence between climbing fibre input and motor output in eyeblink-related 
areas in cat cerebellar cortex. J Physiol (Lond). 1994; 476:229–244. [PubMed: 8046640] 
23. Mostofi A, Holtzman T, Grout AS, Yeo CH, Edgley SA. Electrophysiological localization of 
eyeblink-related microzones in rabbit cerebellar cortex. J Neurosci. 2010; 30:8920–8934. 
[PubMed: 20592214] 
24. Najafi F, Giovannucci A, Wang SSH, Medina JF. Sensory-driven enhancement of calcium signals 
in individual Purkinje cell dendrites of awake mice. Cell Rep. 2014; 6:792–798. [PubMed: 
24582958] 
25. Najafi F, Giovannucci A, Wang SSH, Medina JF. Coding of stimulus strength via analog calcium 
signals in Purkinje cell dendrites of awake mice. Elife. 2014; 3:e03663. [PubMed: 25205669] 
26. Pnevmatikakis EA, et al. Simultaneous denoising, deconvolution, and demixing of calcium 
imaging data. Neuron. 2016; 89:285–299. [PubMed: 26774160] 
27. Narayanan NS, Kimchi EY, Laubach M. Redundancy and synergy of neuronal ensembles in motor 
cortex. J Neurosci. 2005; 25:4207–4216. [PubMed: 15858046] 
28. Puchalla JL, Schneidman E, Harris RA, Berry MJ. Redundancy in the population code of the 
retina. Neuron. 2005; 46:493–504. [PubMed: 15882648] 
29. Freeman JH. Cerebellar learning mechanisms. Brain Res. 2015; 1621:260–269. [PubMed: 
25289586] 
30. Gao Z, et al. Excitatory cerebellar nucleocortical circuit provides internal amplification during 
associative conditioning. Neuron. 2016; 89:645–657. [PubMed: 26844836] 
31. Ankri L, et al. A novel inhibitory nucleo-cortical circuit controls cerebellar Golgi cell activity. 
Elife. 2015; 4:e06262.
32. Jörntell H. Cerebellar physiology: links between microcircuitry properties and sensorimotor 
functions. J Physiol (Lond). 2017; 595:11–27. [PubMed: 27388692] 
33. Medina JF, Lisberger SG. Variation, signal, and noise in cerebellar sensory-motor processing for 
smooth-pursuit eye movements. J Neurosci. 2007; 27:6832–6842. [PubMed: 17581971] 
34. ten Brinke MM, et al. Evolving models of Pavlovian conditioning: cerebellar cortical dynamics in 
awake behaving mice. Cell Rep. 2015; 13:1977–1988. [PubMed: 26655909] 
35. Lisberger SG, Medina JF. How and why neural and motor variation are related. Curr Opin 
Neurobiol. 2015; 33:110–116. [PubMed: 25845626] 
36. Jirenhed DA, Hesslow G. Are Purkinje cell pauses drivers of classically conditioned blink 
responses? Cerebellum. 2016; 15:526–534. [PubMed: 26400585] 
37. Lee KH, et al. Circuit mechanisms underlying motor memory formation in the cerebellum. Neuron. 
2015; 86:529–540. [PubMed: 25843404] 
38. Billings G, Piasini E, Lőrincz A, Nusser Z, Silver RA. Network structure within the cerebellar 
input layer enables lossless sparse encoding. Neuron. 2014; 83:960–974. [PubMed: 25123311] 
Giovannucci et al.
Page 18
Nat Neurosci. Author manuscript; available in PMC 2018 May 01.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 39. Lubow RE. Latent inhibition. Psychol Bull. 1973; 79:398–407. [PubMed: 4575029] 
40. Wang H, et al. High-speed mapping of synaptic connectivity using photostimulation in 
channelrhodopsin-2 transgenic mice. Proc Natl Acad Sci USA. 2007; 104:8143–8148. [PubMed: 
17483470] 
41. Zuiderveld, K. Contrast limited adaptive histogram equalization. In: Heckbert, PS., editor. Graphics 
Gems IV. Academic Press Professional, Inc; 1994. p. 474-485.
42. Dalal, N., Triggs, B. Histograms of oriented gradients for human detection. IEEE Computer 
Society Conference on Computer Vision and Pattern Recognition; 2005. p. 886-893.
43. Otsu N. A threshold selection method from gray-level histograms. IEEE Trans Syst Man Cybern. 
1979; 9:62–66.
44. Myronenko A, Song X. Point set registration: coherent point drift. IEEE Trans Pattern Anal Mach 
Intell. 2010; 32:2262–2275. [PubMed: 20975122] 
45. Huber D, et al. Multiple dynamic representations in the motor cortex during sensorimotor learning. 
Nature. 2012; 484:473–478. [PubMed: 22538608] 
46. Badura A, et al. Climbing fiber input shapes reciprocity of Purkinje cell firing. Neuron. 2013; 
78:700–713. [PubMed: 23643935] 
47. Jaarsma D, et al. A role for bicaudal-D2 in radial cerebellar granule cell migration. Nat Commun. 
2014; 5:3411. [PubMed: 24614806] 
48. Zhou H, et al. Cerebellar modules operate at different frequencies. Elife. 2014; 3:e02536. 
[PubMed: 24843004] 
49. Chung K, Deisseroth K. CLARITY for mapping the nervous system. Nat Methods. 2013; 10:508–
513. [PubMed: 23722210] 
50. Kloth AD, et al. Cerebellar associative sensory learning defects in five mouse autism models. Elife. 
2015; 4:e06085. [PubMed: 26158416] 
Giovannucci et al.
Page 19
Nat Neurosci. Author manuscript; available in PMC 2018 May 01.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 Figure 1. 
GCaMP expression and signals in cerebellar GrCs. (a) Dorsal view of the cerebellum with 
imaged area of lobule VI indicated in green. (b) GABAA α6 staining (red) highlights dense 
virally driven expression of GCaMP6f (green) in GrCs (GrCs; each FOV of 100 × 100 μm 
contained an average of 187 GrCs; 20 FOVs and 2 mice per expression strategy, NeuroD1-
cre and hSyn). Note the absence of GCaMP signal in the mossy fiber (mf) bundle and 
Purkinje cells (asterisks). Arrows indicate putative Golgi or Lugaro cells. (c) Top: three 
panels show (from top to bottom) two-photon imaging FOV in the granular layer, overlaid 
with a subset of spatial components identified by NMF and classified as GrCs (red) or a 
putative Golgi cell (green, G) and the same GrCs on a dark background. Bottom: GrC 
fluorescence traces and corresponding spatial mask. (d) Two-photon imaging of parallel 
fiber activity. Top: an example FOV without and with manually selected regions of interest. 
Bottom left: fluorescence traces. Bottom right: cross-correlations reveal high correlation 
between mediolaterally aligned boutons. (e) Coronal cerebellar sections of the mouse shown 
in d, counterstained for GABAA α6. Arrows point to a parallel fiber expressing GCaMP6f. 
(f) Fluorescent traces from parallel fiber boutons recorded from a trained mouse, aligned to 
corneal airpuffs and light flashes.
Giovannucci et al.
Page 20
Nat Neurosci. Author manuscript; available in PMC 2018 May 01.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 Figure 2. 
Role of imaged regions in eyeblink conditioning. (a) Task schematic. CS (ultraviolet LED 
flash to the contralateral eye or weak puff to the ipsilateral vibrissa) and US (periorbital 
airpuff) were delivered to a head-fixed mouse on a freely moving treadmill while blinks, 
snout movement, body movement and treadmill rotation were monitored by high-speed 
infrared camera (100 frames/s) and (in some experiments) a magnet attached to the lower 
eyelid. (b) CRs, quantified as eyelid closure as a fraction of US response, during CS–US 
paired trials in a single animal. Green (CS, light) and red (US, airpuff) shaded zones indicate 
stimulus presentations. Blue shaded zone indicates time window for computing e*, eyelid 
movement as a measure of CR amplitude. (c) Evolution of learning in 6 animals trained for 
up to 12 consecutive d (2 mice trained with whisker CS, open squares; 4 mice trained with 
light CS, closed gray diamonds; average indicated by open circles). Error bars for the 
averaged plot indicate ± s.e.m. (d) Left: focal injection of muscimol, but not saline vehicle, 
led to a reduction in the percentage of CRs (muscimol (drug) versus saline CR probability, P 
= 0.005, paired t-test; each line represents one animal). Filled symbols depict data for the 
example mouse shown in e. Right: focal injection of muscimol, but not saline vehicle, led to 
a reduction in the amplitude of CRs (muscimol versus saline CR, P = 0.026, paired t-test; n 
= 5). Blue and red dots depict averages. Error bars indicate ± s.e.m. (e) Example of the 
inactivation experiment in one mouse (filled diamonds in d, left). Left: a coronal cerebellar 
section counterstained with DAPI (blue) and aldolase C (green) reveals the injection position 
(red, muscimol + Evans Blue). Right: individual (light gray) and averaged (black) eyelid 
responses during baseline trials before injections and after drug or saline injections.
Giovannucci et al.
Page 21
Nat Neurosci. Author manuscript; available in PMC 2018 May 01.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 Figure 3. 
Calcium signals of a single GrC during eyeblink conditioning. (a) Eyelid movement (left), 
locomotion activity (center) and single-cell calcium signal (right) from one neuron followed 
over 9 d of training. Each horizontal line represents a single trial. Date labels indicate the 
start of a day’s training, and unlabeled ticks indicate the start of a new session within the 
same day. Vertical solid lines indicate onset and offset of CS stimulus. Dashed vertical lines 
indicate delivery time of the US stimulus. (b) Top: data from the last 3 d of training, resorted 
according to whether the CS did (CR+, middle) or did not (CR−, top) evoke an anticipatory 
eyelid closure before the US. Trials with significant locomotion (> 2 cm/s) during the CS are 
excluded. Bottom left: overlaid average eyelid responses in US trials (cyan) and at the final 
stage of training when the animal did (CR+, black) or did not (CR−, red) produce a CR. 
Bottom middle: overlaid average locomotion speeds during US, CR+ and CR− trials. Bottom 
right: overlaid average calcium signals during US, CR+ and CR− trials. f* is the integral of 
the neural response in an 85-ms window before the UR.
Giovannucci et al.
Page 22
Nat Neurosci. Author manuscript; available in PMC 2018 May 01.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 Figure 4. 
Cerebellar GrCs acquire a neural correlate of the learned conditional response. (a) Top: in a 
mouse trained with light CS, average CR amplitude (first column) and fluorescence 
responses (second column) for populations of GrCs grouped by trial type (n = 29 neurons). 
US, cyan; CR+ trials, black; CR− trials, red. Bottom: same results for a mouse trained with 
whisker CS (N = 60 neurons). Behavioral and neural traces averaged over an 85-ms time 
window (brackets) preceding the UR for eyelid responses (e*) and fluorescence response 
(f*). Shaded regions in the right column represent the amount of GrC response in CR− trials 
(red) and the excess GrC response in CR+ vs. CR− trials (black). (b) Top: evolution of the 
calcium response during 9 d of conditioning to a CS light stimulus, shown separately for 
CR+ (left) and CR− (right) trials in 29 individual GrCs from a single animal. Gray indicates 
that not enough trials (5) were available to compute a value. Middle: average calcium 
responses for the 29 GrCs in the population as a function of training day. Responses before 
and after training were significantly different (paired t-test, P = 5.7 × 10−7). Bottom: eyelid 
response and locomotion for CR+ and CR− trials. Error bars indicate ± s.e.m. (c) Evolution 
of GrC calcium responses across all animals (n = 6). Plotted values show average ± s.e.m. 
calculated by bootstrap-resampling (n = 480 neurons, eyelid-amplitude CR+ trials; n = 1,120 
cells, eyelid-amplitude CR− trials; n = 459 neurons, percentage responses CR+ trials; n = 
1,109 neurons, percentage responses CR− trials) to obtain equal weighting among FOVs 
across 6 mice. Left: 0–20%, 20–40%, 40–60%, 60–80% and 80–100% of CRs. Right: blocks 
of trials sorted by e*. For the significant bins, from left to right, t-tests: CR+ vs. CR−, P = 2.5 
× 10−4, 7.8 × 10−3 and 6.1 × 10−4 (left), and P = 0.041 and 1.6 × 10−4, 08.1 × 10−6 (right). 
Error bars indicate ± s.e.m. *P < 0.05; **P < 0.01; ***P < 0.001; ****P < 0.0001. (d) 
Histograms of GrC responses in 2 fully trained mice (one trained with whisker CS and one 
with light CS; for other mice see Supplementary Fig. 8d). Each histogram bar represents the 
response of a single GrC to a CS stimulus without wheel movement. Red histograms, ΔF/F 
for trials with no conditional response (CR−, same time bin as f*); black histograms, 
difference in ΔF/F between CR+ and CR− trial responses for the same cells, i.e., the CR+ 
excess (same time bin as f*); n = 60 cells, light CS; n = 60 cells, whisker CS.
Giovannucci et al.
Page 23
Nat Neurosci. Author manuscript; available in PMC 2018 May 01.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 Figure 5. 
GrCs simultaneously express correlates of eyeblink, locomotion and snout movement. (a) 
Simultaneous recording of three GrCs whose calcium signals (black) were correlated with 
eyelid (magenta), wheel (orange) or snout (cyan) movements. Pearson correlations over one 
day’s recording session are given in the left column. Dashed traces superimposed on the 
calcium signals are the same movement-related traces shown in the panels above. (b) In a 
single GrC, eyelid responses to CS presentation (e*) as a function of fluorescence signal 
(f*). Error bars indicate ± s.e.m. (c) Left: in a single GrC, US-only presentation caused a 
range of eyelid response amplitudes (URs) concurrent with changes in f*. Right: eyelid 
closure amplitude as a function of neural activity in a single GrC, averaged across US-only 
trials. (d) Examples of GrCs with high correlations to two behavioral parameters. (e) In three 
mice with the strongest learning and a high CR rate, tuning of all imaged GrCs (gray lines 
and open circles) to eyelid CR, snout movement, wheel speed and eyelid UR amplitude. 
Tunings corresponding to the GrCs in a (colored lines and circles) and d (black lines and 
circles) are highlighted. Bottom: the distribution of GrCs with strongest correlation to each 
individual behavior. Asterisks indicate US-alone trials.
Giovannucci et al.
Page 24
Nat Neurosci. Author manuscript; available in PMC 2018 May 01.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
 Figure 6. 
Redundancy in the GrC representation of learned responses. (a) For one example mouse, a 
histogram of Pearson correlations for all neurons (red, values larger than the shuffled range 
shown). The black dashed line indicates the Pearson correlation between the output of the 
population multivariate regressor and the actual eyelid response (e*) for multiple runs. Gray 
shading indicates the ± 1 s.d. range of regressor performance. The cyan band indicates the 
correlations for single cells when the eyelid responses in individual trials are randomly 
shuffled. (b) Information content of the population regressor (black) as a function of the 
number of neurons included. The red curve indicates the maximum possible information in 
the case of no redundancy.
Giovannucci et al.
Page 25
Nat Neurosci. Author manuscript; available in PMC 2018 May 01.
Author Manuscript
Author Manuscript
Author Manuscript
Author Manuscript
