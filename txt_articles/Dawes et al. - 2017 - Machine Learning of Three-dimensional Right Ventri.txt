 Original research n CardiaC imaging
Radiology: Volume 283: Number 2—May 2017 n radiology.rsna.org 
381
1 From the MRC Clinical Sciences Centre, Du Cane Rd, Lon-
don W12 0NN, England (T.J.W.D., A.d.M., W.S., T.F., S.A.C., 
D.P.O.); Division of Experimental Medicine, Department 
of Medicine (T.J.W.D, T.F., G.M.J.W., J.W., C.J.R., M.R.W.), 
Department of Computing (W.S., D.R.), and National Heart 
and Lung Institute (J.S.R.G.), Imperial College London, 
London, England; National Heart Centre Singapore, Singa-
pore and Duke-NUS Graduate Medical School, Singapore 
(S.A.C.); and Department of Cardiology, National Pulmonary 
Hypertension Service, Imperial College Healthcare NHS 
Trust, London, England (L.S.G.E.H., J.S.R.G.). Received June 
9, 2016; revision requested August 18; revision received 
October 11; accepted October 23; final version accepted 
October 25. Address correspondence to D.P.O. (e-mail: 
declan.oregan@imperial.ac.uk).
Study supported by the Wellcome Trust (100211/Z/12/Z), 
the British Heart Foundation (PG/12/27/29489, 
SP/10/10/28431), the Medical Research Council, and the 
National Institute for Health Research.
Published under a CC BY-NC-ND 4.0 license.
Purpose:
To determine if patient survival and mechanisms of right 
ventricular failure in pulmonary hypertension could be 
predicted by using supervised machine learning of three-
dimensional patterns of systolic cardiac motion.
Materials and 
Methods:
The study was approved by a research ethics committee, 
and participants gave written informed consent. Two hun-
dred fifty-six patients (143 women; mean age 6 standard 
deviation, 63 years 6 17) with newly diagnosed pulmo-
nary hypertension underwent cardiac magnetic resonance 
(MR) imaging, right-sided heart catheterization, and 6-mi-
nute walk testing with a median follow-up of 4.0 years. 
Semiautomated segmentation of short-axis cine images 
was used to create a three-dimensional model of right ven-
tricular motion. Supervised principal components analysis 
was used to identify patterns of systolic motion that were 
most strongly predictive of survival. Survival prediction 
was assessed by using difference in median survival time 
and area under the curve with time-dependent receiver 
operating characteristic analysis for 1-year survival.
Results:
At the end of follow-up, 36% of patients (93 of 256) died, 
and one underwent lung transplantation. Poor outcome 
was predicted by a loss of effective contraction in the sep-
tum and free wall, coupled with reduced basal longitudinal 
motion. When added to conventional imaging and hemo-
dynamic, functional, and clinical markers, three-dimen-
sional cardiac motion improved survival prediction (area 
under the receiver operating characteristic curve, 0.73 vs 
0.60, respectively; P , .001) and provided greater differ-
entiation according to difference in median survival time 
between high- and low-risk groups (13.8 vs 10.7 years, 
respectively; P , .001).
Conclusion:
A machine-learning survival model that uses three-dimen-
sional cardiac motion predicts outcome independent of 
conventional risk factors in patients with newly diagnosed 
pulmonary hypertension.
Published under a CC BY-NC-ND 4.0 license.
Online supplemental material is available for this article.
Timothy J. W. Dawes, FRCA, PhD
Antonio de Marvao, MRCP, PhD
Wenzhe Shi, PhD
Tristan Fletcher, PhD, MSc
Geoffrey M. J. Watson, MRCP
John Wharton, PhD
Christopher J. Rhodes, PhD
Luke S. G. E. Howard, FRCP, DPhil
J. Simon R. Gibbs, MD, FRCP
Daniel Rueckert, PhD
Stuart A. Cook, FRCP, PhD
Martin R. Wilkins, MD, FMedSci
Declan P. O’Regan, FRCR, PhD
Machine learning of Three-
dimensional right Ventricular 
Motion enables Outcome 
Prediction in Pulmonary 
hypertension: A Cardiac MR 
Imaging Study1
This copy is for personal use only. To order printed copies, contact reprints@rsna.org
 382 
radiology.rsna.org n Radiology: Volume 283: Number 2—May 2017
CARDIAC IMAGING: Machine Learning of Three-dimensional Right Ventricular Motion in Pulmonary Hypertension 
Dawes et al
and October 2013 were included in the 
study, with end of follow-up in Sep-
tember 2014. Criteria for inclusion in-
cluded a documented diagnosis of PH 
by means of right-sided heart catheter-
ization (RHC) with a resting mean pul-
monary artery pressure of at least 25 
mm Hg. Clinical classification was per-
formed according to European guide-
lines (1), and patients with congenital 
shunts, arrhythmias that prevented 
cardiac gating, or more than 3 months 
between baseline investigations were 
excluded. All patients were treated 
with standard therapy in accordance 
with current guidelines and National 
Health Service England treatment pol-
icy (10).
RHC Procedure
RHC was performed by certified inter-
ventionists with a balloon-tipped, flow-
directed Swan-Ganz catheter (Baxter 
Healthcare, Irvine, Calif) to derive 
cardiac output, cardiac index, mean 
pulmonary artery pressure, pulmonary 
capillary wedge pressure, and pulmo-
nary vascular resistance. Six-minute 
walk distance was measured according 
to American Thoracic Society guide-
lines (11).
(MR) imaging, which provides an 
accurate assessment of cardiac func-
tional status; however, realizing the 
full predictive potential of cardiac 
imaging requires methods capable 
of selecting the most relevant and 
meaningful prognostic features (6). 
Computational image analysis coupled 
with machine learning could enable 
discovery of the complex functional 
adaptations that can be used to pre-
dict eventual right-sided heart failure 
and death. Unlocking the full poten-
tial of diagnostic imaging in this way 
has become feasible with advances in 
computational modeling of the struc-
ture and function of the heart (7–9). 
The purpose of the present study was 
to determine if patient survival and 
mechanisms of RV failure in PH could 
be predicted by using supervised 
machine learning of three-dimension-
al (3D) patterns of systolic cardiac 
motion.
Materials and Methods
Study Population
This study was part of a continuous 
prospective research program into the 
prognosis of patients with PH by using 
conventional clinical and imaging bio-
markers. The program had ethics com-
mittee approval, and all patients gave 
written informed consent. Our com-
putational analysis was retrospectively 
performed on the data for the UK Dig-
ital Heart Project (http://digital-heart.
org). Patients referred to the National 
Pulmonary Hypertension Service at the 
Imperial College Healthcare NHS Trust 
for routine diagnostic assessment and 
cardiac imaging between May 2004 
Published online before print
10.1148/radiol.2016161315 Content codes: 
 
Radiology 2017; 283:381–390
Abbreviations:
PH = pulmonary hypertension
RHC = right-sided heart catheterization
ROC = receiver operating characteristic
RV = right ventricular
3D = three-dimensional
Author contributions:
Guarantors of integrity of entire study, T.J.W.D., G.M.J.W., 
S.A.C., D.P.O.; study concepts/study design or data acquisi-
tion or data analysis/interpretation, all authors; manuscript 
drafting or manuscript revision for important intellectual 
content, all authors; approval of final version of submitted 
manuscript, all authors; agrees to ensure any questions 
related to the work are appropriately resolved, all authors; 
literature research, T.J.W.D., A.d.M., D.R., D.P.O.; clinical 
studies, T.J.W.D., A.d.M., G.M.J.W., L.S.G.E.H., M.R.W., 
D.P.O.; experimental studies, W.S., J.W.; statistical analysis, 
T.J.W.D., A.d.M., W.S., T.F., D.P.O.; and manuscript editing, 
T.J.W.D., A.d.M., W.S., G.M.J.W., J.W., L.S.G.E.H., J.S.R.G., 
D.R., S.A.C., M.R.W., D.P.O.
Conflicts of interest are listed at the end of this article.
Advances in Knowledge
 
n A disease-specific cardiac atlas 
can be used to create accurate 
(Hausdorff distance, 3.0 mm 6 
1.2) and reproducible (intraclass 
correlation coefficients for 
agreement of position in each 
axis, 0.98, 0.98, and 0.91; all P 
, .001) segmentations of the 
heart in pulmonary hypertension 
(PH) from conventional cardiac 
MR images.
 
n A supervised machine-learning 
survival model that includes three-
dimensional cardiac motion pro-
vides incremental prognostic 
benefit when compared with con-
ventional imaging and hemody-
namic, functional, and clinical 
markers (area under the receiver 
operating characteristic curve, 
0.73 vs 0.60, respectively [P , 
.001]; difference in median sur-
vival time between high- and low-
risk groups, 13.8 vs 10.7 years, 
respectively [P , .001]).
Implications for Patient Care
 
n Computational analysis of right 
ventricular motion in PH can be 
used for risk stratification and 
demonstrates early prognostic 
signs of dysfunction.
 
n Machine learning by using car-
diac MR imaging should be evalu-
ated as a tool to guide patient 
management.
P
ulmonary hypertension (PH) is 
a heterogeneous group of dis-
eases defined by a resting mean 
pulmonary artery pressure of at least 
25 mm Hg (1). PH may follow a rap-
idly progressive clinical course, with 
impaired exercise tolerance and dys-
pnea associated with right ventricular 
(RV) hypertrophy, right-sided heart 
dilatation, and, ultimately, cardiac 
failure (2). Outcome prediction in 
PH has been investigated extensively 
by using invasive hemodynamic data, 
serum biomarkers, exercise testing, 
and cardiac imaging. These markers 
consistently demonstrate that survival 
is related to functional adaptation of 
the right ventricle (3). RV ejection 
fraction is a measure of global systolic 
function that can be used to predict 
survival in patients with PH (4), al-
though the complex shape and con-
traction pattern of the right ventricle 
make this an insensitive assessment 
method for early cardiac decompen-
sation (5).
Patients investigated for PH routinely 
undergo cardiac magnetic resonance 
 Radiology: Volume 283: Number 2—May 2017 n radiology.rsna.org 
383
CARDIAC IMAGING: Machine Learning of Three-dimensional Right Ventricular Motion in Pulmonary Hypertension 
Dawes et al
derived from 47 patients with PH and 
were included in the Digital Heart Pro-
ject population data set for analysis of 
both shape and motion (16). Each voxel 
in the PH atlases was manually labeled 
as either cavity or myocardium in the 
left and right ventricles by using freely 
available software (ITKsnap, National 
Library of Medicine Insight Segmenta-
tion and Registration Toolkit; http://
www.itksnap.org/). With a multiatlas 
approach, the entire data set of labeled 
atlases was used, rather than relying on 
a model-based average representation 
(17). An approximate graph search was 
performed to find correspondences be-
tween small cubic regions, or patches, 
on the image to be segmented and the 
database of labeled atlases. Spectral em-
bedding by using a multilayered graph of 
the images was used to capture global 
shape properties. Finally, we estimated 
anatomic patch correspondences on the 
basis of a joint spectral representation 
of the image and atlases (14,18). The 
final segmentations were coregistered 
to an average template surface mesh, 
where vertex density was determined by 
curvature at each sampling point, allow-
ing cardiac shape or function within the 
population to be compared in a common 
space (freely available at https://github.
com/UK-Digital-Heart-Project).
images was made to ensure correct 
placement of the contours. Papillary 
muscles and trabeculae were included 
in the RV volume.
Three-dimensional Assessment of 
Ventricular Physiology
Atlas-based approaches for segment-
ing the right ventricle enabled a 3D 
model of RV structure and function to 
be constructed (14). To ensure a fair 
comparison, manual volumetry and 
computational analysis were both per-
formed with the same standard cardiac 
MR images.
All image processing was performed 
in Matlab (MathWorks, Natick, Mass). 
We used the short-axis cine images for 
each patient with PH and automatically 
aligned each set of end-diastolic and 
end-systolic images by minimizing the 
intensity differences between each sec-
tion (15). The segmentation process was 
then initialized by a reader (T.J.W
.D.) 
who placed six predefined anatomic 
landmarks on the target images (left 
ventricular apex, mitral annulus, and 
lateral wall; the RV free wall; and the su-
perior and inferior RV insertion points 
[Fig E1 {online}]). These landmarks 
were also defined on each labeled at-
las. Manually annotated cardiac atlases 
at end-diastole and end-systole were 
MR Imaging Protocol
Cardiac MR imaging was performed at 
a single site with a 1.5-T Achieva unit 
(Philips, Best, the Netherlands), and a 
standard clinical protocol was followed 
according to published international 
guidelines 
(12). 
Ventricular 
func-
tion was assessed by using balanced 
steady-state free-precession cine im-
ages acquired in conventional cardiac 
short- and long-axis planes with typical 
parameters: repetition time (msec)/
echo time (msec), 3.2/1.6; voxel size, 
1.5 3 1.5 3 8 mm; flip angle, 60°; 
sensitivity encoding factor, two; band-
width, 962 Hz per pixel; and temporal 
resolution, 29 msec. Reproducibility 
was assessed in 20 subjects undergo-
ing repeat studies on the same day. 
Images were stored in an open-source 
database (MRIdb; Imperial College 
London, London, England).
Quantification of RV Function
Volumetric analysis of cine images 
was performed by using a ViewForum 
(Philips), with one reader with 3 years 
of experience (T.J.W.D.) manually de-
fining the RV endocardial borders at 
end-diastole and end-systole by using a 
standard published protocol (13). Ref-
erence to the position of the pulmo-
nary and tricuspid valves on long-axis 
Figure 1
Figure 1: Example of computational modeling for a patient with idiopathic pulmonary arterial hypertension. A, Cine MR images were segmented by using prior 
knowledge from a set of disease-specific atlases. Here, the intensity image in the short-axis of the heart is overlaid with labels for left ventricular blood pool (red), 
myocardium (green), RV blood pool (yellow), and free wall (blue). B, A 3D model at end-diastole (gray) and end-systole (blue, right ventricle; and red, left ventricle) 
was used to determine the direction and magnitude of systolic excursion at each corresponding anatomic point in the mesh by using a deformable motion model. 
C, A statistical model of RV endocardial motion was used for feature selection to determine functional patterns associated with survival (relative weightings shown 
for the RV free wall).
 384 
radiology.rsna.org n Radiology: Volume 283: Number 2—May 2017
CARDIAC IMAGING: Machine Learning of Three-dimensional Right Ventricular Motion in Pulmonary Hypertension 
Dawes et al
end-diastolic volume, and stroke volume 
divided by RV end-systolic volume). 
Model 3 included the predictors in both 
models 1 and 2, as well as 3D motion. 
Models were optimized in the training 
data and then assessed in the unseen 
validation data by using eightfold cross-
validation (Fig 2) (21). In each fold, 224 
cases provided the training data for a 
predictive model, which was then eval-
uated on the held-out set of 32 cases 
until every patient had been in a valida-
tion set exactly once. Supervised prin-
cipal components analysis proceeded as 
follows: (a) A Cox proportional-hazards 
regression and classification problems 
by using complex input data (20).
The performance of each marker 
was tested as a predictor of survival in 
the whole data set, and significant uni-
variate predictors (P , .05) were car-
ried forward to three nested models de-
signed to test the incremental benefit of 
groups of predictors. Model 1 included 
the clinical, hemodynamic, and func-
tional predictors found to be significant 
in univariate prediction. Model 2 addi-
tionally included markers of MR volu-
metry (RV ejection fraction, indexed 
RV end-systolic volume, indexed RV 
Three-dimensional motion recon-
struction was performed by using tem-
poral sparse free-form registration to 
estimate cardiac motion between the 
two time points at end-diastole and 
end-systole (Fig 1) (19). For each en-
docardial vertex in the right ventricle 
(approximately 30 
000 data points), we 
calculated the direction and magnitude 
of systolic excursion—that is, the max-
imal displacement from the initial po-
sition in end-diastole. Each vector was 
then resolved into three perpendicular 
components (longitudinal, circumferen-
tial, and radial) relative to a long axis 
defined between the tricuspid orifice 
and RV apex. The resulting coregis-
tered 3D data set represented the sys-
tolic motion of the endocardial surface 
of the right ventricle and septum in the 
PH cohort. Patterns of 3D motion asso-
ciated with survival were then assessed 
with supervised principal components 
analysis. Accuracy was assessed by 
comparing manual and semiautomated 
segmentations by using leave-one-out 
cross-validation, and repeatability was 
evaluated by measuring the agreement 
between the two studies.
Statistical Analysis
Data were analyzed in R (R Founda-
tion, Vienna, Austria) by using RStudio 
Server version 0.98 (Boston, Mass). 
Categorical variables were expressed as 
percentages. Continuous variables were 
expressed as means 6 standard devia-
tions or medians 6 interquartile ranges 
for nonnormal variables. Baseline an-
thropometric data were compared by 
using unpaired t tests and Mann-Whit-
ney U tests pending normality (contin-
uous variables), as well as Fisher exact 
(nominal variables) and Cochran-Ar-
mitage (ordinal variables) tests. Inter-
group age differences were controlled 
for by means of linear regression.
Standard 
principal 
components 
analysis is commonly used to summa-
rize data into components that account 
for most of the variance in the observed 
data, but these components may not 
relate to markers of interest, such as 
outcome or survival. Supervised princi-
pal components analysis is a supervised 
learning approach that is effective for 
Figure 2
Figure 2: Flow diagram for recruitment and analysis of patients with PH. Cardiac MR images were 
segmented and analyzed in 256 eligible patients. In the training phase, supervised machine learning was 
used to discover patterns of RV function associated with outcome. Predictive performance of multivariable 
risk models was assessed by using eightfold cross-validation to demonstrate the incremental value of 
computational phenotyping. CMR = cardiovascular MR.
 Radiology: Volume 283: Number 2—May 2017 n radiology.rsna.org 
385
CARDIAC IMAGING: Machine Learning of Three-dimensional Right Ventricular Motion in Pulmonary Hypertension 
Dawes et al
Figure 3
Figure 3: A comparison of survival prediction for each parameter is shown. (a) Standardized hazard ratios (HRs) (for a 1.96 standard devia-
tion difference) with 95% confidence intervals (CIs) are shown for 3D motion and conventional prognostic markers. (b) Kaplan-Meier curves and 
numbers at risk for the survival of patients with PH were used to compare risk stratification according to 3D motion versus RV ejection fraction 
(RVEF 
). mPAP = mean pulmonary artery pressure, mRAP = mean right atrial pressure, PVR = pulmonary vascular resistance, RAP = right atrial 
pressure, RVEDP = RV end-diastolic pressure, RVEDVI = indexed RV end-diastolic volume, RVESVI = indexed RV end-systolic volume, SV/ESV = 
stroke volume divided by end-systolic volume, 6MWD = 6-minute walk distance.
model was fit for each predictor, (b) 
feature selection was performed by 
selecting predictors with coefficients 
that exceeded an absolute threshold 
(established by means of cross-valida-
tion of the log-likelihood ratios), and 
(c) the first principal component of 
the reduced data matrix was used as 
a prognostic marker. The value of this 
principal component in unseen subjects 
was used to predict whether subjects 
would be alive or dead at censoring and 
 386 
radiology.rsna.org n Radiology: Volume 283: Number 2—May 2017
CARDIAC IMAGING: Machine Learning of Three-dimensional Right Ventricular Motion in Pulmonary Hypertension 
Dawes et al
PH subgroup and are presented in Tables 
E2–E4 (online).
Accuracy and Reproducibility of 
Segmentation and Motion Tracking
Mean Hausdorff distance 6 standard 
deviation between corresponding semi-
automated and manual segmentations 
of the right ventricle was 3.0 mm 6 
1.2. Computational analysis showed 
good interstudy agreement accord-
ing to the intraclass correlation coeffi-
cient in determining the longitudinal, 
radial, and circumferential positions of 
corresponding points in each orthogo-
nal coordinate (intraclass correlation 
coefficients of 0.98, 0.98, and 0.91, 
respectively; all P , .001) and for as-
sessment of cardiac motion (intraclass 
correlation coefficients of 0.90, 0.81, 
and 0.82, respectively; all P , .001). A 
3D representation of the spatial errors 
in segmentation is given in Figure E2 
(online).
Survival Prediction
Univariate Cox regression analyses in-
dicated that age, sex, and race (“clinical 
markers”), mean right atrial pressure 
and RV end-diastolic pressure (“he-
modynamic markers”), functional class 
and 6-minute walk distance (“functional 
markers”), and all baseline cardiac MR 
measurements (“volumetric markers”) 
were significantly associated with sur-
vival (Table E1 [online]). Univariate 
standardized hazard ratios for each 
predictor and Kaplan-Meier estimates 
of survival used to compare RV ejec-
tion fraction to 3D motion analysis are 
shown in Figure 3.
Feature extraction and supervised 
learning from the data are shown in 
Figure 4. All three nested prediction 
models were significant when com-
pared with the null hypothesis (all P , 
.001), and there was a significant differ-
ence between the predictive power of 
the models (analysis of variance hazard 
ratio, F = 80.2 [P , .001]; area under 
the ROC curve, F = 94.2 [P , .001]; R2 
analysis, F = 40.7 [P , .001]). Model 3, 
which included 3D motion, had a sig-
nificantly higher hazard ratio, area un-
der the ROC curve, and R2 value, and 
a greater difference in median survival 
Individual Prognosis or Diagnosis, or 
TRIPOD, guidelines.
Results
Study Population Characteristics
In total, 405 consecutive patients referred 
for investigation to Imperial College 
Healthcare NHS Trust were evaluated 
for eligibility, and 256 subjects with con-
firmed PH were enrolled. Of these, 36% 
(93 of 256) died, and one underwent 
lung transplantation during follow-up, 
which was a median length of 4.0 years 
(interquartile range, 2.0–5.7 years). In 
the cohort, 6% of patients (16 of 256) 
were unable to take the 6-minute walk 
distance test. Median patient age was 67 
years (range, 52–75 years), and 143 pa-
tients (56%) were women (anthropomet-
ric, hemodynamic, and cardiac MR data 
are presented in Table E1 [online]). Ad-
ditional data were stratified according to 
to fit a Cox proportional-hazards model 
for subject survival from which model 
fit was measured.
Survival was recorded as the time 
between enrollment and death from any 
cause. Survival prediction for the Cox 
proportional-hazards model was assessed 
 
by using the hazard ratio, the R2 value 
for each model, and the area under the 
curve by using time-dependent receiver 
operating characteristic (ROC) analysis 
for 1-year survival (22). The model was 
bootstrapped (1000 bootstraps) to esti-
mate performance metrics, which were 
then compared by means of analysis of 
variance with post hoc Tukey testing. 
Model performance was compared with 
the null hypothesis by means of per-
mutation testing (1000 permutations), 
with a P value less than .05 considered 
to indicate a significant difference.
This study was conducted accord-
ing to the Transparent Reporting of 
a Multivariable Prediction Model for 
Figure 4
Figure 4: Illustration of how features of RV motion are automatically selected for prognostic importance 
in patients with PH. A, Plot represents how the magnitude of systolic excursion in the right ventricle, derived 
from atlas-based cardiac segmentations, varies between survivors and nonsurvivors from the basal level to 
the apical level. B, Plot shows where supervised machine learning identifies features within these motion-
based data that most accurately allow discrimination between low-risk and high-risk patients. The full model 
used for survival prediction took into account the prognostic importance of motion throughout a 3D represen-
tation of the right ventricle, resolved into orthogonal components.
 Radiology: Volume 283: Number 2—May 2017 n radiology.rsna.org 
387
CARDIAC IMAGING: Machine Learning of Three-dimensional Right Ventricular Motion in Pulmonary Hypertension 
Dawes et al
time (all P , .001) (Table). Five-year 
survival from time of diagnosis accord-
ing to quartiles of risk predicted with 
model 3 is shown in Figure 5.
Functional Contributions to Survival and 
Ventricular Function
Systolic function throughout most of 
the right ventricle and septum was 
influential in patient survival (Fig 6). 
 
Reduced longitudinal excursion through-
out the basal and midventricular re-
gions was associated with poor out-
come. A decrease in radial contraction 
in the septum and free wall also had 
prognostic significance. Mortality was 
also predicted by a global increase in 
circumferential 
function. 
Machine-
learning analysis from the motion data 
sets enabled prediction of survival in 
all three PH subgroups (all P , .001), 
and the variation in cardiac function 
between groups is shown in Figure E3 
(online).
Discussion
Semiautomated analysis of cine cardiac 
MR images in patients with PH is feasi-
ble, accurate, and reproducible. Super-
vised machine learning of the patterns 
of cardiac motion indicates that survival 
in patients with PH is predicted by a 
loss of effective contractile motion in 
anatomically distinct but functionally 
synergistic regions of the right ventri-
cle. A machine-learning survival model 
that includes cardiac motion has incre-
mental prognostic power when com-
pared with conventional parameters.
Computational modeling provides 
a platform for improving our under-
standing of the heart, and the inte-
gration of experimental and clinical 
data is now bringing computational 
models closer to use in routine clin-
ical practice (23). Advances in both 
cardiac imaging and analytic models 
offer a wealth of biological data that 
contribute to the search for novel 
biomarkers of cardiac dysfunction. 
Multimodal techniques can now offer 
biventricular electromechanical mod-
eling, fluid-solid mechanical models, 
and luminal flow streamlines cou-
pled with myocardial displacement 
Survival Prediction in the Validation Cases
Model
Predictors in Each Model
Hazard Ratio
Model Comparison  
for Hazard Ratio
Area under the  
ROC Curve
Model Comparison  
for Area under  
the ROC Curve
R 2 Value
Model Comparison  
for R 2 Value
Survival (y)
Model Comparison  
for Survival
Clinical  
Markers
RHC  
Markers
Functional  
Markers
MR  
Markers
3D  
Marker
Model 1 Yes
Yes
Yes
No
No
1.71 (1.24, 2.17) …
0.64 (0.49, 0.76) …
0.09 (0.03, 0.19) …
9.5 (3.3, 22.0) …
Model 2 Yes
Yes
Yes
Yes
No
1.66 (1.33, 2.02) Model 2 vs 1,  
P = .06
0.60 (0.49, 0.74) Model 2 vs 1,  
P = .33
0.08 (0.03, 0.15) Model 2 vs 1,  
P = .09
10.7 (5.0, 22.6) Model 2 vs 1,  
P = .52
Model 3 Yes
Yes
Yes
Yes
Yes
1.99 (1.59, 2.69) Model 3 vs 2,  
P , .001
0.73 (0.58, 0.81) Model 3 vs 2,  
P , .001
0.13 (0.07, 0.20) Model 3 vs 2,  
P , .001
13.8 (8.0, 25.3) Model 3 vs 2,  
P , .001
Note.—Numbers in parentheses are 95% confidence intervals. Clinical markers were age, sex, race, and PH subtype; RHC hemodynamic markers were right atrial pressure and RV end-diastolic pressure. Functional markers were New York Heart 
Association functional class and 6-minute walk distance. MR markers were RV end-diastolic volume index, RV end-systolic volume index, RV ejection fraction, and stroke volume divided by RV end-systolic volume. The 3D marker was 3D motion. 
Area under the ROC curve indicates the performance of each marker in 1-year survival prediction. In subgroups with more than 50% survival at censoring, median survival values were extrapolated. All models were significantly better predictors than 
the null hypothesis (P , .001).
 388 
radiology.rsna.org n Radiology: Volume 283: Number 2—May 2017
CARDIAC IMAGING: Machine Learning of Three-dimensional Right Ventricular Motion in Pulmonary Hypertension 
Dawes et al
The predictive performance of machine 
learning is independent of PH subtype, 
but the models identify some prognostic 
variations in RV geometry and function 
that may reflect differing responses to 
altered loading conditions. These integra-
tive models of right-sided heart physiol-
ogy show that cardiac decompensation 
is not simply a global decline in function 
but instead results from a loss of effective 
contractile motion in anatomically dis-
tinct but functionally synergistic regions.
Innovation in biomarker discovery 
and personalized medicine requires a 
cultural change in how clinical data are 
exploited (6). Here we have demon-
strated how it is possible to maximize 
the potential of existing imaging re-
sources for outcome prediction by us-
ing computational models that require 
minimal human intervention. As well as 
performing accurate risk classification 
of individual patients, the models also 
inform clinicians about the functional 
mechanisms that underlie RV failure. 
The potential for such computational 
simulations lies not only in risk strati-
fication but also in designing trials for 
new therapies that have a direct effect 
on RV contractility. Future work will 
be directed at improving the depth of 
phenotyping by using time-resolved seg-
mentations throughout the cardiac cycle 
to model 3D strain tensors, evaluating 
machine-learning predictions in an inde-
pendent validation cohort benchmarked 
against conventional multivariate risk 
models, and exploring the potential of 
deep learning architectures for hierar-
chical feature recognition (33,34).
Our study has limitations. The prag-
matic study design, which included all 
noncongenital cases of PH and all treat-
ment regimens, may limit applicability 
in selective groups but demonstrates 
that the methods are effective across a 
spectrum of disease and treatments. We 
classified our patients according to inter-
national guidelines, but it is recognized 
that patients with PH have multifactorial 
disease with overlap between categories. 
Study end point and censoring were con-
fined to all-cause mortality to avoid bias 
in the classification of cause of death, 
though the performance of markers will 
also be affected by variations in therapy 
imaging, a mathematical model of 
the relationship of cardiac function to 
survival can be generated.
Conventional cardiac MR studies in 
PH have shown that deteriorating RV 
function is associated with poor outcome, 
despite therapeutic reductions in pulmo-
nary vascular resistance (4). Imaging can 
be used to assess RV systolic function in 
several ways, typically by means of global 
measures of pump function or regional 
systolic excursion (29). Our models indi-
cate that survival is linked to a combined 
failure of basal longitudinal shortening 
and transverse contraction of the septum 
and free wall. The importance of these in-
dividual components of motion to pump 
function has been proposed previously 
in physiological studies (30), and here 
we demonstrate the combined influence 
on outcome. The modeling also demon-
strates the risk associated with adapta-
tions of circumferential function, which 
tends to increase in PH as global failure 
develops (31). Raised afterload and RV 
dilatation are associated with fiber re-
orientation toward the circumferential 
direction (32), and our data indicate 
that such adverse structural remodeling 
independently contributes to survival. 
(24,25). Atlas-based analysis in the 
heart has been applied to describing 
shape variation among asymptomatic 
adults, identifying persisting effects 
of preterm delivery on ventricular 
geometry, and demonstrating pat-
terns of remodeling after myocardial 
infarction (9,26,27). The potential for 
this technique lies not just in shape 
analysis but as a means to understand 
how the integrated function of the 
heart contributes to survival in large 
clinical cohorts as the data from each 
subject are coregistered. While other 
approaches to cardiac segmentation 
are more widely available, atlas-based 
methods maintain the anatomic cor-
respondence of the 3D mesh between 
patients. Machine learning, both su-
pervised and unsupervised, can be 
applied to clinical data sets for the 
purpose of developing robust risk 
models and redefining patient classes 
(28). In this study, we used a complex 
3D model of cardiac displacement and 
applied a machine-learning algorithm 
to identify recurring patterns within 
this high-dimensional data set that 
enabled prediction of outcomes most 
strongly. From standard diagnostic 
Figure 5
Figure 5: Graph shows observed 5-year survival from the time of diagnosis according to predicted risk 
strata obtained by using model 3, as described in the Table.
 Radiology: Volume 283: Number 2—May 2017 n radiology.rsna.org 
389
CARDIAC IMAGING: Machine Learning of Three-dimensional Right Ventricular Motion in Pulmonary Hypertension 
Dawes et al
regional contraction in the circumferen-
tial and radial directions also contribute 
to prognosis.
In conclusion, applying machine 
learning of complex motion phenotypes 
obtained from cardiac MR imaging al-
lows more accurate prediction of pa-
tient outcomes in PH.
Acknowledgments: The authors thank our ra-
diographers Giuliana Durighel, MSc, Marina 
Quinlan, MSc, and Catherine Holden, BSc, and 
our research nurses Tamara Diamond, RN, BSc, 
and Laura Monje-Garcia, RN, MSc. We also ac-
knowledge the staff of the National Institute for 
Health Research and Wellcome Trust Imperial 
Clinical Research Facility, Hammersmith Hospi-
tal (London, England), and George Villa for the 
TRIPHIC (Translational Research in Pulmonary 
Hypertension at Imperial College) database.
Disclosures of Conflicts of Interest: T.J.W
.D. 
disclosed no relevant relationships. A.d.M. dis-
closed no relevant relationships. W
.S. disclosed 
no relevant relationships. T.F. disclosed no rele-
vant relationships. G.M.J.W
. disclosed no rel-
evant relationships. J.W
. disclosed no relevant 
relationships. C.J.R. disclosed no relevant re-
lationships. L.S.G.E.H. disclosed no relevant 
relationships. J.S.R.G. Activities related to the 
present article: author received grants and per-
sonal fees from Actelion, Bayer, and GSK; author 
received personal fees from Gilead, Pfizer, AOP 
Orphan, and Novartis; author received grants 
from United Therapeutics and Amco. Activities 
not related to the present article: disclosed no 
relevant relationships. Other relationships: dis-
closed no relevant relationships. D.R. Activities 
related to the present article: author received 
grants from EPSRC. Activities not related to the 
present article: disclosed no relevant relation-
ships. Other relationships: disclosed no relevant 
relationships. S.A.C. disclosed no relevant rela-
tionships. M.R.W
. disclosed no relevant relation-
ships. D.P.O. disclosed no relevant relationships.
References
 1. Galiè N, Humbert M, Vachiery JL, et al. 
2015 ESC/ERS guidelines for the diagnosis 
and treatment of pulmonary hypertension: 
The Joint Task Force for the Diagnosis and 
Treatment of Pulmonary Hypertension of 
the European Society of Cardiology (ESC) 
and the European Respiratory Society 
(ERS). Endorsed by: Association for Euro-
pean Paediatric and Congenital Cardiology 
(AEPC), International Society for Heart and 
Lung Transplantation (ISHLT). Eur Respir J 
2015;46(4):903–975.
 2. Benza RL, Miller DP
, Gomberg-Maitland M, 
et al. Predicting survival in pulmonary arte-
rial hypertension: insights from the Registry 
to Evaluate Early and Long-Term Pulmonary 
Arterial Hypertension Disease Management 
(REVEAL). Circulation 2010;122(2):164–172.
of the 3D functional model, as this ex-
plains the most variance in data as is 
possible and allows a fair comparison 
with other single-parameter predictors. 
The cumulative variance of subsequent 
components may further improve pre-
diction, although later components are 
increasingly influenced by noise. Con-
temporaneous echocardiography and 
cardiopulmonary exercise testing were 
not available for each case. Tricuspid 
annular-plane systolic excursion offers 
a prognostic indicator that is simple to 
measure, and although we confirm the 
importance of basal longitudinal excur-
sion to survival, the models show that 
and those selected for surgery. The ac-
curacy of our segmentation technique 
compares well to that in previously 
published results (14); however, the 
uncertainty in both end-diastolic and 
end-systolic segmentation will propagate 
to the uncertainty in displacement esti-
mation. Our models are also currently 
limited to measuring excursion rather 
than contractility, and deriving strain 
tensors may add additional prognostic 
data (34). Human intervention is limited 
to landmark placement, but newer tech-
niques offer a means to also automate 
this step (35). We considered only the 
first supervised principal component 
Figure 6
Figure 6: A 3D model of the right ventricle shows the regional contributions to survival prediction in 256 
patients with PH. The models show where reduced (red) or increased (blue) systolic motion is associated 
with death. This is shown by, A, the magnitude of excursion, as well as, B–D, each directional component. 
The right ventricle is shown in the anterior and septal views, with the left ventricle depicted as a mesh. A 
reduction in both longitudinal basal motion and transverse bellows contraction is associated with death, as is 
an increase in circumferential contraction.
 390 
radiology.rsna.org n Radiology: Volume 283: Number 2—May 2017
CARDIAC IMAGING: Machine Learning of Three-dimensional Right Ventricular Motion in Pulmonary Hypertension 
Dawes et al
 3. Vonk-Noordegraaf A, Haddad F, Chin KM, 
et al. Right heart adaptation to pulmo-
nary arterial hypertension: physiology and 
pathobiology. J Am Coll Cardiol 2013;62(25 
Suppl):D22–D33.
 4. van de Veerdonk MC, Kind T, Marcus JT, et 
al. Progressive right ventricular dysfunction 
in patients with pulmonary arterial hyper-
tension responding to therapy. J Am Coll 
Cardiol 2011;58(24):2511–2519.
 5. Naeije R, Ghio S. More on the right ventri-
cle in pulmonary hypertension. Eur Respir J 
2015;45(1):33–35.
 6. Scruggs SB, Watson K, Su AI, et al. Har-
nessing the heart of big data. Circ Res 2015; 
116(7):1115–1119.
 7. Fonseca CG, Backhaus M, Bluemke DA, et 
al. The Cardiac Atlas Project—an imaging 
database for computational modeling and 
statistical atlases of the heart. Bioinformat-
ics 2011;27(16):2288–2295.
 8. de Marvao A, Dawes TJ, Shi W, et al. Pop-
ulation-based studies of myocardial hyper-
trophy: high resolution cardiovascular mag-
netic resonance atlases improve statistical 
power. J Cardiovasc Magn Reson 2014;16: 
16.
 9. Medrano-Gracia P, Cowan BR, Ambale-Ven-
katesh B, et al. Left ventricular shape varia-
tion in asymptomatic populations: the Multi-
Ethnic Study of Atherosclerosis. J Cardiovasc 
Magn Reson 2014;16:56.
 
10. NHS England. Clinical Commissioning Pol-
icy: National Policy for Targeted Therapies 
for the Treatment of Pulmonary Hyperten-
sion in Adults. London, England: NHS Eng-
land, 2014.
 
11. ATS Committee on Proficiency Standards for 
Clinical Pulmonary Function Laboratories. 
ATS statement: guidelines for the six-minute 
walk test. Am J Respir Crit Care Med 2002; 
166(1):111–117.
 
12. Kramer CM, Barkhausen J, Flamm SD, 
Kim RJ, Nagel E; Society for Cardiovascu-
lar Magnetic Resonance Board of Trustees 
Task Force on Standardized Protocols. Stan-
dardized cardiovascular magnetic resonance 
(CMR) protocols 2013 update. J Cardiovasc 
Magn Reson 2013;15:91.
 
13. Schulz-Menger J, Bluemke DA, Bremerich J, 
et al. Standardized image interpretation and 
post processing in cardiovascular magnetic 
resonance: Society for Cardiovascular Mag-
netic Resonance (SCMR) board of trustees 
task force on standardized post processing. 
J Cardiovasc Magn Reson 2013;15:35.
 
14. Petitjean C, Zuluaga MA, Bai W, et al. Right 
ventricle segmentation from cardiac MRI: a 
collation study. Med Image Anal 2015;19(1): 
187–202.
 
15. Hill DL, Batchelor PG, Holden M, Hawkes 
DJ. Medical image registration. Phys Med 
Biol 2001;46(3):R1–R45.
 
16. Bai W, Shi W, de Marvao A, et al. A bi-ven-
tricular cardiac atlas built from 1000+ high 
resolution MR images of healthy subjects 
and an analysis of shape and motion. Med 
Image Anal 2015;26(1):133–145.
 
17. Aljabar P, Heckemann RA, Hammers A, 
Hajnal JV, Rueckert D. Multi-atlas based 
segmentation of brain images: atlas selec-
tion and its effect on accuracy. Neuroimage 
2009;46(3):726–738.
 
18. Shi W
, Lombaert H, Bai W
, et al. Multi-atlas 
spectral PatchMatch: application to cardiac 
image segmentation. Med Image Comput 
Comput Assist Interv 2014;17(Pt 1):348–
355.
 
19. Wang H, Shi W
, Zhuang X, et al. Automatic 
Cardiac Motion Tracking Using Both Un-
tagged and 3D Tagged MR Images. In: Ca-
mara O, Konukoglu E, Pop M, Rhode K, Ser-
mesant M, Young A, eds. Statistical Atlases 
and Computational Models of the Heart Im-
aging and Modelling Challenges: Second In-
ternational Workshop, STACOM 2011, held 
in conjunction with MICCAI 2011, Toronto, 
ON, Canada, September 22, 2011, revised 
selected papers. Berlin, Germany: Springer, 
2012; 45–54.
 
20. Bair E, Tibshirani R. Semi-supervised 
methods to predict patient survival from gene 
expression data. PLoS Biol 2004;2(4):E108.
 
21. Simon RM, Subramanian J, Li MC, Mene-
zes S. Using cross-validation to evaluate 
predictive accuracy of survival risk classi-
fiers based on high-dimensional data. Brief 
Bioinform 2011;12(3):203–214.
 
22. Heagerty PJ, Lumley T, Pepe MS. Time-de-
pendent ROC curves for censored survival 
data and a diagnostic marker. Biometrics 
2000;56(2):337–344.
 
23. Chabiniok R, Wang VY, Hadjicharalam-
bous M, et al. Multiphysics and multiscale 
modelling, data-model fusion and integra-
tion of organ physiology in the clinic: ven-
tricular cardiac mechanics. Interface Focus 
2016;6(2):20150083.
 
24. Sermesant M, Chabiniok R, Chinchapatnam 
P, et al. Patient-specific electromechanical 
models of the heart for the prediction of pac-
ing acute effects in CRT: a preliminary clin-
ical validation. Med Image Anal 2012;16(1): 
201–215.
 
25. McCormick M, Nordsletten DA, Kay D, 
Smith NP. Simulating left ventricular fluid–
solid mechanics through the cardiac cycle 
under LVAD support. J Comput Phys 2013; 
244:80–96.
 
26. Lewandowski AJ, Augustine D, Lamata P, et 
al. Preterm heart in adult life: cardiovascular 
magnetic resonance reveals distinct differ-
ences in left ventricular mass, geometry, and 
function. Circulation 2013;127(2):197–206.
 
27. Zhang X, Cowan BR, Bluemke DA, et al. At-
las-based quantification of cardiac remodel-
ing due to myocardial infarction. PLoS One 
2014;9(10):e110243.
 
28. Deo RC. Machine learning in medicine. Cir-
culation 2015;132(20):1920–1930.
 
29. Forfia PR, Fisher MR, Mathai SC, et al. Tri-
cuspid annular displacement predicts survival 
in pulmonary hypertension. Am J Respir Crit 
Care Med 2006;174(9):1034–1041.
 
30. Kind T, Mauritz GJ, Marcus JT, van de Veer-
donk M, Westerhof N, Vonk-Noordegraaf A. 
Right ventricular ejection fraction is better 
reflected by transverse rather than longitu-
dinal wall motion in pulmonary hyperten-
sion. J Cardiovasc Magn Reson 2010;12:35.
 
31. Buckberg G, Mahajan A, Saleh S, Hoffman 
JI, Coghlan C. Structure and function rela-
tionships of the helical ventricular myocar-
dial band. J Thorac Cardiovasc Surg 2008; 
136(3):578–589, 589.e1–589.e11.
 
32. Pettersen E, Helle-Valle T, Edvardsen T, et 
al. Contraction pattern of the systemic right 
ventricle shift from longitudinal to circumfer-
ential shortening and absent global ventricu-
lar torsion. J Am Coll Cardiol 2007;49(25): 
2450–2456.
 
33. LeCun Y, Bengio Y, Hinton G. Deep learn-
ing. Nature 2015;521(7553):436–444.
 
34. Auger DA, Zhong X, Epstein FH, Spottis-
woode BS. Mapping right ventricular myo-
cardial mechanics using 3D cine DENSE 
cardiovascular magnetic resonance. J Car-
diovasc Magn Reson 2012;14:4.
 
35. Oktay O, Bai W, Guerrero R, et al. Strati-
fied decision forests for accurate anatomical 
landmark localization. IEEE Trans Med Im-
aging 2016. [Epub ahead of print] 
